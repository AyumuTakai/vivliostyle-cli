(() => {
  let __defineProperty = Object.defineProperty;
  let __hasOwnProperty = Object.prototype.hasOwnProperty;
  let __commonJS = (callback, module) => () => {
    if (!module) {
      module = { exports: {} };
      callback(module.exports, module);
    }
    return module.exports;
  };
  let __markAsModule = (target) => {
    return __defineProperty(target, '__esModule', { value: true });
  };
  let __exportStar = (target, module) => {
    __markAsModule(target);
    if (typeof module === 'object' || typeof module === 'function') {
      for (let key in module)
        if (
          __hasOwnProperty.call(module, key) &&
          !__hasOwnProperty.call(target, key) &&
          key !== 'default'
        )
          __defineProperty(target, key, {
            get: () => module[key],
            enumerable: true,
          });
    }
    return target;
  };
  let __toModule = (module) => {
    if (module && module.__esModule) return module;
    return __exportStar(
      __defineProperty({}, 'default', { value: module, enumerable: true }),
      module,
    );
  };

  // node_modules/fast-diff/diff.js
  var require_diff = __commonJS((exports, module) => {
    var DIFF_DELETE = -1;
    var DIFF_INSERT = 1;
    var DIFF_EQUAL = 0;
    function diff_main(text1, text2, cursor_pos, _fix_unicode) {
      if (text1 === text2) {
        if (text1) {
          return [[DIFF_EQUAL, text1]];
        }
        return [];
      }
      if (cursor_pos != null) {
        var editdiff = find_cursor_edit_diff(text1, text2, cursor_pos);
        if (editdiff) {
          return editdiff;
        }
      }
      var commonlength = diff_commonPrefix(text1, text2);
      var commonprefix = text1.substring(0, commonlength);
      text1 = text1.substring(commonlength);
      text2 = text2.substring(commonlength);
      commonlength = diff_commonSuffix(text1, text2);
      var commonsuffix = text1.substring(text1.length - commonlength);
      text1 = text1.substring(0, text1.length - commonlength);
      text2 = text2.substring(0, text2.length - commonlength);
      var diffs = diff_compute_(text1, text2);
      if (commonprefix) {
        diffs.unshift([DIFF_EQUAL, commonprefix]);
      }
      if (commonsuffix) {
        diffs.push([DIFF_EQUAL, commonsuffix]);
      }
      diff_cleanupMerge(diffs, _fix_unicode);
      return diffs;
    }
    function diff_compute_(text1, text2) {
      var diffs;
      if (!text1) {
        return [[DIFF_INSERT, text2]];
      }
      if (!text2) {
        return [[DIFF_DELETE, text1]];
      }
      var longtext = text1.length > text2.length ? text1 : text2;
      var shorttext = text1.length > text2.length ? text2 : text1;
      var i2 = longtext.indexOf(shorttext);
      if (i2 !== -1) {
        diffs = [
          [DIFF_INSERT, longtext.substring(0, i2)],
          [DIFF_EQUAL, shorttext],
          [DIFF_INSERT, longtext.substring(i2 + shorttext.length)],
        ];
        if (text1.length > text2.length) {
          diffs[0][0] = diffs[2][0] = DIFF_DELETE;
        }
        return diffs;
      }
      if (shorttext.length === 1) {
        return [
          [DIFF_DELETE, text1],
          [DIFF_INSERT, text2],
        ];
      }
      var hm = diff_halfMatch_(text1, text2);
      if (hm) {
        var text1_a = hm[0];
        var text1_b = hm[1];
        var text2_a = hm[2];
        var text2_b = hm[3];
        var mid_common = hm[4];
        var diffs_a = diff_main(text1_a, text2_a);
        var diffs_b = diff_main(text1_b, text2_b);
        return diffs_a.concat([[DIFF_EQUAL, mid_common]], diffs_b);
      }
      return diff_bisect_(text1, text2);
    }
    function diff_bisect_(text1, text2) {
      var text1_length = text1.length;
      var text2_length = text2.length;
      var max_d = Math.ceil((text1_length + text2_length) / 2);
      var v_offset = max_d;
      var v_length = 2 * max_d;
      var v1 = new Array(v_length);
      var v2 = new Array(v_length);
      for (var x2 = 0; x2 < v_length; x2++) {
        v1[x2] = -1;
        v2[x2] = -1;
      }
      v1[v_offset + 1] = 0;
      v2[v_offset + 1] = 0;
      var delta = text1_length - text2_length;
      var front = delta % 2 !== 0;
      var k1start = 0;
      var k1end = 0;
      var k2start = 0;
      var k2end = 0;
      for (var d2 = 0; d2 < max_d; d2++) {
        for (var k1 = -d2 + k1start; k1 <= d2 - k1end; k1 += 2) {
          var k1_offset = v_offset + k1;
          var x1;
          if (
            k1 === -d2 ||
            (k1 !== d2 && v1[k1_offset - 1] < v1[k1_offset + 1])
          ) {
            x1 = v1[k1_offset + 1];
          } else {
            x1 = v1[k1_offset - 1] + 1;
          }
          var y1 = x1 - k1;
          while (
            x1 < text1_length &&
            y1 < text2_length &&
            text1.charAt(x1) === text2.charAt(y1)
          ) {
            x1++;
            y1++;
          }
          v1[k1_offset] = x1;
          if (x1 > text1_length) {
            k1end += 2;
          } else if (y1 > text2_length) {
            k1start += 2;
          } else if (front) {
            var k2_offset = v_offset + delta - k1;
            if (
              k2_offset >= 0 &&
              k2_offset < v_length &&
              v2[k2_offset] !== -1
            ) {
              var x22 = text1_length - v2[k2_offset];
              if (x1 >= x22) {
                return diff_bisectSplit_(text1, text2, x1, y1);
              }
            }
          }
        }
        for (var k2 = -d2 + k2start; k2 <= d2 - k2end; k2 += 2) {
          var k2_offset = v_offset + k2;
          var x22;
          if (
            k2 === -d2 ||
            (k2 !== d2 && v2[k2_offset - 1] < v2[k2_offset + 1])
          ) {
            x22 = v2[k2_offset + 1];
          } else {
            x22 = v2[k2_offset - 1] + 1;
          }
          var y2 = x22 - k2;
          while (
            x22 < text1_length &&
            y2 < text2_length &&
            text1.charAt(text1_length - x22 - 1) ===
              text2.charAt(text2_length - y2 - 1)
          ) {
            x22++;
            y2++;
          }
          v2[k2_offset] = x22;
          if (x22 > text1_length) {
            k2end += 2;
          } else if (y2 > text2_length) {
            k2start += 2;
          } else if (!front) {
            var k1_offset = v_offset + delta - k2;
            if (
              k1_offset >= 0 &&
              k1_offset < v_length &&
              v1[k1_offset] !== -1
            ) {
              var x1 = v1[k1_offset];
              var y1 = v_offset + x1 - k1_offset;
              x22 = text1_length - x22;
              if (x1 >= x22) {
                return diff_bisectSplit_(text1, text2, x1, y1);
              }
            }
          }
        }
      }
      return [
        [DIFF_DELETE, text1],
        [DIFF_INSERT, text2],
      ];
    }
    function diff_bisectSplit_(text1, text2, x2, y2) {
      var text1a = text1.substring(0, x2);
      var text2a = text2.substring(0, y2);
      var text1b = text1.substring(x2);
      var text2b = text2.substring(y2);
      var diffs = diff_main(text1a, text2a);
      var diffsb = diff_main(text1b, text2b);
      return diffs.concat(diffsb);
    }
    function diff_commonPrefix(text1, text2) {
      if (!text1 || !text2 || text1.charAt(0) !== text2.charAt(0)) {
        return 0;
      }
      var pointermin = 0;
      var pointermax = Math.min(text1.length, text2.length);
      var pointermid = pointermax;
      var pointerstart = 0;
      while (pointermin < pointermid) {
        if (
          text1.substring(pointerstart, pointermid) ==
          text2.substring(pointerstart, pointermid)
        ) {
          pointermin = pointermid;
          pointerstart = pointermin;
        } else {
          pointermax = pointermid;
        }
        pointermid = Math.floor((pointermax - pointermin) / 2 + pointermin);
      }
      if (is_surrogate_pair_start(text1.charCodeAt(pointermid - 1))) {
        pointermid--;
      }
      return pointermid;
    }
    function diff_commonSuffix(text1, text2) {
      if (!text1 || !text2 || text1.slice(-1) !== text2.slice(-1)) {
        return 0;
      }
      var pointermin = 0;
      var pointermax = Math.min(text1.length, text2.length);
      var pointermid = pointermax;
      var pointerend = 0;
      while (pointermin < pointermid) {
        if (
          text1.substring(
            text1.length - pointermid,
            text1.length - pointerend,
          ) ==
          text2.substring(text2.length - pointermid, text2.length - pointerend)
        ) {
          pointermin = pointermid;
          pointerend = pointermin;
        } else {
          pointermax = pointermid;
        }
        pointermid = Math.floor((pointermax - pointermin) / 2 + pointermin);
      }
      if (is_surrogate_pair_end(text1.charCodeAt(text1.length - pointermid))) {
        pointermid--;
      }
      return pointermid;
    }
    function diff_halfMatch_(text1, text2) {
      var longtext = text1.length > text2.length ? text1 : text2;
      var shorttext = text1.length > text2.length ? text2 : text1;
      if (longtext.length < 4 || shorttext.length * 2 < longtext.length) {
        return null;
      }
      function diff_halfMatchI_(longtext2, shorttext2, i2) {
        var seed = longtext2.substring(
          i2,
          i2 + Math.floor(longtext2.length / 4),
        );
        var j2 = -1;
        var best_common = '';
        var best_longtext_a,
          best_longtext_b,
          best_shorttext_a,
          best_shorttext_b;
        while ((j2 = shorttext2.indexOf(seed, j2 + 1)) !== -1) {
          var prefixLength = diff_commonPrefix(
            longtext2.substring(i2),
            shorttext2.substring(j2),
          );
          var suffixLength = diff_commonSuffix(
            longtext2.substring(0, i2),
            shorttext2.substring(0, j2),
          );
          if (best_common.length < suffixLength + prefixLength) {
            best_common =
              shorttext2.substring(j2 - suffixLength, j2) +
              shorttext2.substring(j2, j2 + prefixLength);
            best_longtext_a = longtext2.substring(0, i2 - suffixLength);
            best_longtext_b = longtext2.substring(i2 + prefixLength);
            best_shorttext_a = shorttext2.substring(0, j2 - suffixLength);
            best_shorttext_b = shorttext2.substring(j2 + prefixLength);
          }
        }
        if (best_common.length * 2 >= longtext2.length) {
          return [
            best_longtext_a,
            best_longtext_b,
            best_shorttext_a,
            best_shorttext_b,
            best_common,
          ];
        } else {
          return null;
        }
      }
      var hm1 = diff_halfMatchI_(
        longtext,
        shorttext,
        Math.ceil(longtext.length / 4),
      );
      var hm2 = diff_halfMatchI_(
        longtext,
        shorttext,
        Math.ceil(longtext.length / 2),
      );
      var hm;
      if (!hm1 && !hm2) {
        return null;
      } else if (!hm2) {
        hm = hm1;
      } else if (!hm1) {
        hm = hm2;
      } else {
        hm = hm1[4].length > hm2[4].length ? hm1 : hm2;
      }
      var text1_a, text1_b, text2_a, text2_b;
      if (text1.length > text2.length) {
        text1_a = hm[0];
        text1_b = hm[1];
        text2_a = hm[2];
        text2_b = hm[3];
      } else {
        text2_a = hm[0];
        text2_b = hm[1];
        text1_a = hm[2];
        text1_b = hm[3];
      }
      var mid_common = hm[4];
      return [text1_a, text1_b, text2_a, text2_b, mid_common];
    }
    function diff_cleanupMerge(diffs, fix_unicode) {
      diffs.push([DIFF_EQUAL, '']);
      var pointer = 0;
      var count_delete = 0;
      var count_insert = 0;
      var text_delete = '';
      var text_insert = '';
      var commonlength;
      while (pointer < diffs.length) {
        if (pointer < diffs.length - 1 && !diffs[pointer][1]) {
          diffs.splice(pointer, 1);
          continue;
        }
        switch (diffs[pointer][0]) {
          case DIFF_INSERT:
            count_insert++;
            text_insert += diffs[pointer][1];
            pointer++;
            break;
          case DIFF_DELETE:
            count_delete++;
            text_delete += diffs[pointer][1];
            pointer++;
            break;
          case DIFF_EQUAL:
            var previous_equality = pointer - count_insert - count_delete - 1;
            if (fix_unicode) {
              if (
                previous_equality >= 0 &&
                ends_with_pair_start(diffs[previous_equality][1])
              ) {
                var stray = diffs[previous_equality][1].slice(-1);
                diffs[previous_equality][1] = diffs[previous_equality][1].slice(
                  0,
                  -1,
                );
                text_delete = stray + text_delete;
                text_insert = stray + text_insert;
                if (!diffs[previous_equality][1]) {
                  diffs.splice(previous_equality, 1);
                  pointer--;
                  var k2 = previous_equality - 1;
                  if (diffs[k2] && diffs[k2][0] === DIFF_INSERT) {
                    count_insert++;
                    text_insert = diffs[k2][1] + text_insert;
                    k2--;
                  }
                  if (diffs[k2] && diffs[k2][0] === DIFF_DELETE) {
                    count_delete++;
                    text_delete = diffs[k2][1] + text_delete;
                    k2--;
                  }
                  previous_equality = k2;
                }
              }
              if (starts_with_pair_end(diffs[pointer][1])) {
                var stray = diffs[pointer][1].charAt(0);
                diffs[pointer][1] = diffs[pointer][1].slice(1);
                text_delete += stray;
                text_insert += stray;
              }
            }
            if (pointer < diffs.length - 1 && !diffs[pointer][1]) {
              diffs.splice(pointer, 1);
              break;
            }
            if (text_delete.length > 0 || text_insert.length > 0) {
              if (text_delete.length > 0 && text_insert.length > 0) {
                commonlength = diff_commonPrefix(text_insert, text_delete);
                if (commonlength !== 0) {
                  if (previous_equality >= 0) {
                    diffs[previous_equality][1] += text_insert.substring(
                      0,
                      commonlength,
                    );
                  } else {
                    diffs.splice(0, 0, [
                      DIFF_EQUAL,
                      text_insert.substring(0, commonlength),
                    ]);
                    pointer++;
                  }
                  text_insert = text_insert.substring(commonlength);
                  text_delete = text_delete.substring(commonlength);
                }
                commonlength = diff_commonSuffix(text_insert, text_delete);
                if (commonlength !== 0) {
                  diffs[pointer][1] =
                    text_insert.substring(text_insert.length - commonlength) +
                    diffs[pointer][1];
                  text_insert = text_insert.substring(
                    0,
                    text_insert.length - commonlength,
                  );
                  text_delete = text_delete.substring(
                    0,
                    text_delete.length - commonlength,
                  );
                }
              }
              var n2 = count_insert + count_delete;
              if (text_delete.length === 0 && text_insert.length === 0) {
                diffs.splice(pointer - n2, n2);
                pointer = pointer - n2;
              } else if (text_delete.length === 0) {
                diffs.splice(pointer - n2, n2, [DIFF_INSERT, text_insert]);
                pointer = pointer - n2 + 1;
              } else if (text_insert.length === 0) {
                diffs.splice(pointer - n2, n2, [DIFF_DELETE, text_delete]);
                pointer = pointer - n2 + 1;
              } else {
                diffs.splice(
                  pointer - n2,
                  n2,
                  [DIFF_DELETE, text_delete],
                  [DIFF_INSERT, text_insert],
                );
                pointer = pointer - n2 + 2;
              }
            }
            if (pointer !== 0 && diffs[pointer - 1][0] === DIFF_EQUAL) {
              diffs[pointer - 1][1] += diffs[pointer][1];
              diffs.splice(pointer, 1);
            } else {
              pointer++;
            }
            count_insert = 0;
            count_delete = 0;
            text_delete = '';
            text_insert = '';
            break;
        }
      }
      if (diffs[diffs.length - 1][1] === '') {
        diffs.pop();
      }
      var changes = false;
      pointer = 1;
      while (pointer < diffs.length - 1) {
        if (
          diffs[pointer - 1][0] === DIFF_EQUAL &&
          diffs[pointer + 1][0] === DIFF_EQUAL
        ) {
          if (
            diffs[pointer][1].substring(
              diffs[pointer][1].length - diffs[pointer - 1][1].length,
            ) === diffs[pointer - 1][1]
          ) {
            diffs[pointer][1] =
              diffs[pointer - 1][1] +
              diffs[pointer][1].substring(
                0,
                diffs[pointer][1].length - diffs[pointer - 1][1].length,
              );
            diffs[pointer + 1][1] =
              diffs[pointer - 1][1] + diffs[pointer + 1][1];
            diffs.splice(pointer - 1, 1);
            changes = true;
          } else if (
            diffs[pointer][1].substring(0, diffs[pointer + 1][1].length) ==
            diffs[pointer + 1][1]
          ) {
            diffs[pointer - 1][1] += diffs[pointer + 1][1];
            diffs[pointer][1] =
              diffs[pointer][1].substring(diffs[pointer + 1][1].length) +
              diffs[pointer + 1][1];
            diffs.splice(pointer + 1, 1);
            changes = true;
          }
        }
        pointer++;
      }
      if (changes) {
        diff_cleanupMerge(diffs, fix_unicode);
      }
    }
    function is_surrogate_pair_start(charCode) {
      return charCode >= 55296 && charCode <= 56319;
    }
    function is_surrogate_pair_end(charCode) {
      return charCode >= 56320 && charCode <= 57343;
    }
    function starts_with_pair_end(str) {
      return is_surrogate_pair_end(str.charCodeAt(0));
    }
    function ends_with_pair_start(str) {
      return is_surrogate_pair_start(str.charCodeAt(str.length - 1));
    }
    function remove_empty_tuples(tuples) {
      var ret = [];
      for (var i2 = 0; i2 < tuples.length; i2++) {
        if (tuples[i2][1].length > 0) {
          ret.push(tuples[i2]);
        }
      }
      return ret;
    }
    function make_edit_splice(before, oldMiddle, newMiddle, after) {
      if (ends_with_pair_start(before) || starts_with_pair_end(after)) {
        return null;
      }
      return remove_empty_tuples([
        [DIFF_EQUAL, before],
        [DIFF_DELETE, oldMiddle],
        [DIFF_INSERT, newMiddle],
        [DIFF_EQUAL, after],
      ]);
    }
    function find_cursor_edit_diff(oldText, newText, cursor_pos) {
      var oldRange =
        typeof cursor_pos === 'number'
          ? { index: cursor_pos, length: 0 }
          : cursor_pos.oldRange;
      var newRange =
        typeof cursor_pos === 'number' ? null : cursor_pos.newRange;
      var oldLength = oldText.length;
      var newLength = newText.length;
      if (
        oldRange.length === 0 &&
        (newRange === null || newRange.length === 0)
      ) {
        var oldCursor = oldRange.index;
        var oldBefore = oldText.slice(0, oldCursor);
        var oldAfter = oldText.slice(oldCursor);
        var maybeNewCursor = newRange ? newRange.index : null;
        editBefore: {
          var newCursor = oldCursor + newLength - oldLength;
          if (maybeNewCursor !== null && maybeNewCursor !== newCursor) {
            break editBefore;
          }
          if (newCursor < 0 || newCursor > newLength) {
            break editBefore;
          }
          var newBefore = newText.slice(0, newCursor);
          var newAfter = newText.slice(newCursor);
          if (newAfter !== oldAfter) {
            break editBefore;
          }
          var prefixLength = Math.min(oldCursor, newCursor);
          var oldPrefix = oldBefore.slice(0, prefixLength);
          var newPrefix = newBefore.slice(0, prefixLength);
          if (oldPrefix !== newPrefix) {
            break editBefore;
          }
          var oldMiddle = oldBefore.slice(prefixLength);
          var newMiddle = newBefore.slice(prefixLength);
          return make_edit_splice(oldPrefix, oldMiddle, newMiddle, oldAfter);
        }
        editAfter: {
          if (maybeNewCursor !== null && maybeNewCursor !== oldCursor) {
            break editAfter;
          }
          var cursor = oldCursor;
          var newBefore = newText.slice(0, cursor);
          var newAfter = newText.slice(cursor);
          if (newBefore !== oldBefore) {
            break editAfter;
          }
          var suffixLength = Math.min(oldLength - cursor, newLength - cursor);
          var oldSuffix = oldAfter.slice(oldAfter.length - suffixLength);
          var newSuffix = newAfter.slice(newAfter.length - suffixLength);
          if (oldSuffix !== newSuffix) {
            break editAfter;
          }
          var oldMiddle = oldAfter.slice(0, oldAfter.length - suffixLength);
          var newMiddle = newAfter.slice(0, newAfter.length - suffixLength);
          return make_edit_splice(oldBefore, oldMiddle, newMiddle, oldSuffix);
        }
      }
      if (oldRange.length > 0 && newRange && newRange.length === 0) {
        replaceRange: {
          var oldPrefix = oldText.slice(0, oldRange.index);
          var oldSuffix = oldText.slice(oldRange.index + oldRange.length);
          var prefixLength = oldPrefix.length;
          var suffixLength = oldSuffix.length;
          if (newLength < prefixLength + suffixLength) {
            break replaceRange;
          }
          var newPrefix = newText.slice(0, prefixLength);
          var newSuffix = newText.slice(newLength - suffixLength);
          if (oldPrefix !== newPrefix || oldSuffix !== newSuffix) {
            break replaceRange;
          }
          var oldMiddle = oldText.slice(prefixLength, oldLength - suffixLength);
          var newMiddle = newText.slice(prefixLength, newLength - suffixLength);
          return make_edit_splice(oldPrefix, oldMiddle, newMiddle, oldSuffix);
        }
      }
      return null;
    }
    function diff(text1, text2, cursor_pos) {
      return diff_main(text1, text2, cursor_pos, true);
    }
    diff.INSERT = DIFF_INSERT;
    diff.DELETE = DIFF_DELETE;
    diff.EQUAL = DIFF_EQUAL;
    module.exports = diff;
  });

  // node_modules/@vivliostyle/core/lib/vivliostyle.js
  var require_vivliostyle = __commonJS((exports) => {
    var t2;
    var e2;
    var n2;
    var i2 =
      (t2 = require_diff()) && 'object' == typeof t2 && 'default' in t2
        ? t2.default
        : t2;
    function r2(t3) {
      exports.isDebug = t3;
    }
    function o2(t3) {
      switch (t3) {
        case 'ltr':
          return exports.PageProgression.LTR;
        case 'rtl':
          return exports.PageProgression.RTL;
        default:
          throw new Error('unknown PageProgression: ' + t3);
      }
    }
    (exports.isDebug = false),
      (function (t3) {
        (t3.LTR = 'ltr'), (t3.RTL = 'rtl');
      })(exports.PageProgression || (exports.PageProgression = {})),
      ((e2 = exports.PageSide || (exports.PageSide = {})).LEFT = 'left'),
      (e2.RIGHT = 'right'),
      ((n2 = exports.ReadyState || (exports.ReadyState = {})).LOADING =
        'loading'),
      (n2.INTERACTIVE = 'interactive'),
      (n2.COMPLETE = 'complete');
    var a2;
    var s2 = {
      PageProgression: exports.PageProgression,
      PageSide: exports.PageSide,
      ReadyState: exports.ReadyState,
    };
    function l2(t3) {
      var e3 = Array.from(t3),
        n3 = null;
      return (
        e3[0] instanceof Error && (n3 = e3.shift()), { error: n3, messages: e3 }
      );
    }
    function u2(t3) {
      var e3 = t3.error,
        n3 = e3 && (e3.frameTrace || e3.stack),
        i3 = [].concat(t3.messages);
      return (
        e3 &&
          (i3.length > 0 && (i3 = i3.concat(['\n'])),
          (i3 = i3.concat([e3.toString()])),
          n3 && (i3 = i3.concat(['\n']).concat(n3))),
        i3
      );
    }
    !(function (t3) {
      (t3[(t3.DEBUG = 1)] = 'DEBUG'),
        (t3[(t3.INFO = 2)] = 'INFO'),
        (t3[(t3.WARN = 3)] = 'WARN'),
        (t3[(t3.ERROR = 4)] = 'ERROR');
    })(a2 || (a2 = {}));
    var h2;
    var c2 = new ((function () {
      function t3(t4) {
        (this.opt_console = t4), (this.listeners = {});
      }
      var e3 = t3.prototype;
      return (
        (e3.consoleDebug = function (t4) {
          var e4, n3, i3;
          this.opt_console
            ? this.opt_console.debug
              ? (e4 = this.opt_console).debug.apply(e4, t4)
              : (n3 = this.opt_console).log.apply(n3, t4)
            : (i3 = console).debug.apply(i3, t4);
        }),
        (e3.consoleInfo = function (t4) {
          var e4, n3, i3;
          this.opt_console
            ? this.opt_console.info
              ? (e4 = this.opt_console).info.apply(e4, t4)
              : (n3 = this.opt_console).log.apply(n3, t4)
            : (i3 = console).info.apply(i3, t4);
        }),
        (e3.consoleWarn = function (t4) {
          var e4, n3, i3;
          this.opt_console
            ? this.opt_console.warn
              ? (e4 = this.opt_console).warn.apply(e4, t4)
              : (n3 = this.opt_console).log.apply(n3, t4)
            : (i3 = console).warn.apply(i3, t4);
        }),
        (e3.consoleError = function (t4) {
          var e4, n3, i3;
          this.opt_console
            ? this.opt_console.error
              ? (e4 = this.opt_console).error.apply(e4, t4)
              : (n3 = this.opt_console).log.apply(n3, t4)
            : (i3 = console).error.apply(i3, t4);
        }),
        (e3.triggerListeners = function (t4, e4) {
          var n3 = this.listeners[t4];
          n3 &&
            n3.forEach(function (t5) {
              t5(e4);
            });
        }),
        (e3.addListener = function (t4, e4) {
          var n3 = this.listeners[t4];
          n3 || (n3 = this.listeners[t4] = []), n3.push(e4);
        }),
        (e3.debug = function () {
          var t4 = l2(arguments);
          this.consoleDebug(u2(t4)), this.triggerListeners(a2.DEBUG, t4);
        }),
        (e3.info = function () {
          var t4 = l2(arguments);
          this.consoleInfo(u2(t4)), this.triggerListeners(a2.INFO, t4);
        }),
        (e3.warn = function () {
          var t4 = l2(arguments);
          this.consoleWarn(u2(t4)), this.triggerListeners(a2.WARN, t4);
        }),
        (e3.error = function () {
          var t4 = l2(arguments);
          this.consoleError(u2(t4)), this.triggerListeners(a2.ERROR, t4);
        }),
        t3
      );
    })())();
    ((h2 = exports.HOOKS || (exports.HOOKS = {})).SIMPLE_PROPERTY =
      'SIMPLE_PROPERTY'),
      (h2.PREPROCESS_SINGLE_DOCUMENT = 'PREPROCESS_SINGLE_DOCUMENT'),
      (h2.PREPROCESS_TEXT_CONTENT = 'PREPROCESS_TEXT_CONTENT'),
      (h2.PREPROCESS_ELEMENT_STYLE = 'PREPROCESS_ELEMENT_STYLE'),
      (h2.POLYFILLED_INHERITED_PROPS = 'POLYFILLED_INHERITED_PROPS'),
      (h2.CONFIGURATION = 'CONFIGURATION'),
      (h2.RESOLVE_TEXT_NODE_BREAKER = 'RESOLVE_TEXT_NODE_BREAKER'),
      (h2.RESOLVE_FORMATTING_CONTEXT = 'RESOLVE_FORMATTING_CONTEXT'),
      (h2.RESOLVE_LAYOUT_PROCESSOR = 'RESOLVE_LAYOUT_PROCESSOR'),
      (h2.POST_LAYOUT_BLOCK = 'POST_LAYOUT_BLOCK');
    var f2 = {};
    function d2(t3, e3) {
      if (exports.HOOKS[t3]) {
        var n3 = f2[t3];
        n3 || (n3 = f2[t3] = []), n3.push(e3);
      } else c2.warn(new Error("Skipping unknown plugin hook '" + t3 + "'."));
    }
    function p2(t3, e3) {
      if (exports.HOOKS[t3]) {
        var n3 = f2[t3];
        if (n3) {
          var i3 = n3.indexOf(e3);
          i3 >= 0 && n3.splice(i3, 1);
        }
      } else c2.warn(new Error("Ignoring unknown plugin hook '" + t3 + "'."));
    }
    function g2(t3) {
      return f2[t3] || [];
    }
    var m2 = { registerHook: d2, removeHook: p2 };
    var v2 = (function () {
      function t3(t4) {
        (this.performanceInstance = t4),
          (this.timestamps = {}),
          (this.registerTiming = E),
          (this.registerStartTiming = this.registerStartTiming = E),
          (this.registerEndTiming = this.registerEndTiming = E);
      }
      var e3 = t3.prototype;
      return (
        (e3.forceRegisterStartTiming = function (t4, e4) {
          y2.call(this, t4, 'start', e4);
        }),
        (e3.forceRegisterEndTiming = function (t4, e4) {
          y2.call(this, t4, 'end', e4);
        }),
        (e3.printTimings = function () {
          var t4 = this.timestamps,
            e4 = '';
          Object.keys(t4).forEach(function (n3) {
            for (var i3 = t4[n3], r3 = i3.length, o3 = 0; o3 < r3; o3++) {
              var a3 = i3[o3];
              (e4 += n3),
                r3 > 1 && (e4 += '(' + o3 + ')'),
                (e4 +=
                  ' => start: ' +
                  a3.start +
                  ', end: ' +
                  a3.end +
                  ', duration: ' +
                  (a3.end - a3.start) +
                  '\n');
            }
          }),
            c2.info(e4);
        }),
        (e3.disable = function () {
          (this.registerTiming = E),
            (this.registerStartTiming = this.registerStartTiming = E),
            (this.registerEndTiming = this.registerEndTiming = E);
        }),
        (e3.enable = function () {
          (this.registerTiming = y2),
            (this.registerStartTiming = this.registerStartTiming = w2),
            (this.registerEndTiming = this.registerEndTiming = N2);
        }),
        (e3.isEnabled = function () {
          return this.registerStartTiming === w2;
        }),
        t3
      );
    })();
    function E() {}
    function y2(t3, e3, n3) {
      n3 || (n3 = this.performanceInstance.now());
      var i3,
        r3 = this.timestamps[t3];
      r3 || (r3 = this.timestamps[t3] = []);
      for (var o3 = r3.length - 1; o3 >= 0 && (!(i3 = r3[o3]) || i3[e3]); o3--)
        i3 = null;
      i3 || r3.push((i3 = {})), (i3[e3] = n3);
    }
    function w2(t3, e3) {
      this.registerTiming(t3, 'start', e3);
    }
    function N2(t3, e3) {
      this.registerTiming(t3, 'end', e3);
    }
    var b2 = { now: Date.now };
    var S2 = new v2((window && window.performance) || b2);
    S2.forceRegisterStartTiming('load_vivliostyle');
    var C2 = {
      profiler: {
        registerStartTiming: S2.registerStartTiming,
        registerEndTiming: S2.registerEndTiming,
        printTimings: S2.printTimings,
        disable: S2.disable,
        enable: S2.enable,
      },
    };
    function T2(t3, e3) {
      for (var n3 = 0; n3 < e3.length; n3++) {
        var i3 = e3[n3];
        (i3.enumerable = i3.enumerable || false),
          (i3.configurable = true),
          'value' in i3 && (i3.writable = true),
          Object.defineProperty(t3, i3.key, i3);
      }
    }
    function x2(t3, e3, n3) {
      return e3 && T2(t3.prototype, e3), n3 && T2(t3, n3), t3;
    }
    function I2(t3, e3) {
      (t3.prototype = Object.create(e3.prototype)),
        (t3.prototype.constructor = t3),
        (t3.__proto__ = e3);
    }
    function P2(t3) {
      return (P2 = Object.setPrototypeOf
        ? Object.getPrototypeOf
        : function (t4) {
            return t4.__proto__ || Object.getPrototypeOf(t4);
          })(t3);
    }
    function R(t3, e3) {
      return (R =
        Object.setPrototypeOf ||
        function (t4, e4) {
          return (t4.__proto__ = e4), t4;
        })(t3, e3);
    }
    function A2() {
      if ('undefined' == typeof Reflect || !Reflect.construct) return false;
      if (Reflect.construct.sham) return false;
      if ('function' == typeof Proxy) return true;
      try {
        return (
          Date.prototype.toString.call(
            Reflect.construct(Date, [], function () {}),
          ),
          true
        );
      } catch (t3) {
        return false;
      }
    }
    function L2(t3, e3, n3) {
      return (L2 = A2()
        ? Reflect.construct
        : function (t4, e4, n4) {
            var i3 = [null];
            i3.push.apply(i3, e4);
            var r3 = new (Function.bind.apply(t4, i3))();
            return n4 && R(r3, n4.prototype), r3;
          }).apply(null, arguments);
    }
    function O2(t3) {
      var e3 = 'function' == typeof Map ? new Map() : void 0;
      return (O2 = function (t4) {
        if (
          null === t4 ||
          -1 === Function.toString.call(t4).indexOf('[native code]')
        )
          return t4;
        if ('function' != typeof t4)
          throw new TypeError(
            'Super expression must either be null or a function',
          );
        if (void 0 !== e3) {
          if (e3.has(t4)) return e3.get(t4);
          e3.set(t4, n3);
        }
        function n3() {
          return L2(t4, arguments, P2(this).constructor);
        }
        return (
          (n3.prototype = Object.create(t4.prototype, {
            constructor: {
              value: n3,
              enumerable: false,
              writable: true,
              configurable: true,
            },
          })),
          R(n3, t4)
        );
      })(t3);
    }
    function k2(t3) {
      if (void 0 === t3)
        throw new ReferenceError(
          "this hasn't been initialised - super() hasn't been called",
        );
      return t3;
    }
    function F(t3, e3) {
      (null == e3 || e3 > t3.length) && (e3 = t3.length);
      for (var n3 = 0, i3 = new Array(e3); n3 < e3; n3++) i3[n3] = t3[n3];
      return i3;
    }
    function D(t3, e3) {
      var n3;
      if ('undefined' == typeof Symbol || null == t3[Symbol.iterator]) {
        if (
          Array.isArray(t3) ||
          (n3 = (function (t4, e4) {
            if (t4) {
              if ('string' == typeof t4) return F(t4, void 0);
              var n4 = Object.prototype.toString.call(t4).slice(8, -1);
              return (
                'Object' === n4 && t4.constructor && (n4 = t4.constructor.name),
                'Map' === n4 || 'Set' === n4
                  ? Array.from(t4)
                  : 'Arguments' === n4 ||
                    /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n4)
                  ? F(t4, void 0)
                  : void 0
              );
            }
          })(t3)) ||
          (e3 && t3 && 'number' == typeof t3.length)
        ) {
          n3 && (t3 = n3);
          var i3 = 0;
          return function () {
            return i3 >= t3.length
              ? { done: true }
              : { done: false, value: t3[i3++] };
          };
        }
        throw new TypeError(
          'Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.',
        );
      }
      return (n3 = t3[Symbol.iterator]()).next.bind(n3);
    }
    var _2 = {};
    function B(t3) {
      return JSON.parse(t3);
    }
    function M2(t3) {
      var e3 = t3.match(/^([^#]*)/);
      return e3 ? e3[1] : t3;
    }
    var U = window.location.href;
    function V(t3) {
      U = t3;
    }
    var H2;
    var z2 = window.location.href;
    function G(t3) {
      z2 = t3;
    }
    function W(t3, e3) {
      if (/^data:/i.test(e3)) return t3 || e3;
      if (!e3 || t3.match(/^\w{2,}:/))
        return t3.toLowerCase().match('^javascript:')
          ? '#'
          : (t3.match(/^\w{2,}:\/\/[^\/]+$/) && (t3 += '/'), t3);
      var n3;
      if ((e3.match(/^\w{2,}:\/\/[^\/]+$/) && (e3 += '/'), t3.match(/^\/\//)))
        return (n3 = e3.match(/^(\w{2,}:)\/\//)) ? n3[1] + t3 : t3;
      if (t3.match(/^\//))
        return (n3 = e3.match(/^(\w{2,}:\/\/[^\/]+)\//)) ? n3[1] + t3 : t3;
      if (
        (t3.match(/^\.(\/|$)/) && (t3 = t3.substr(2)),
        (e3 = (function (t4) {
          var e4 = t4.match(/^([^#?]*)/);
          return e4 ? e4[1] : t4;
        })(e3)),
        t3.match(/^#/))
      )
        return e3 + t3;
      var i3 = e3.lastIndexOf('/');
      if (i3 < 0) return t3;
      if (i3 < e3.length - 1 && e3.lastIndexOf('.') < i3) {
        if ('' == t3) return e3;
        i3 = (e3 += '/').length - 1;
      }
      var r3 = e3.substr(0, i3 + 1) + t3,
        o3 = '';
      for (
        (n3 = r3.match(/^([^?#]*)([?#].*)$/)) && ((r3 = n3[1]), (o3 = n3[2]));
        !((i3 = r3.indexOf('/../')) <= 0);

      ) {
        var a3 = r3.lastIndexOf('/', i3 - 1);
        if (a3 <= 0) break;
        r3 = r3.substr(0, a3) + r3.substr(i3 + 3);
      }
      return r3.replace(/\/(\.\/)+/g, '/') + o3;
    }
    function X(t3) {
      var e3;
      return (
        (e3 = /^(https?:)\/\/github\.com\/([^/]+\/[^/]+)\/(blob\/|tree\/|raw\/)?(.*)$/.exec(
          t3,
        ))
          ? (t3 =
              e3[1] +
              '//raw.githubusercontent.com/' +
              e3[2] +
              '/' +
              (e3[3] ? '' : 'master/') +
              e3[4])
          : (e3 = /^(https?:)\/\/www\.aozora\.gr\.jp\/(cards\/[^/]+\/files\/[^/.]+\.html)$/.exec(
              t3,
            ))
          ? (t3 =
              e3[1] +
              '//raw.githubusercontent.com/aozorabunko/aozorabunko/master/' +
              e3[2])
          : (e3 = /^(https?:)\/\/gist\.github\.com\/([^/]+\/\w+)(\/|$)(raw(\/|$))?(.*)$/.exec(
              t3,
            ))
          ? (t3 =
              e3[1] + '//gist.githubusercontent.com/' + e3[2] + '/raw/' + e3[6])
          : (e3 = /^(https?:)\/\/(?:[^/.]+\.)?jsbin\.com\/(?!(?:blog|help)\b)(\w+)((\/\d+)?).*$/.exec(
              t3,
            )) && (t3 = e3[1] + '//output.jsbin.com/' + e3[2] + e3[3] + '/'),
        t3
      );
    }
    function j2(t3) {
      return null == t3 ? t3 : t3.toString();
    }
    !(function (t3) {
      (t3.FB2 = 'http://www.gribuser.ru/xml/fictionbook/2.0'),
        (t3.epub = 'http://www.idpf.org/2007/ops'),
        (t3.EV = 'http://www.w3.org/2001/xml-events'),
        (t3.MATHML = 'http://www.w3.org/1998/Math/MathML'),
        (t3.XML = 'http://www.w3.org/XML/1998/namespace'),
        (t3.XHTML = 'http://www.w3.org/1999/xhtml'),
        (t3.XLINK = 'http://www.w3.org/1999/xlink'),
        (t3.SHADOW = 'http://www.pyroxy.com/ns/shadow'),
        (t3.SVG = 'http://www.w3.org/2000/svg'),
        (t3.DC = 'http://purl.org/dc/elements/1.1/'),
        (t3.NCX = 'http://www.daisy.org/z3986/2005/ncx/'),
        (t3.SSE = 'http://example.com/sse');
    })(H2 || (H2 = {}));
    var Y = (function () {
      function t3() {
        this.queue = [null];
      }
      var e3 = t3.prototype;
      return (
        (e3.length = function () {
          return this.queue.length - 1;
        }),
        (e3.add = function (t4) {
          for (var e4 = this.queue.length; e4 > 1; ) {
            var n3 = Math.floor(e4 / 2),
              i3 = this.queue[n3];
            if (i3.compare(t4) > 0) return void (this.queue[e4] = t4);
            (this.queue[e4] = i3), (e4 = n3);
          }
          this.queue[1] = t4;
        }),
        (e3.peek = function () {
          return this.queue[1];
        }),
        (e3.remove = function () {
          var t4 = this.queue[1],
            e4 = this.queue.pop(),
            n3 = this.queue.length;
          if (n3 > 1) {
            for (var i3 = 1; ; ) {
              var r3 = 2 * i3;
              if (r3 >= n3) break;
              if (this.queue[r3].compare(e4) > 0)
                r3 + 1 < n3 &&
                  this.queue[r3 + 1].compare(this.queue[r3]) > 0 &&
                  r3++;
              else {
                if (!(r3 + 1 < n3 && this.queue[r3 + 1].compare(e4) > 0)) break;
                r3++;
              }
              (this.queue[i3] = this.queue[r3]), (i3 = r3);
            }
            this.queue[i3] = e4;
          }
          return t4;
        }),
        t3
      );
    })();
    var K = ['', '-webkit-', '-moz-', '-ms-', '-o-', '-epub-'];
    var q2 = {};
    function Q(t3, e3) {
      if ('writing-mode' === e3) {
        var n3 = document.createElement('span');
        return '-ms-' === t3
          ? (n3.style.setProperty(t3 + e3, 'tb-rl'),
            'tb-rl' === n3.style['writing-mode'])
          : (n3.style.setProperty(t3 + e3, 'vertical-rl'),
            'vertical-rl' === n3.style[t3 + e3]);
      }
      return (
        'string' ==
        typeof document.documentElement.style[
          (function (t4, e4) {
            return (
              t4 &&
                ((e4 = '-' + e4),
                'moz' === (t4 = t4.replace(/-/g, '')) && (t4 = 'Moz')),
              t4 +
                e4.replace(/-[a-z]/g, function (t5) {
                  return t5.substr(1).toUpperCase();
                })
            );
          })(t3, e3)
        ]
      );
    }
    function Z(t3) {
      var e3 = q2[t3];
      if (e3 || null === e3) return e3;
      switch (t3) {
        case 'text-combine-upright':
          if (Q('-webkit-', 'text-combine') && !Q('', 'text-combine-upright'))
            return (
              (q2[t3] = ['-webkit-text-combine']), ['-webkit-text-combine']
            );
          break;
        case 'writing-mode':
          if (Q('-ms-', 'writing-mode'))
            return (q2[t3] = ['-ms-writing-mode']), ['-ms-writing-mode'];
          break;
        case 'filter':
          if (Q('-webkit-', 'filter'))
            return (q2[t3] = ['-webkit-filter']), ['-webkit-filter'];
          break;
        case 'clip-path':
          if (Q('-webkit-', 'clip-path'))
            return (q2[t3] = ['-webkit-clip-path', 'clip-path']);
          break;
        case 'margin-inline-start':
          if (Q('-webkit-', 'margin-start'))
            return (
              (q2[t3] = ['-webkit-margin-start']), ['-webkit-margin-start']
            );
          break;
        case 'margin-inline-end':
          if (Q('-webkit-', 'margin-end'))
            return (q2[t3] = ['-webkit-margin-end']), ['-webkit-margin-end'];
          break;
        case 'padding-inline-start':
          if (Q('-webkit-', 'padding-start'))
            return (
              (q2[t3] = ['-webkit-padding-start']), ['-webkit-padding-start']
            );
          break;
        case 'padding-inline-end':
          if (Q('-webkit-', 'padding-end'))
            return (q2[t3] = ['-webkit-padding-end']), ['-webkit-padding-end'];
      }
      for (var n3, i3 = D(K); !(n3 = i3()).done; ) {
        var r3 = n3.value;
        if (Q(r3, t3)) return (q2[t3] = [(e3 = r3 + t3)]), [e3];
      }
      return (
        c2.warn('Property not supported by the browser: ', t3),
        (q2[t3] = null),
        null
      );
    }
    function $2(t3, e3, n3) {
      try {
        var i3 = Z(e3);
        if (!i3) return;
        i3.forEach(function (e4) {
          if ('-ms-writing-mode' === e4)
            switch (n3) {
              case 'horizontal-tb':
                n3 = 'lr-tb';
                break;
              case 'vertical-rl':
                n3 = 'tb-rl';
                break;
              case 'vertical-lr':
                n3 = 'tb-lr';
            }
          else if ('-webkit-text-combine' === e4)
            switch (n3) {
              case 'all':
                n3 = 'horizontal';
            }
          t3 && t3.style && t3.style.setProperty(e4, n3);
        });
      } catch (t4) {
        c2.warn(t4);
      }
    }
    function J(t3, e3, n3) {
      try {
        var i3 = q2[e3];
        return t3.style.getPropertyValue(i3 ? i3[0] : e3);
      } catch (t4) {}
      return n3 || '';
    }
    function tt(t3) {
      var e3 = t3.getAttributeNS(H2.XML, 'lang');
      return (
        e3 || t3.namespaceURI != H2.XHTML || (e3 = t3.getAttribute('lang')), e3
      );
    }
    var et = (function () {
      function t3() {
        this.list = [];
      }
      var e3 = t3.prototype;
      return (
        (e3.append = function (t4) {
          return this.list.push(t4), this;
        }),
        (e3.clear = function () {
          this.list = [];
        }),
        (e3.toString = function () {
          var t4 = this.list.join('');
          return (this.list = [t4]), t4;
        }),
        t3
      );
    })();
    function nt(t3) {
      return '\\' + t3.charCodeAt(0).toString(16) + ' ';
    }
    function it(t3) {
      return t3.replace(/[^-_a-zA-Z0-9\u0080-\uFFFF]/g, nt);
    }
    function rt(t3) {
      return t3.replace(/[\u0000-\u001F"\\]/g, nt);
    }
    function ot(t3) {
      return t3.replace(/[\s+&?=#\u007F-\uFFFF]+/g, encodeURIComponent);
    }
    function at(t3) {
      return !!t3.match(
        /^[a-zA-Z\u009E\u009F\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u024F\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527]$/,
      );
    }
    function st(t3, e3) {
      return t3.replace(/[^-a-zA-Z0-9_]/g, function (t4) {
        return (function (t5, e4) {
          return (
            (e4 = 'string' == typeof e4 ? e4 : '\\u') +
            (65536 | t5.charCodeAt(0)).toString(16).substr(1)
          );
        })(t4, e3);
      });
    }
    function lt(t3) {
      return st(t3);
    }
    function ut(t3, e3) {
      for (var n3 = 0, i3 = t3; ; ) {
        if ((0 == n3 || e3(n3 - 1), i3 == t3 || e3(i3), n3 == i3)) return n3;
        var r3 = (n3 + i3) >> 1;
        e3(r3) ? (i3 = r3) : (n3 = r3 + 1);
      }
    }
    function ht(t3, e3) {
      return t3 - e3;
    }
    function ct(t3, e3) {
      for (var n3, i3 = {}, r3 = D(t3); !(n3 = r3()).done; ) {
        var o3 = n3.value,
          a3 = e3(o3);
        a3 && !i3[a3] && (i3[a3] = o3);
      }
      return i3;
    }
    function ft(t3, e3) {
      for (var n3, i3 = {}, r3 = D(t3); !(n3 = r3()).done; ) {
        var o3 = n3.value,
          a3 = e3(o3);
        a3 && (i3[a3] ? i3[a3].push(o3) : (i3[a3] = [o3]));
      }
      return i3;
    }
    var dt = (function () {
      function t3() {
        this.listeners = {};
      }
      var e3 = t3.prototype;
      return (
        (e3.dispatchEvent = function (t4) {
          var e4 = this.listeners[t4.type];
          if (e4) {
            (t4.target = this), (t4.currentTarget = this);
            for (var n3 = 0; n3 < e4.length; n3++) e4[n3](t4);
          }
        }),
        (e3.addEventListener = function (t4, e4, n3) {
          if (!n3) {
            var i3 = this.listeners[t4];
            i3 ? i3.push(e4) : (this.listeners[t4] = [e4]);
          }
        }),
        (e3.removeEventListener = function (t4, e4, n3) {
          if (!n3) {
            var i3 = this.listeners[t4];
            if (i3) {
              var r3 = i3.indexOf(e4);
              r3 >= 0 && i3.splice(r3, 1);
            }
          }
        }),
        t3
      );
    })();
    var pt = null;
    var gt = null;
    var mt = null;
    var vt = null;
    function Et(t3) {
      if (1 == t3.nodeType) {
        var e3 = t3.getAttribute('id');
        if (e3 && e3.match(/^[-a-zA-Z_0-9.\u007F-\uFFFF]+$/)) return e3;
      }
      return null;
    }
    function yt(t3) {
      return '^' + t3;
    }
    function wt(t3) {
      return t3.replace(/[\[\]\(\),=;^]/g, yt);
    }
    function Nt(t3) {
      return t3.substr(1);
    }
    function bt(t3) {
      return t3 ? t3.replace(/\^[\[\]\(\),=;^]/g, Nt) : t3;
    }
    function St(t3) {
      var e3 = [];
      do {
        var n3 = t3.match(/^(\^,|[^,])*/),
          i3 = bt(n3[0]);
        if (!(t3 = t3.substr(n3[0].length + 1)) && !e3.length) return i3;
        e3.push(i3);
      } while (t3);
      return e3;
    }
    function Ct(t3) {
      for (var e3 = {}; t3; ) {
        var n3 = t3.match(/^;([^;=]+)=(([^;]|\^;)*)/);
        if (!n3) return e3;
        (e3[n3[1]] = St(n3[2])), (t3 = t3.substr(n3[0].length));
      }
      return e3;
    }
    var Tt = (function () {
      function t3() {}
      var e3 = t3.prototype;
      return (
        (e3.appendTo = function (t4) {
          t4.append('!');
        }),
        (e3.applyTo = function (t4) {
          return false;
        }),
        t3
      );
    })();
    var xt = (function () {
      function t3(t4, e4, n3) {
        (this.index = t4), (this.id = e4), (this.sideBias = n3);
      }
      var e3 = t3.prototype;
      return (
        (e3.appendTo = function (t4) {
          t4.append('/'),
            t4.append(this.index.toString()),
            (this.id || this.sideBias) &&
              (t4.append('['),
              this.id && t4.append(this.id),
              this.sideBias && (t4.append(';s='), t4.append(this.sideBias)),
              t4.append(']'));
        }),
        (e3.applyTo = function (t4) {
          if (1 != t4.node.nodeType) throw new Error('E_CFI_NOT_ELEMENT');
          var e4,
            n3 = t4.node,
            i3 = n3.children,
            r3 = i3.length,
            o3 = Math.floor(this.index / 2) - 1;
          if (o3 < 0 || 0 == r3) t4.node = (e4 = n3.firstChild) || n3;
          else {
            if (((e4 = i3[Math.min(o3, r3 - 1)]), 1 & this.index)) {
              var a3 = e4.nextSibling;
              a3 && 1 != a3.nodeType ? (e4 = a3) : (t4.after = true);
            }
            t4.node = e4;
          }
          if (this.id && (t4.after || this.id != Et(t4.node)))
            throw new Error('E_CFI_ID_MISMATCH');
          return (t4.sideBias = this.sideBias), true;
        }),
        t3
      );
    })();
    var It = (function () {
      function t3(t4, e4, n3, i3) {
        (this.offset = t4),
          (this.textBefore = e4),
          (this.textAfter = n3),
          (this.sideBias = i3);
      }
      var e3 = t3.prototype;
      return (
        (e3.applyTo = function (t4) {
          if (this.offset > 0 && !t4.after) {
            for (var e4 = this.offset, n3 = t4.node; ; ) {
              var i3 = n3.nodeType;
              if (1 == i3) break;
              var r3 = n3.nextSibling;
              if (3 <= i3 && i3 <= 5) {
                var o3 = n3.textContent.length;
                if (e4 <= o3) break;
                if (!r3) {
                  e4 = o3;
                  break;
                }
                e4 -= o3;
              }
              if (!r3) {
                e4 = 0;
                break;
              }
              n3 = r3;
            }
            (t4.node = n3), (t4.offset = e4);
          }
          return (t4.sideBias = this.sideBias), true;
        }),
        (e3.appendTo = function (t4) {
          t4.append(':'),
            t4.append(this.offset.toString()),
            (this.textBefore || this.textAfter || this.sideBias) &&
              (t4.append('['),
              (this.textBefore || this.textAfter) &&
                (this.textBefore && t4.append(wt(this.textBefore)),
                t4.append(','),
                this.textAfter && t4.append(wt(this.textAfter))),
              this.sideBias && (t4.append(';s='), t4.append(this.sideBias)),
              t4.append(']'));
        }),
        t3
      );
    })();
    var Pt = (function () {
      function t3() {
        this.steps = null;
      }
      var e3 = t3.prototype;
      return (
        (e3.fromString = function (t4) {
          var e4 = t4.match(/^#?epubcfi\((.*)\)$/);
          if (!e4) throw new Error('E_CFI_NOT_CFI');
          for (var n3 = e4[1], i3 = 0, r3 = []; ; ) {
            var o3 = void 0;
            switch (n3.charAt(i3)) {
              case '/':
                if (
                  (i3++,
                  !(e4 = n3
                    .substr(i3)
                    .match(
                      /^(0|[1-9][0-9]*)(\[([-a-zA-Z_0-9.\u007F-\uFFFF]+)(;([^\]]|\^\])*)?\])?/,
                    )))
                )
                  throw new Error('E_CFI_NUMBER_EXPECTED');
                i3 += e4[0].length;
                var a3 = parseInt(e4[1], 10),
                  s3 = e4[3];
                (o3 = Ct(e4[4])), r3.push(new xt(a3, s3, j2(o3.s)));
                break;
              case ':':
                if (
                  (i3++,
                  !(e4 = n3
                    .substr(i3)
                    .match(
                      /^(0|[1-9][0-9]*)(\[((([^\];,]|\^[\];,])*)(,(([^\];,]|\^[\];,])*))?)(;([^]]|\^\])*)?\])?/,
                    )))
                )
                  throw new Error('E_CFI_NUMBER_EXPECTED');
                i3 += e4[0].length;
                var l3 = parseInt(e4[1], 10),
                  u3 = e4[4];
                u3 && (u3 = bt(u3));
                var h3 = e4[7];
                h3 && (h3 = bt(h3)),
                  (o3 = Ct(e4[10])),
                  r3.push(new It(l3, u3, h3, j2(o3.s)));
                break;
              case '!':
                i3++, r3.push(new Tt());
                break;
              case '~':
              case '@':
              case '':
                return void (this.steps = r3);
              default:
                throw new Error('E_CFI_PARSE_ERROR');
            }
          }
        }),
        (e3.navigate = function (e4) {
          for (
            var n3 = {
                node: e4.documentElement,
                offset: 0,
                after: false,
                sideBias: null,
                ref: null,
              },
              i3 = 0;
            i3 < this.steps.length;
            i3++
          )
            if (!this.steps[i3].applyTo(n3)) {
              (n3.ref = new t3()), (n3.ref.steps = this.steps.slice(i3 + 1));
              break;
            }
          return n3;
        }),
        (e3.trim = function (t4, e4) {
          return t4
            .replace(/\s+/g, ' ')
            .match(
              e4
                ? /^[ -\uD7FF\uE000-\uFFFF]{0,8}/
                : /[ -\uD7FF\uE000-\uFFFF]{0,8}$/,
            )[0]
            .replace(/^\s/, '')
            .replace(/\s$/, '');
        }),
        (e3.prependPathFromNode = function (t4, e4, n3, i3) {
          for (var r3 = [], o3 = t4.parentNode, a3 = '', s3 = ''; t4; ) {
            switch (t4.nodeType) {
              case 3:
              case 4:
              case 5:
                var l3 = t4.textContent,
                  u3 = l3.length;
                n3
                  ? ((e4 += u3), a3 || (a3 = l3))
                  : (e4 > u3 && (e4 = u3),
                    (n3 = true),
                    (a3 = l3.substr(0, e4)),
                    (s3 = l3.substr(e4))),
                  (t4 = t4.previousSibling);
                continue;
              case 8:
                t4 = t4.previousSibling;
                continue;
            }
            break;
          }
          for (
            (e4 > 0 || a3 || s3) &&
            ((a3 = this.trim(a3, false)),
            (s3 = this.trim(s3, true)),
            r3.push(new It(e4, a3, s3, i3)),
            (i3 = null));
            o3 && o3 && 9 != o3.nodeType;

          ) {
            for (var h3 = n3 ? null : Et(t4), c3 = n3 ? 1 : 0; t4; )
              1 == t4.nodeType && (c3 += 2), (t4 = t4.previousSibling);
            r3.push(new xt(c3, h3, i3)),
              (i3 = null),
              (t4 = o3),
              (o3 = o3.parentNode),
              (n3 = false);
          }
          r3.reverse(),
            this.steps
              ? (r3.push(new Tt()), (this.steps = r3.concat(this.steps)))
              : (this.steps = r3);
        }),
        (e3.toString = function () {
          if (!this.steps) return '';
          var t4 = new et();
          t4.append('epubcfi(');
          for (var e4 = 0; e4 < this.steps.length; e4++)
            this.steps[e4].appendTo(t4);
          return t4.append(')'), t4.toString();
        }),
        t3
      );
    })();
    function Rt(t3) {
      return {
        fontFamily: t3.fontFamily,
        lineHeight: t3.lineHeight,
        margin: t3.margin,
        hyphenate: t3.hyphenate,
        columnWidth: t3.columnWidth,
        horizontal: t3.horizontal,
        nightMode: t3.nightMode,
        spreadView: t3.spreadView,
        pageBorder: t3.pageBorder,
        enabledMediaTypes: Object.assign({}, t3.enabledMediaTypes),
        defaultPaperSize: t3.defaultPaperSize
          ? Object.assign({}, t3.defaultPaperSize)
          : void 0,
      };
    }
    var At = {
      fontFamily: 'serif',
      lineHeight: 1.25,
      margin: 8,
      hyphenate: false,
      columnWidth: 25,
      horizontal: false,
      nightMode: false,
      spreadView: false,
      pageBorder: 1,
      enabledMediaTypes: { vivliostyle: true, print: true },
      defaultPaperSize: void 0,
    };
    var Lt = {};
    function Ot(t3, e3, n3, i3) {
      var r3 = Math.min((t3 - 0) / n3, (e3 - 0) / i3);
      return 'matrix(' + r3 + ',0,0,' + r3 + ',0,0)';
    }
    function kt(t3) {
      return '"' + rt('' + t3) + '"';
    }
    function Ft(t3) {
      return it('' + t3);
    }
    function Dt(t3, e3) {
      return t3 ? it(t3) + '.' + it(e3) : it(e3);
    }
    var _t = 0;
    var Bt = (function () {
      function t3(t4, e4) {
        if (
          ((this.parent = t4),
          (this.resolver = e4),
          (this.children = []),
          (this.values = {}),
          (this.funcs = {}),
          (this.builtIns = {}),
          (this.scopeKey = 'S' + _t++),
          (this.zero = new Ee(this, 0)),
          (this.one = new Ee(this, 1)),
          (this._true = new Ee(this, true)),
          (this._false = new Ee(this, false)),
          t4 && t4.children.push(this),
          !t4)
        ) {
          var n3 = this.builtIns;
          (n3.floor = Math.floor),
            (n3.ceil = Math.ceil),
            (n3.round = Math.round),
            (n3.sqrt = Math.sqrt),
            (n3.min = Math.min),
            (n3.max = Math.max),
            (n3.letterbox = Ot),
            (n3['css-string'] = kt),
            (n3['css-name'] = Ft),
            (n3.typeof = function (t5) {
              return typeof t5;
            }),
            this.defineBuiltInName('page-width', function () {
              return this.pageWidth();
            }),
            this.defineBuiltInName('page-height', function () {
              return this.pageHeight();
            }),
            this.defineBuiltInName('pref-font-family', function () {
              return this.pref.fontFamily;
            }),
            this.defineBuiltInName('pref-night-mode', function () {
              return this.pref.nightMode;
            }),
            this.defineBuiltInName('pref-hyphenate', function () {
              return this.pref.hyphenate;
            }),
            this.defineBuiltInName('pref-margin', function () {
              return this.pref.margin;
            }),
            this.defineBuiltInName('pref-line-height', function () {
              return this.pref.lineHeight;
            }),
            this.defineBuiltInName('pref-column-width', function () {
              return this.pref.columnWidth * this.fontSize;
            }),
            this.defineBuiltInName('pref-horizontal', function () {
              return this.pref.horizontal;
            }),
            this.defineBuiltInName('pref-spread-view', function () {
              return this.pref.spreadView;
            }),
            this.defineBuiltInName('pub-title', function () {
              return kt(this.pubTitle ? this.pubTitle : '');
            }),
            this.defineBuiltInName('doc-title', function () {
              return kt(this.docTitle ? this.docTitle : '');
            });
        }
      }
      var e3 = t3.prototype;
      return (
        (e3.defineBuiltInName = function (t4, e4) {
          this.values[t4] = new ge(this, e4, t4);
        }),
        (e3.defineName = function (t4, e4) {
          this.values[t4] = e4;
        }),
        (e3.defineFunc = function (t4, e4) {
          this.funcs[t4] = e4;
        }),
        (e3.defineBuiltIn = function (t4, e4) {
          this.builtIns[t4] = e4;
        }),
        t3
      );
    })();
    function Mt(t3) {
      switch (t3.toLowerCase()) {
        case 'vw':
        case 'vh':
        case 'vi':
        case 'vb':
        case 'vmin':
        case 'vmax':
        case 'pvw':
        case 'pvh':
        case 'pvi':
        case 'pvb':
        case 'pvmin':
        case 'pvmax':
          return true;
        default:
          return false;
      }
    }
    var Ut = {
      px: 1,
      in: 96,
      pt: 4 / 3,
      pc: 16,
      cm: 96 / 2.54,
      mm: 96 / 25.4,
      q: 96 / 2.54 / 40,
      em: 16,
      rem: 16,
      ex: 8,
      dppx: 1,
      dpi: 1 / 96,
      dpcm: 2.54 / 96,
    };
    function Vt(t3) {
      switch (t3) {
        case 'q':
        case 'rem':
          return true;
        default:
          return false;
      }
    }
    var Ht = (function () {
      function t3(t4, e4, n3, i3) {
        (this.rootScope = t4),
          (this.viewportWidth = e4),
          (this.viewportHeight = n3),
          (this.actualPageWidth = null),
          (this.actualPageHeight = null),
          (this.rootFontSize = null),
          (this.scopes = {}),
          (this.pageAreaWidth = null),
          (this.pageAreaHeight = null),
          (this.pageVertical = null),
          (this.pubTitle = null),
          (this.docTitle = null),
          (this.pageWidth = function () {
            return this.actualPageWidth
              ? this.actualPageWidth
              : this.pref.spreadView
              ? Math.floor(e4 / 2) - this.pref.pageBorder
              : e4;
          }),
          (this.pageHeight = function () {
            return this.actualPageHeight ? this.actualPageHeight : n3;
          }),
          (this.initialFontSize = i3),
          (this.fontSize = function () {
            return this.rootFontSize ? this.rootFontSize : i3;
          }),
          (this.pref = At);
      }
      var e3 = t3.prototype;
      return (
        (e3.getScopeContext = function (t4) {
          var e4 = this.scopes[t4.scopeKey];
          return e4 || (this.scopes[t4.scopeKey] = e4 = {}), e4;
        }),
        (e3.clearScope = function (t4) {
          this.scopes[t4.scopeKey] = {};
          for (var e4 = 0; e4 < t4.children.length; e4++)
            this.clearScope(t4.children[e4]);
        }),
        (e3.queryUnitSize = function (t4, e4) {
          if (Mt(t4)) {
            var n3 = this.pageWidth() / 100,
              i3 = this.pageHeight() / 100,
              r3 = null != this.pageAreaWidth ? this.pageAreaWidth / 100 : n3,
              o3 = null != this.pageAreaHeight ? this.pageAreaHeight / 100 : i3;
            switch (t4) {
              case 'vw':
                return r3;
              case 'vh':
                return o3;
              case 'vi':
                return this.pageVertical ? o3 : r3;
              case 'vb':
                return this.pageVertical ? r3 : o3;
              case 'vmin':
                return r3 < o3 ? r3 : o3;
              case 'vmax':
                return r3 > o3 ? r3 : o3;
              case 'pvw':
                return n3;
              case 'pvh':
                return i3;
              case 'pvi':
                return this.pageVertical ? i3 : n3;
              case 'pvb':
                return this.pageVertical ? n3 : i3;
              case 'pvmin':
                return n3 < i3 ? n3 : i3;
              case 'pvmax':
                return n3 > i3 ? n3 : i3;
            }
          }
          return 'em' == t4 || 'rem' == t4
            ? e4
              ? this.initialFontSize
              : this.fontSize()
            : 'ex' == t4
            ? (Ut.ex * (e4 ? this.initialFontSize : this.fontSize())) / Ut.em
            : Ut[t4];
        }),
        (e3.evalName = function (t4, e4) {
          do {
            var n3 = t4.values[e4];
            if (n3) return n3;
            if (t4.resolver && (n3 = t4.resolver.call(this, e4, false)))
              return n3;
            t4 = t4.parent;
          } while (t4);
          throw new Error("Name '" + e4 + "' is undefined");
        }),
        (e3.evalCall = function (t4, e4, n3, i3) {
          do {
            var r3 = t4.funcs[e4];
            if (r3) return r3;
            if (t4.resolver && (r3 = t4.resolver.call(this, e4, true)))
              return r3;
            var o3 = t4.builtIns[e4];
            if (o3) {
              if (i3) return t4.zero;
              for (var a3 = Array(n3.length), s3 = 0; s3 < n3.length; s3++)
                a3[s3] = n3[s3].evaluate(this);
              return new Ee(t4, o3.apply(this, a3));
            }
            t4 = t4.parent;
          } while (t4);
          throw new Error("Function '" + e4 + "' is undefined");
        }),
        (e3.evalMediaName = function (t4, e4) {
          var n3 = 'all' === t4 || !!this.pref.enabledMediaTypes[t4];
          return e4 ? !n3 : n3;
        }),
        (e3.evalMediaTest = function (t4, e4) {
          var n3 = '',
            i3 = t4.match(/^(min|max)-(.*)$/);
          i3 && ((n3 = i3[1]), (t4 = i3[2]));
          var r3 = null,
            o3 = null;
          switch (t4) {
            case 'width':
            case 'height':
            case 'device-width':
            case 'device-height':
            case 'color':
              e4 && (r3 = e4.evaluate(this));
          }
          switch (t4) {
            case 'width':
              o3 = this.pageWidth();
              break;
            case 'height':
              o3 = this.pageHeight();
              break;
            case 'device-width':
              o3 = window.screen.availWidth;
              break;
            case 'device-height':
              o3 = window.screen.availHeight;
              break;
            case 'color':
              o3 = window.screen.pixelDepth;
          }
          if (null != o3 && null != r3)
            switch (n3) {
              case 'min':
                return o3 >= r3;
              case 'max':
                return o3 <= r3;
              default:
                return o3 == r3;
            }
          else if (null != o3 && null == e4) return 0 !== o3;
          return false;
        }),
        (e3.queryVal = function (t4, e4) {
          var n3 = this.scopes[t4.scopeKey];
          return n3 ? n3[e4] : void 0;
        }),
        (e3.storeVal = function (t4, e4, n3) {
          this.getScopeContext(t4)[e4] = n3;
        }),
        t3
      );
    })();
    var zt = (function () {
      function t3(t4) {
        (this.scope = t4), (this.scope = t4), (this.key = '_' + _t++);
      }
      var e3 = t3.prototype;
      return (
        (e3.toString = function () {
          var t4 = new et();
          return this.appendTo(t4, 0), t4.toString();
        }),
        (e3.appendTo = function (t4, e4) {
          throw new Error('F_ABSTRACT');
        }),
        (e3.evaluateCore = function (t4) {
          throw new Error('F_ABSTRACT');
        }),
        (e3.expand = function (t4, e4) {
          return this;
        }),
        (e3.dependCore = function (t4, e4, n3) {
          return t4 === this;
        }),
        (e3.dependOuter = function (t4, e4, n3) {
          var i3 = n3[this.key];
          if (null != i3) return i3 !== Lt && i3;
          n3[this.key] = Lt;
          var r3 = this.dependCore(t4, e4, n3);
          return (n3[this.key] = r3), r3;
        }),
        (e3.depend = function (t4, e4) {
          return this.dependOuter(t4, e4, {});
        }),
        (e3.evaluate = function (t4) {
          var e4 = t4.queryVal(this.scope, this.key);
          return (
            void 0 !== e4 ||
              ((e4 = this.evaluateCore(t4)),
              t4.storeVal(this.scope, this.key, e4)),
            e4
          );
        }),
        (e3.isMediaName = function () {
          return false;
        }),
        t3
      );
    })();
    var Gt = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return ((i3 = t3.call(this, e4) || this).val = n4), i3;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getOp = function () {
          throw new Error('F_ABSTRACT');
        }),
        (n3.evalPrefix = function (t4) {
          throw new Error('F_ABSTRACT');
        }),
        (n3.evaluateCore = function (t4) {
          var e4 = this.val.evaluate(t4);
          return this.evalPrefix(e4);
        }),
        (n3.dependCore = function (t4, e4, n4) {
          return t4 === this || this.val.dependOuter(t4, e4, n4);
        }),
        (n3.appendTo = function (t4, e4) {
          10 < e4 && t4.append('('),
            t4.append(this.getOp()),
            this.val.appendTo(t4, 10),
            10 < e4 && t4.append(')');
        }),
        (n3.expand = function (t4, e4) {
          var n4 = this.val.expand(t4, e4);
          return n4 === this.val ? this : new this.constructor(this.scope, n4);
        }),
        e3
      );
    })(zt);
    var Wt = (function (t3) {
      function e3(e4, n4, i3) {
        var r3;
        return ((r3 = t3.call(this, e4) || this).lhs = n4), (r3.rhs = i3), r3;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getPriority = function () {
          throw new Error('F_ABSTRACT');
        }),
        (n3.getOp = function () {
          throw new Error('F_ABSTRACT');
        }),
        (n3.evalInfix = function (t4, e4) {
          throw new Error('F_ABSTRACT');
        }),
        (n3.evaluateCore = function (t4) {
          var e4 = this.lhs.evaluate(t4),
            n4 = this.rhs.evaluate(t4);
          return this.evalInfix(e4, n4);
        }),
        (n3.dependCore = function (t4, e4, n4) {
          return (
            t4 === this ||
            this.lhs.dependOuter(t4, e4, n4) ||
            this.rhs.dependOuter(t4, e4, n4)
          );
        }),
        (n3.appendTo = function (t4, e4) {
          var n4 = this.getPriority();
          n4 <= e4 && t4.append('('),
            this.lhs.appendTo(t4, n4),
            t4.append(this.getOp()),
            this.rhs.appendTo(t4, n4),
            n4 <= e4 && t4.append(')');
        }),
        (n3.expand = function (t4, e4) {
          var n4 = this.lhs.expand(t4, e4),
            i3 = this.rhs.expand(t4, e4);
          return n4 === this.lhs && i3 === this.rhs
            ? this
            : new this.constructor(this.scope, n4, i3);
        }),
        e3
      );
    })(zt);
    var Xt = (function (t3) {
      function e3(e4, n3, i3) {
        return t3.call(this, e4, n3, i3) || this;
      }
      return (
        I2(e3, t3),
        (e3.prototype.getPriority = function () {
          return 1;
        }),
        e3
      );
    })(Wt);
    var jt = (function (t3) {
      function e3(e4, n3, i3) {
        return t3.call(this, e4, n3, i3) || this;
      }
      return (
        I2(e3, t3),
        (e3.prototype.getPriority = function () {
          return 2;
        }),
        e3
      );
    })(Wt);
    var Yt = (function (t3) {
      function e3(e4, n3, i3) {
        return t3.call(this, e4, n3, i3) || this;
      }
      return (
        I2(e3, t3),
        (e3.prototype.getPriority = function () {
          return 3;
        }),
        e3
      );
    })(Wt);
    var Kt = (function (t3) {
      function e3(e4, n3, i3) {
        return t3.call(this, e4, n3, i3) || this;
      }
      return (
        I2(e3, t3),
        (e3.prototype.getPriority = function () {
          return 4;
        }),
        e3
      );
    })(Wt);
    var qt = (function (t3) {
      function e3(e4, n4) {
        return t3.call(this, e4, n4) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getOp = function () {
          return '!';
        }),
        (n3.evalPrefix = function (t4) {
          return !t4;
        }),
        e3
      );
    })(Gt);
    var Qt = (function (t3) {
      function e3(e4, n4) {
        return t3.call(this, e4, n4) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getOp = function () {
          return '-';
        }),
        (n3.evalPrefix = function (t4) {
          return -t4;
        }),
        e3
      );
    })(Gt);
    var Zt = (function (t3) {
      function e3(e4, n4, i3) {
        return t3.call(this, e4, n4, i3) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getOp = function () {
          return '&&';
        }),
        (n3.evaluateCore = function (t4) {
          return this.lhs.evaluate(t4) && this.rhs.evaluate(t4);
        }),
        e3
      );
    })(Xt);
    var $t = (function (t3) {
      function e3(e4, n3, i3) {
        return t3.call(this, e4, n3, i3) || this;
      }
      return (
        I2(e3, t3),
        (e3.prototype.getOp = function () {
          return ' and ';
        }),
        e3
      );
    })(Zt);
    var Jt = (function (t3) {
      function e3(e4, n4, i3) {
        return t3.call(this, e4, n4, i3) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getOp = function () {
          return '||';
        }),
        (n3.evaluateCore = function (t4) {
          return this.lhs.evaluate(t4) || this.rhs.evaluate(t4);
        }),
        e3
      );
    })(Xt);
    var te = (function (t3) {
      function e3(e4, n3, i3) {
        return t3.call(this, e4, n3, i3) || this;
      }
      return (
        I2(e3, t3),
        (e3.prototype.getOp = function () {
          return ', ';
        }),
        e3
      );
    })(Jt);
    var ee = (function (t3) {
      function e3(e4, n4, i3) {
        return t3.call(this, e4, n4, i3) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getOp = function () {
          return '<';
        }),
        (n3.evalInfix = function (t4, e4) {
          return t4 < e4;
        }),
        e3
      );
    })(jt);
    var ne = (function (t3) {
      function e3(e4, n4, i3) {
        return t3.call(this, e4, n4, i3) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getOp = function () {
          return '<=';
        }),
        (n3.evalInfix = function (t4, e4) {
          return t4 <= e4;
        }),
        e3
      );
    })(jt);
    var ie = (function (t3) {
      function e3(e4, n4, i3) {
        return t3.call(this, e4, n4, i3) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getOp = function () {
          return '>';
        }),
        (n3.evalInfix = function (t4, e4) {
          return t4 > e4;
        }),
        e3
      );
    })(jt);
    var re = (function (t3) {
      function e3(e4, n4, i3) {
        return t3.call(this, e4, n4, i3) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getOp = function () {
          return '>=';
        }),
        (n3.evalInfix = function (t4, e4) {
          return t4 >= e4;
        }),
        e3
      );
    })(jt);
    var oe = (function (t3) {
      function e3(e4, n4, i3) {
        return t3.call(this, e4, n4, i3) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getOp = function () {
          return '==';
        }),
        (n3.evalInfix = function (t4, e4) {
          return t4 == e4;
        }),
        e3
      );
    })(jt);
    var ae = (function (t3) {
      function e3(e4, n4, i3) {
        return t3.call(this, e4, n4, i3) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getOp = function () {
          return '!=';
        }),
        (n3.evalInfix = function (t4, e4) {
          return t4 != e4;
        }),
        e3
      );
    })(jt);
    var se = (function (t3) {
      function e3(e4, n4, i3) {
        return t3.call(this, e4, n4, i3) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getOp = function () {
          return '+';
        }),
        (n3.evalInfix = function (t4, e4) {
          return t4 + e4;
        }),
        e3
      );
    })(Yt);
    var le = (function (t3) {
      function e3(e4, n4, i3) {
        return t3.call(this, e4, n4, i3) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getOp = function () {
          return ' - ';
        }),
        (n3.evalInfix = function (t4, e4) {
          return t4 - e4;
        }),
        e3
      );
    })(Yt);
    var ue = (function (t3) {
      function e3(e4, n4, i3) {
        return t3.call(this, e4, n4, i3) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getOp = function () {
          return '*';
        }),
        (n3.evalInfix = function (t4, e4) {
          return t4 * e4;
        }),
        e3
      );
    })(Kt);
    var he = (function (t3) {
      function e3(e4, n4, i3) {
        return t3.call(this, e4, n4, i3) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getOp = function () {
          return '/';
        }),
        (n3.evalInfix = function (t4, e4) {
          return t4 / e4;
        }),
        e3
      );
    })(Kt);
    var ce = (function (t3) {
      function e3(e4, n4, i3) {
        return t3.call(this, e4, n4, i3) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getOp = function () {
          return '%';
        }),
        (n3.evalInfix = function (t4, e4) {
          return t4 % e4;
        }),
        e3
      );
    })(Kt);
    var fe = (function (t3) {
      function e3(e4, n4, i3) {
        var r3;
        return (
          ((r3 = t3.call(this, e4) || this).num = n4),
          (r3.unit = i3.toLowerCase()),
          r3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.appendTo = function (t4, e4) {
          t4.append(this.num.toString()), t4.append(it(this.unit));
        }),
        (n3.evaluateCore = function (t4) {
          return this.num * t4.queryUnitSize(this.unit, false);
        }),
        e3
      );
    })(zt);
    var de = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return ((i3 = t3.call(this, e4) || this).qualifiedName = n4), i3;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.appendTo = function (t4, e4) {
          t4.append(this.qualifiedName);
        }),
        (n3.evaluateCore = function (t4) {
          return t4.evalName(this.scope, this.qualifiedName).evaluate(t4);
        }),
        (n3.dependCore = function (t4, e4, n4) {
          return (
            t4 === this ||
            e4.evalName(this.scope, this.qualifiedName).dependOuter(t4, e4, n4)
          );
        }),
        e3
      );
    })(zt);
    var pe = (function (t3) {
      function e3(e4, n4, i3) {
        var r3;
        return ((r3 = t3.call(this, e4) || this).not = n4), (r3.name = i3), r3;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.appendTo = function (t4, e4) {
          this.not && t4.append('not '), t4.append(it(this.name));
        }),
        (n3.evaluateCore = function (t4) {
          return t4.evalMediaName(this.name, this.not);
        }),
        (n3.dependCore = function (t4, e4, n4) {
          return t4 === this || this.value.dependOuter(t4, e4, n4);
        }),
        (n3.isMediaName = function () {
          return true;
        }),
        e3
      );
    })(zt);
    var ge = (function (t3) {
      function e3(e4, n4, i3) {
        var r3;
        return ((r3 = t3.call(this, e4) || this).fn = n4), (r3.str = i3), r3;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.appendTo = function (t4, e4) {
          t4.append(this.str);
        }),
        (n3.evaluateCore = function (t4) {
          return this.fn.call(t4);
        }),
        e3
      );
    })(zt);
    var me = (function (t3) {
      function e3(e4, n4, i3) {
        var r3;
        return (
          ((r3 = t3.call(this, e4) || this).qualifiedName = n4),
          (r3.params = i3),
          r3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.appendTo = function (t4, e4) {
          t4.append(this.qualifiedName),
            (function (t5, e5) {
              t5.append('(');
              for (var n4 = 0; n4 < e5.length; n4++)
                n4 && t5.append(','), e5[n4].appendTo(t5, 0);
              t5.append(')');
            })(t4, this.params);
        }),
        (n3.evaluateCore = function (t4) {
          return t4
            .evalCall(this.scope, this.qualifiedName, this.params, false)
            .expand(t4, this.params)
            .evaluate(t4);
        }),
        (n3.dependCore = function (t4, e4, n4) {
          if (t4 === this) return true;
          for (var i3 = 0; i3 < this.params.length; i3++)
            if (this.params[i3].dependOuter(t4, e4, n4)) return true;
          return e4
            .evalCall(this.scope, this.qualifiedName, this.params, true)
            .dependOuter(t4, e4, n4);
        }),
        (n3.expand = function (t4, n4) {
          var i3 = (function (t5, e4, n5) {
            for (var i4 = e4, r3 = 0; r3 < e4.length; r3++) {
              var o3 = e4[r3].expand(t5, n5);
              if (e4 !== i4) i4[r3] = o3;
              else if (o3 !== e4[r3]) {
                i4 = Array(e4.length);
                for (var a3 = 0; a3 < r3; a3++) i4[a3] = e4[a3];
                i4[r3] = o3;
              }
            }
            return i4;
          })(t4, this.params, n4);
          return i3 === this.params
            ? this
            : new e3(this.scope, this.qualifiedName, i3);
        }),
        e3
      );
    })(zt);
    var ve = (function (t3) {
      function e3(e4, n4, i3, r3) {
        var o3;
        return (
          ((o3 = t3.call(this, e4) || this).cond = n4),
          (o3.ifTrue = i3),
          (o3.ifFalse = r3),
          o3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.appendTo = function (t4, e4) {
          e4 > 0 && t4.append('('),
            this.cond.appendTo(t4, 0),
            t4.append('?'),
            this.ifTrue.appendTo(t4, 0),
            t4.append(':'),
            this.ifFalse.appendTo(t4, 0),
            e4 > 0 && t4.append(')');
        }),
        (n3.evaluateCore = function (t4) {
          return this.cond.evaluate(t4)
            ? this.ifTrue.evaluate(t4)
            : this.ifFalse.evaluate(t4);
        }),
        (n3.dependCore = function (t4, e4, n4) {
          return (
            t4 === this ||
            this.cond.dependOuter(t4, e4, n4) ||
            this.ifTrue.dependOuter(t4, e4, n4) ||
            this.ifFalse.dependOuter(t4, e4, n4)
          );
        }),
        (n3.expand = function (t4, n4) {
          var i3 = this.cond.expand(t4, n4),
            r3 = this.ifTrue.expand(t4, n4),
            o3 = this.ifFalse.expand(t4, n4);
          return i3 === this.cond && r3 === this.ifTrue && o3 === this.ifFalse
            ? this
            : new e3(this.scope, i3, r3, o3);
        }),
        e3
      );
    })(zt);
    var Ee = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return ((i3 = t3.call(this, e4) || this).val = n4), i3;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.appendTo = function (t4, e4) {
          switch (typeof this.val) {
            case 'number':
            case 'boolean':
              t4.append(this.val.toString());
              break;
            case 'string':
              t4.append('"'), t4.append(rt(this.val)), t4.append('"');
              break;
            default:
              throw new Error('F_UNEXPECTED_STATE');
          }
        }),
        (n3.evaluateCore = function (t4) {
          return this.val;
        }),
        e3
      );
    })(zt);
    var ye = (function (t3) {
      function e3(e4, n4, i3) {
        var r3;
        return (
          ((r3 = t3.call(this, e4) || this).name = n4), (r3.value = i3), r3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.appendTo = function (t4, e4) {
          t4.append('('),
            t4.append(rt(this.name.name)),
            t4.append(':'),
            this.value.appendTo(t4, 0),
            t4.append(')');
        }),
        (n3.evaluateCore = function (t4) {
          return t4.evalMediaTest(this.name.name, this.value);
        }),
        (n3.dependCore = function (t4, e4, n4) {
          return t4 === this || this.value.dependOuter(t4, e4, n4);
        }),
        (n3.expand = function (t4, n4) {
          var i3 = this.value.expand(t4, n4);
          return i3 === this.value ? this : new e3(this.scope, this.name, i3);
        }),
        e3
      );
    })(zt);
    var we = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return ((i3 = t3.call(this, e4) || this).index = n4), i3;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.appendTo = function (t4, e4) {
          t4.append('$'), t4.append(this.index.toString());
        }),
        (n3.expand = function (t4, e4) {
          var n4 = e4[this.index];
          if (!n4) throw new Error('Parameter missing: ' + this.index);
          return n4;
        }),
        e3
      );
    })(zt);
    function Ne(t3, e3, n3) {
      return e3 === t3._false ||
        e3 === t3.zero ||
        n3 == t3._false ||
        n3 == t3.zero
        ? t3._false
        : e3 === t3._true || e3 === t3.one
        ? n3
        : n3 === t3._true || n3 === t3.one
        ? e3
        : new Zt(t3, e3, n3);
    }
    function be(t3, e3, n3) {
      return e3 === t3.zero ? n3 : n3 === t3.zero ? e3 : new se(t3, e3, n3);
    }
    function Se(t3, e3, n3) {
      return e3 === t3.zero
        ? new Qt(t3, n3)
        : n3 === t3.zero
        ? e3
        : new le(t3, e3, n3);
    }
    function Ce(t3, e3, n3) {
      return e3 === t3.zero || n3 === t3.zero
        ? t3.zero
        : e3 === t3.one
        ? n3
        : n3 === t3.one
        ? e3
        : new ue(t3, e3, n3);
    }
    function Te(t3, e3, n3) {
      return e3 === t3.zero ? t3.zero : n3 === t3.one ? e3 : new he(t3, e3, n3);
    }
    var xe = (function () {
      function t3() {}
      var e3 = t3.prototype;
      return (
        (e3.visitValues = function (t4) {
          for (var e4 = 0; e4 < t4.length; e4++) t4[e4].visit(this);
        }),
        (e3.visitEmpty = function (t4) {
          throw new Error('E_CSS_EMPTY_NOT_ALLOWED');
        }),
        (e3.visitSlash = function (t4) {
          throw new Error('E_CSS_SLASH_NOT_ALLOWED');
        }),
        (e3.visitStr = function (t4) {
          throw new Error('E_CSS_STR_NOT_ALLOWED');
        }),
        (e3.visitIdent = function (t4) {
          throw new Error('E_CSS_IDENT_NOT_ALLOWED');
        }),
        (e3.visitNumeric = function (t4) {
          throw new Error('E_CSS_NUMERIC_NOT_ALLOWED');
        }),
        (e3.visitNum = function (t4) {
          throw new Error('E_CSS_NUM_NOT_ALLOWED');
        }),
        (e3.visitInt = function (t4) {
          return this.visitNum(t4);
        }),
        (e3.visitColor = function (t4) {
          throw new Error('E_CSS_COLOR_NOT_ALLOWED');
        }),
        (e3.visitURL = function (t4) {
          throw new Error('E_CSS_URL_NOT_ALLOWED');
        }),
        (e3.visitSpaceList = function (t4) {
          throw new Error('E_CSS_LIST_NOT_ALLOWED');
        }),
        (e3.visitCommaList = function (t4) {
          throw new Error('E_CSS_COMMA_NOT_ALLOWED');
        }),
        (e3.visitFunc = function (t4) {
          throw new Error('E_CSS_FUNC_NOT_ALLOWED');
        }),
        (e3.visitExpr = function (t4) {
          throw new Error('E_CSS_EXPR_NOT_ALLOWED');
        }),
        t3
      );
    })();
    var Ie = (function (t3) {
      function e3() {
        return t3.call(this) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.visitValues = function (t4) {
          for (var e4 = null, n4 = 0; n4 < t4.length; n4++) {
            var i3 = t4[n4],
              r3 = i3.visit(this);
            if (e4) e4[n4] = r3;
            else if (i3 !== r3) {
              e4 = new Array(t4.length);
              for (var o3 = 0; o3 < n4; o3++) e4[o3] = t4[o3];
              e4[n4] = r3;
            }
          }
          return e4 || t4;
        }),
        (n3.visitStr = function (t4) {
          return t4;
        }),
        (n3.visitIdent = function (t4) {
          return t4;
        }),
        (n3.visitSlash = function (t4) {
          return t4;
        }),
        (n3.visitNumeric = function (t4) {
          return t4;
        }),
        (n3.visitNum = function (t4) {
          return t4;
        }),
        (n3.visitInt = function (t4) {
          return t4;
        }),
        (n3.visitColor = function (t4) {
          return t4;
        }),
        (n3.visitURL = function (t4) {
          return t4;
        }),
        (n3.visitSpaceList = function (t4) {
          var e4 = this.visitValues(t4.values);
          return e4 === t4.values ? t4 : new He(e4);
        }),
        (n3.visitCommaList = function (t4) {
          var e4 = this.visitValues(t4.values);
          return e4 === t4.values ? t4 : new ze(e4);
        }),
        (n3.visitFunc = function (t4) {
          var e4 = this.visitValues(t4.values);
          return e4 === t4.values ? t4 : new Ge(t4.name, e4);
        }),
        (n3.visitExpr = function (t4) {
          return t4;
        }),
        e3
      );
    })(xe);
    var Pe = (function () {
      function t3() {}
      var e3 = t3.prototype;
      return (
        (e3.toString = function () {
          var t4 = new et();
          return this.appendTo(t4, true), t4.toString();
        }),
        (e3.stringValue = function () {
          var t4 = new et();
          return this.appendTo(t4, false), t4.toString();
        }),
        (e3.toExpr = function (t4, e4) {
          throw new Error('F_ABSTRACT');
        }),
        (e3.appendTo = function (t4, e4) {
          t4.append('[error]');
        }),
        (e3.isExpr = function () {
          return false;
        }),
        (e3.isNumeric = function () {
          return false;
        }),
        (e3.isNum = function () {
          return false;
        }),
        (e3.isIdent = function () {
          return false;
        }),
        (e3.isSpaceList = function () {
          return false;
        }),
        (e3.visit = function (t4) {
          throw new Error('F_ABSTRACT');
        }),
        t3
      );
    })();
    var Re = (function (t3) {
      function e3() {
        return t3.call(this) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.toExpr = function (t4, e4) {
          return new Ee(t4, '');
        }),
        (n3.appendTo = function (t4, e4) {}),
        (n3.visit = function (t4) {
          return t4.visitEmpty(this);
        }),
        x2(e3, null, [
          {
            key: 'instance',
            get: function () {
              return this.empty || (this.empty = new e3()), this.empty;
            },
          },
        ]),
        e3
      );
    })(Pe).instance;
    var Ae = (function (t3) {
      function e3() {
        return t3.call(this) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.toExpr = function (t4, e4) {
          return new Ee(t4, '/');
        }),
        (n3.appendTo = function (t4, e4) {
          t4.append('/');
        }),
        (n3.visit = function (t4) {
          return t4.visitSlash(this);
        }),
        x2(e3, null, [
          {
            key: 'instance',
            get: function () {
              return this.slash || (this.slash = new e3()), this.slash;
            },
          },
        ]),
        e3
      );
    })(Pe).instance;
    var Le = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).str = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.toExpr = function (t4, e4) {
          return new Ee(t4, this.str);
        }),
        (n3.appendTo = function (t4, e4) {
          e4
            ? (t4.append('"'), t4.append(rt(this.str)), t4.append('"'))
            : t4.append(this.str);
        }),
        (n3.visit = function (t4) {
          return t4.visitStr(this);
        }),
        e3
      );
    })(Pe);
    var Oe = {};
    var ke = (function (t3) {
      function e3(e4) {
        var n4;
        if ((((n4 = t3.call(this) || this).name = e4), Oe[e4]))
          throw new Error('E_INVALID_CALL');
        return (Oe[e4] = k2(n4)), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.toExpr = function (t4, e4) {
          return new Ee(t4, this.name);
        }),
        (n3.appendTo = function (t4, e4) {
          t4.append(e4 ? it(this.name) : this.name);
        }),
        (n3.visit = function (t4) {
          return t4.visitIdent(this);
        }),
        (n3.isIdent = function () {
          return true;
        }),
        e3
      );
    })(Pe);
    function Fe(t3) {
      var e3 = Oe[t3];
      return e3 || (e3 = new ke(t3)), e3;
    }
    var De = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return (
          ((i3 = t3.call(this) || this).num = e4),
          (i3.unit = n4.toLowerCase()),
          i3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.toExpr = function (t4, e4) {
          return 0 == this.num
            ? t4.zero
            : e4 && '%' == this.unit
            ? 100 == this.num
              ? e4
              : new ue(t4, e4, new Ee(t4, this.num / 100))
            : new fe(t4, this.num, this.unit);
        }),
        (n3.appendTo = function (t4, e4) {
          t4.append(this.num.toString()), t4.append(this.unit);
        }),
        (n3.visit = function (t4) {
          return t4.visitNumeric(this);
        }),
        (n3.isNumeric = function () {
          return true;
        }),
        e3
      );
    })(Pe);
    var _e = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).num = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.toExpr = function (t4, e4) {
          return 0 == this.num
            ? t4.zero
            : 1 == this.num
            ? t4.one
            : new Ee(t4, this.num);
        }),
        (n3.appendTo = function (t4, e4) {
          t4.append(this.num.toString());
        }),
        (n3.visit = function (t4) {
          return t4.visitNum(this);
        }),
        (n3.isNum = function () {
          return true;
        }),
        e3
      );
    })(Pe);
    var Be = (function (t3) {
      function e3(e4) {
        return t3.call(this, e4) || this;
      }
      return (
        I2(e3, t3),
        (e3.prototype.visit = function (t4) {
          return t4.visitInt(this);
        }),
        e3
      );
    })(_e);
    var Me = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).rgb = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.appendTo = function (t4, e4) {
          t4.append('#');
          var n4 = this.rgb.toString(16);
          t4.append('000000'.substr(n4.length)), t4.append(n4);
        }),
        (n3.visit = function (t4) {
          return t4.visitColor(this);
        }),
        e3
      );
    })(Pe);
    var Ue = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).url = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.appendTo = function (t4, e4) {
          t4.append('url("'), t4.append(rt(this.url)), t4.append('")');
        }),
        (n3.visit = function (t4) {
          return t4.visitURL(this);
        }),
        e3
      );
    })(Pe);
    function Ve(t3, e3, n3, i3) {
      var r3 = e3.length;
      e3[0].appendTo(t3, i3);
      for (var o3 = 1; o3 < r3; o3++) t3.append(n3), e3[o3].appendTo(t3, i3);
    }
    var He = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).values = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.appendTo = function (t4, e4) {
          Ve(t4, this.values, ' ', e4);
        }),
        (n3.visit = function (t4) {
          return t4.visitSpaceList(this);
        }),
        (n3.isSpaceList = function () {
          return true;
        }),
        e3
      );
    })(Pe);
    var ze = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).values = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.appendTo = function (t4, e4) {
          Ve(t4, this.values, ',', e4);
        }),
        (n3.visit = function (t4) {
          return t4.visitCommaList(this);
        }),
        e3
      );
    })(Pe);
    var Ge = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return ((i3 = t3.call(this) || this).name = e4), (i3.values = n4), i3;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.appendTo = function (t4, e4) {
          t4.append(it(this.name)),
            t4.append('('),
            Ve(t4, this.values, ',', e4),
            t4.append(')');
        }),
        (n3.visit = function (t4) {
          return t4.visitFunc(this);
        }),
        e3
      );
    })(Pe);
    var We = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).expr = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.toExpr = function () {
          return this.expr;
        }),
        (n3.appendTo = function (t4, e4) {
          t4.append('-epubx-expr('), this.expr.appendTo(t4, 0), t4.append(')');
        }),
        (n3.visit = function (t4) {
          return t4.visitExpr(this);
        }),
        (n3.isExpr = function () {
          return true;
        }),
        e3
      );
    })(Pe);
    function Xe(t3, e3) {
      if (t3) {
        if (t3.isNumeric()) {
          var n3 = t3;
          return e3.queryUnitSize(n3.unit, false) * n3.num;
        }
        if (t3.isNum()) return t3.num;
      }
      return 0;
    }
    function je(t3, e3) {
      return new De(Xe(t3, e3), 'px');
    }
    var Ye = {
      absolute: Fe('absolute'),
      all: Fe('all'),
      always: Fe('always'),
      auto: Fe('auto'),
      avoid: Fe('avoid'),
      balance: Fe('balance'),
      balance_all: Fe('balance-all'),
      block: Fe('block'),
      block_end: Fe('block-end'),
      block_start: Fe('block-start'),
      both: Fe('both'),
      bottom: Fe('bottom'),
      border_box: Fe('border-box'),
      break_all: Fe('break-all'),
      break_word: Fe('break-word'),
      crop: Fe('crop'),
      cross: Fe('cross'),
      column: Fe('column'),
      exclusive: Fe('exclusive'),
      _false: Fe('false'),
      fixed: Fe('fixed'),
      flex: Fe('flex'),
      footnote: Fe('footnote'),
      footer: Fe('footer'),
      header: Fe('header'),
      hidden: Fe('hidden'),
      horizontal_tb: Fe('horizontal-tb'),
      inherit: Fe('inherit'),
      inline: Fe('inline'),
      inline_block: Fe('inline-block'),
      inline_end: Fe('inline-end'),
      inline_start: Fe('inline-start'),
      landscape: Fe('landscape'),
      left: Fe('left'),
      line: Fe('line'),
      list_item: Fe('list-item'),
      ltr: Fe('ltr'),
      manual: Fe('manual'),
      none: Fe('none'),
      normal: Fe('normal'),
      oeb_page_foot: Fe('oeb-page-foot'),
      oeb_page_head: Fe('oeb-page-head'),
      page: Fe('page'),
      relative: Fe('relative'),
      right: Fe('right'),
      same: Fe('same'),
      scale: Fe('scale'),
      snap_block: Fe('snap-block'),
      spread: Fe('spread'),
      _static: Fe('static'),
      rtl: Fe('rtl'),
      table: Fe('table'),
      table_caption: Fe('table-caption'),
      table_cell: Fe('table-cell'),
      table_footer_group: Fe('table-footer-group'),
      table_header_group: Fe('table-header-group'),
      table_row: Fe('table-row'),
      top: Fe('top'),
      transparent: Fe('transparent'),
      vertical_lr: Fe('vertical-lr'),
      vertical_rl: Fe('vertical-rl'),
      visible: Fe('visible'),
      _true: Fe('true'),
    };
    var Ke = new De(100, '%');
    var qe = new De(100, 'pvw');
    var Qe = new De(100, 'pvh');
    var Ze = new De(0, 'px');
    var $e = { 'font-size': 1, color: 2 };
    function Je(t3, e3) {
      return ($e[t3] || Number.MAX_VALUE) - ($e[e3] || Number.MAX_VALUE);
    }
    var tn = function (t3, e3, n3, i3) {
      (this.x1 = t3), (this.y1 = e3), (this.x2 = n3), (this.y2 = i3);
    };
    var en = function (t3, e3) {
      (this.x = t3), (this.y = e3);
    };
    var nn = function (t3, e3, n3, i3) {
      (this.left = t3), (this.top = e3), (this.right = n3), (this.bottom = i3);
    };
    var rn = function (t3, e3, n3, i3) {
      (this.low = t3),
        (this.high = e3),
        (this.winding = n3),
        (this.shapeId = i3);
    };
    var on = function (t3, e3, n3, i3) {
      (this.y1 = t3),
        (this.y2 = e3),
        (this.x1 = n3),
        (this.x2 = i3),
        (this.left = null),
        (this.right = null);
    };
    function an(t3, e3) {
      return t3.low.y - e3.low.y || t3.low.x - e3.low.x;
    }
    var sn = (function () {
      function t3(t4) {
        this.points = t4;
      }
      var e3 = t3.prototype;
      return (
        (e3.addSegments = function (t4, e4) {
          for (
            var n3 = this.points, i3 = n3.length, r3 = n3[i3 - 1], o3 = 0;
            o3 < i3;
            o3++
          ) {
            var a3,
              s3 = n3[o3];
            (a3 = r3.y < s3.y ? new rn(r3, s3, 1, e4) : new rn(s3, r3, -1, e4)),
              t4.push(a3),
              (r3 = s3);
          }
        }),
        (e3.withOffset = function (e4, n3) {
          for (var i3, r3 = [], o3 = D(this.points); !(i3 = o3()).done; ) {
            var a3 = i3.value;
            r3.push(new en(a3.x + e4, a3.y + n3));
          }
          return new t3(r3);
        }),
        t3
      );
    })();
    function ln(t3, e3, n3, i3) {
      for (var r3 = [], o3 = 0; o3 < 20; o3++) {
        var a3 = (2 * o3 * Math.PI) / 20;
        r3.push(new en(t3 + n3 * Math.sin(a3), e3 + i3 * Math.cos(a3)));
      }
      return new sn(r3);
    }
    function un(t3, e3, n3, i3) {
      return new sn([
        new en(t3, e3),
        new en(n3, e3),
        new en(n3, i3),
        new en(t3, i3),
      ]);
    }
    var hn = function (t3, e3, n3, i3) {
      (this.x = t3),
        (this.winding = e3),
        (this.shapeId = n3),
        (this.lowOrHigh = i3);
    };
    function cn(t3, e3) {
      var n3 =
        t3.low.x +
        ((t3.high.x - t3.low.x) * (e3 - t3.low.y)) / (t3.high.y - t3.low.y);
      if (isNaN(n3)) throw new Error('Bad intersection');
      return n3;
    }
    function fn(t3, e3, n3, i3) {
      var r3, o3, a3, s3;
      e3.high.y < n3 && c2.warn('Error: inconsistent segment (1)'),
        e3.low.y <= n3
          ? ((r3 = cn(e3, n3)), (o3 = e3.winding))
          : ((r3 = e3.low.x), (o3 = 0)),
        e3.high.y >= i3
          ? ((a3 = cn(e3, i3)), (s3 = e3.winding))
          : ((a3 = e3.high.x), (s3 = 0)),
        r3 < a3
          ? (t3.push(new hn(r3, o3, e3.shapeId, -1)),
            t3.push(new hn(a3, s3, e3.shapeId, 1)))
          : (t3.push(new hn(a3, s3, e3.shapeId, -1)),
            t3.push(new hn(r3, o3, e3.shapeId, 1)));
    }
    function dn(t3, e3, n3) {
      var i3,
        r3 = e3 + n3,
        o3 = Array(r3),
        a3 = Array(r3);
      for (i3 = 0; i3 <= r3; i3++) (o3[i3] = 0), (a3[i3] = 0);
      for (var s3 = [], l3 = false, u3 = t3.length, h3 = 0; h3 < u3; h3++) {
        var c3 = t3[h3];
        (o3[c3.shapeId] += c3.winding), (a3[c3.shapeId] += c3.lowOrHigh);
        var f3 = false;
        for (i3 = 0; i3 < e3; i3++)
          if (o3[i3] && !a3[i3]) {
            f3 = true;
            break;
          }
        if (f3) {
          for (i3 = e3; i3 <= r3; i3++)
            if (o3[i3] || a3[i3]) {
              f3 = false;
              break;
            }
        }
        l3 != f3 && (s3.push(c3.x), (l3 = f3));
      }
      return s3;
    }
    function pn(t3, e3) {
      return e3 ? Math.floor(t3 / e3) * e3 : t3;
    }
    function gn(t3) {
      return new tn(t3.y1, -t3.x2, t3.y2, -t3.x1);
    }
    function mn(t3) {
      return new tn(-t3.y2, t3.x1, -t3.y1, t3.x2);
    }
    function vn(t3) {
      return new sn(
        t3.points.map(function (t4) {
          return (function (t5) {
            return new en(t5.y, -t5.x);
          })(t4);
        }),
      );
    }
    function En(t3, e3) {
      for (
        var n3 = e3.length - 1, i3 = new on(t3.y2, t3.y2, t3.x1, t3.x2);
        n3 >= 0;

      ) {
        var r3 = i3;
        ((i3 = e3[n3]).y2 - i3.y1 < 1 || (i3.x1 == r3.x1 && i3.x2 == r3.x2)) &&
          ((r3.y1 = i3.y1), e3.splice(n3, 1), (i3 = r3)),
          n3--;
      }
    }
    function yn(t3, e3) {
      for (var n3 = 0, i3 = t3.length; n3 < i3; ) {
        var r3 = Math.floor((n3 + i3) / 2);
        e3 >= t3[r3].y2 ? (n3 = r3 + 1) : (i3 = r3);
      }
      return n3;
    }
    function wn(t3, e3) {
      if (!t3.length) return e3;
      var n3,
        i3,
        r3 = e3.y1;
      for (
        i3 = 0;
        i3 < t3.length &&
        !(
          (n3 = t3[i3]).y2 > e3.y1 &&
          n3.x1 - 0.1 <= e3.x1 &&
          n3.x2 + 0.1 >= e3.x2
        );
        i3++
      )
        r3 = Math.max(r3, n3.y2);
      for (
        var o3 = r3;
        i3 < t3.length &&
        !(
          (n3 = t3[i3]).y1 >= e3.y2 ||
          n3.x1 - 0.1 > e3.x1 ||
          n3.x2 + 0.1 < e3.x2
        );
        i3++
      )
        o3 = n3.y2;
      return (o3 = i3 === t3.length ? e3.y2 : Math.min(o3, e3.y2)) <= r3
        ? null
        : new tn(e3.x1, r3, e3.x2, o3);
    }
    function Nn(t3, e3) {
      if (!t3.length) return e3;
      var n3,
        i3,
        r3 = e3.y2;
      for (
        i3 = t3.length - 1;
        i3 >= 0 &&
        ((n3 = t3[i3]), !(i3 === t3.length - 1 && n3.y2 < e3.y2)) &&
        !(n3.y1 < e3.y2 && n3.x1 - 0.1 <= e3.x1 && n3.x2 + 0.1 >= e3.x2);
        i3--
      )
        r3 = Math.min(r3, n3.y1);
      for (
        var o3 = Math.min(r3, n3.y2);
        i3 >= 0 &&
        !(
          (n3 = t3[i3]).y2 <= e3.y1 ||
          n3.x1 - 0.1 > e3.x1 ||
          n3.x2 + 0.1 < e3.x2
        );
        i3--
      )
        o3 = n3.y1;
      return r3 <= (o3 = Math.max(o3, e3.y1))
        ? null
        : new tn(e3.x1, o3, e3.x2, r3);
    }
    var bn = (function (t3) {
      function e3() {
        var e4;
        return ((e4 = t3.call(this) || this).propSet = {}), e4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.visitIdent = function (t4) {
          return (this.propSet[t4.name] = true), t4;
        }),
        (n3.visitSpaceList = function (t4) {
          return this.visitValues(t4.values), t4;
        }),
        e3
      );
    })(xe);
    var Sn = (function (t3) {
      function e3(e4) {
        var n3;
        return ((n3 = t3.call(this) || this).value = e4), n3;
      }
      return (
        I2(e3, t3),
        (e3.prototype.visitInt = function (t4) {
          return (this.value = t4.num), t4;
        }),
        e3
      );
    })(xe);
    function Cn(t3, e3) {
      if (t3) {
        var n3 = new Sn(e3);
        try {
          return t3.visit(n3), n3.value;
        } catch (t4) {
          c2.warn(t4, 'toInt: ');
        }
      }
      return e3;
    }
    var Tn = (function (t3) {
      function e3() {
        var e4;
        return (
          ((e4 = t3.call(this) || this).collect = false),
          (e4.coords = []),
          (e4.name = null),
          e4
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.visitNumeric = function (t4) {
          return this.collect && this.coords.push(t4), null;
        }),
        (n3.visitNum = function (t4) {
          return (
            this.collect && 0 == t4.num && this.coords.push(new De(0, 'px')),
            null
          );
        }),
        (n3.visitSpaceList = function (t4) {
          return this.visitValues(t4.values), null;
        }),
        (n3.visitFunc = function (t4) {
          return (
            this.collect ||
              ((this.collect = true),
              this.visitValues(t4.values),
              (this.collect = false),
              (this.name = t4.name.toLowerCase())),
            null
          );
        }),
        (n3.getShape = function (t4, e4, n4, i3, r3) {
          var o3 = this;
          if (this.coords.length > 0) {
            var a3 = [];
            switch (
              (this.coords.forEach(function (t5, e5) {
                if ('%' == t5.unit) {
                  var s4 = e5 % 2 == 0 ? n4 : i3;
                  3 == e5 &&
                    'circle' == o3.name &&
                    (s4 = Math.sqrt((n4 * n4 + i3 * i3) / 2)),
                    a3.push((t5.num * s4) / 100);
                } else a3.push(t5.num * r3.queryUnitSize(t5.unit, false));
              }),
              this.name)
            ) {
              case 'polygon':
                if (a3.length % 2 == 0) {
                  for (var s3 = [], l3 = 0; l3 < a3.length; l3 += 2)
                    s3.push(new en(t4 + a3[l3], e4 + a3[l3 + 1]));
                  return new sn(s3);
                }
                break;
              case 'rectangle':
                if (4 == a3.length)
                  return un(
                    t4 + a3[0],
                    e4 + a3[1],
                    t4 + a3[0] + a3[2],
                    e4 + a3[1] + a3[3],
                  );
                break;
              case 'ellipse':
                if (4 == a3.length)
                  return ln(t4 + a3[0], e4 + a3[1], a3[2], a3[3]);
                break;
              case 'circle':
                if (3 == a3.length)
                  return ln(t4 + a3[0], e4 + a3[1], a3[2], a3[2]);
            }
          }
          return null;
        }),
        e3
      );
    })(xe);
    function xn(t3, e3, n3, i3, r3, o3) {
      if (t3) {
        var a3 = new Tn();
        try {
          return t3.visit(a3), a3.getShape(e3, n3, i3, r3, o3);
        } catch (t4) {
          c2.warn(t4, 'toShape:');
        }
      }
      return un(e3, n3, e3 + i3, n3 + r3);
    }
    var In = (function (t3) {
      function e3(e4) {
        var n4;
        return (
          ((n4 = t3.call(this) || this).reset = e4),
          (n4.counters = {}),
          (n4.name = null),
          n4
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.visitIdent = function (t4) {
          return (
            (this.name = t4.toString()),
            (this.counters[this.name] = this.reset
              ? 0
              : (this.counters[this.name] || 0) + 1),
            t4
          );
        }),
        (n3.visitInt = function (t4) {
          return (
            this.name &&
              (this.counters[this.name] += t4.num - (this.reset ? 0 : 1)),
            t4
          );
        }),
        (n3.visitSpaceList = function (t4) {
          return this.visitValues(t4.values), t4;
        }),
        e3
      );
    })(xe);
    function Pn(t3, e3) {
      var n3 = new In(e3);
      try {
        t3.visit(n3);
      } catch (t4) {
        c2.warn(t4, 'toCounters:');
      }
      return n3.counters;
    }
    var Rn = (function (t3) {
      function e3(e4, n3) {
        var i3;
        return (
          ((i3 = t3.call(this) || this).baseUrl = e4), (i3.transformer = n3), i3
        );
      }
      return (
        I2(e3, t3),
        (e3.prototype.visitURL = function (t4) {
          return new Ue(this.transformer.transformURL(t4.url, this.baseUrl));
        }),
        e3
      );
    })(Ie);
    function An(t3) {
      var e3 = {};
      return (
        Object.keys(t3).forEach(function (n3) {
          e3[n3] = Array.from(t3[n3]);
        }),
        e3
      );
    }
    var Ln;
    var On = (function () {
      function t3(t4, e4) {
        (this.targetId = t4),
          (this.resolved = e4),
          (this.pageCounters = null),
          (this.spineIndex = -1),
          (this.pageIndex = -1);
      }
      var e3 = t3.prototype;
      return (
        (e3.equals = function (t4) {
          return (
            this === t4 ||
            (!!t4 &&
              this.targetId === t4.targetId &&
              this.resolved === t4.resolved &&
              this.spineIndex === t4.spineIndex &&
              this.pageIndex === t4.pageIndex)
          );
        }),
        (e3.isResolved = function () {
          return this.resolved;
        }),
        (e3.resolve = function () {
          this.resolved = true;
        }),
        (e3.unresolve = function () {
          this.resolved = false;
        }),
        t3
      );
    })();
    var kn = (function () {
      function t3(t4, e4) {
        (this.counterStore = t4), (this.baseURL = e4);
      }
      var e3 = t3.prototype;
      return (
        (e3.countersOfId = function (t4, e4) {
          (t4 = this.counterStore.documentURLTransformer.transformFragment(
            t4,
            this.baseURL,
          )),
            (this.counterStore.countersById[t4] = e4);
        }),
        (e3.getExprContentListener = function () {
          return this.counterStore.getExprContentListener();
        }),
        t3
      );
    })();
    var Fn = (function () {
      function t3(t4, e4, n3, i3) {
        (this.counterStore = t4),
          (this.baseURL = e4),
          (this.rootScope = n3),
          (this.pageScope = i3),
          (this.styler = null);
      }
      var e3 = t3.prototype;
      return (
        (e3.setStyler = function (t4) {
          this.styler = t4;
        }),
        (e3.getFragment = function (t4) {
          var e4 = t4.match(/^[^#]*#(.*)$/);
          return e4 ? e4[1] : null;
        }),
        (e3.getTransformedId = function (t4) {
          var e4 = this.counterStore.documentURLTransformer.transformURL(
            W(t4, this.baseURL),
            this.baseURL,
          );
          return '#' === e4.charAt(0) && (e4 = e4.substring(1)), e4;
        }),
        (e3.getPageCounterVal = function (t4, e4) {
          var n3 = this,
            i3 = new ge(
              this.pageScope,
              function () {
                return e4(
                  (function () {
                    var e5 = n3.counterStore.currentPageCounters[t4];
                    return e5 && e5.length ? e5[e5.length - 1] : null;
                  })(),
                );
              },
              'page-counter-' + t4,
            );
          return (
            this.counterStore.registerPageCounterExpr(
              t4,
              function (t5) {
                return e4(t5[0]);
              },
              i3,
            ),
            i3
          );
        }),
        (e3.getPageCountersVal = function (t4, e4) {
          var n3 = this,
            i3 = new ge(
              this.pageScope,
              function () {
                return e4(n3.counterStore.currentPageCounters[t4] || []);
              },
              'page-counters-' + t4,
            );
          return this.counterStore.registerPageCounterExpr(t4, e4, i3), i3;
        }),
        (e3.getTargetCounters = function (t4, e4, n3) {
          var i3 = this.counterStore.countersById[e4];
          return (
            !i3 &&
              n3 &&
              t4 &&
              (this.styler.styleUntilIdIsReached(t4),
              (i3 = this.counterStore.countersById[e4])),
            i3 || null
          );
        }),
        (e3.getTargetPageCounters = function (t4) {
          return this.counterStore.currentPage.elementsById[t4]
            ? this.counterStore.currentPageCounters
            : this.counterStore.pageCountersById[t4] || null;
        }),
        (e3.getTargetCounterVal = function (t4, e4, n3) {
          var i3 = this.getFragment(t4),
            r3 = this.getTransformedId(t4),
            o3 = this.getTargetCounters(i3, r3, false);
          if (o3 && o3[e4]) {
            var a3 = o3[e4];
            return new Ee(this.rootScope, n3(a3[a3.length - 1] || null));
          }
          var s3 = this;
          return new ge(
            this.pageScope,
            function () {
              if ((o3 = s3.getTargetCounters(i3, r3, true))) {
                if (o3[e4]) {
                  var t5 = o3[e4];
                  return n3(t5[t5.length - 1] || null);
                }
                var a4 = s3.getTargetPageCounters(r3);
                if (a4) {
                  if ((s3.counterStore.resolveReference(r3), a4[e4])) {
                    var l3 = a4[e4];
                    return n3(l3[l3.length - 1] || null);
                  }
                  return n3(0);
                }
                return (
                  s3.counterStore.saveReferenceOfCurrentPage(r3, false), '??'
                );
              }
              return (
                s3.counterStore.saveReferenceOfCurrentPage(r3, false), '??'
              );
            },
            'target-counter-' + e4 + '-of-' + t4,
          );
        }),
        (e3.getTargetCountersVal = function (t4, e4, n3) {
          var i3 = this.getFragment(t4),
            r3 = this.getTransformedId(t4),
            o3 = this;
          return new ge(
            this.pageScope,
            function () {
              var t5 = o3.getTargetPageCounters(r3);
              if (t5) {
                o3.counterStore.resolveReference(r3);
                var a3 = t5[e4] || [],
                  s3 = o3.getTargetCounters(i3, r3, true);
                return n3(a3.concat(s3[e4] || []));
              }
              return (
                o3.counterStore.saveReferenceOfCurrentPage(r3, false), '??'
              );
            },
            'target-counters-' + e4 + '-of-' + t4,
          );
        }),
        t3
      );
    })();
    var Dn = (function () {
      function t3(t4) {
        (this.documentURLTransformer = t4),
          (this.countersById = {}),
          (this.pageCountersById = {}),
          (this.currentPageCounters = {}),
          (this.previousPageCounters = {}),
          (this.currentPageCountersStack = []),
          (this.pageIndicesById = {}),
          (this.currentPage = null),
          (this.newReferencesOfCurrentPage = []),
          (this.referencesToSolve = []),
          (this.referencesToSolveStack = []),
          (this.unresolvedReferences = {}),
          (this.resolvedReferences = {}),
          (this.pagesCounterExprs = []),
          (this.currentPageCounters.page = [0]);
      }
      var e3 = t3.prototype;
      return (
        (e3.createCounterListener = function (t4) {
          return new kn(this, t4);
        }),
        (e3.createCounterResolver = function (t4, e4, n3) {
          return new Fn(this, t4, e4, n3);
        }),
        (e3.setCurrentPage = function (t4) {
          this.currentPage = t4;
        }),
        (e3.definePageCounter = function (t4, e4) {
          this.currentPageCounters[t4]
            ? this.currentPageCounters[t4].push(e4)
            : (this.currentPageCounters[t4] = [e4]);
        }),
        (e3.forceSetPageCounter = function (t4) {
          var e4 = this.currentPageCounters.page;
          e4 && e4.length
            ? (e4[e4.length - 1] = t4)
            : (this.currentPageCounters.page = [t4]);
        }),
        (e3.updatePageCounters = function (t4, e4) {
          var n3;
          this.previousPageCounters = An(this.currentPageCounters);
          var i3,
            r3 = t4['counter-reset'];
          if (r3) {
            var o3 = r3.evaluate(e4);
            o3 && (n3 = Pn(o3, true));
          }
          if (n3) for (var a3 in n3) this.definePageCounter(a3, n3[a3]);
          var s3 = t4['counter-increment'];
          if (s3) {
            var l3 = s3.evaluate(e4);
            l3 && (i3 = Pn(l3, false));
          }
          for (var u3 in (i3
            ? 'page' in i3 || (i3.page = 1)
            : ((i3 = {}).page = 1),
          i3)) {
            this.currentPageCounters[u3] || this.definePageCounter(u3, 0);
            var h3 = this.currentPageCounters[u3];
            h3[h3.length - 1] += i3[u3];
          }
        }),
        (e3.pushPageCounters = function (t4) {
          this.currentPageCountersStack.push(this.currentPageCounters),
            (this.currentPageCounters = An(t4));
        }),
        (e3.popPageCounters = function () {
          this.currentPageCounters = this.currentPageCountersStack.pop();
        }),
        (e3.resolveReference = function (t4) {
          var e4 = this.unresolvedReferences[t4],
            n3 = this.resolvedReferences[t4];
          n3 || (n3 = this.resolvedReferences[t4] = []);
          for (var i3 = false, r3 = 0; r3 < this.referencesToSolve.length; ) {
            var o3 = this.referencesToSolve[r3];
            if (o3.targetId === t4) {
              if ((o3.resolve(), this.referencesToSolve.splice(r3, 1), e4)) {
                var a3 = e4.indexOf(o3);
                a3 >= 0 && e4.splice(a3, 1);
              }
              n3.push(o3), (i3 = true);
            } else r3++;
          }
          i3 || this.saveReferenceOfCurrentPage(t4, true);
        }),
        (e3.saveReferenceOfCurrentPage = function (t4, e4) {
          if (
            !this.newReferencesOfCurrentPage.some(function (e5) {
              return e5.targetId === t4;
            })
          ) {
            var n3 = new On(t4, e4);
            this.newReferencesOfCurrentPage.push(n3);
          }
        }),
        (e3.finishPage = function (t4, e4) {
          var n3 = this,
            i3 = Object.keys(this.currentPage.elementsById);
          if (i3.length > 0) {
            var r3 = An(this.currentPageCounters);
            i3.forEach(function (i4) {
              n3.pageCountersById[i4] = r3;
              var o4 = n3.pageIndicesById[i4];
              if (o4 && o4.pageIndex < e4) {
                var a4 = n3.resolvedReferences[i4];
                if (a4) {
                  var s4,
                    l3 = n3.unresolvedReferences[i4];
                  for (
                    l3 || (l3 = n3.unresolvedReferences[i4] = []);
                    (s4 = a4.shift());

                  )
                    s4.unresolve(), l3.push(s4);
                }
              }
              n3.pageIndicesById[i4] = { spineIndex: t4, pageIndex: e4 };
            });
          }
          for (
            var o3, a3 = this.previousPageCounters;
            (o3 = this.newReferencesOfCurrentPage.shift());

          ) {
            (o3.pageCounters = a3), (o3.spineIndex = t4), (o3.pageIndex = e4);
            var s3 = void 0;
            o3.isResolved()
              ? (s3 = this.resolvedReferences[o3.targetId]) ||
                (s3 = this.resolvedReferences[o3.targetId] = [])
              : (s3 = this.unresolvedReferences[o3.targetId]) ||
                (s3 = this.unresolvedReferences[o3.targetId] = []),
              s3.every(function (t5) {
                return !o3.equals(t5);
              }) && s3.push(o3);
          }
          this.currentPage = null;
        }),
        (e3.getUnresolvedRefsToPage = function (t4) {
          var e4 = this,
            n3 = [];
          Object.keys(t4.elementsById).forEach(function (t5) {
            var i4 = e4.unresolvedReferences[t5];
            i4 && (n3 = n3.concat(i4));
          }),
            n3.sort(function (t5, e5) {
              return (
                t5.spineIndex - e5.spineIndex || t5.pageIndex - e5.pageIndex
              );
            });
          var i3 = [],
            r3 = null;
          return (
            n3.forEach(function (t5) {
              r3 &&
              r3.spineIndex === t5.spineIndex &&
              r3.pageIndex === t5.pageIndex
                ? r3.refs.push(t5)
                : i3.push(
                    (r3 = {
                      spineIndex: t5.spineIndex,
                      pageIndex: t5.pageIndex,
                      pageCounters: t5.pageCounters,
                      refs: [t5],
                    }),
                  );
            }),
            i3
          );
        }),
        (e3.pushReferencesToSolve = function (t4) {
          this.referencesToSolveStack.push(this.referencesToSolve),
            (this.referencesToSolve = t4);
        }),
        (e3.popReferencesToSolve = function () {
          this.referencesToSolve = this.referencesToSolveStack.pop();
        }),
        (e3.registerPageCounterExpr = function (t4, e4, n3) {
          'pages' === t4 &&
            this.pagesCounterExprs.push({ expr: n3, format: e4 });
        }),
        (e3.getExprContentListener = function () {
          return this.exprContentListener.bind(this);
        }),
        (e3.exprContentListener = function (t4, e4, n3) {
          if (
            this.pagesCounterExprs.findIndex(function (e5) {
              return e5.expr === t4;
            }) >= 0
          ) {
            var i3 = n3.createElement('span');
            return (i3.textContent = e4), i3.setAttribute(_n, t4.key), i3;
          }
          return null;
        }),
        (e3.finishLastPage = function (t4) {
          var e4 = this,
            n3 = t4.root.querySelectorAll('[' + _n + ']'),
            i3 = this.currentPageCounters.page[0];
          Array.from(n3).forEach(function (t5) {
            var n4 = t5.getAttribute(_n),
              r3 = e4.pagesCounterExprs.findIndex(function (t6) {
                return t6.expr.key === n4;
              });
            t5.textContent = e4.pagesCounterExprs[r3].format([i3]);
          });
        }),
        (e3.createLayoutConstraint = function (t4) {
          return new Bn(this, t4);
        }),
        t3
      );
    })();
    var _n = 'data-vivliostyle-pages-counter';
    var Bn = (function () {
      function t3(t4, e3) {
        (this.counterStore = t4), (this.pageIndex = e3);
      }
      return (
        (t3.prototype.allowLayout = function (t4) {
          if (!t4 || t4.after) return true;
          var e3 = t4.viewNode;
          if (!e3 || 1 !== e3.nodeType) return true;
          var n3 = e3.getAttribute('id') || e3.getAttribute('name');
          if (!n3) return true;
          if (
            !this.counterStore.resolvedReferences[n3] &&
            !this.counterStore.unresolvedReferences[n3]
          )
            return true;
          var i3 = this.counterStore.pageIndicesById[n3];
          return !i3 || this.pageIndex >= i3.pageIndex;
        }),
        t3
      );
    })();
    function Mn(t3) {
      if ((t3 = t3.substr(1)).match(/^[^0-9a-fA-F\n\r]$/)) return t3;
      var e3 = parseInt(t3, 16);
      return isNaN(e3)
        ? ''
        : e3 <= 65535
        ? String.fromCharCode(e3)
        : e3 <= 1114111
        ? String.fromCharCode(55296 | ((e3 >> 10) & 1023), 56320 | (1023 & e3))
        : '';
    }
    function Un(t3) {
      return t3.replace(
        /\\([0-9a-fA-F]{0,6}(\r\n|[ \n\r\t\f])?|[^0-9a-fA-F\n\r])/g,
        Mn,
      );
    }
    !(function (t3) {
      (t3[(t3.EOF = 0)] = 'EOF'),
        (t3[(t3.IDENT = 1)] = 'IDENT'),
        (t3[(t3.STR = 2)] = 'STR'),
        (t3[(t3.NUMERIC = 3)] = 'NUMERIC'),
        (t3[(t3.NUM = 4)] = 'NUM'),
        (t3[(t3.INT = 5)] = 'INT'),
        (t3[(t3.FUNC = 6)] = 'FUNC'),
        (t3[(t3.HASH = 7)] = 'HASH'),
        (t3[(t3.URL = 8)] = 'URL'),
        (t3[(t3.CLASS = 9)] = 'CLASS'),
        (t3[(t3.O_PAR = 10)] = 'O_PAR'),
        (t3[(t3.C_PAR = 11)] = 'C_PAR'),
        (t3[(t3.O_BRC = 12)] = 'O_BRC'),
        (t3[(t3.C_BRC = 13)] = 'C_BRC'),
        (t3[(t3.O_BRK = 14)] = 'O_BRK'),
        (t3[(t3.C_BRK = 15)] = 'C_BRK'),
        (t3[(t3.COMMA = 16)] = 'COMMA'),
        (t3[(t3.SEMICOL = 17)] = 'SEMICOL'),
        (t3[(t3.COLON = 18)] = 'COLON'),
        (t3[(t3.SLASH = 19)] = 'SLASH'),
        (t3[(t3.AT = 20)] = 'AT'),
        (t3[(t3.PERCENT = 21)] = 'PERCENT'),
        (t3[(t3.QMARK = 22)] = 'QMARK'),
        (t3[(t3.PLUS = 23)] = 'PLUS'),
        (t3[(t3.MINUS = 24)] = 'MINUS'),
        (t3[(t3.BAR_BAR = 25)] = 'BAR_BAR'),
        (t3[(t3.AMP_AMP = 26)] = 'AMP_AMP'),
        (t3[(t3.BANG = 31)] = 'BANG'),
        (t3[(t3.DOLLAR = 32)] = 'DOLLAR'),
        (t3[(t3.HAT = 33)] = 'HAT'),
        (t3[(t3.BAR = 34)] = 'BAR'),
        (t3[(t3.TILDE = 35)] = 'TILDE'),
        (t3[(t3.STAR = 36)] = 'STAR'),
        (t3[(t3.GT = 37)] = 'GT'),
        (t3[(t3.LT = 38)] = 'LT'),
        (t3[(t3.EQ = 39)] = 'EQ'),
        (t3[(t3.BANG_EQ = 41)] = 'BANG_EQ'),
        (t3[(t3.DOLLAR_EQ = 42)] = 'DOLLAR_EQ'),
        (t3[(t3.HAT_EQ = 43)] = 'HAT_EQ'),
        (t3[(t3.BAR_EQ = 44)] = 'BAR_EQ'),
        (t3[(t3.TILDE_EQ = 45)] = 'TILDE_EQ'),
        (t3[(t3.STAR_EQ = 46)] = 'STAR_EQ'),
        (t3[(t3.GT_EQ = 47)] = 'GT_EQ'),
        (t3[(t3.LT_EQ = 48)] = 'LT_EQ'),
        (t3[(t3.EQ_EQ = 49)] = 'EQ_EQ'),
        (t3[(t3.COL_COL = 50)] = 'COL_COL'),
        (t3[(t3.INVALID = 51)] = 'INVALID'),
        (t3[(t3.LAST = 51)] = 'LAST');
    })(Ln || (Ln = {}));
    var Vn;
    var Hn = function () {
      (this.precededBySpace = false),
        (this.num = 0),
        (this.text = ''),
        (this.position = 0),
        (this.type = Ln.EOF);
    };
    function zn(t3, e3) {
      var n3,
        i3 = Array(128);
      for (n3 = 0; n3 < 128; n3++) i3[n3] = t3;
      for (
        i3.NaN = t3 == Vn.END ? Vn.END : Vn.INVALID, n3 = 0;
        n3 < e3.length;
        n3 += 2
      )
        i3[e3[n3]] = e3[n3 + 1];
      return i3;
    }
    !(function (t3) {
      (t3[(t3.SPACE = 1)] = 'SPACE'),
        (t3[(t3.INT = 2)] = 'INT'),
        (t3[(t3.IDENT = 3)] = 'IDENT'),
        (t3[(t3.BANG = 4)] = 'BANG'),
        (t3[(t3.HASH = 6)] = 'HASH'),
        (t3[(t3.DOLLAR = 7)] = 'DOLLAR'),
        (t3[(t3.PERCENT = 8)] = 'PERCENT'),
        (t3[(t3.AMP = 9)] = 'AMP'),
        (t3[(t3.O_PAR = 10)] = 'O_PAR'),
        (t3[(t3.C_PAR = 11)] = 'C_PAR'),
        (t3[(t3.STAR = 12)] = 'STAR'),
        (t3[(t3.PLUS = 13)] = 'PLUS'),
        (t3[(t3.COMMA = 14)] = 'COMMA'),
        (t3[(t3.MINUS = 15)] = 'MINUS'),
        (t3[(t3.DOT = 16)] = 'DOT'),
        (t3[(t3.SLASH = 17)] = 'SLASH'),
        (t3[(t3.COLON = 18)] = 'COLON'),
        (t3[(t3.SEMICOL = 19)] = 'SEMICOL'),
        (t3[(t3.LT = 20)] = 'LT'),
        (t3[(t3.EQ = 21)] = 'EQ'),
        (t3[(t3.GT = 22)] = 'GT'),
        (t3[(t3.QMARK = 23)] = 'QMARK'),
        (t3[(t3.AT = 24)] = 'AT'),
        (t3[(t3.O_BRK = 25)] = 'O_BRK'),
        (t3[(t3.C_BRK = 26)] = 'C_BRK'),
        (t3[(t3.O_BRC = 27)] = 'O_BRC'),
        (t3[(t3.C_BRC = 28)] = 'C_BRC'),
        (t3[(t3.BSLASH = 29)] = 'BSLASH'),
        (t3[(t3.HAT = 30)] = 'HAT'),
        (t3[(t3.BAR = 31)] = 'BAR'),
        (t3[(t3.TILDE = 32)] = 'TILDE'),
        (t3[(t3.STR1 = 33)] = 'STR1'),
        (t3[(t3.STR2 = 34)] = 'STR2'),
        (t3[(t3.END = 35)] = 'END'),
        (t3[(t3.EQTAIL = 36)] = 'EQTAIL'),
        (t3[(t3.ENDINT = 37)] = 'ENDINT'),
        (t3[(t3.ENDNUM = 38)] = 'ENDNUM'),
        (t3[(t3.CONT = 39)] = 'CONT'),
        (t3[(t3.UNIT = 40)] = 'UNIT'),
        (t3[(t3.PCUNIT = 41)] = 'PCUNIT'),
        (t3[(t3.NUMBER = 42)] = 'NUMBER'),
        (t3[(t3.ENDIDNT = 43)] = 'ENDIDNT'),
        (t3[(t3.IDNTESC = 44)] = 'IDNTESC'),
        (t3[(t3.ENDIDES = 45)] = 'ENDIDES'),
        (t3[(t3.ENDSTR = 46)] = 'ENDSTR'),
        (t3[(t3.ENDESTR = 47)] = 'ENDESTR'),
        (t3[(t3.STR1ESC = 48)] = 'STR1ESC'),
        (t3[(t3.STR2ESC = 49)] = 'STR2ESC'),
        (t3[(t3.BAR_BAR = 50)] = 'BAR_BAR'),
        (t3[(t3.AMP_AMP = 51)] = 'AMP_AMP'),
        (t3[(t3.FUNC = 52)] = 'FUNC'),
        (t3[(t3.FUNCES = 53)] = 'FUNCES'),
        (t3[(t3.COMMENT = 54)] = 'COMMENT'),
        (t3[(t3.COMMST = 55)] = 'COMMST'),
        (t3[(t3.ENDNOTK = 56)] = 'ENDNOTK'),
        (t3[(t3.MINMIN = 57)] = 'MINMIN'),
        (t3[(t3.TOINT = 58)] = 'TOINT'),
        (t3[(t3.TONUM = 59)] = 'TONUM'),
        (t3[(t3.TOIDENT = 60)] = 'TOIDENT'),
        (t3[(t3.TOIDES = 61)] = 'TOIDES'),
        (t3[(t3.KILL1 = 62)] = 'KILL1'),
        (t3[(t3.KILL2 = 63)] = 'KILL2'),
        (t3[(t3.URL = 64)] = 'URL'),
        (t3[(t3.URL1 = 65)] = 'URL1'),
        (t3[(t3.URL2 = 66)] = 'URL2'),
        (t3[(t3.ENDURL = 67)] = 'ENDURL'),
        (t3[(t3.TERMURL = 68)] = 'TERMURL'),
        (t3[(t3.FINURL = 69)] = 'FINURL'),
        (t3[(t3.LT_BG = 70)] = 'LT_BG'),
        (t3[(t3.LT_BG_M = 71)] = 'LT_BG_M'),
        (t3[(t3.INVALID = 72)] = 'INVALID'),
        (t3[(t3.CHKPOSS = 73)] = 'CHKPOSS'),
        (t3[(t3.CHKPOSN = 74)] = 'CHKPOSN'),
        (t3[(t3.URLESC = 75)] = 'URLESC'),
        (t3[(t3.IDESCH = 76)] = 'IDESCH'),
        (t3[(t3.COL_COL = 77)] = 'COL_COL'),
        (t3[(t3.TOCLASS = 78)] = 'TOCLASS'),
        (t3[(t3.CHKSP = 79)] = 'CHKSP'),
        (t3[(t3.EOF = 80)] = 'EOF');
    })(Vn || (Vn = {}));
    var Gn = [
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.SPACE,
      Vn.SPACE,
      Vn.INVALID,
      Vn.SPACE,
      Vn.SPACE,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.SPACE,
      Vn.BANG,
      Vn.STR2,
      Vn.HASH,
      Vn.DOLLAR,
      Vn.PERCENT,
      Vn.AMP,
      Vn.STR1,
      Vn.O_PAR,
      Vn.C_PAR,
      Vn.STAR,
      Vn.PLUS,
      Vn.COMMA,
      Vn.MINUS,
      Vn.DOT,
      Vn.SLASH,
      Vn.INT,
      Vn.INT,
      Vn.INT,
      Vn.INT,
      Vn.INT,
      Vn.INT,
      Vn.INT,
      Vn.INT,
      Vn.INT,
      Vn.INT,
      Vn.COLON,
      Vn.SEMICOL,
      Vn.LT,
      Vn.EQ,
      Vn.GT,
      Vn.QMARK,
      Vn.AT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.O_BRK,
      Vn.BSLASH,
      Vn.C_BRK,
      Vn.HAT,
      Vn.IDENT,
      Vn.INVALID,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.IDENT,
      Vn.O_BRC,
      Vn.BAR,
      Vn.C_BRC,
      Vn.TILDE,
      Vn.INVALID,
    ];
    Gn.NaN = Vn.EOF;
    var Wn = [
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.FUNC,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.CONT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.ENDIDNT,
      Vn.IDNTESC,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.CONT,
      Vn.ENDIDNT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
      Vn.ENDIDNT,
    ];
    Wn.NaN = Vn.ENDIDNT;
    var Xn = [
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.TOCLASS,
      Vn.TONUM,
      Vn.INVALID,
      Vn.TONUM,
      Vn.TONUM,
      Vn.TONUM,
      Vn.TONUM,
      Vn.TONUM,
      Vn.TONUM,
      Vn.TONUM,
      Vn.TONUM,
      Vn.TONUM,
      Vn.TONUM,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.INVALID,
      Vn.TOIDES,
      Vn.INVALID,
      Vn.INVALID,
      Vn.TOCLASS,
      Vn.INVALID,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.TOCLASS,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
      Vn.INVALID,
    ];
    Wn.NaN = Vn.ENDIDNT;
    var jn = [
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.MINMIN,
      Vn.TONUM,
      Vn.END,
      Vn.TOINT,
      Vn.TOINT,
      Vn.TOINT,
      Vn.TOINT,
      Vn.TOINT,
      Vn.TOINT,
      Vn.TOINT,
      Vn.TOINT,
      Vn.TOINT,
      Vn.TOINT,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.END,
      Vn.TOIDES,
      Vn.END,
      Vn.END,
      Vn.TOIDENT,
      Vn.END,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.TOIDENT,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
      Vn.END,
    ];
    jn.NaN = Vn.END;
    var Yn = [
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.CHKPOSS,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.CHKPOSS,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.FUNCES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.ENDIDES,
      Vn.IDNTESC,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.CONT,
      Vn.ENDIDES,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
      Vn.ENDIDES,
    ];
    Yn.NaN = Vn.ENDIDES;
    var Kn = [
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.PCUNIT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.NUMBER,
      Vn.ENDINT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.UNIT,
      Vn.ENDINT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
      Vn.ENDINT,
    ];
    Kn.NaN = Vn.ENDINT;
    var qn = [
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.PCUNIT,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.CONT,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.UNIT,
      Vn.ENDNUM,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.UNIT,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
      Vn.ENDNUM,
    ];
    qn.NaN = Vn.ENDNUM;
    var Qn;
    var Zn = zn(Vn.END, [61, Vn.EQTAIL]);
    var $n = zn(Vn.END, [58, Vn.COL_COL]);
    var Jn = zn(Vn.END, [61, Vn.EQTAIL, 124, Vn.BAR_BAR]);
    var ti = zn(Vn.END, [38, Vn.AMP_AMP]);
    var ei = zn(Vn.END, [42, Vn.COMMENT]);
    var ni = zn(Vn.CONT, [42, Vn.COMMST]);
    var ii = zn(Vn.COMMENT, [42, Vn.COMMST, 47, Vn.ENDNOTK]);
    var ri = zn(Vn.KILL1, [62, Vn.ENDNOTK]);
    var oi = zn(Vn.END, [61, Vn.EQTAIL, 33, Vn.LT_BG]);
    var ai = zn(Vn.KILL1, [45, Vn.LT_BG_M]);
    var si = zn(Vn.KILL2, [45, Vn.ENDNOTK]);
    var li = zn(Vn.IDESCH, [
      9,
      Vn.INVALID,
      10,
      Vn.INVALID,
      13,
      Vn.INVALID,
      32,
      Vn.INVALID,
    ]);
    var ui = zn(Vn.CONT, [
      39,
      Vn.ENDSTR,
      10,
      Vn.INVALID,
      13,
      Vn.INVALID,
      92,
      Vn.STR1ESC,
    ]);
    var hi = zn(Vn.CONT, [
      34,
      Vn.ENDSTR,
      10,
      Vn.INVALID,
      13,
      Vn.INVALID,
      92,
      Vn.STR2ESC,
    ]);
    var ci = zn(Vn.CONT, [
      39,
      Vn.ENDESTR,
      10,
      Vn.CHKPOSN,
      13,
      Vn.CHKPOSN,
      92,
      Vn.STR1ESC,
    ]);
    var fi = zn(Vn.CONT, [
      34,
      Vn.ENDESTR,
      10,
      Vn.CHKPOSN,
      13,
      Vn.CHKPOSN,
      92,
      Vn.STR2ESC,
    ]);
    var di = zn(Vn.URL, [
      9,
      Vn.CONT,
      32,
      Vn.CONT,
      34,
      Vn.URL2,
      39,
      Vn.URL1,
      41,
      Vn.INVALID,
      10,
      Vn.CONT,
      13,
      Vn.CONT,
    ]);
    var pi = zn(Vn.CONT, [
      41,
      Vn.ENDURL,
      9,
      Vn.CHKSP,
      10,
      Vn.CHKSP,
      13,
      Vn.CHKSP,
      32,
      Vn.CHKSP,
      92,
      Vn.URLESC,
      40,
      Vn.INVALID,
      91,
      Vn.INVALID,
      93,
      Vn.INVALID,
      123,
      Vn.INVALID,
      125,
      Vn.INVALID,
      NaN,
      Vn.ENDURL,
    ]);
    var gi = zn(Vn.CONT, [
      39,
      Vn.TERMURL,
      10,
      Vn.CHKPOSN,
      13,
      Vn.CHKPOSN,
      92,
      Vn.URLESC,
      NaN,
      Vn.ENDURL,
    ]);
    var mi = zn(Vn.CONT, [
      34,
      Vn.TERMURL,
      10,
      Vn.CHKPOSN,
      13,
      Vn.CHKPOSN,
      92,
      Vn.URLESC,
      NaN,
      Vn.ENDURL,
    ]);
    var vi = zn(Vn.INVALID, [
      9,
      Vn.CONT,
      10,
      Vn.CONT,
      13,
      Vn.CONT,
      32,
      Vn.CONT,
      41,
      Vn.FINURL,
    ]);
    var Ei = (function () {
      function t3(t4, e4) {
        (this.input = t4),
          (this.handler = e4),
          (this.head = -1),
          (this.tail = 0),
          (this.curr = 0),
          (this.position = 0),
          (this.indexMask = 15),
          (this.buffer = Array(this.indexMask + 1));
        for (var n3 = 0; n3 <= this.indexMask; n3++) this.buffer[n3] = new Hn();
      }
      var e3 = t3.prototype;
      return (
        (e3.token = function () {
          return (
            this.tail == this.curr && this.fillBuffer(), this.buffer[this.curr]
          );
        }),
        (e3.nthToken = function (t4) {
          return (
            ((this.tail - this.curr) & this.indexMask) <= t4 &&
              this.fillBuffer(),
            this.buffer[(this.curr + t4) & this.indexMask]
          );
        }),
        (e3.consume = function () {
          this.curr = (this.curr + 1) & this.indexMask;
        }),
        (e3.mark = function () {
          if (this.head >= 0) throw new Error('F_CSSTOK_BAD_CALL mark');
          this.head = this.curr;
        }),
        (e3.reset = function () {
          if (this.head < 0) throw new Error('F_CSSTOK_BAD_CALL reset');
          (this.curr = this.head), (this.head = -1);
        }),
        (e3.unmark = function () {
          this.head = -1;
        }),
        (e3.hasMark = function () {
          return this.head >= 0;
        }),
        (e3.reallocate = function () {
          for (
            var t4 = 2 * (this.indexMask + 1) - 1,
              e4 = Array(t4 + 1),
              n3 = this.head,
              i3 = 0;
            n3 != this.tail;

          )
            (e4[i3] = this.buffer[n3]),
              n3 == this.curr && (this.curr = i3),
              (n3 = (n3 + 1) & this.indexMask),
              i3++;
          for (
            this.head = 0,
              this.tail = i3,
              this.indexMask = t4,
              this.buffer = e4;
            i3 <= t4;

          )
            e4[i3++] = new Hn();
        }),
        (e3.error = function (t4, e4, n3) {
          this.handler && this.handler.error(n3, e4);
        }),
        (e3.fillBuffer = function () {
          var t4 = this.tail,
            e4 = this.head >= 0 ? this.head : this.curr,
            n3 = this.indexMask;
          if ((t4 >= e4 ? (e4 += n3) : e4--, e4 == t4)) {
            if (this.head < 0) throw new Error('F_CSSTOK_INTERNAL');
            this.reallocate(), (t4 = this.tail), (e4 = n3 = this.indexMask);
          }
          for (
            var i3 = Gn,
              r3 = this.input,
              o3 = this.position,
              a3 = this.buffer,
              s3 = Ln.EOF,
              l3 = 0,
              u3 = '',
              h3 = 0,
              c3 = false,
              f3 = a3[t4],
              d3 = -9;
            ;

          ) {
            var p3 = r3.charCodeAt(o3);
            switch (i3[p3] || i3[65]) {
              case Vn.INVALID:
                (s3 = Ln.INVALID),
                  (u3 = isNaN(p3)
                    ? 'E_CSS_UNEXPECTED_EOF'
                    : 'E_CSS_UNEXPECTED_CHAR'),
                  (i3 = Gn),
                  o3++;
                break;
              case Vn.SPACE:
                o3++, (c3 = true);
                continue;
              case Vn.INT:
                (l3 = o3++), (i3 = Kn);
                continue;
              case Vn.IDENT:
                (s3 = Ln.IDENT), (l3 = o3++), (i3 = Wn);
                continue;
              case Vn.BANG:
                (l3 = o3++), (s3 = Ln.BANG), (i3 = Zn);
                continue;
              case Vn.STR1:
                (s3 = Ln.STR), (l3 = ++o3), (i3 = ui);
                continue;
              case Vn.STR2:
                (s3 = Ln.STR), (l3 = ++o3), (i3 = hi);
                continue;
              case Vn.HASH:
                (l3 = ++o3), (s3 = Ln.HASH), (i3 = Wn);
                continue;
              case Vn.DOLLAR:
                (l3 = o3++), (s3 = Ln.DOLLAR), (i3 = Zn);
                continue;
              case Vn.PERCENT:
                (l3 = o3++), (s3 = Ln.PERCENT);
                break;
              case Vn.AMP:
                (l3 = o3++), (s3 = Ln.DOLLAR), (i3 = ti);
                continue;
              case Vn.O_PAR:
                (l3 = o3++), (s3 = Ln.O_PAR);
                break;
              case Vn.C_PAR:
                (l3 = o3++), (s3 = Ln.C_PAR);
                break;
              case Vn.STAR:
                (l3 = o3++), (s3 = Ln.STAR), (i3 = Zn);
                continue;
              case Vn.PLUS:
                (l3 = o3++), (s3 = Ln.PLUS);
                break;
              case Vn.COMMA:
                (l3 = o3++), (s3 = Ln.COMMA);
                break;
              case Vn.MINUS:
                (s3 = Ln.MINUS), (l3 = o3++), (i3 = jn);
                continue;
              case Vn.DOT:
                (l3 = o3++), (i3 = Xn);
                continue;
              case Vn.TOCLASS:
                (l3 = o3++), (s3 = Ln.CLASS), (i3 = Wn);
                continue;
              case Vn.SLASH:
                (l3 = o3++), (s3 = Ln.SLASH), (i3 = ei);
                continue;
              case Vn.COLON:
                (l3 = o3++), (s3 = Ln.COLON), (i3 = $n);
                continue;
              case Vn.COL_COL:
                o3++, (s3 = Ln.COL_COL);
                break;
              case Vn.SEMICOL:
                (l3 = o3++), (s3 = Ln.SEMICOL);
                break;
              case Vn.LT:
                (l3 = o3++), (s3 = Ln.LT), (i3 = oi);
                continue;
              case Vn.EQ:
                (l3 = o3++), (s3 = Ln.EQ), (i3 = Zn);
                continue;
              case Vn.GT:
                (l3 = o3++), (s3 = Ln.GT), (i3 = Zn);
                continue;
              case Vn.QMARK:
                (l3 = o3++), (s3 = Ln.QMARK);
                break;
              case Vn.AT:
                (l3 = ++o3), (s3 = Ln.AT), (i3 = Wn);
                continue;
              case Vn.O_BRK:
                (l3 = o3++), (s3 = Ln.O_BRK);
                break;
              case Vn.C_BRK:
                (l3 = o3++), (s3 = Ln.C_BRK);
                break;
              case Vn.O_BRC:
                (l3 = o3++), (s3 = Ln.O_BRC);
                break;
              case Vn.C_BRC:
                (l3 = o3++), (s3 = Ln.C_BRC);
                break;
              case Vn.BSLASH:
                (d3 = l3 = o3++), (s3 = Ln.IDENT), (i3 = li);
                continue;
              case Vn.HAT:
                (l3 = o3++), (s3 = Ln.HAT), (i3 = Zn);
                continue;
              case Vn.BAR:
                (l3 = o3++), (s3 = Ln.BAR), (i3 = Jn);
                continue;
              case Vn.TILDE:
                (l3 = o3++), (s3 = Ln.TILDE), (i3 = Zn);
                continue;
              case Vn.END:
                break;
              case Vn.EQTAIL:
                o3++, (s3 = s3 + Ln.BANG_EQ - Ln.BANG);
                break;
              case Vn.ENDINT:
                (s3 = Ln.INT), (h3 = parseInt(r3.substring(l3, o3), 10));
                break;
              case Vn.ENDNUM:
                (s3 = Ln.NUM), (h3 = parseFloat(r3.substring(l3, o3)));
                break;
              case Vn.CONT:
                o3++;
                continue;
              case Vn.UNIT:
                (s3 = Ln.NUMERIC),
                  (h3 = parseFloat(r3.substring(l3, o3))),
                  (l3 = o3++),
                  (i3 = Wn);
                continue;
              case Vn.PCUNIT:
                (s3 = Ln.NUMERIC),
                  (h3 = parseFloat(r3.substring(l3, o3))),
                  (u3 = '%'),
                  (l3 = o3++);
                break;
              case Vn.NUMBER:
                o3++, (i3 = qn);
                continue;
              case Vn.ENDIDNT:
                u3 = r3.substring(l3, o3);
                break;
              case Vn.IDNTESC:
                (d3 = o3++), (i3 = li);
                continue;
              case Vn.ENDIDES:
                u3 = Un(r3.substring(l3, o3));
                break;
              case Vn.ENDSTR:
                (u3 = r3.substring(l3, o3)), o3++;
                break;
              case Vn.ENDESTR:
                (u3 = Un(r3.substring(l3, o3))), o3++;
                break;
              case Vn.STR1ESC:
                (d3 = o3), (o3 += 2), (i3 = ci);
                continue;
              case Vn.STR2ESC:
                (d3 = o3), (o3 += 2), (i3 = fi);
                continue;
              case Vn.BAR_BAR:
                o3++, (s3 = Ln.BAR_BAR);
                break;
              case Vn.AMP_AMP:
                o3++, (s3 = Ln.AMP_AMP);
                break;
              case Vn.FUNC:
                if (((u3 = r3.substring(l3, o3)), s3 == Ln.IDENT)) {
                  if ((o3++, 'url' == u3.toLowerCase())) {
                    i3 = di;
                    continue;
                  }
                  s3 = Ln.FUNC;
                }
                break;
              case Vn.FUNCES:
                if (((u3 = Un(r3.substring(l3, o3))), s3 == Ln.IDENT)) {
                  if ((o3++, 'url' == u3.toLowerCase())) {
                    i3 = di;
                    continue;
                  }
                  s3 = Ln.FUNC;
                }
                break;
              case Vn.COMMENT:
                (i3 = ni), o3++;
                continue;
              case Vn.COMMST:
                (i3 = ii), o3++;
                continue;
              case Vn.ENDNOTK:
                (i3 = Gn), o3++;
                continue;
              case Vn.MINMIN:
                (i3 = ri), o3++;
                continue;
              case Vn.TOINT:
                (s3 = Ln.INT), (i3 = Kn), o3++;
                continue;
              case Vn.TONUM:
                (s3 = Ln.NUM), (i3 = qn), o3++;
                continue;
              case Vn.TOIDENT:
                (s3 = Ln.IDENT), (i3 = Wn), o3++;
                continue;
              case Vn.TOIDES:
                (s3 = Ln.IDENT), (i3 = li), (d3 = o3++);
                continue;
              case Vn.KILL1:
                o3--;
                break;
              case Vn.KILL2:
                o3 -= 2;
                break;
              case Vn.URL:
                (l3 = o3++), (i3 = pi);
                continue;
              case Vn.URL1:
                (l3 = ++o3), (i3 = gi);
                continue;
              case Vn.URL2:
                (l3 = ++o3), (i3 = mi);
                continue;
              case Vn.ENDURL:
                (s3 = Ln.URL), (u3 = Un(r3.substring(l3, o3))), o3++;
                break;
              case Vn.FINURL:
                o3++;
                break;
              case Vn.LT_BG:
                (i3 = ai), o3++;
                continue;
              case Vn.LT_BG_M:
                (i3 = si), o3++;
                continue;
              case Vn.CHKSP:
                if (
                  o3 - d3 < 8 &&
                  r3
                    .substring(d3 + 1, o3 + 1)
                    .match(/^[0-9a-fA-F]{0,6}(\r\n|[\n\r])|[ \t]$/)
                ) {
                  o3++;
                  continue;
                }
              case Vn.TERMURL:
                (s3 = Ln.URL), (u3 = Un(r3.substring(l3, o3))), o3++, (i3 = vi);
                continue;
              case Vn.CHKPOSN:
                if (
                  ++o3 - d3 < 9 &&
                  r3
                    .substring(d3 + 1, o3)
                    .match(/^[0-9a-fA-F]{0,6}(\r\n|[\n\r])$/)
                )
                  continue;
                (s3 = Ln.INVALID), (u3 = 'E_CSS_UNEXPECTED_NEWLINE'), (i3 = Gn);
                break;
              case Vn.CHKPOSS:
                if (
                  o3 - d3 < 9 &&
                  r3.substring(d3 + 1, o3 + 1).match(/^[0-9a-fA-F]{0,6}[ \t]$/)
                ) {
                  o3++;
                  continue;
                }
                u3 = Un(r3.substring(l3, o3));
                break;
              case Vn.URLESC:
                d3 = o3++;
                continue;
              case Vn.IDESCH:
                o3++, (i3 = Yn);
                continue;
              default:
                if (i3 !== Gn) {
                  (s3 = Ln.INVALID), (u3 = 'E_CSS_UNEXPECTED_STATE');
                  break;
                }
                (l3 = o3), (s3 = Ln.EOF);
            }
            if (
              ((f3.type = s3),
              (f3.precededBySpace = c3),
              (f3.num = h3),
              (f3.text = u3),
              (f3.position = l3),
              ++t4 >= e4)
            )
              break;
            (i3 = Gn), (c3 = false), (f3 = a3[t4 & n3]);
          }
          (this.position = o3), (this.tail = t4 & n3);
        }),
        t3
      );
    })();
    var yi = null;
    var wi = null;
    function Ni() {
      return yi;
    }
    function bi(t3) {
      if (!yi) throw new Error('E_TASK_NO_CONTEXT');
      yi.name || (yi.name = t3);
      var e3 = yi,
        n3 = new Oi(e3, e3.top, t3);
      return (e3.top = n3), (n3.state = Qn.ACTIVE), n3;
    }
    function Si(t3) {
      return new Ai(t3);
    }
    function Ci(t3, e3, n3) {
      var i3 = bi(t3);
      i3.handler = n3;
      try {
        e3(i3);
      } catch (t4) {
        i3.task.raise(t4, i3);
      }
      return i3.result();
    }
    !(function (t3) {
      (t3[(t3.INIT = 0)] = 'INIT'),
        (t3[(t3.ACTIVE = 1)] = 'ACTIVE'),
        (t3[(t3.FINISHED = 2)] = 'FINISHED'),
        (t3[(t3.DEAD = 3)] = 'DEAD');
    })(Qn || (Qn = {}));
    var Ti;
    var xi = (function () {
      function t3() {}
      var e3 = t3.prototype;
      return (
        (e3.currentTime = function () {
          return new Date().valueOf();
        }),
        (e3.setTimeout = (function (t4) {
          function e4(e5, n3) {
            return t4.apply(this, arguments);
          }
          return (
            (e4.toString = function () {
              return t4.toString();
            }),
            e4
          );
        })(function (t4, e4) {
          return setTimeout(t4, e4);
        })),
        (e3.clearTimeout = (function (t4) {
          function e4(e5) {
            return t4.apply(this, arguments);
          }
          return (
            (e4.toString = function () {
              return t4.toString();
            }),
            e4
          );
        })(function (t4) {
          clearTimeout(t4);
        })),
        t3
      );
    })();
    var Ii = (function () {
      function t3(t4) {
        (this.timer = t4),
          (this.timeout = 1),
          (this.slice = 25),
          (this.sliceOverTime = 0),
          (this.wakeupTime = null),
          (this.timeoutToken = null),
          (this.inTimeSlice = false),
          (this.order = 0),
          (this.queue = new Y()),
          wi || (wi = this);
      }
      var e3 = t3.prototype;
      return (
        (e3.setSlice = function (t4) {
          this.slice = t4;
        }),
        (e3.setTimeout = function (t4) {
          this.timeout = t4;
        }),
        (e3.isTimeSliceOver = function () {
          return this.timer.currentTime() >= this.sliceOverTime;
        }),
        (e3.arm = function () {
          if (!this.inTimeSlice) {
            var t4 = this.queue.peek().scheduledTime,
              e4 = this.timer.currentTime();
            if (null != this.timeoutToken) {
              if (e4 + this.timeout > this.wakeupTime) return;
              this.timer.clearTimeout(this.timeoutToken);
            }
            var n3 = t4 - e4;
            n3 <= this.timeout && (n3 = this.timeout),
              (this.wakeupTime = e4 + n3);
            var i3 = this;
            this.timeoutToken = this.timer.setTimeout(function () {
              (i3.timeoutToken = null), i3.doTimeSlice();
            }, n3);
          }
        }),
        (e3.schedule = function (t4, e4) {
          var n3 = t4,
            i3 = this.timer.currentTime();
          (n3.order = this.order++),
            (n3.scheduledTime = i3 + (e4 || 0)),
            this.queue.add(n3),
            this.arm();
        }),
        (e3.doTimeSlice = function () {
          null != this.timeoutToken &&
            (this.timer.clearTimeout(this.timeoutToken),
            (this.timeoutToken = null)),
            (this.inTimeSlice = true);
          try {
            var t4 = this.timer.currentTime();
            for (this.sliceOverTime = t4 + this.slice; this.queue.length(); ) {
              var e4 = this.queue.peek();
              if (e4.scheduledTime > t4) break;
              if (
                (this.queue.remove(),
                e4.canceled || e4.resumeInternal(),
                (t4 = this.timer.currentTime()) >= this.sliceOverTime)
              )
                break;
            }
          } catch (t5) {
            c2.error(t5);
          }
          (this.inTimeSlice = false), this.queue.length() && this.arm();
        }),
        (e3.run = function (t4, e4) {
          var n3 = new Ri(this, e4 || '');
          (n3.top = new Oi(n3, null, 'bootstrap')),
            (n3.top.state = Qn.ACTIVE),
            n3.top.then(function () {
              var e5 = function () {
                n3.running = false;
                for (var t5, e6 = D(n3.callbacks); !(t5 = e6()).done; ) {
                  var i4 = t5.value;
                  try {
                    i4();
                  } catch (t6) {
                    c2.error(t6);
                  }
                }
              };
              try {
                t4().then(function (t5) {
                  (n3.result = t5), e5();
                });
              } catch (t5) {
                n3.raise(t5), e5();
              }
            });
          var i3 = yi;
          return (
            (yi = n3), this.schedule(n3.top.suspend('bootstrap')), (yi = i3), n3
          );
        }),
        t3
      );
    })();
    var Pi = (function () {
      function t3(t4) {
        (this.task = t4),
          (this.scheduledTime = 0),
          (this.order = 0),
          (this.result = null),
          (this.canceled = false);
      }
      var e3 = t3.prototype;
      return (
        (e3.compare = function (t4) {
          return t4.scheduledTime - this.scheduledTime || t4.order - this.order;
        }),
        (e3.getTask = function () {
          return this.task;
        }),
        (e3.schedule = function (t4, e4) {
          (this.result = t4), this.task.scheduler.schedule(this, e4);
        }),
        (e3.resumeInternal = function () {
          var t4 = this.task;
          if (((this.task = null), t4 && t4.continuation == this)) {
            t4.continuation = null;
            var e4 = yi;
            return (yi = t4), t4.top.finish(this.result), (yi = e4), true;
          }
          return false;
        }),
        (e3.cancel = function () {
          this.canceled = true;
        }),
        t3
      );
    })();
    var Ri = (function () {
      function t3(t4, e4) {
        (this.scheduler = t4),
          (this.name = e4),
          (this.callbacks = []),
          (this.exception = null),
          (this.running = true),
          (this.result = null),
          (this.waitTarget = null),
          (this.top = null),
          (this.continuation = null);
      }
      var e3 = t3.prototype;
      return (
        (e3.getName = function () {
          return this.name;
        }),
        (e3.interrupt = function (t4) {
          if (
            (this.raise(t4 || new Error('E_TASK_INTERRUPT')),
            this !== yi && this.continuation)
          ) {
            this.continuation.cancel();
            var e4 = new Pi(this);
            (this.waitTarget = 'interrupt'),
              (this.continuation = e4),
              this.scheduler.schedule(e4);
          }
        }),
        (e3.getScheduler = function () {
          return this.scheduler;
        }),
        (e3.isRunning = function () {
          return this.running;
        }),
        (e3.whenDone = function (t4) {
          this.callbacks.push(t4);
        }),
        (e3.join = function () {
          var t4 = bi('Task.join');
          if (this.running) {
            var e4 = t4.suspend(this),
              n3 = this;
            this.whenDone(function () {
              e4.schedule(n3.result);
            });
          } else t4.finish(this.result);
          return t4.result();
        }),
        (e3.unwind = function () {
          for (; this.top && !this.top.handler; ) this.top = this.top.parent;
          if (this.top && this.top.handler && this.exception) {
            var t4 = this.exception;
            (this.exception = null), this.top.handler(this.top, t4);
          } else
            this.exception &&
              c2.error(
                this.exception,
                'Unhandled exception in task',
                this.name,
              );
        }),
        (e3.raise = function (t4, e4) {
          if ((this.fillStack(t4), e4)) {
            for (var n3 = this.top; n3 && n3 != e4; ) n3 = n3.parent;
            n3 == e4 && (this.top = n3);
          }
          (this.exception = t4), this.unwind();
        }),
        (e3.fillStack = function (t4) {
          var e4 = t4.frameTrace;
          if (!e4) {
            e4 = t4.stack ? t4.stack + '\n	---- async ---\n' : '';
            for (var n3 = this.top; n3; n3 = n3.parent)
              (e4 += '	'), (e4 += n3.getName()), (e4 += '\n');
            t4.frameTrace = e4;
          }
        }),
        t3
      );
    })();
    var Ai = (function () {
      function t3(t4) {
        this.value = t4;
      }
      var e3 = t3.prototype;
      return (
        (e3.then = function (t4) {
          t4(this.value);
        }),
        (e3.thenAsync = function (t4) {
          return t4(this.value);
        }),
        (e3.thenReturn = function (e4) {
          return new t3(e4);
        }),
        (e3.thenFinish = function (t4) {
          t4.finish(this.value);
        }),
        (e3.isPending = function () {
          return false;
        }),
        (e3.get = function () {
          return this.value;
        }),
        t3
      );
    })();
    var Li = (function () {
      function t3(t4) {
        this.frame = t4;
      }
      var e3 = t3.prototype;
      return (
        (e3.then = function (t4) {
          this.frame.then(t4);
        }),
        (e3.thenAsync = function (t4) {
          if (this.isPending()) {
            var e4 = new Oi(
              this.frame.task,
              this.frame.parent,
              'AsyncResult.thenAsync',
            );
            return (
              (e4.state = Qn.ACTIVE),
              (this.frame.parent = e4),
              this.frame.then(function (n3) {
                t4(n3).then(function (t5) {
                  e4.finish(t5);
                });
              }),
              e4.result()
            );
          }
          return t4(this.frame.res);
        }),
        (e3.thenReturn = function (t4) {
          return this.isPending()
            ? this.thenAsync(function () {
                return new Ai(t4);
              })
            : new Ai(t4);
        }),
        (e3.thenFinish = function (t4) {
          this.isPending()
            ? this.then(function (e4) {
                t4.finish(e4);
              })
            : t4.finish(this.frame.res);
        }),
        (e3.isPending = function () {
          return this.frame.state == Qn.ACTIVE;
        }),
        (e3.get = function () {
          if (this.isPending()) throw new Error('Result is pending');
          return this.frame.res;
        }),
        t3
      );
    })();
    var Oi = (function () {
      function t3(t4, e4, n3) {
        (this.task = t4),
          (this.parent = e4),
          (this.name = n3),
          (this.res = null),
          (this.callback = null),
          (this.handler = null),
          (this.state = Qn.INIT);
      }
      var e3 = t3.prototype;
      return (
        (e3.checkEnvironment = function () {
          if (!yi) throw new Error('F_TASK_NO_CONTEXT');
          if (this !== yi.top) throw new Error('F_TASK_NOT_TOP_FRAME');
        }),
        (e3.result = function () {
          return new Li(this);
        }),
        (e3.finish = function (t4) {
          this.checkEnvironment(),
            yi && !yi.exception && (this.res = t4),
            (this.state = Qn.FINISHED);
          var e4 = this.parent;
          if ((yi && (yi.top = e4), this.callback)) {
            try {
              this.callback(t4);
            } catch (t5) {
              this.task.raise(t5, e4);
            }
            this.state = Qn.DEAD;
          }
        }),
        (e3.getTask = function () {
          return this.task;
        }),
        (e3.getName = function () {
          return this.name;
        }),
        (e3.getScheduler = function () {
          return this.task.scheduler;
        }),
        (e3.then = function (t4) {
          switch (this.state) {
            case Qn.ACTIVE:
              if (this.callback)
                throw new Error('F_TASK_FRAME_ALREADY_HAS_CALLBACK');
              this.callback = t4;
              break;
            case Qn.FINISHED:
              var e4 = this.task,
                n3 = this.parent;
              try {
                t4(this.res), (this.state = Qn.DEAD);
              } catch (t5) {
                (this.state = Qn.DEAD), e4.raise(t5, n3);
              }
              break;
            case Qn.DEAD:
              throw new Error('F_TASK_DEAD_FRAME');
            default:
              throw new Error('F_TASK_UNEXPECTED_FRAME_STATE ' + this.state);
          }
        }),
        (e3.timeSlice = function () {
          var t4 = bi('Frame.timeSlice');
          return (
            t4.getScheduler().isTimeSliceOver()
              ? (c2.debug('-- time slice --'), t4.suspend().schedule(true))
              : t4.finish(true),
            t4.result()
          );
        }),
        (e3.sleep = function (t4) {
          var e4 = bi('Frame.sleep');
          return e4.suspend().schedule(true, t4), e4.result();
        }),
        (e3.loop = function (t4) {
          var e4 = bi('Frame.loop');
          return (
            (function n3(i3) {
              try {
                for (; i3; ) {
                  var r3 = t4();
                  if (r3.isPending()) return void r3.then(n3);
                  r3.then(function (t5) {
                    i3 = t5;
                  });
                }
                e4.finish(true);
              } catch (t5) {
                e4.task.raise(t5, e4);
              }
            })(true),
            e4.result()
          );
        }),
        (e3.loopWithFrame = function (t4) {
          var e4 = yi;
          if (!e4) throw new Error('E_TASK_NO_CONTEXT');
          return this.loop(function () {
            var n3;
            do {
              var i3 = new ki(e4, e4.top);
              (e4.top = i3), (i3.state = Qn.ACTIVE), t4(i3), (n3 = i3.result());
            } while (!n3.isPending() && n3.get());
            return n3;
          });
        }),
        (e3.suspend = function (t4) {
          if ((this.checkEnvironment(), this.task.continuation))
            throw new Error('E_TASK_ALREADY_SUSPENDED');
          var e4 = new Pi(this.task);
          return (
            (this.task.continuation = e4),
            (yi = null),
            (this.task.waitTarget = t4 || null),
            e4
          );
        }),
        t3
      );
    })();
    var ki = (function (t3) {
      function e3(e4, n4) {
        return t3.call(this, e4, n4, 'loop') || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.continueLoop = function () {
          this.finish(true);
        }),
        (n3.breakLoop = function () {
          this.finish(false);
        }),
        e3
      );
    })(Oi);
    var Fi = (function () {
      function t3(t4, e4) {
        (this.fetch = t4),
          (this.arrived = false),
          (this.resource = null),
          (this.task = null),
          (this.piggybacks = []),
          (this.name = e4);
      }
      var e3 = t3.prototype;
      return (
        (e3.start = function () {
          if (!this.task) {
            var t4 = this;
            this.task = Ni()
              .getScheduler()
              .run(function () {
                var e4 = bi('Fetcher.run');
                return (
                  t4.fetch().then(function (n3) {
                    var i3 = t4.piggybacks;
                    if (
                      ((t4.arrived = true),
                      (t4.resource = n3),
                      (t4.task = null),
                      (t4.piggybacks = []),
                      i3)
                    )
                      for (var r3 = 0; r3 < i3.length; r3++)
                        try {
                          i3[r3](n3);
                        } catch (t5) {
                          c2.error(t5, 'Error:');
                        }
                    e4.finish(n3);
                  }),
                  e4.result()
                );
              }, this.name);
          }
        }),
        (e3.piggyback = function (t4) {
          this.arrived ? t4(this.resource) : this.piggybacks.push(t4);
        }),
        (e3.get = function () {
          return this.arrived
            ? Si(this.resource)
            : (this.start(), this.task.join());
        }),
        (e3.hasArrived = function () {
          return this.arrived;
        }),
        t3
      );
    })();
    var Di = function (t3) {
      if (0 == t3.length) return Si(true);
      if (1 == t3.length) return t3[0].get().thenReturn(true);
      var e3 = bi('waitForFetches'),
        n3 = 0;
      return (
        e3
          .loop(function () {
            for (; n3 < t3.length; ) {
              var e4 = t3[n3++];
              if (!e4.hasArrived()) return e4.get().thenReturn(true);
            }
            return Si(false);
          })
          .then(function () {
            e3.finish(true);
          }),
        e3.result()
      );
    };
    function _i(t3, e3) {
      var n3 = null,
        i3 = null;
      'img' == t3.localName &&
        ((n3 = t3.getAttribute('width')), (i3 = t3.getAttribute('height')));
      var r3 = new Fi(function () {
        var r4 = bi('loadImage'),
          o3 = r4.suspend(t3),
          a3 = false,
          s3 = function (e4) {
            a3 ||
              ((a3 = true),
              'img' == t3.localName &&
                (n3 || t3.removeAttribute('width'),
                i3 || t3.removeAttribute('height')),
              o3.schedule(e4 ? e4.type : 'timeout'));
          };
        return (
          t3.addEventListener('load', s3, false),
          t3.addEventListener('error', s3, false),
          t3.addEventListener('abort', s3, false),
          t3.namespaceURI == H2.SVG
            ? (t3.setAttributeNS(H2.XLINK, 'xlink:href', e3),
              setTimeout(s3, 300))
            : (t3.src = e3),
          r4.result()
        );
      }, 'loadElement ' + e3);
      return r3.start(), r3;
    }
    function Bi(t3, e3, n3, i3, r3) {
      var o3 = bi('ajax'),
        a3 = new XMLHttpRequest(),
        s3 = o3.suspend(a3),
        l3 = {
          status: 0,
          statusText: '',
          url: t3,
          contentType: null,
          responseText: null,
          responseXML: null,
          responseBlob: null,
        };
      a3.open(n3 || 'GET', t3, true),
        e3 && (a3.responseType = e3),
        (a3.onreadystatechange = function () {
          if (4 === a3.readyState) {
            if (
              ((l3.status = a3.status),
              (l3.statusText =
                a3.statusText || (404 == a3.status && 'Not Found') || ''),
              200 == l3.status || 0 == l3.status)
            )
              if (
                (e3 && e3 !== Ti.DOCUMENT) ||
                !a3.responseXML ||
                'parsererror' == a3.responseXML.documentElement.localName
              )
                if (
                  (!e3 || e3 === Ti.DOCUMENT) &&
                  a3.response instanceof HTMLDocument
                )
                  (l3.responseXML = a3.response),
                    (l3.contentType = a3.response.contentType);
                else {
                  var n4 = a3.response;
                  (e3 && e3 !== Ti.TEXT) || 'string' != typeof n4
                    ? n4
                      ? (l3.responseBlob =
                          'string' == typeof n4 ? Mi([n4]) : n4)
                      : c2.warn('Unexpected empty success response for', t3)
                    : (l3.responseText = n4);
                  var i4 = a3.getResponseHeader('Content-Type');
                  i4 && (l3.contentType = i4.replace(/(.*);.*$/, '$1'));
                }
              else
                (l3.responseXML = a3.responseXML),
                  (l3.contentType = a3.responseXML.contentType);
            s3.schedule(l3);
          }
        });
      try {
        i3
          ? (a3.setRequestHeader(
              'Content-Type',
              r3 || 'text/plain; charset=UTF-8',
            ),
            a3.send(i3))
          : (/^file:|^https?:\/\/[^/]+\.githubusercontent\.com|\.(xhtml|xht|opf)$/i.test(
              t3,
            )
              ? /\/aozorabunko\/[^/]+\/cards\/[^/]+\/files\/[^/.]+\.html$/.test(
                  t3,
                )
                ? a3.overrideMimeType('text/html; charset=Shift_JIS')
                : /\.(html|htm)$/i.test(t3)
                ? a3.overrideMimeType('text/html; charset=UTF-8')
                : /\.(xhtml|xht|xml|opf)$/i.test(t3)
                ? a3.overrideMimeType('application/xml; charset=UTF-8')
                : /\.(txt|css)$/i.test(t3)
                ? a3.overrideMimeType('text/plain; charset=UTF-8')
                : a3.overrideMimeType('text/html; charset=UTF-8')
              : /^data:,(<|%3c)/i.test(t3)
              ? a3.overrideMimeType('text/html; charset=UTF-8')
              : /^data:,/i.test(t3) &&
                a3.overrideMimeType('text/plain; charset=UTF-8'),
            a3.send(null));
      } catch (e4) {
        c2.warn(e4, 'Error fetching ' + t3), s3.schedule(l3);
      }
      return o3.result();
    }
    function Mi(t3, e3) {
      var n3 = e3 || 'application/octet-stream',
        i3 = window.WebKitBlobBuilder || window.MSBlobBuilder;
      if (i3) {
        for (var r3 = new i3(), o3 = 0; o3 < t3.length; o3++) r3.append(t3[o3]);
        return r3.getBlob(n3);
      }
      return new Blob(t3, { type: n3 });
    }
    !(function (t3) {
      (t3.DEFAULT = ''),
        (t3.ARRAYBUFFER = 'arraybuffer'),
        (t3.BLOB = 'blob'),
        (t3.DOCUMENT = 'document'),
        (t3.JSON = 'json'),
        (t3.TEXT = 'text');
    })(Ti || (Ti = {}));
    var Ui;
    var Vi = (function () {
      function t3(t4, e4) {
        (this.parser = t4),
          (this.type = e4),
          (this.resources = {}),
          (this.fetchers = {});
      }
      var e3 = t3.prototype;
      return (
        (e3.load = function (t4, e4, n3) {
          t4 = M2(t4);
          var i3 = this.resources[t4];
          return void 0 !== i3 ? Si(i3) : this.fetch(t4, e4, n3).get();
        }),
        (e3.fetchInner = function (t4, e4, n3) {
          var i3 = this,
            r3 = bi('fetch'),
            o3 = t4.endsWith('?viv-toc-box');
          o3 && (t4 = t4.replace('?viv-toc-box', ''));
          var a3 = W('user-agent.xml', z2),
            s3 = !o3 && t4 === a3;
          return (
            s3 &&
              (t4 =
                'data:application/xml,' +
                encodeURIComponent(
                  '\n<!DOCTYPE html>\n<html xmlns="http://www.w3.org/1999/xhtml" xmlns:s="http://www.pyroxy.com/ns/shadow">\n<head>\n<style><![CDATA[\n\n.footnote-content {\n  float: footnote;\n}\n\n.table-cell-container {\n  display: block;\n}\n\n]]></style>\n</head>\n<body>\n\n<s:template id="footnote"><s:content/><s:include class="footnote-content"/></s:template>\n\n<s:template id="table-cell"><div data-vivliostyle-flow-root="true" class="table-cell-container"><s:content/></div></s:template>\n\n</body>\n</html>',
                )),
            Bi(t4, i3.type).then(function (l3) {
              if (l3.status >= 400 && e4)
                throw new Error(
                  (n3 || 'Failed to fetch required resource: ' + t4) +
                    ' (' +
                    l3.status +
                    (l3.statusText ? ' ' + l3.statusText : '') +
                    ')',
                );
              o3
                ? ((t4 += '?viv-toc-box'), (l3.url += '?viv-toc-box'))
                : s3 && (l3.url = t4 = a3),
                i3.parser(l3, i3).then(function (e5) {
                  delete i3.fetchers[t4],
                    (i3.resources[t4] = e5),
                    r3.finish(e5);
                });
            }),
            r3.result()
          );
        }),
        (e3.fetch = function (t4, e4, n3) {
          if (((t4 = M2(t4)), this.resources[t4])) return null;
          var i3 = this.fetchers[t4];
          if (!i3) {
            var r3 = this;
            (i3 = new Fi(function () {
              return r3.fetchInner(t4, e4, n3);
            }, 'Fetch ' + t4)),
              (r3.fetchers[t4] = i3),
              i3.start();
          }
          return i3;
        }),
        (e3.get = function (t4) {
          return this.resources[M2(t4)];
        }),
        (e3.delete = function (t4) {
          delete this.resources[M2(t4)];
        }),
        t3
      );
    })();
    function Hi(t3, e3) {
      var n3 = t3.responseText;
      return Si(n3 ? B(n3) : null);
    }
    function zi(t3) {
      var e3 = parseInt(t3, 16);
      if (isNaN(e3)) throw new Error('E_CSS_COLOR');
      if (6 == t3.length) return new Me(e3);
      if (3 == t3.length)
        return new Me(
          (e3 =
            (15 & e3) |
            ((15 & e3) << 4) |
            ((240 & e3) << 4) |
            ((240 & e3) << 8) |
            ((3840 & e3) << 8) |
            ((3840 & e3) << 12)),
        );
      throw new Error('E_CSS_COLOR');
    }
    !(function (t3) {
      (t3.USER_AGENT = 'UA'), (t3.USER = 'User'), (t3.AUTHOR = 'Author');
    })(Ui || (Ui = {}));
    var Gi;
    var Wi = (function () {
      function t3(t4) {
        (this.scope = t4), (this.flavor = Ui.AUTHOR);
      }
      var e3 = t3.prototype;
      return (
        (e3.getCurrentToken = function () {
          return null;
        }),
        (e3.getScope = function () {
          return this.scope;
        }),
        (e3.error = function (t4, e4) {}),
        (e3.startStylesheet = function (t4) {
          this.flavor = t4;
        }),
        (e3.tagSelector = function (t4, e4) {}),
        (e3.classSelector = function (t4) {}),
        (e3.pseudoclassSelector = function (t4, e4) {}),
        (e3.pseudoelementSelector = function (t4, e4) {}),
        (e3.idSelector = function (t4) {}),
        (e3.attributeSelector = function (t4, e4, n3, i3) {}),
        (e3.descendantSelector = function () {}),
        (e3.childSelector = function () {}),
        (e3.adjacentSiblingSelector = function () {}),
        (e3.followingSiblingSelector = function () {}),
        (e3.nextSelector = function () {}),
        (e3.startSelectorRule = function () {}),
        (e3.startFontFaceRule = function () {}),
        (e3.startFootnoteRule = function (t4) {}),
        (e3.startViewportRule = function () {}),
        (e3.startDefineRule = function () {}),
        (e3.startRegionRule = function () {}),
        (e3.startPageRule = function () {}),
        (e3.startPageMarginBoxRule = function (t4) {}),
        (e3.startWhenRule = function (t4) {}),
        (e3.startMediaRule = function (t4) {
          this.startWhenRule(t4);
        }),
        (e3.startFlowRule = function (t4) {}),
        (e3.startPageTemplateRule = function () {}),
        (e3.startPageMasterRule = function (t4, e4, n3) {}),
        (e3.startPartitionRule = function (t4, e4, n3) {}),
        (e3.startPartitionGroupRule = function (t4, e4, n3) {}),
        (e3.startRuleBody = function () {}),
        (e3.property = function (t4, e4, n3) {}),
        (e3.endRule = function () {}),
        (e3.startFuncWithSelector = function (t4) {}),
        (e3.endFuncWithSelector = function () {}),
        (e3.getImportantSpecificity = function () {
          switch (this.flavor) {
            case Ui.USER_AGENT:
              return 0;
            case Ui.USER:
              return 100663296;
            default:
              return 83886080;
          }
        }),
        (e3.getBaseSpecificity = function () {
          switch (this.flavor) {
            case Ui.USER_AGENT:
              return 0;
            case Ui.USER:
              return 16777216;
            default:
              return 33554432;
          }
        }),
        t3
      );
    })();
    var Xi = (function (t3) {
      function e3() {
        var e4;
        return (
          ((e4 = t3.call(this, null) || this).stack = []),
          (e4.tokenizer = null),
          (e4.slave = null),
          e4
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.pushHandler = function (t4) {
          this.stack.push(this.slave), (this.slave = t4);
        }),
        (n3.popHandler = function () {
          this.slave = this.stack.pop();
        }),
        (n3.getCurrentToken = function () {
          return this.tokenizer ? this.tokenizer.token() : null;
        }),
        (n3.getScope = function () {
          return this.slave.getScope();
        }),
        (n3.error = function (t4, e4) {
          this.slave.error(t4, e4);
        }),
        (n3.errorMsg = function (t4, e4) {
          c2.warn(t4);
        }),
        (n3.startStylesheet = function (e4) {
          t3.prototype.startStylesheet.call(this, e4),
            this.stack.length > 0 &&
              ((this.slave = this.stack[0]), (this.stack = [])),
            this.slave.startStylesheet(e4);
        }),
        (n3.tagSelector = function (t4, e4) {
          this.slave.tagSelector(t4, e4);
        }),
        (n3.classSelector = function (t4) {
          this.slave.classSelector(t4);
        }),
        (n3.pseudoclassSelector = function (t4, e4) {
          this.slave.pseudoclassSelector(t4, e4);
        }),
        (n3.pseudoelementSelector = function (t4, e4) {
          this.slave.pseudoelementSelector(t4, e4);
        }),
        (n3.idSelector = function (t4) {
          this.slave.idSelector(t4);
        }),
        (n3.attributeSelector = function (t4, e4, n4, i3) {
          this.slave.attributeSelector(t4, e4, n4, i3);
        }),
        (n3.descendantSelector = function () {
          this.slave.descendantSelector();
        }),
        (n3.childSelector = function () {
          this.slave.childSelector();
        }),
        (n3.adjacentSiblingSelector = function () {
          this.slave.adjacentSiblingSelector();
        }),
        (n3.followingSiblingSelector = function () {
          this.slave.followingSiblingSelector();
        }),
        (n3.nextSelector = function () {
          this.slave.nextSelector();
        }),
        (n3.startSelectorRule = function () {
          this.slave.startSelectorRule();
        }),
        (n3.startFontFaceRule = function () {
          this.slave.startFontFaceRule();
        }),
        (n3.startFootnoteRule = function (t4) {
          this.slave.startFootnoteRule(t4);
        }),
        (n3.startViewportRule = function () {
          this.slave.startViewportRule();
        }),
        (n3.startDefineRule = function () {
          this.slave.startDefineRule();
        }),
        (n3.startRegionRule = function () {
          this.slave.startRegionRule();
        }),
        (n3.startPageRule = function () {
          this.slave.startPageRule();
        }),
        (n3.startPageMarginBoxRule = function (t4) {
          this.slave.startPageMarginBoxRule(t4);
        }),
        (n3.startWhenRule = function (t4) {
          this.slave.startWhenRule(t4);
        }),
        (n3.startFlowRule = function (t4) {
          this.slave.startFlowRule(t4);
        }),
        (n3.startPageTemplateRule = function () {
          this.slave.startPageTemplateRule();
        }),
        (n3.startPageMasterRule = function (t4, e4, n4) {
          this.slave.startPageMasterRule(t4, e4, n4);
        }),
        (n3.startPartitionRule = function (t4, e4, n4) {
          this.slave.startPartitionRule(t4, e4, n4);
        }),
        (n3.startPartitionGroupRule = function (t4, e4, n4) {
          this.slave.startPartitionGroupRule(t4, e4, n4);
        }),
        (n3.startRuleBody = function () {
          this.slave.startRuleBody();
        }),
        (n3.property = function (t4, e4, n4) {
          this.slave.property(t4, e4, n4);
        }),
        (n3.endRule = function () {
          this.slave.endRule();
        }),
        (n3.startFuncWithSelector = function (t4) {
          this.slave.startFuncWithSelector(t4);
        }),
        (n3.endFuncWithSelector = function () {
          this.slave.endFuncWithSelector();
        }),
        e3
      );
    })(Wi);
    var ji = (function (t3) {
      function e3(e4, n4, i3) {
        var r3;
        return (
          ((r3 = t3.call(this, e4) || this).owner = n4),
          (r3.topLevel = i3),
          (r3.depth = 0),
          n4 && (r3.flavor = n4.flavor),
          r3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getCurrentToken = function () {
          return this.owner.getCurrentToken();
        }),
        (n3.error = function (t4, e4) {
          this.owner.errorMsg(t4, e4);
        }),
        (n3.startRuleBody = function () {
          this.depth++;
        }),
        (n3.endRule = function () {
          0 != --this.depth || this.topLevel || this.owner.popHandler();
        }),
        e3
      );
    })(Wi);
    var Yi = (function (t3) {
      function e3(e4, n4, i3) {
        return t3.call(this, e4, n4, i3) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.report = function (t4) {
          this.error(t4, this.getCurrentToken());
        }),
        (n3.reportAndSkip = function (t4) {
          this.report(t4),
            this.owner.pushHandler(new ji(this.scope, this.owner, false));
        }),
        (n3.startSelectorRule = function () {
          this.reportAndSkip('E_CSS_UNEXPECTED_SELECTOR');
        }),
        (n3.startFontFaceRule = function () {
          this.reportAndSkip('E_CSS_UNEXPECTED_FONT_FACE');
        }),
        (n3.startFootnoteRule = function (t4) {
          this.reportAndSkip('E_CSS_UNEXPECTED_FOOTNOTE');
        }),
        (n3.startViewportRule = function () {
          this.reportAndSkip('E_CSS_UNEXPECTED_VIEWPORT');
        }),
        (n3.startDefineRule = function () {
          this.reportAndSkip('E_CSS_UNEXPECTED_DEFINE');
        }),
        (n3.startRegionRule = function () {
          this.reportAndSkip('E_CSS_UNEXPECTED_REGION');
        }),
        (n3.startPageRule = function () {
          this.reportAndSkip('E_CSS_UNEXPECTED_PAGE');
        }),
        (n3.startWhenRule = function (t4) {
          this.reportAndSkip('E_CSS_UNEXPECTED_WHEN');
        }),
        (n3.startFlowRule = function (t4) {
          this.reportAndSkip('E_CSS_UNEXPECTED_FLOW');
        }),
        (n3.startPageTemplateRule = function () {
          this.reportAndSkip('E_CSS_UNEXPECTED_PAGE_TEMPLATE');
        }),
        (n3.startPageMasterRule = function (t4, e4, n4) {
          this.reportAndSkip('E_CSS_UNEXPECTED_PAGE_MASTER');
        }),
        (n3.startPartitionRule = function (t4, e4, n4) {
          this.reportAndSkip('E_CSS_UNEXPECTED_PARTITION');
        }),
        (n3.startPartitionGroupRule = function (t4, e4, n4) {
          this.reportAndSkip('E_CSS_UNEXPECTED_PARTITION_GROUP');
        }),
        (n3.startFuncWithSelector = function (t4) {
          this.reportAndSkip('E_CSS_UNEXPECTED_SELECTOR_FUNC');
        }),
        (n3.endFuncWithSelector = function () {
          this.reportAndSkip('E_CSS_UNEXPECTED_END_SELECTOR_FUNC');
        }),
        (n3.property = function (t4, e4, n4) {
          this.error('E_CSS_UNEXPECTED_PROPERTY', this.getCurrentToken());
        }),
        e3
      );
    })(ji);
    var Ki = [];
    var qi = [];
    var Qi = [];
    var Zi = [];
    var $i = [];
    var Ji = [];
    var tr = [];
    var er = [];
    var nr = [];
    var ir = [];
    var rr = [];
    var or = [];
    var ar = [];
    !(function (t3) {
      (t3[(t3.SELECTOR_NAME_1 = 1)] = 'SELECTOR_NAME_1'),
        (t3[(t3.SELECTOR_NAME = 2)] = 'SELECTOR_NAME'),
        (t3[(t3.SELECTOR_ANY_1 = 3)] = 'SELECTOR_ANY_1'),
        (t3[(t3.SELECTOR_ANY = 4)] = 'SELECTOR_ANY'),
        (t3[(t3.SELECTOR_ID_1 = 5)] = 'SELECTOR_ID_1'),
        (t3[(t3.SELECTOR_ID = 6)] = 'SELECTOR_ID'),
        (t3[(t3.SELECTOR_CLASS_1 = 7)] = 'SELECTOR_CLASS_1'),
        (t3[(t3.SELECTOR_CLASS = 8)] = 'SELECTOR_CLASS'),
        (t3[(t3.SELECTOR_ATTR_1 = 9)] = 'SELECTOR_ATTR_1'),
        (t3[(t3.SELECTOR_ATTR = 10)] = 'SELECTOR_ATTR'),
        (t3[(t3.SELECTOR_CHILD = 11)] = 'SELECTOR_CHILD'),
        (t3[(t3.SELECTOR_SIBLING = 12)] = 'SELECTOR_SIBLING'),
        (t3[(t3.SELECTOR_BODY = 13)] = 'SELECTOR_BODY'),
        (t3[(t3.SELECTOR_PSEUDOCLASS = 14)] = 'SELECTOR_PSEUDOCLASS'),
        (t3[(t3.VAL_IDENT = 15)] = 'VAL_IDENT'),
        (t3[(t3.VAL_HASH = 16)] = 'VAL_HASH'),
        (t3[(t3.VAL_NUM = 17)] = 'VAL_NUM'),
        (t3[(t3.VAL_INT = 18)] = 'VAL_INT'),
        (t3[(t3.VAL_NUMERIC = 19)] = 'VAL_NUMERIC'),
        (t3[(t3.VAL_STR = 20)] = 'VAL_STR'),
        (t3[(t3.VAL_URL = 21)] = 'VAL_URL'),
        (t3[(t3.VAL_COMMA = 22)] = 'VAL_COMMA'),
        (t3[(t3.VAL_SLASH = 23)] = 'VAL_SLASH'),
        (t3[(t3.VAL_FUNC = 24)] = 'VAL_FUNC'),
        (t3[(t3.VAL_C_PAR = 25)] = 'VAL_C_PAR'),
        (t3[(t3.VAL_END = 26)] = 'VAL_END'),
        (t3[(t3.RULE_END = 27)] = 'RULE_END'),
        (t3[(t3.IDENT = 28)] = 'IDENT'),
        (t3[(t3.SELECTOR_START = 29)] = 'SELECTOR_START'),
        (t3[(t3.AT = 30)] = 'AT'),
        (t3[(t3.EXPR_IDENT = 31)] = 'EXPR_IDENT'),
        (t3[(t3.EXPR_NUM = 32)] = 'EXPR_NUM'),
        (t3[(t3.EXPR_NUMERIC = 33)] = 'EXPR_NUMERIC'),
        (t3[(t3.EXPR_STR = 34)] = 'EXPR_STR'),
        (t3[(t3.EXPR_PARAM = 35)] = 'EXPR_PARAM'),
        (t3[(t3.EXPR_PREFIX = 36)] = 'EXPR_PREFIX'),
        (t3[(t3.EXPR_INFIX = 37)] = 'EXPR_INFIX'),
        (t3[(t3.EXPR_FUNC = 38)] = 'EXPR_FUNC'),
        (t3[(t3.EXPR_C_PAR = 39)] = 'EXPR_C_PAR'),
        (t3[(t3.EXPR_O_PAR = 40)] = 'EXPR_O_PAR'),
        (t3[(t3.SELECTOR_NEXT = 41)] = 'SELECTOR_NEXT'),
        (t3[(t3.SELECTOR_PSEUDOELEM = 42)] = 'SELECTOR_PSEUDOELEM'),
        (t3[(t3.EXPR_O_BRC = 43)] = 'EXPR_O_BRC'),
        (t3[(t3.VAL_FINISH = 44)] = 'VAL_FINISH'),
        (t3[(t3.EXPR_INFIX_NAME = 45)] = 'EXPR_INFIX_NAME'),
        (t3[(t3.PROP = 46)] = 'PROP'),
        (t3[(t3.VAL_BANG = 47)] = 'VAL_BANG'),
        (t3[(t3.VAL_BRC = 48)] = 'VAL_BRC'),
        (t3[(t3.EXPR_SEMICOL = 49)] = 'EXPR_SEMICOL'),
        (t3[(t3.ERROR_PUSH = 50)] = 'ERROR_PUSH'),
        (t3[(t3.ERROR_POP = 51)] = 'ERROR_POP'),
        (t3[(t3.ERROR_POP_DECL = 52)] = 'ERROR_POP_DECL'),
        (t3[(t3.ERROR_SEMICOL = 53)] = 'ERROR_SEMICOL'),
        (t3[(t3.VAL_PLUS = 54)] = 'VAL_PLUS'),
        (t3[(t3.SELECTOR_PSEUDOCLASS_1 = 55)] = 'SELECTOR_PSEUDOCLASS_1'),
        (t3[(t3.SELECTOR_FOLLOWING_SIBLING = 56)] =
          'SELECTOR_FOLLOWING_SIBLING'),
        (t3[(t3.DONE = 200)] = 'DONE');
    })(Gi || (Gi = {}));
    var sr;
    var lr = Ln.LAST + 1;
    (Ki[Ln.IDENT] = Gi.IDENT),
      (Ki[Ln.STAR] = Gi.SELECTOR_START),
      (Ki[Ln.HASH] = Gi.SELECTOR_START),
      (Ki[Ln.CLASS] = Gi.SELECTOR_START),
      (Ki[Ln.O_BRK] = Gi.SELECTOR_START),
      (Ki[Ln.COLON] = Gi.SELECTOR_START),
      (Ki[Ln.AT] = Gi.AT),
      (Ki[Ln.C_BRC] = Gi.RULE_END),
      (Ki[Ln.EOF] = Gi.DONE),
      (qi[Ln.IDENT] = Gi.PROP),
      (qi[Ln.EOF] = Gi.DONE),
      (Ji[Ln.IDENT] = Gi.SELECTOR_NAME),
      (Ji[Ln.STAR] = Gi.SELECTOR_ANY),
      (Ji[Ln.HASH] = Gi.SELECTOR_ID),
      (Ji[Ln.CLASS] = Gi.SELECTOR_CLASS),
      (Ji[Ln.O_BRK] = Gi.SELECTOR_ATTR),
      (Ji[Ln.COLON] = Gi.SELECTOR_PSEUDOCLASS),
      (Qi[Ln.GT] = Gi.SELECTOR_CHILD),
      (Qi[Ln.PLUS] = Gi.SELECTOR_SIBLING),
      (Qi[Ln.TILDE] = Gi.SELECTOR_FOLLOWING_SIBLING),
      (Qi[Ln.IDENT] = Gi.SELECTOR_NAME_1),
      (Qi[Ln.STAR] = Gi.SELECTOR_ANY_1),
      (Qi[Ln.HASH] = Gi.SELECTOR_ID_1),
      (Qi[Ln.CLASS] = Gi.SELECTOR_CLASS_1),
      (Qi[Ln.O_BRK] = Gi.SELECTOR_ATTR_1),
      (Qi[Ln.O_BRC] = Gi.SELECTOR_BODY),
      (Qi[Ln.COLON] = Gi.SELECTOR_PSEUDOCLASS_1),
      (Qi[Ln.COL_COL] = Gi.SELECTOR_PSEUDOELEM),
      (Qi[Ln.COMMA] = Gi.SELECTOR_NEXT),
      (Zi[Ln.IDENT] = Gi.SELECTOR_NAME_1),
      (Zi[Ln.STAR] = Gi.SELECTOR_ANY_1),
      (Zi[Ln.HASH] = Gi.SELECTOR_ID_1),
      (Zi[Ln.CLASS] = Gi.SELECTOR_CLASS_1),
      (Zi[Ln.O_BRK] = Gi.SELECTOR_ATTR_1),
      (Zi[Ln.C_PAR] = Gi.DONE),
      (Zi[Ln.COLON] = Gi.SELECTOR_PSEUDOCLASS_1),
      ($i[Ln.IDENT] = Gi.SELECTOR_NAME),
      ($i[Ln.STAR] = Gi.SELECTOR_ANY),
      ($i[Ln.HASH] = Gi.SELECTOR_ID),
      ($i[Ln.CLASS] = Gi.SELECTOR_CLASS),
      ($i[Ln.COLON] = Gi.SELECTOR_PSEUDOCLASS),
      ($i[Ln.COL_COL] = Gi.SELECTOR_PSEUDOELEM),
      ($i[Ln.O_BRK] = Gi.SELECTOR_ATTR),
      ($i[Ln.O_BRC] = Gi.SELECTOR_BODY),
      (tr[Ln.IDENT] = Gi.VAL_IDENT),
      (tr[Ln.HASH] = Gi.VAL_HASH),
      (tr[Ln.NUM] = Gi.VAL_NUM),
      (tr[Ln.INT] = Gi.VAL_INT),
      (tr[Ln.NUMERIC] = Gi.VAL_NUMERIC),
      (tr[Ln.STR] = Gi.VAL_STR),
      (tr[Ln.URL] = Gi.VAL_URL),
      (tr[Ln.COMMA] = Gi.VAL_COMMA),
      (tr[Ln.SLASH] = Gi.VAL_SLASH),
      (tr[Ln.FUNC] = Gi.VAL_FUNC),
      (tr[Ln.C_PAR] = Gi.VAL_C_PAR),
      (tr[Ln.SEMICOL] = Gi.VAL_END),
      (tr[Ln.C_BRC] = Gi.VAL_BRC),
      (tr[Ln.BANG] = Gi.VAL_BANG),
      (tr[Ln.PLUS] = Gi.VAL_PLUS),
      (tr[Ln.EOF] = Gi.VAL_FINISH),
      (er[Ln.IDENT] = Gi.EXPR_IDENT),
      (er[Ln.NUM] = Gi.EXPR_NUM),
      (er[Ln.INT] = Gi.EXPR_NUM),
      (er[Ln.NUMERIC] = Gi.EXPR_NUMERIC),
      (er[Ln.STR] = Gi.EXPR_STR),
      (er[Ln.O_PAR] = Gi.EXPR_O_PAR),
      (er[Ln.FUNC] = Gi.EXPR_FUNC),
      (er[Ln.BANG] = Gi.EXPR_PREFIX),
      (er[Ln.MINUS] = Gi.EXPR_PREFIX),
      (er[Ln.DOLLAR] = Gi.EXPR_PARAM),
      (nr[Ln.IDENT] = Gi.EXPR_INFIX_NAME),
      (nr[Ln.COMMA] = Gi.EXPR_INFIX),
      (nr[Ln.GT] = Gi.EXPR_INFIX),
      (nr[Ln.LT] = Gi.EXPR_INFIX),
      (nr[Ln.GT_EQ] = Gi.EXPR_INFIX),
      (nr[Ln.LT_EQ] = Gi.EXPR_INFIX),
      (nr[Ln.EQ] = Gi.EXPR_INFIX),
      (nr[Ln.EQ_EQ] = Gi.EXPR_INFIX),
      (nr[Ln.BANG_EQ] = Gi.EXPR_INFIX),
      (nr[Ln.AMP_AMP] = Gi.EXPR_INFIX),
      (nr[Ln.BAR_BAR] = Gi.EXPR_INFIX),
      (nr[Ln.PLUS] = Gi.EXPR_INFIX),
      (nr[Ln.MINUS] = Gi.EXPR_INFIX),
      (nr[Ln.SLASH] = Gi.EXPR_INFIX),
      (nr[Ln.PERCENT] = Gi.EXPR_INFIX),
      (nr[Ln.STAR] = Gi.EXPR_INFIX),
      (nr[Ln.COLON] = Gi.EXPR_INFIX),
      (nr[Ln.QMARK] = Gi.EXPR_INFIX),
      (nr[Ln.C_PAR] = Gi.EXPR_C_PAR),
      (nr[Ln.O_BRC] = Gi.EXPR_O_BRC),
      (nr[Ln.SEMICOL] = Gi.EXPR_SEMICOL),
      (ir[Ln.EOF] = Gi.DONE),
      (ir[Ln.O_BRC] = Gi.ERROR_PUSH),
      (ir[Ln.C_BRC] = Gi.ERROR_POP),
      (ir[Ln.O_BRK] = Gi.ERROR_PUSH),
      (ir[Ln.C_BRK] = Gi.ERROR_POP),
      (ir[Ln.O_PAR] = Gi.ERROR_PUSH),
      (ir[Ln.C_PAR] = Gi.ERROR_POP),
      (ir[Ln.SEMICOL] = Gi.ERROR_SEMICOL),
      (rr[Ln.EOF] = Gi.DONE),
      (rr[Ln.O_BRC] = Gi.ERROR_PUSH),
      (rr[Ln.C_BRC] = Gi.ERROR_POP_DECL),
      (rr[Ln.O_BRK] = Gi.ERROR_PUSH),
      (rr[Ln.C_BRK] = Gi.ERROR_POP),
      (rr[Ln.O_PAR] = Gi.ERROR_PUSH),
      (rr[Ln.C_PAR] = Gi.ERROR_POP),
      (rr[Ln.SEMICOL] = Gi.ERROR_SEMICOL),
      (or[Ln.EOF] = Gi.DONE),
      (or[Ln.O_BRC] = Gi.ERROR_PUSH),
      (or[Ln.C_BRC] = Gi.ERROR_POP),
      (or[Ln.O_BRK] = Gi.ERROR_PUSH),
      (or[Ln.C_BRK] = Gi.ERROR_POP),
      (or[Ln.O_PAR] = Gi.ERROR_PUSH),
      (or[Ln.C_PAR] = Gi.ERROR_POP),
      (ar[Ln.C_PAR] = 0),
      (ar[Ln.COMMA] = 0),
      (ar[Ln.QMARK] = 1),
      (ar[Ln.COLON] = 1),
      (ar[Ln.AMP_AMP] = 2),
      (ar[Ln.BAR_BAR] = 2),
      (ar[Ln.LT] = 3),
      (ar[Ln.GT] = 3),
      (ar[Ln.LT_EQ] = 3),
      (ar[Ln.GT_EQ] = 3),
      (ar[Ln.EQ] = 3),
      (ar[Ln.EQ_EQ] = 3),
      (ar[Ln.BANG_EQ] = 3),
      (ar[Ln.PLUS] = 4),
      (ar[Ln.MINUS] = 4),
      (ar[Ln.STAR] = 5),
      (ar[Ln.SLASH] = 5),
      (ar[Ln.PERCENT] = 5),
      (ar[Ln.EOF] = 6),
      (ar[lr] = 2),
      (function (t3) {
        (t3[(t3.PROP = 0)] = 'PROP'),
          (t3[(t3.WHEN = 1)] = 'WHEN'),
          (t3[(t3.MEDIA = 2)] = 'MEDIA'),
          (t3[(t3.IMPORT = 3)] = 'IMPORT');
      })(sr || (sr = {}));
    var ur = (function () {
      function t3(t4, e4, n3, i3) {
        (this.actions = t4),
          (this.tokenizer = e4),
          (this.handler = n3),
          (this.baseURL = i3),
          (this.valStack = []),
          (this.namespacePrefixToURI = {}),
          (this.defaultNamespaceURI = null),
          (this.propName = null),
          (this.propImportant = false),
          (this.result = null),
          (this.importReady = false),
          (this.importURL = null),
          (this.importCondition = null),
          (this.errorBrackets = []),
          (this.ruleStack = []),
          (this.regionRule = false),
          (this.pageRule = false),
          (this.exprContext = sr.MEDIA);
      }
      var e3 = t3.prototype;
      return (
        (e3.extractVals = function (t4, e4) {
          for (
            var n3 = [], i3 = this.valStack;
            n3.push(i3[e4++]), e4 != i3.length;

          )
            if (i3[e4++] != t4) throw new Error('Unexpected state');
          return n3;
        }),
        (e3.valStackReduce = function (t4, e4) {
          var n3,
            i3 = this.valStack,
            r3 = i3.length;
          do {
            n3 = i3[--r3];
          } while (void 0 !== n3 && 'string' != typeof n3);
          var o3 = i3.length - (r3 + 1);
          if (
            (o3 > 1 &&
              i3.splice(r3 + 1, o3, new He(i3.slice(r3 + 1, i3.length))),
            ',' == t4)
          )
            return null;
          r3++;
          do {
            n3 = i3[--r3];
          } while (void 0 !== n3 && ('string' != typeof n3 || ',' == n3));
          if (((o3 = i3.length - (r3 + 1)), '(' == n3)) {
            if (')' != t4)
              return (
                this.handler.error('E_CSS_MISMATCHED_C_PAR', e4),
                (this.actions = rr),
                null
              );
            var a3 = new Ge(i3[r3 - 1], this.extractVals(',', r3 + 1));
            return i3.splice(r3 - 1, o3 + 2, a3), null;
          }
          return ';' != t4 || r3 >= 0
            ? (this.handler.error('E_CSS_UNEXPECTED_VAL_END', e4),
              (this.actions = rr),
              null)
            : o3 > 1
            ? new ze(this.extractVals(',', r3 + 1))
            : i3[0];
        }),
        (e3.exprError = function (t4, e4) {
          (this.actions = this.propName ? rr : ir), this.handler.error(t4, e4);
        }),
        (e3.exprStackReduce = function (t4, e4) {
          for (
            var n3, i3 = this.valStack, r3 = this.handler, o3 = i3.pop();
            ;

          ) {
            var a3 = i3.pop();
            if (t4 == Ln.C_PAR) {
              for (var s3 = [o3]; a3 == Ln.COMMA; )
                s3.unshift(i3.pop()), (a3 = i3.pop());
              if ('string' == typeof a3) {
                if ('{' == a3) {
                  for (; s3.length >= 2; ) {
                    var l3 = s3.shift(),
                      u3 = s3.shift(),
                      h3 = new te(r3.getScope(), l3, u3);
                    s3.unshift(h3);
                  }
                  return i3.push(new We(s3[0])), true;
                }
                if ('(' == a3) {
                  var c3 = i3.pop(),
                    f3 = i3.pop();
                  (o3 = new me(r3.getScope(), Dt(f3, c3), s3)), (t4 = Ln.EOF);
                  continue;
                }
              }
              if (a3 == Ln.O_PAR) {
                o3.isMediaName() && (o3 = new ye(r3.getScope(), o3, null)),
                  (t4 = Ln.EOF);
                continue;
              }
            } else if ('string' == typeof a3) {
              i3.push(a3);
              break;
            }
            if (a3 < 0)
              if (a3 == -Ln.BANG) o3 = new qt(r3.getScope(), o3);
              else {
                if (a3 != -Ln.MINUS)
                  return this.exprError('F_UNEXPECTED_STATE', e4), false;
                o3 = new Qt(r3.getScope(), o3);
              }
            else {
              if (ar[t4] > ar[a3]) {
                i3.push(a3);
                break;
              }
              switch (((n3 = i3.pop()), a3)) {
                case Ln.AMP_AMP:
                  o3 = new Zt(r3.getScope(), n3, o3);
                  break;
                case lr:
                  o3 = new $t(r3.getScope(), n3, o3);
                  break;
                case Ln.BAR_BAR:
                  o3 = new Jt(r3.getScope(), n3, o3);
                  break;
                case Ln.LT:
                  o3 = new ee(r3.getScope(), n3, o3);
                  break;
                case Ln.GT:
                  o3 = new ie(r3.getScope(), n3, o3);
                  break;
                case Ln.LT_EQ:
                  o3 = new ne(r3.getScope(), n3, o3);
                  break;
                case Ln.GT_EQ:
                  o3 = new re(r3.getScope(), n3, o3);
                  break;
                case Ln.EQ:
                case Ln.EQ_EQ:
                  o3 = new oe(r3.getScope(), n3, o3);
                  break;
                case Ln.BANG_EQ:
                  o3 = new ae(r3.getScope(), n3, o3);
                  break;
                case Ln.PLUS:
                  o3 = new se(r3.getScope(), n3, o3);
                  break;
                case Ln.MINUS:
                  o3 = new le(r3.getScope(), n3, o3);
                  break;
                case Ln.STAR:
                  o3 = new ue(r3.getScope(), n3, o3);
                  break;
                case Ln.SLASH:
                  o3 = new he(r3.getScope(), n3, o3);
                  break;
                case Ln.PERCENT:
                  o3 = new ce(r3.getScope(), n3, o3);
                  break;
                case Ln.COLON:
                  if (!(i3.length > 1))
                    return this.exprError('E_CSS_EXPR_COND', e4), false;
                  switch (i3[i3.length - 1]) {
                    case Ln.QMARK:
                      i3.pop(), (o3 = new ve(r3.getScope(), i3.pop(), n3, o3));
                      break;
                    case Ln.O_PAR:
                      if (!n3.isMediaName())
                        return this.exprError('E_CSS_MEDIA_TEST', e4), false;
                      o3 = new ye(r3.getScope(), n3, o3);
                  }
                  break;
                case Ln.QMARK:
                  if (t4 != Ln.COLON)
                    return this.exprError('E_CSS_EXPR_COND', e4), false;
                case Ln.O_PAR:
                  return i3.push(n3), i3.push(a3), i3.push(o3), false;
                default:
                  return this.exprError('F_UNEXPECTED_STATE', e4), false;
              }
            }
          }
          return i3.push(o3), false;
        }),
        (e3.readPseudoParams = function () {
          for (var t4 = []; ; ) {
            var e4 = this.tokenizer.token();
            switch (e4.type) {
              case Ln.IDENT:
                t4.push(e4.text);
                break;
              case Ln.PLUS:
                t4.push('+');
                break;
              case Ln.NUM:
              case Ln.INT:
                t4.push(e4.num);
                break;
              default:
                return t4;
            }
            this.tokenizer.consume();
          }
        }),
        (e3.readNthPseudoParams = function () {
          var t4 = false,
            e4 = this.tokenizer.token();
          if (e4.type === Ln.PLUS)
            (t4 = true),
              this.tokenizer.consume(),
              (e4 = this.tokenizer.token());
          else if (
            e4.type === Ln.IDENT &&
            ('even' === e4.text || 'odd' === e4.text)
          )
            return this.tokenizer.consume(), [2, 'odd' === e4.text ? 1 : 0];
          switch (e4.type) {
            case Ln.NUMERIC:
              if (t4 && e4.num < 0) return null;
            case Ln.IDENT:
              if (t4 && '-' === e4.text.charAt(0)) return null;
              if ('n' === e4.text || '-n' === e4.text) {
                if (t4 && e4.precededBySpace) return null;
                var n3 = '-n' === e4.text ? -1 : 1;
                e4.type === Ln.NUMERIC && (n3 = e4.num);
                var i3 = 0;
                this.tokenizer.consume();
                var r3 = (e4 = this.tokenizer.token()).type === Ln.MINUS,
                  o3 = e4.type === Ln.PLUS || r3;
                if (
                  (o3 &&
                    (this.tokenizer.consume(), (e4 = this.tokenizer.token())),
                  e4.type === Ln.INT)
                ) {
                  if (1 / (i3 = e4.num) == 1 / -0) {
                    if (((i3 = 0), o3)) return null;
                  } else if (i3 < 0) {
                    if (o3) return null;
                  } else if (i3 >= 0 && !o3) return null;
                  this.tokenizer.consume();
                } else if (o3) return null;
                return [n3, r3 && i3 > 0 ? -i3 : i3];
              }
              if ('n-' === e4.text || '-n-' === e4.text) {
                if (t4 && e4.precededBySpace) return null;
                var a3 = '-n-' === e4.text ? -1 : 1;
                if (
                  (e4.type === Ln.NUMERIC && (a3 = e4.num),
                  this.tokenizer.consume(),
                  (e4 = this.tokenizer.token()).type === Ln.INT)
                )
                  return e4.num < 0 || 1 / e4.num == 1 / -0
                    ? null
                    : (this.tokenizer.consume(), [a3, e4.num]);
              } else {
                var s3 = e4.text.match(/^n(-[0-9]+)$/);
                if (s3)
                  return t4 && e4.precededBySpace
                    ? null
                    : (this.tokenizer.consume(),
                      [
                        e4.type === Ln.NUMERIC ? e4.num : 1,
                        parseInt(s3[1], 10),
                      ]);
                if ((s3 = e4.text.match(/^-n(-[0-9]+)$/)))
                  return this.tokenizer.consume(), [-1, parseInt(s3[1], 10)];
              }
              return null;
            case Ln.INT:
              return t4 && (e4.precededBySpace || e4.num < 0)
                ? null
                : (this.tokenizer.consume(), [0, e4.num]);
          }
          return null;
        }),
        (e3.makeCondition = function (t4, e4) {
          var n3 = this.handler.getScope();
          if (!n3) return null;
          if (((e4 = e4 || n3._true), t4))
            for (var i3, r3 = D(t4.split(/\s+/)); !(i3 = r3()).done; )
              switch (i3.value) {
                case 'vertical':
                  e4 = Ne(n3, e4, new qt(n3, new de(n3, 'pref-horizontal')));
                  break;
                case 'horizontal':
                  e4 = Ne(n3, e4, new de(n3, 'pref-horizontal'));
                  break;
                case 'day':
                  e4 = Ne(n3, e4, new qt(n3, new de(n3, 'pref-night-mode')));
                  break;
                case 'night':
                  e4 = Ne(n3, e4, new de(n3, 'pref-night-mode'));
                  break;
                default:
                  e4 = n3._false;
              }
          return e4 === n3._true ? null : new We(e4);
        }),
        (e3.isInsidePropertyOnlyRule = function () {
          switch (this.ruleStack[this.ruleStack.length - 1]) {
            case '[selector]':
            case 'font-face':
            case '-epubx-flow':
            case '-epubx-viewport':
            case '-epubx-define':
            case '-adapt-footnote-area':
              return true;
          }
          return false;
        }),
        (e3.runParser = function (t4, e4, n3, i3, r3) {
          var o3,
            a3,
            s3,
            l3,
            u3,
            h3,
            c3,
            f3 = this.handler,
            d3 = this.tokenizer,
            p3 = this.valStack;
          i3 && ((this.exprContext = sr.MEDIA), this.valStack.push('{'));
          t: for (; t4 > 0; --t4)
            switch (((o3 = d3.token()), this.actions[o3.type])) {
              case Gi.IDENT:
                if (d3.nthToken(1).type != Ln.COLON) {
                  this.isInsidePropertyOnlyRule()
                    ? (f3.error('E_CSS_COLON_EXPECTED', d3.nthToken(1)),
                      (this.actions = rr))
                    : ((this.actions = Ji), f3.startSelectorRule());
                  continue;
                }
                (a3 = d3.nthToken(2)).precededBySpace ||
                  (a3.type != Ln.IDENT && a3.type != Ln.FUNC) ||
                  d3.mark(),
                  (this.propName = o3.text),
                  (this.propImportant = false),
                  d3.consume(),
                  d3.consume(),
                  (this.actions = tr),
                  p3.splice(0, p3.length);
                continue;
              case Gi.PROP:
                if (d3.nthToken(1).type != Ln.COLON) {
                  (this.actions = rr),
                    f3.error('E_CSS_COLON_EXPECTED', d3.nthToken(1));
                  continue;
                }
                (this.propName = o3.text),
                  (this.propImportant = false),
                  d3.consume(),
                  d3.consume(),
                  (this.actions = tr),
                  p3.splice(0, p3.length);
                continue;
              case Gi.SELECTOR_START:
                (this.actions = Ji), f3.startSelectorRule();
                continue;
              case Gi.SELECTOR_NAME_1:
                if (!o3.precededBySpace) {
                  (this.actions = or), f3.error('E_CSS_SPACE_EXPECTED', o3);
                  continue;
                }
                f3.descendantSelector();
              case Gi.SELECTOR_NAME:
                if (d3.nthToken(1).type == Ln.BAR)
                  if (
                    (d3.consume(),
                    d3.consume(),
                    null != (s3 = this.namespacePrefixToURI[o3.text]))
                  )
                    switch ((o3 = d3.token()).type) {
                      case Ln.IDENT:
                        f3.tagSelector(s3, o3.text),
                          (this.actions = r3 ? Zi : Qi),
                          d3.consume();
                        break;
                      case Ln.STAR:
                        f3.tagSelector(s3, null),
                          (this.actions = r3 ? Zi : Qi),
                          d3.consume();
                        break;
                      default:
                        (this.actions = ir), f3.error('E_CSS_NAMESPACE', o3);
                    }
                  else
                    (this.actions = ir),
                      f3.error('E_CSS_UNDECLARED_PREFIX', o3);
                else
                  f3.tagSelector(this.defaultNamespaceURI, o3.text),
                    (this.actions = r3 ? Zi : Qi),
                    d3.consume();
                continue;
              case Gi.SELECTOR_ANY_1:
                if (!o3.precededBySpace) {
                  (this.actions = or), f3.error('E_CSS_SPACE_EXPECTED', o3);
                  continue;
                }
                f3.descendantSelector();
              case Gi.SELECTOR_ANY:
                if (d3.nthToken(1).type == Ln.BAR)
                  switch (
                    (d3.consume(), d3.consume(), (o3 = d3.token()).type)
                  ) {
                    case Ln.IDENT:
                      f3.tagSelector(null, o3.text),
                        (this.actions = r3 ? Zi : Qi),
                        d3.consume();
                      break;
                    case Ln.STAR:
                      f3.tagSelector(null, null),
                        (this.actions = r3 ? Zi : Qi),
                        d3.consume();
                      break;
                    default:
                      (this.actions = ir), f3.error('E_CSS_NAMESPACE', o3);
                  }
                else
                  f3.tagSelector(this.defaultNamespaceURI, null),
                    (this.actions = r3 ? Zi : Qi),
                    d3.consume();
                continue;
              case Gi.SELECTOR_ID_1:
                o3.precededBySpace && f3.descendantSelector();
              case Gi.SELECTOR_ID:
                f3.idSelector(o3.text),
                  (this.actions = r3 ? Zi : Qi),
                  d3.consume();
                continue;
              case Gi.SELECTOR_CLASS_1:
                o3.precededBySpace && f3.descendantSelector();
              case Gi.SELECTOR_CLASS:
                f3.classSelector(o3.text),
                  (this.actions = r3 ? Zi : Qi),
                  d3.consume();
                continue;
              case Gi.SELECTOR_PSEUDOCLASS_1:
                o3.precededBySpace && f3.descendantSelector();
              case Gi.SELECTOR_PSEUDOCLASS:
                d3.consume();
                e: switch ((o3 = d3.token()).type) {
                  case Ln.IDENT:
                    f3.pseudoclassSelector(o3.text, null),
                      d3.consume(),
                      (this.actions = r3 ? Zi : Qi);
                    continue;
                  case Ln.FUNC:
                    switch (((l3 = o3.text), d3.consume(), l3)) {
                      case 'not':
                        (this.actions = Ji),
                          f3.startFuncWithSelector('not'),
                          (this.actions = this.runParser(
                            Number.POSITIVE_INFINITY,
                            false,
                            false,
                            false,
                            true,
                          )
                            ? Qi
                            : or);
                        break t;
                      case 'lang':
                      case 'href-epub-type':
                        if ((o3 = d3.token()).type === Ln.IDENT) {
                          (c3 = [o3.text]), d3.consume();
                          break;
                        }
                        break e;
                      case 'nth-child':
                      case 'nth-of-type':
                      case 'nth-last-child':
                      case 'nth-last-of-type':
                        if ((c3 = this.readNthPseudoParams())) break;
                        break e;
                      default:
                        c3 = this.readPseudoParams();
                    }
                    if ((o3 = d3.token()).type == Ln.C_PAR) {
                      f3.pseudoclassSelector(l3, c3),
                        d3.consume(),
                        (this.actions = r3 ? Zi : Qi);
                      continue;
                    }
                }
                f3.error('E_CSS_PSEUDOCLASS_SYNTAX', o3), (this.actions = ir);
                continue;
              case Gi.SELECTOR_PSEUDOELEM:
                switch ((d3.consume(), (o3 = d3.token()).type)) {
                  case Ln.IDENT:
                    f3.pseudoelementSelector(o3.text, null),
                      (this.actions = r3 ? Zi : Qi),
                      d3.consume();
                    continue;
                  case Ln.FUNC:
                    if (((l3 = o3.text), d3.consume(), 'nth-fragment' == l3)) {
                      if (null === (c3 = this.readNthPseudoParams())) break;
                    } else c3 = this.readPseudoParams();
                    if ((o3 = d3.token()).type == Ln.C_PAR) {
                      f3.pseudoelementSelector(l3, c3),
                        (this.actions = r3 ? Zi : Qi),
                        d3.consume();
                      continue;
                    }
                }
                f3.error('E_CSS_PSEUDOELEM_SYNTAX', o3), (this.actions = ir);
                continue;
              case Gi.SELECTOR_ATTR_1:
                o3.precededBySpace && f3.descendantSelector();
              case Gi.SELECTOR_ATTR:
                if ((d3.consume(), (o3 = d3.token()).type == Ln.IDENT))
                  (l3 = o3.text), d3.consume();
                else if (o3.type == Ln.STAR) (l3 = null), d3.consume();
                else {
                  if (o3.type != Ln.BAR) {
                    (this.actions = or),
                      f3.error('E_CSS_ATTR', o3),
                      d3.consume();
                    continue;
                  }
                  l3 = '';
                }
                if ((o3 = d3.token()).type == Ln.BAR) {
                  if (null == (s3 = l3 ? this.namespacePrefixToURI[l3] : l3)) {
                    (this.actions = or),
                      f3.error('E_CSS_UNDECLARED_PREFIX', o3),
                      d3.consume();
                    continue;
                  }
                  if ((d3.consume(), (o3 = d3.token()).type != Ln.IDENT)) {
                    (this.actions = or),
                      f3.error('E_CSS_ATTR_NAME_EXPECTED', o3);
                    continue;
                  }
                  (l3 = o3.text), d3.consume(), (o3 = d3.token());
                } else s3 = '';
                switch (o3.type) {
                  case Ln.EQ:
                  case Ln.TILDE_EQ:
                  case Ln.BAR_EQ:
                  case Ln.HAT_EQ:
                  case Ln.DOLLAR_EQ:
                  case Ln.STAR_EQ:
                  case Ln.COL_COL:
                    (u3 = o3.type), d3.consume(), (o3 = d3.token());
                    break;
                  case Ln.C_BRK:
                    f3.attributeSelector(s3, l3, Ln.EOF, null),
                      (this.actions = r3 ? Zi : Qi),
                      d3.consume();
                    continue;
                  default:
                    (this.actions = or), f3.error('E_CSS_ATTR_OP_EXPECTED', o3);
                    continue;
                }
                switch (o3.type) {
                  case Ln.IDENT:
                  case Ln.STR:
                    f3.attributeSelector(s3, l3, u3, o3.text),
                      d3.consume(),
                      (o3 = d3.token());
                    break;
                  default:
                    (this.actions = or),
                      f3.error('E_CSS_ATTR_VAL_EXPECTED', o3);
                    continue;
                }
                if (o3.type != Ln.C_BRK) {
                  (this.actions = or), f3.error('E_CSS_ATTR', o3);
                  continue;
                }
                (this.actions = r3 ? Zi : Qi), d3.consume();
                continue;
              case Gi.SELECTOR_CHILD:
                f3.childSelector(), (this.actions = $i), d3.consume();
                continue;
              case Gi.SELECTOR_SIBLING:
                f3.adjacentSiblingSelector(), (this.actions = $i), d3.consume();
                continue;
              case Gi.SELECTOR_FOLLOWING_SIBLING:
                f3.followingSiblingSelector(),
                  (this.actions = $i),
                  d3.consume();
                continue;
              case Gi.SELECTOR_BODY:
                this.regionRule
                  ? (this.ruleStack.push('-epubx-region'),
                    (this.regionRule = false))
                  : this.pageRule
                  ? (this.ruleStack.push('page'), (this.pageRule = false))
                  : this.ruleStack.push('[selector]'),
                  f3.startRuleBody(),
                  (this.actions = Ki),
                  d3.consume();
                continue;
              case Gi.SELECTOR_NEXT:
                f3.nextSelector(), (this.actions = Ji), d3.consume();
                continue;
              case Gi.VAL_IDENT:
                p3.push(Fe(o3.text)), d3.consume();
                continue;
              case Gi.VAL_HASH:
                u3 = parseInt(o3.text, 16);
                try {
                  p3.push(zi(o3.text));
                } catch (t5) {
                  f3.error('E_CSS_COLOR', o3), (this.actions = ir);
                }
                d3.consume();
                continue;
              case Gi.VAL_NUM:
                p3.push(new _e(o3.num)), d3.consume();
                continue;
              case Gi.VAL_INT:
                p3.push(new Be(o3.num)), d3.consume();
                continue;
              case Gi.VAL_NUMERIC:
                Mt(o3.text)
                  ? p3.push(new We(new fe(f3.getScope(), o3.num, o3.text)))
                  : p3.push(new De(o3.num, o3.text)),
                  d3.consume();
                continue;
              case Gi.VAL_STR:
                p3.push(new Le(o3.text)), d3.consume();
                continue;
              case Gi.VAL_URL:
                p3.push(new Ue(W(o3.text, this.baseURL))), d3.consume();
                continue;
              case Gi.VAL_COMMA:
                this.valStackReduce(',', o3), p3.push(','), d3.consume();
                continue;
              case Gi.VAL_SLASH:
                p3.push(Ae), d3.consume();
                continue;
              case Gi.VAL_FUNC:
                '-epubx-expr' == (l3 = o3.text.toLowerCase()) ||
                'calc' == l3 ||
                'env' == l3
                  ? ((this.actions = er),
                    (this.exprContext = sr.PROP),
                    p3.push('{'))
                  : (p3.push(l3), p3.push('(')),
                  d3.consume();
                continue;
              case Gi.VAL_C_PAR:
                this.valStackReduce(')', o3), d3.consume();
                continue;
              case Gi.VAL_BANG:
                if (
                  (d3.consume(),
                  (o3 = d3.token()),
                  (a3 = d3.nthToken(1)),
                  o3.type == Ln.IDENT &&
                    'important' == o3.text.toLowerCase() &&
                    (a3.type == Ln.SEMICOL ||
                      a3.type == Ln.EOF ||
                      a3.type == Ln.C_BRC))
                ) {
                  d3.consume(), (this.propImportant = true);
                  continue;
                }
                this.exprError('E_CSS_SYNTAX', o3);
                continue;
              case Gi.VAL_PLUS:
                switch ((a3 = d3.nthToken(1)).type) {
                  case Ln.NUM:
                  case Ln.NUMERIC:
                  case Ln.INT:
                    if (!a3.precededBySpace) {
                      d3.consume();
                      continue;
                    }
                }
                if (this.actions === tr && d3.hasMark()) {
                  d3.reset(), (this.actions = Ji), f3.startSelectorRule();
                  continue;
                }
                this.exprError('E_CSS_UNEXPECTED_PLUS', o3);
                continue;
              case Gi.VAL_END:
                d3.consume();
              case Gi.VAL_BRC:
                d3.unmark(),
                  (h3 = this.valStackReduce(';', o3)) &&
                    this.propName &&
                    f3.property(this.propName, h3, this.propImportant),
                  (this.actions = n3 ? qi : Ki);
                continue;
              case Gi.VAL_FINISH:
                if (
                  (d3.consume(),
                  d3.unmark(),
                  (h3 = this.valStackReduce(';', o3)),
                  e4)
                )
                  return (this.result = h3), true;
                if (
                  (this.propName &&
                    h3 &&
                    f3.property(this.propName, h3, this.propImportant),
                  n3)
                )
                  return true;
                this.exprError('E_CSS_SYNTAX', o3);
                continue;
              case Gi.EXPR_IDENT:
                (a3 = d3.nthToken(1)).type == Ln.CLASS
                  ? (d3.nthToken(2).type != Ln.O_PAR ||
                    d3.nthToken(2).precededBySpace
                      ? (p3.push(new de(f3.getScope(), Dt(o3.text, a3.text))),
                        (this.actions = nr))
                      : (p3.push(o3.text, a3.text, '('), d3.consume()),
                    d3.consume())
                  : (this.exprContext == sr.MEDIA ||
                    this.exprContext == sr.IMPORT
                      ? 'not' == o3.text.toLowerCase()
                        ? (d3.consume(),
                          p3.push(new pe(f3.getScope(), true, a3.text)))
                        : ('only' == o3.text.toLowerCase() &&
                            (d3.consume(), (o3 = a3)),
                          p3.push(new pe(f3.getScope(), false, o3.text)))
                      : p3.push(new de(f3.getScope(), o3.text)),
                    (this.actions = nr)),
                  d3.consume();
                continue;
              case Gi.EXPR_FUNC:
                p3.push(null, o3.text, '('), d3.consume();
                continue;
              case Gi.EXPR_NUM:
                p3.push(new Ee(f3.getScope(), o3.num)),
                  d3.consume(),
                  (this.actions = nr);
                continue;
              case Gi.EXPR_NUMERIC:
                '%' == (l3 = o3.text) &&
                  (l3 =
                    this.propName &&
                    this.propName.match(/height|^(top|bottom)$/)
                      ? 'vh'
                      : 'vw'),
                  p3.push(new fe(f3.getScope(), o3.num, l3)),
                  d3.consume(),
                  (this.actions = nr);
                continue;
              case Gi.EXPR_STR:
                p3.push(new Ee(f3.getScope(), o3.text)),
                  d3.consume(),
                  (this.actions = nr);
                continue;
              case Gi.EXPR_PARAM:
                d3.consume(),
                  (o3 = d3.token()).type != Ln.INT || o3.precededBySpace
                    ? this.exprError('E_CSS_SYNTAX', o3)
                    : (p3.push(new we(f3.getScope(), o3.num)),
                      d3.consume(),
                      (this.actions = nr));
                continue;
              case Gi.EXPR_PREFIX:
                p3.push(-o3.type), d3.consume();
                continue;
              case Gi.EXPR_INFIX:
                (this.actions = er),
                  this.exprStackReduce(o3.type, o3),
                  p3.push(o3.type),
                  d3.consume();
                continue;
              case Gi.EXPR_INFIX_NAME:
                'and' == o3.text.toLowerCase()
                  ? ((this.actions = er),
                    this.exprStackReduce(lr, o3),
                    p3.push(lr),
                    d3.consume())
                  : this.exprError('E_CSS_SYNTAX', o3);
                continue;
              case Gi.EXPR_C_PAR:
                this.exprStackReduce(o3.type, o3) &&
                  (this.propName
                    ? (this.actions = tr)
                    : this.exprError('E_CSS_UNBALANCED_PAR', o3)),
                  d3.consume();
                continue;
              case Gi.EXPR_O_BRC:
                this.exprStackReduce(Ln.C_PAR, o3) &&
                  (this.propName || this.exprContext == sr.IMPORT
                    ? this.exprError('E_CSS_UNEXPECTED_BRC', o3)
                    : (this.exprContext == sr.WHEN
                        ? f3.startWhenRule(p3.pop())
                        : f3.startMediaRule(p3.pop()),
                      this.ruleStack.push('media'),
                      f3.startRuleBody(),
                      (this.actions = Ki))),
                  d3.consume();
                continue;
              case Gi.EXPR_SEMICOL:
                if (this.exprStackReduce(Ln.C_PAR, o3)) {
                  if (!this.propName && this.exprContext == sr.IMPORT)
                    return (
                      (this.importCondition = p3.pop()),
                      (this.importReady = true),
                      (this.actions = Ki),
                      d3.consume(),
                      false
                    );
                  this.exprError('E_CSS_UNEXPECTED_SEMICOL', o3);
                }
                d3.consume();
                continue;
              case Gi.EXPR_O_PAR:
                p3.push(o3.type), d3.consume();
                continue;
              case Gi.RULE_END:
                (this.actions = Ki),
                  d3.consume(),
                  f3.endRule(),
                  this.ruleStack.length && this.ruleStack.pop();
                continue;
              case Gi.AT:
                switch ((l3 = o3.text.toLowerCase())) {
                  case 'import':
                    if (
                      (d3.consume(),
                      (o3 = d3.token()).type == Ln.STR || o3.type == Ln.URL)
                    ) {
                      if (
                        ((this.importURL = o3.text),
                        d3.consume(),
                        (o3 = d3.token()).type == Ln.SEMICOL ||
                          o3.type == Ln.EOF)
                      )
                        return (this.importReady = true), d3.consume(), false;
                      (this.propName = null),
                        (this.exprContext = sr.IMPORT),
                        (this.actions = er),
                        p3.push('{');
                      continue;
                    }
                    f3.error('E_CSS_IMPORT_SYNTAX', o3), (this.actions = ir);
                    continue;
                  case 'namespace':
                    switch ((d3.consume(), (o3 = d3.token()).type)) {
                      case Ln.IDENT:
                        if (
                          ((l3 = o3.text),
                          d3.consume(),
                          ((o3 = d3.token()).type == Ln.STR ||
                            o3.type == Ln.URL) &&
                            d3.nthToken(1).type == Ln.SEMICOL)
                        ) {
                          (this.namespacePrefixToURI[l3] = o3.text),
                            d3.consume(),
                            d3.consume();
                          continue;
                        }
                        break;
                      case Ln.STR:
                      case Ln.URL:
                        if (d3.nthToken(1).type == Ln.SEMICOL) {
                          (this.defaultNamespaceURI = o3.text),
                            d3.consume(),
                            d3.consume();
                          continue;
                        }
                    }
                    f3.error('E_CSS_NAMESPACE_SYNTAX', o3), (this.actions = ir);
                    continue;
                  case 'charset':
                    if (
                      (d3.consume(),
                      (o3 = d3.token()).type == Ln.STR &&
                        d3.nthToken(1).type == Ln.SEMICOL)
                    ) {
                      'utf-8' != (l3 = o3.text.toLowerCase()) &&
                        'utf-16' != l3 &&
                        f3.error('E_CSS_UNEXPECTED_CHARSET ' + l3, o3),
                        d3.consume(),
                        d3.consume();
                      continue;
                    }
                    f3.error('E_CSS_CHARSET_SYNTAX', o3), (this.actions = ir);
                    continue;
                  case 'font-face':
                  case '-epubx-page-template':
                  case '-epubx-define':
                  case '-epubx-viewport':
                    if (d3.nthToken(1).type == Ln.O_BRC) {
                      switch ((d3.consume(), d3.consume(), l3)) {
                        case 'font-face':
                          f3.startFontFaceRule();
                          break;
                        case '-epubx-page-template':
                          f3.startPageTemplateRule();
                          break;
                        case '-epubx-define':
                          f3.startDefineRule();
                          break;
                        case '-epubx-viewport':
                          f3.startViewportRule();
                      }
                      this.ruleStack.push(l3), f3.startRuleBody();
                      continue;
                    }
                    break;
                  case '-adapt-footnote-area':
                    switch ((d3.consume(), (o3 = d3.token()).type)) {
                      case Ln.O_BRC:
                        d3.consume(),
                          f3.startFootnoteRule(null),
                          this.ruleStack.push(l3),
                          f3.startRuleBody();
                        continue;
                      case Ln.COL_COL:
                        if (
                          (d3.consume(),
                          (o3 = d3.token()).type == Ln.IDENT &&
                            d3.nthToken(1).type == Ln.O_BRC)
                        ) {
                          (l3 = o3.text),
                            d3.consume(),
                            d3.consume(),
                            f3.startFootnoteRule(l3),
                            this.ruleStack.push('-adapt-footnote-area'),
                            f3.startRuleBody();
                          continue;
                        }
                    }
                    break;
                  case '-epubx-region':
                    d3.consume(),
                      f3.startRegionRule(),
                      (this.regionRule = true),
                      (this.actions = Ji);
                    continue;
                  case 'page':
                    d3.consume(),
                      f3.startPageRule(),
                      (this.pageRule = true),
                      (this.actions = $i);
                    continue;
                  case 'top-left-corner':
                  case 'top-left':
                  case 'top-center':
                  case 'top-right':
                  case 'top-right-corner':
                  case 'right-top':
                  case 'right-middle':
                  case 'right-bottom':
                  case 'bottom-right-corner':
                  case 'bottom-right':
                  case 'bottom-center':
                  case 'bottom-left':
                  case 'bottom-left-corner':
                  case 'left-bottom':
                  case 'left-middle':
                  case 'left-top':
                    if ((d3.consume(), (o3 = d3.token()).type == Ln.O_BRC)) {
                      d3.consume(),
                        f3.startPageMarginBoxRule(l3),
                        this.ruleStack.push(l3),
                        f3.startRuleBody();
                      continue;
                    }
                    break;
                  case '-epubx-when':
                    d3.consume(),
                      (this.propName = null),
                      (this.exprContext = sr.WHEN),
                      (this.actions = er),
                      p3.push('{');
                    continue;
                  case 'media':
                    d3.consume(),
                      (this.propName = null),
                      (this.exprContext = sr.MEDIA),
                      (this.actions = er),
                      p3.push('{');
                    continue;
                  case '-epubx-flow':
                    if (
                      d3.nthToken(1).type == Ln.IDENT &&
                      d3.nthToken(2).type == Ln.O_BRC
                    ) {
                      f3.startFlowRule(d3.nthToken(1).text),
                        d3.consume(),
                        d3.consume(),
                        d3.consume(),
                        this.ruleStack.push(l3),
                        f3.startRuleBody();
                      continue;
                    }
                    break;
                  case '-epubx-page-master':
                  case '-epubx-partition':
                  case '-epubx-partition-group':
                    d3.consume();
                    var g3 = null,
                      m3 = null,
                      v3 = [];
                    for (
                      (o3 = d3.token()).type == Ln.IDENT &&
                        ((g3 = o3.text), d3.consume(), (o3 = d3.token())),
                        o3.type == Ln.COLON &&
                          d3.nthToken(1).type == Ln.IDENT &&
                          ((m3 = d3.nthToken(1).text),
                          d3.consume(),
                          d3.consume(),
                          (o3 = d3.token()));
                      o3.type == Ln.FUNC &&
                      'class' == o3.text.toLowerCase() &&
                      d3.nthToken(1).type == Ln.IDENT &&
                      d3.nthToken(2).type == Ln.C_PAR;

                    )
                      v3.push(d3.nthToken(1).text),
                        d3.consume(),
                        d3.consume(),
                        d3.consume(),
                        (o3 = d3.token());
                    if (o3.type == Ln.O_BRC) {
                      switch ((d3.consume(), l3)) {
                        case '-epubx-page-master':
                          f3.startPageMasterRule(g3, m3, v3);
                          break;
                        case '-epubx-partition':
                          f3.startPartitionRule(g3, m3, v3);
                          break;
                        case '-epubx-partition-group':
                          f3.startPartitionGroupRule(g3, m3, v3);
                      }
                      this.ruleStack.push(l3), f3.startRuleBody();
                      continue;
                    }
                    break;
                  case '':
                    f3.error('E_CSS_UNEXPECTED_AT' + l3, o3),
                      (this.actions = or);
                    continue;
                  default:
                    f3.error('E_CSS_AT_UNKNOWN ' + l3, o3), (this.actions = ir);
                    continue;
                }
                f3.error('E_CSS_AT_SYNTAX ' + l3, o3), (this.actions = ir);
                continue;
              case Gi.ERROR_PUSH:
                if (e4 || n3) return true;
                this.errorBrackets.push(o3.type + 1), d3.consume();
                continue;
              case Gi.ERROR_POP_DECL:
                if (e4 || n3) return true;
                if (0 == this.errorBrackets.length) {
                  this.actions = Ki;
                  continue;
                }
              case Gi.ERROR_POP:
                this.errorBrackets.length > 0 &&
                  this.errorBrackets[this.errorBrackets.length - 1] ==
                    o3.type &&
                  this.errorBrackets.pop(),
                  0 == this.errorBrackets.length &&
                    o3.type == Ln.C_BRC &&
                    (this.actions = Ki),
                  d3.consume();
                continue;
              case Gi.ERROR_SEMICOL:
                if (e4 || n3) return true;
                0 == this.errorBrackets.length && (this.actions = Ki),
                  d3.consume();
                continue;
              case Gi.DONE:
                return r3 && (d3.consume(), f3.endFuncWithSelector()), true;
              default:
                if (e4 || n3) return true;
                if (i3)
                  return (
                    !!this.exprStackReduce(Ln.C_PAR, o3) &&
                    ((this.result = p3.pop()), true)
                  );
                if (r3)
                  return (
                    f3.error(
                      o3.type == Ln.INVALID ? o3.text : 'E_CSS_SYNTAX',
                      o3,
                    ),
                    false
                  );
                if (this.actions === tr && d3.hasMark()) {
                  d3.reset(), (this.actions = Ji), f3.startSelectorRule();
                  continue;
                }
                if (
                  this.actions !== ir &&
                  this.actions !== or &&
                  this.actions !== rr
                ) {
                  f3.error(
                    o3.type == Ln.INVALID ? o3.text : 'E_CSS_SYNTAX',
                    o3,
                  ),
                    (this.actions = this.isInsidePropertyOnlyRule() ? rr : or);
                  continue;
                }
                d3.consume();
                continue;
            }
          return false;
        }),
        t3
      );
    })();
    var hr = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this, null) || this).scope = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.error = function (t4, e4) {
          throw new Error(t4);
        }),
        (n3.getScope = function () {
          return this.scope;
        }),
        e3
      );
    })(Wi);
    function cr(t3, e3, n3, i3, r3) {
      return Ci(
        'parseStylesheetFromText',
        function (o3) {
          (function (t4, e4, n4, i4, r4) {
            var o4 = bi('parseStylesheet'),
              a3 = new ur(Ki, t4, e4, n4),
              s3 = null;
            return (
              r4 &&
                (s3 = (function (t5, e5, n5) {
                  var i5 = new ur(er, t5, e5, n5);
                  return (
                    i5.runParser(
                      Number.POSITIVE_INFINITY,
                      false,
                      false,
                      true,
                      false,
                    ),
                    i5.result
                  );
                })(new Ei(r4, e4), e4, n4)),
              (s3 = a3.makeCondition(i4, s3 && s3.toExpr())) &&
                (e4.startMediaRule(s3), e4.startRuleBody()),
              o4
                .loop(function () {
                  for (; !a3.runParser(100, false, false, false, false); ) {
                    if (a3.importReady) {
                      var t5 = (function () {
                        var t6 = W(a3.importURL, n4);
                        a3.importCondition &&
                          (e4.startMediaRule(a3.importCondition),
                          e4.startRuleBody());
                        var i6 = bi('parseStylesheet.import');
                        return (
                          fr(t6, e4, null, null).then(function () {
                            a3.importCondition && e4.endRule(),
                              (a3.importReady = false),
                              (a3.importURL = null),
                              (a3.importCondition = null),
                              i6.finish(true);
                          }),
                          { v: i6.result() }
                        );
                      })();
                      if ('object' == typeof t5) return t5.v;
                    }
                    var i5 = o4.timeSlice();
                    if (i5.isPending) return i5;
                  }
                  return Si(false);
                })
                .then(function () {
                  s3 && e4.endRule(), o4.finish(true);
                }),
              o4.result()
            );
          })(new Ei(t3, e3), e3, n3, i3, r3).thenFinish(o3);
        },
        function (e4, n4) {
          c2.warn(n4, 'Failed to parse stylesheet text: ' + t3),
            e4.finish(false);
        },
      );
    }
    function fr(t3, e3, n3, i3) {
      return Ci(
        'parseStylesheetFromURL',
        function (r3) {
          Bi(t3).then(function (o3) {
            o3.responseText
              ? cr(o3.responseText, e3, t3, n3, i3).then(function (e4) {
                  e4 || c2.warn('Failed to parse stylesheet from ' + t3),
                    r3.finish(true);
                })
              : r3.finish(true);
          });
        },
        function (e4, n4) {
          c2.warn(n4, 'Exception while fetching and parsing:', t3),
            e4.finish(true);
        },
      );
    }
    function dr(t3, e3, n3) {
      var i3 = new ur(tr, e3, new hr(t3), n3);
      return (
        i3.runParser(Number.POSITIVE_INFINITY, true, false, false, false),
        i3.result
      );
    }
    var pr = {
      'z-index': true,
      'column-count': true,
      'flow-linger': true,
      opacity: true,
      page: true,
      'flow-priority': true,
      utilization: true,
    };
    function gr(t3, e3, n3) {
      return e3.isExpr()
        ? (function (t4, e4, n4) {
            var i3 = e4.evaluate(t4);
            switch (typeof i3) {
              case 'number':
                return (function (t5) {
                  return !!pr[t5];
                })(n4)
                  ? i3 == Math.round(i3)
                    ? new Be(i3)
                    : new _e(i3)
                  : new De(i3, 'px');
              case 'string':
                return i3 ? dr(e4.scope, new Ei(i3, null), '') : Re;
              case 'boolean':
                return i3 ? Ye._true : Ye._false;
              case 'undefined':
                return Re;
            }
            throw new Error('E_UNEXPECTED');
          })(t3, e3.expr, n3)
        : e3;
    }
    function mr(t3, e3, n3) {
      return (t3 -= n3), 0 === e3 ? 0 === t3 : t3 % e3 == 0 && t3 / e3 >= 0;
    }
    var vr = (function () {
      function t3(t4) {
        this.matchers = t4;
      }
      return (
        (t3.prototype.matches = function () {
          return this.matchers.some(function (t4) {
            return t4.matches();
          });
        }),
        t3
      );
    })();
    var Er = (function () {
      function t3(t4) {
        this.matchers = t4;
      }
      return (
        (t3.prototype.matches = function () {
          return this.matchers.every(function (t4) {
            return t4.matches();
          });
        }),
        t3
      );
    })();
    var yr = (function () {
      function t3(t4, e3, n3) {
        (this.elementOffset = t4), (this.a = e3), (this.b = n3);
      }
      return (
        (t3.registerFragmentIndex = function (e3, n3, i3) {
          var r3 = t3.fragmentIndices;
          (!r3[e3] || r3[e3].priority <= i3) &&
            (r3[e3] = { fragmentIndex: n3, priority: i3 });
        }),
        (t3.clearFragmentIndices = function () {
          t3.fragmentIndices = {};
        }),
        (t3.prototype.matches = function () {
          var e3 = t3.fragmentIndices[this.elementOffset];
          return (
            null != e3 &&
            null != e3.fragmentIndex &&
            mr(e3.fragmentIndex, this.a, this.b)
          );
        }),
        t3
      );
    })();
    yr.fragmentIndices = {};
    var wr = (function () {
      function t3() {}
      return (
        (t3.buildViewConditionMatcher = function (t4, e3) {
          var n3 = e3.split('_');
          return 'NFS' == n3[0]
            ? new yr(t4, parseInt(n3[1], 10), parseInt(n3[2], 10))
            : null;
        }),
        (t3.buildAllMatcher = function (t4) {
          return new Er(t4);
        }),
        (t3.buildAnyMatcher = function (t4) {
          return new vr(t4);
        }),
        t3
      );
    })();
    var Nr = {
      azimuth: true,
      'border-collapse': true,
      'border-spacing': true,
      'caption-side': true,
      'clip-rule': true,
      color: true,
      'color-interpolation': true,
      'color-rendering': true,
      cursor: true,
      direction: true,
      elevation: true,
      'empty-cells': true,
      fill: true,
      'fill-opacity': true,
      'fill-rule': true,
      'font-kerning': true,
      'font-size': true,
      'font-size-adjust': true,
      'font-family': true,
      'font-feature-settings': true,
      'font-style': true,
      'font-stretch': true,
      'font-variant': true,
      'font-weight': true,
      'glyph-orientation-vertical': true,
      hyphens: true,
      'hyphenate-character': true,
      'hyphenate-limit-chars': true,
      'hyphenate-limit-last': true,
      'image-rendering': true,
      'image-resolution': true,
      'letter-spacing': true,
      'line-break': true,
      'line-height': true,
      'list-style-image': true,
      'list-style-position': true,
      'list-style-type': true,
      marker: true,
      'marker-end': true,
      'marker-mid': true,
      'marker-start': true,
      orphans: true,
      'overflow-wrap': true,
      'paint-order': true,
      'pointer-events': true,
      'pitch-range': true,
      quotes: true,
      richness: true,
      'ruby-align': true,
      'ruby-position': true,
      'speak-header': true,
      'speak-numeral': true,
      'speak-punctuation': true,
      'speech-rate': true,
      'shape-rendering': true,
      stress: true,
      stroke: true,
      'stroke-dasharray': true,
      'stroke-dashoffset': true,
      'stroke-linecap': true,
      'stroke-linejoin': true,
      'stroke-miterlimit': true,
      'stroke-opacity': true,
      'stroke-width': true,
      'tab-size': true,
      'text-align': true,
      'text-align-last': true,
      'text-anchor': true,
      'text-decoration-skip': true,
      'text-emphasis-color': true,
      'text-emphasis-position': true,
      'text-emphasis-style': true,
      'text-combine-upright': true,
      'text-indent': true,
      'text-justify': true,
      'text-rendering': true,
      'text-size-adjust': true,
      'text-transform': true,
      'text-underline-position': true,
      visibility: true,
      'voice-family': true,
      volume: true,
      'white-space': true,
      widows: true,
      'word-break': true,
      'word-spacing': true,
      'word-wrap': true,
      'writing-mode': true,
    };
    var br = ['box-decoration-break', 'image-resolution', 'orphans', 'widows'];
    function Sr() {
      return g2(exports.HOOKS.POLYFILLED_INHERITED_PROPS).reduce(function (
        t3,
        e3,
      ) {
        return t3.concat(e3());
      },
      [].concat(br));
    }
    var Cr = {
      'http://www.idpf.org/2007/ops': true,
      'http://www.w3.org/1999/xhtml': true,
      'http://www.w3.org/2000/svg': true,
    };
    var Tr = [
      'margin-%',
      'padding-%',
      'border-%-width',
      'border-%-style',
      'border-%-color',
      '%',
    ];
    var xr = ['max-%', 'min-%', '%'];
    var Ir = (function () {
      for (
        var t3 = ['left', 'right', 'top', 'bottom'],
          e3 = {
            width: true,
            height: true,
            'max-width': true,
            'max-height': true,
            'min-width': true,
            'min-height': true,
          },
          n3 = 0;
        n3 < Tr.length;
        n3++
      )
        for (var i3 = 0; i3 < t3.length; i3++)
          e3[Tr[n3].replace('%', t3[i3])] = true;
      return e3;
    })();
    function Pr(t3, e3) {
      for (var n3, i3 = {}, r3 = D(Tr); !(n3 = r3()).done; ) {
        var o3 = n3.value;
        for (var a3 in t3) {
          var s3 = o3.replace('%', a3),
            l3 = o3.replace('%', t3[a3]);
          (i3[s3] = l3), (i3[l3] = s3);
        }
      }
      for (var u3, h3 = D(xr); !(u3 = h3()).done; ) {
        var c3 = u3.value;
        for (var f3 in e3) {
          var d3 = c3.replace('%', f3),
            p3 = c3.replace('%', e3[f3]);
          (i3[d3] = p3), (i3[p3] = d3);
        }
      }
      return i3;
    }
    var Rr = Pr(
      {
        'block-start': 'right',
        'block-end': 'left',
        'inline-start': 'top',
        'inline-end': 'bottom',
      },
      { 'block-size': 'width', 'inline-size': 'height' },
    );
    var Ar = Pr(
      {
        'block-start': 'top',
        'block-end': 'bottom',
        'inline-start': 'left',
        'inline-end': 'right',
      },
      { 'block-size': 'height', 'inline-size': 'width' },
    );
    var Lr = Pr(
      {
        'block-start': 'right',
        'block-end': 'left',
        'inline-start': 'bottom',
        'inline-end': 'top',
      },
      { 'block-size': 'width', 'inline-size': 'height' },
    );
    var Or = Pr(
      {
        'block-start': 'top',
        'block-end': 'bottom',
        'inline-start': 'right',
        'inline-end': 'left',
      },
      { 'block-size': 'height', 'inline-size': 'width' },
    );
    var kr = (function () {
      function t3(t4, e4) {
        (this.value = t4), (this.priority = e4);
      }
      var e3 = t3.prototype;
      return (
        (e3.getBaseValue = function () {
          return this;
        }),
        (e3.filterValue = function (e4) {
          var n3 = this.value.visit(e4);
          return n3 === this.value ? this : new t3(n3, this.priority);
        }),
        (e3.increaseSpecificity = function (e4) {
          return 0 == e4 ? this : new t3(this.value, this.priority + e4);
        }),
        (e3.evaluate = function (t4, e4) {
          return gr(t4, this.value, e4);
        }),
        (e3.isEnabled = function (t4) {
          return true;
        }),
        t3
      );
    })();
    var Fr = (function (t3) {
      function e3(e4, n4, i3) {
        var r3;
        return ((r3 = t3.call(this, e4, n4) || this).condition = i3), r3;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getBaseValue = function () {
          return new kr(this.value, this.priority);
        }),
        (n3.filterValue = function (t4) {
          var n4 = this.value.visit(t4);
          return n4 === this.value
            ? this
            : new e3(n4, this.priority, this.condition);
        }),
        (n3.increaseSpecificity = function (t4) {
          return 0 == t4
            ? this
            : new e3(this.value, this.priority + t4, this.condition);
        }),
        (n3.isEnabled = function (t4) {
          return !!this.condition.evaluate(t4);
        }),
        e3
      );
    })(kr);
    function Dr(t3, e3, n3) {
      return (null == e3 || n3.priority > e3.priority) && n3.isEnabled(t3)
        ? n3.getBaseValue()
        : e3;
    }
    var _r = { 'region-id': true, 'fragment-selector-id': true };
    function Br(t3) {
      return !!_r[t3];
    }
    function Mr(t3) {
      return '_' != t3.charAt(0) && !_r[t3];
    }
    function Ur(t3) {
      return !!Nr[t3];
    }
    function Vr(t3, e3) {
      return t3[e3];
    }
    function Hr(t3, e3, n3) {
      n3 ? (t3[e3] = n3) : delete t3[e3];
    }
    function zr(t3, e3) {
      return t3[e3];
    }
    function Gr(t3, e3) {
      var n3 = t3[e3];
      return n3 || (t3[e3] = n3 = {}), n3;
    }
    var Wr = function (t3) {
      var e3 = t3._viewConditionalStyles;
      return e3 || (t3._viewConditionalStyles = e3 = []), e3;
    };
    function Xr(t3, e3) {
      return t3[e3];
    }
    function jr(t3, e3) {
      var n3 = t3[e3];
      return n3 || (t3[e3] = n3 = []), n3;
    }
    function Yr(t3, e3, n3, i3, r3, o3, a3) {
      for (var s3 in ([
        { id: r3, styleKey: '_pseudos' },
        { id: o3, styleKey: '_regions' },
      ].forEach(function (t4) {
        if (t4.id) {
          var n4 = Gr(e3, t4.styleKey);
          (e3 = n4[t4.id]) || (n4[t4.id] = e3 = {});
        }
      }),
      a3 && Wr(e3).push({ styles: (e3 = {}), matcher: a3 }),
      n3))
        if ('_' != s3.charAt(0))
          if (Br(s3)) {
            var l3 = Xr(n3, s3),
              u3 = jr(e3, s3);
            Array.prototype.push.apply(u3, l3);
          } else {
            var h3 = Vr(n3, s3).increaseSpecificity(i3),
              c3 = Vr(e3, s3);
            Hr(e3, s3, Dr(t3, c3, h3));
          }
    }
    function Kr(t3, e3) {
      if (t3.length > 0) {
        t3.sort(function (t4, e4) {
          return e4.getPriority() - t4.getPriority();
        });
        for (var n3 = null, i3 = t3.length - 1; i3 >= 0; i3--)
          ((n3 = t3[i3]).chained = e3), (e3 = n3);
        return n3;
      }
      return e3;
    }
    var qr = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return (
          ((i3 = t3.call(this) || this).props = e4),
          (i3.context = n4),
          (i3.propName = ''),
          i3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.setPropName = function (t4) {
          this.propName = t4;
        }),
        (n3.getFontSize = function () {
          var t4 = Vr(this.props, 'font-size').value;
          if (
            !(function (t5) {
              switch (t5.toLowerCase()) {
                case 'px':
                case 'in':
                case 'pt':
                case 'pc':
                case 'cm':
                case 'mm':
                case 'q':
                  return true;
                default:
                  return false;
              }
            })(t4.unit)
          )
            throw new Error('Unexpected state');
          return t4.num * Ut[t4.unit];
        }),
        (n3.visitNumeric = function (t4) {
          if ('font-size' === this.propName)
            return (function (t5, e5, n4) {
              var i3 = (t5 = Qr(t5, e5, n4)).unit,
                r3 = t5.num;
              return 'px' === i3
                ? t5
                : new De(
                    '%' === i3
                      ? (r3 / 100) * e5
                      : r3 * n4.queryUnitSize(i3, false),
                    'px',
                  );
            })(t4, this.getFontSize(), this.context);
          if ('em' == t4.unit || 'ex' == t4.unit || 'rem' == t4.unit)
            return Qr(t4, this.getFontSize(), this.context);
          if ('%' == t4.unit) {
            if ('line-height' === this.propName) return t4;
            var e4 = this.propName.match(/height|^(top|bottom)$/) ? 'vh' : 'vw';
            return new De(t4.num, e4);
          }
          return t4;
        }),
        (n3.visitExpr = function (t4) {
          return 'font-size' == this.propName
            ? gr(this.context, t4, this.propName).visit(this)
            : t4;
        }),
        e3
      );
    })(Ie);
    function Qr(t3, e3, n3) {
      var i3 = t3.unit,
        r3 = t3.num;
      return 'em' === i3 || 'ex' === i3
        ? new De(r3 * (Ut[i3] / Ut.em) * e3, 'px')
        : 'rem' === i3
        ? new De(r3 * n3.fontSize(), 'px')
        : t3;
    }
    var Zr = (function () {
      function t3() {}
      var e3 = t3.prototype;
      return (
        (e3.apply = function (t4) {}),
        (e3.mergeWith = function (t4) {
          return new Jr([this, t4]);
        }),
        (e3.clone = function () {
          return this;
        }),
        t3
      );
    })();
    var $r = (function (t3) {
      function e3(e4) {
        var n3;
        return ((n3 = t3.call(this) || this).conditionItem = e4), n3;
      }
      return (
        I2(e3, t3),
        (e3.prototype.apply = function (t4) {
          t4.pushConditionItem(this.conditionItem.fresh(t4));
        }),
        e3
      );
    })(Zr);
    var Jr = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).list = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          for (var e4 = 0; e4 < this.list.length; e4++) this.list[e4].apply(t4);
        }),
        (n3.mergeWith = function (t4) {
          return this.list.push(t4), this;
        }),
        (n3.clone = function () {
          return new e3([].concat(this.list));
        }),
        e3
      );
    })(Zr);
    var to = (function (t3) {
      function e3(e4, n3, i3, r3, o3) {
        var a3;
        return (
          ((a3 = t3.call(this) || this).style = e4),
          (a3.specificity = n3),
          (a3.pseudoelement = i3),
          (a3.regionId = r3),
          (a3.viewConditionId = o3),
          a3
        );
      }
      return (
        I2(e3, t3),
        (e3.prototype.apply = function (t4) {
          Yr(
            t4.context,
            t4.currentStyle,
            this.style,
            this.specificity,
            this.pseudoelement,
            this.regionId,
            t4.buildViewConditionMatcher(this.viewConditionId),
          );
        }),
        e3
      );
    })(Zr);
    var eo = (function (t3) {
      function e3() {
        var e4;
        return ((e4 = t3.call(this) || this).chained = null), e4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 0;
        }),
        (n3.makePrimary = function (t4) {
          return false;
        }),
        e3
      );
    })(Zr);
    var no = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).className = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          t4.currentClassNames.includes(this.className) &&
            this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 10;
        }),
        (n3.makePrimary = function (t4) {
          return (
            this.chained &&
              t4.insertInTable(t4.classes, this.className, this.chained),
            true
          );
        }),
        e3
      );
    })(eo);
    var io = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).id = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          (t4.currentId != this.id && t4.currentXmlId != this.id) ||
            this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 11;
        }),
        (n3.makePrimary = function (t4) {
          return (
            this.chained && t4.insertInTable(t4.ids, this.id, this.chained),
            true
          );
        }),
        e3
      );
    })(eo);
    var ro = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).localName = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          t4.currentLocalName == this.localName && this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 8;
        }),
        (n3.makePrimary = function (t4) {
          return (
            this.chained &&
              t4.insertInTable(t4.tags, this.localName, this.chained),
            true
          );
        }),
        e3
      );
    })(eo);
    var oo = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return ((i3 = t3.call(this) || this).ns = e4), (i3.localName = n4), i3;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          t4.currentLocalName == this.localName &&
            t4.currentNamespace == this.ns &&
            this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 8;
        }),
        (n3.makePrimary = function (t4) {
          if (this.chained) {
            var e4 = t4.nsPrefix[this.ns];
            e4 ||
              ((e4 = 'ns' + t4.nsCount++ + ':'), (t4.nsPrefix[this.ns] = e4)),
              t4.insertInTable(t4.nstags, e4 + this.localName, this.chained);
          }
          return true;
        }),
        e3
      );
    })(eo);
    var ao = (function (t3) {
      function e3(e4) {
        var n3;
        return ((n3 = t3.call(this) || this).epubTypePatt = e4), n3;
      }
      return (
        I2(e3, t3),
        (e3.prototype.apply = function (t4) {
          var e4 = t4.currentElement;
          if (e4 && 'a' == t4.currentLocalName) {
            var n3 = e4.getAttribute('href');
            if (n3 && n3.match(/^#/)) {
              var i3 = n3.substring(1),
                r3 = e4.ownerDocument.getElementById(i3);
              if (r3) {
                var o3 = r3.getAttributeNS(H2.epub, 'type');
                o3 && o3.match(this.epubTypePatt) && this.chained.apply(t4);
              }
            }
          }
        }),
        e3
      );
    })(eo);
    var so = (function (t3) {
      function e3(e4) {
        var n3;
        return ((n3 = t3.call(this) || this).ns = e4), n3;
      }
      return (
        I2(e3, t3),
        (e3.prototype.apply = function (t4) {
          t4.currentNamespace == this.ns && this.chained.apply(t4);
        }),
        e3
      );
    })(eo);
    var lo = (function (t3) {
      function e3(e4, n3) {
        var i3;
        return ((i3 = t3.call(this) || this).ns = e4), (i3.name = n3), i3;
      }
      return (
        I2(e3, t3),
        (e3.prototype.apply = function (t4) {
          t4.currentElement &&
            t4.currentElement.hasAttributeNS(this.ns, this.name) &&
            this.chained.apply(t4);
        }),
        e3
      );
    })(eo);
    var uo = (function (t3) {
      function e3(e4, n4, i3) {
        var r3;
        return (
          ((r3 = t3.call(this) || this).ns = e4),
          (r3.name = n4),
          (r3.value = i3),
          r3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          t4.currentElement &&
            t4.currentElement.getAttributeNS(this.ns, this.name) ==
              this.value &&
            this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 'type' == this.name && this.ns == H2.epub ? 9 : 0;
        }),
        (n3.makePrimary = function (t4) {
          return (
            'type' == this.name &&
            this.ns == H2.epub &&
            (this.chained &&
              t4.insertInTable(t4.epubtypes, this.value, this.chained),
            true)
          );
        }),
        e3
      );
    })(eo);
    var ho = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return ((i3 = t3.call(this) || this).ns = e4), (i3.name = n4), i3;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          if (t4.currentElement) {
            var e4 = t4.currentElement.getAttributeNS(this.ns, this.name);
            e4 && Cr[e4] && this.chained.apply(t4);
          }
        }),
        (n3.getPriority = function () {
          return 0;
        }),
        (n3.makePrimary = function (t4) {
          return false;
        }),
        e3
      );
    })(eo);
    var co = (function (t3) {
      function e3(e4, n3, i3) {
        var r3;
        return (
          ((r3 = t3.call(this) || this).ns = e4),
          (r3.name = n3),
          (r3.regexp = i3),
          r3
        );
      }
      return (
        I2(e3, t3),
        (e3.prototype.apply = function (t4) {
          if (t4.currentElement) {
            var e4 = t4.currentElement.getAttributeNS(this.ns, this.name);
            e4 && e4.match(this.regexp) && this.chained.apply(t4);
          }
        }),
        e3
      );
    })(eo);
    var fo = (function (t3) {
      function e3(e4) {
        var n3;
        return ((n3 = t3.call(this) || this).langRegExp = e4), n3;
      }
      return (
        I2(e3, t3),
        (e3.prototype.apply = function (t4) {
          t4.lang.match(this.langRegExp) && this.chained.apply(t4);
        }),
        e3
      );
    })(eo);
    var po = (function (t3) {
      function e3() {
        return t3.call(this) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          t4.isFirst && this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 6;
        }),
        e3
      );
    })(eo);
    var go = (function (t3) {
      function e3() {
        return t3.call(this) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          t4.isRoot && this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 12;
        }),
        e3
      );
    })(eo);
    var mo = (function (t3) {
      function e3(e4, n3) {
        var i3;
        return ((i3 = t3.call(this) || this).a = e4), (i3.b = n3), i3;
      }
      return (
        I2(e3, t3),
        (e3.prototype.matchANPlusB = function (t4) {
          return mr(t4, this.a, this.b);
        }),
        e3
      );
    })(eo);
    var vo = (function (t3) {
      function e3(e4, n4) {
        return t3.call(this, e4, n4) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          this.matchANPlusB(t4.currentSiblingOrder) && this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 5;
        }),
        e3
      );
    })(mo);
    var Eo = (function (t3) {
      function e3(e4, n4) {
        return t3.call(this, e4, n4) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          this.matchANPlusB(
            t4.currentSiblingTypeCounts[t4.currentNamespace][
              t4.currentLocalName
            ],
          ) && this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 5;
        }),
        e3
      );
    })(mo);
    var yo = (function (t3) {
      function e3(e4, n4) {
        return t3.call(this, e4, n4) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          var e4 = t4.currentFollowingSiblingOrder;
          null === e4 &&
            (e4 = t4.currentFollowingSiblingOrder =
              t4.currentElement.parentNode.childElementCount -
              t4.currentSiblingOrder +
              1),
            this.matchANPlusB(e4) && this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 4;
        }),
        e3
      );
    })(mo);
    var wo = (function (t3) {
      function e3(e4, n4) {
        return t3.call(this, e4, n4) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          var e4 = t4.currentFollowingSiblingTypeCounts;
          if (!e4[t4.currentNamespace]) {
            var n4 = t4.currentElement;
            do {
              var i3 = n4.namespaceURI,
                r3 = n4.localName,
                o3 = e4[i3];
              o3 || (o3 = e4[i3] = {}), (o3[r3] = (o3[r3] || 0) + 1);
            } while ((n4 = n4.nextElementSibling));
          }
          this.matchANPlusB(e4[t4.currentNamespace][t4.currentLocalName]) &&
            this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 4;
        }),
        e3
      );
    })(mo);
    var No = (function (t3) {
      function e3() {
        return t3.call(this) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          for (var e4 = t4.currentElement.firstChild; e4; ) {
            switch (e4.nodeType) {
              case Node.ELEMENT_NODE:
                return;
              case Node.TEXT_NODE:
                if (e4.length > 0) return;
            }
            e4 = e4.nextSibling;
          }
          this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 4;
        }),
        e3
      );
    })(eo);
    var bo = (function (t3) {
      function e3() {
        return t3.call(this) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          false === t4.currentElement.disabled && this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 5;
        }),
        e3
      );
    })(eo);
    var So = (function (t3) {
      function e3() {
        return t3.call(this) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          true === t4.currentElement.disabled && this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 5;
        }),
        e3
      );
    })(eo);
    var Co = (function (t3) {
      function e3() {
        return t3.call(this) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          var e4 = t4.currentElement;
          (true !== e4.selected && true !== e4.checked) ||
            this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 5;
        }),
        e3
      );
    })(eo);
    var To = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).condition = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          if (t4.conditions[this.condition])
            try {
              t4.dependentConditions.push(this.condition),
                this.chained.apply(t4);
            } finally {
              t4.dependentConditions.pop();
            }
        }),
        (n3.getPriority = function () {
          return 5;
        }),
        e3
      );
    })(eo);
    var xo = (function (t3) {
      function e3() {
        var e4;
        return ((e4 = t3.call(this) || this).applied = false), e4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          this.applied = true;
        }),
        (n3.clone = function () {
          var t4 = new e3();
          return (t4.applied = this.applied), t4;
        }),
        e3
      );
    })(Zr);
    var Io = (function (t3) {
      function e3(e4) {
        var n4;
        return (
          ((n4 = t3.call(this) || this).checkAppliedAction = new xo()),
          (n4.firstAction = Kr(e4, n4.checkAppliedAction)),
          n4
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          this.firstAction.apply(t4),
            this.checkAppliedAction.applied || this.chained.apply(t4),
            (this.checkAppliedAction.applied = false);
        }),
        (n3.getPriority = function () {
          return this.firstAction.getPriority();
        }),
        e3
      );
    })(eo);
    var Po = (function () {
      function t3(t4, e4, n3) {
        (this.condition = t4),
          (this.viewConditionId = e4),
          (this.viewCondition = n3);
      }
      var e3 = t3.prototype;
      return (
        (e3.increment = function (t4) {
          t4.increment(this.condition, this.viewCondition);
        }),
        (e3.decrement = function (t4) {
          t4.decrement(this.condition, this.viewCondition);
        }),
        (e3.buildViewConditionMatcher = function (t4) {
          return t4.buildViewConditionMatcher(this.viewConditionId);
        }),
        t3
      );
    })();
    var Ro = (function (t3) {
      function e3(e4, n4, i3) {
        return t3.call(this, e4, n4, i3) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.fresh = function (t4) {
          return new e3(
            this.condition,
            this.viewConditionId,
            this.buildViewConditionMatcher(t4),
          );
        }),
        (n3.push = function (t4, e4) {
          return 0 == e4 && this.increment(t4), false;
        }),
        (n3.pop = function (t4, e4) {
          return 0 == e4 && (this.decrement(t4), true);
        }),
        e3
      );
    })(Po);
    var Ao = (function (t3) {
      function e3(e4, n4, i3) {
        return t3.call(this, e4, n4, i3) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.fresh = function (t4) {
          return new e3(
            this.condition,
            this.viewConditionId,
            this.buildViewConditionMatcher(t4),
          );
        }),
        (n3.push = function (t4, e4) {
          return (
            0 == e4 ? this.increment(t4) : 1 == e4 && this.decrement(t4), false
          );
        }),
        (n3.pop = function (t4, e4) {
          return 0 == e4
            ? (this.decrement(t4), true)
            : (1 == e4 && this.increment(t4), false);
        }),
        e3
      );
    })(Po);
    var Lo = (function (t3) {
      function e3(e4, n4, i3) {
        var r3;
        return ((r3 = t3.call(this, e4, n4, i3) || this).fired = false), r3;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.fresh = function (t4) {
          return new e3(
            this.condition,
            this.viewConditionId,
            this.buildViewConditionMatcher(t4),
          );
        }),
        (n3.push = function (t4, e4) {
          return !!this.fired && (this.decrement(t4), true);
        }),
        (n3.pop = function (t4, e4) {
          return this.fired
            ? (this.decrement(t4), true)
            : (0 == e4 && ((this.fired = true), this.increment(t4)), false);
        }),
        e3
      );
    })(Po);
    var Oo = (function (t3) {
      function e3(e4, n4, i3) {
        var r3;
        return ((r3 = t3.call(this, e4, n4, i3) || this).fired = false), r3;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.fresh = function (t4) {
          return new e3(
            this.condition,
            this.viewConditionId,
            this.buildViewConditionMatcher(t4),
          );
        }),
        (n3.push = function (t4, e4) {
          return (
            this.fired &&
              (-1 == e4 ? this.increment(t4) : 0 == e4 && this.decrement(t4)),
            false
          );
        }),
        (n3.pop = function (t4, e4) {
          if (this.fired) {
            if (-1 == e4) return this.decrement(t4), true;
            0 == e4 && this.increment(t4);
          } else 0 == e4 && ((this.fired = true), this.increment(t4));
          return false;
        }),
        e3
      );
    })(Po);
    var ko = (function () {
      function t3(t4, e4) {
        (this.afterprop = t4), (this.element = e4);
      }
      var e3 = t3.prototype;
      return (
        (e3.fresh = function (t4) {
          return this;
        }),
        (e3.push = function (t4, e4) {
          return false;
        }),
        (e3.pop = function (t4, e4) {
          return (
            0 == e4 &&
            (t4.processPseudoelementProps(this.afterprop, this.element), true)
          );
        }),
        t3
      );
    })();
    var Fo = (function () {
      function t3(t4) {
        this.lang = t4;
      }
      var e3 = t3.prototype;
      return (
        (e3.fresh = function (t4) {
          return this;
        }),
        (e3.push = function (t4, e4) {
          return false;
        }),
        (e3.pop = function (t4, e4) {
          return 0 == e4 && ((t4.lang = this.lang), true);
        }),
        t3
      );
    })();
    var Do = (function () {
      function t3(t4) {
        this.oldQuotes = t4;
      }
      var e3 = t3.prototype;
      return (
        (e3.fresh = function (t4) {
          return this;
        }),
        (e3.push = function (t4, e4) {
          return false;
        }),
        (e3.pop = function (t4, e4) {
          return 0 == e4 && ((t4.quotes = this.oldQuotes), true);
        }),
        t3
      );
    })();
    var _o = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).element = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.createValueFromString = function (t4, e4) {
          switch (e4) {
            case 'url':
              return new Ue(t4 || 'about:invalid');
            case 'string':
            default:
              return new Le(t4 || '');
          }
        }),
        (n3.visitFunc = function (e4) {
          if ('attr' !== e4.name) return t3.prototype.visitFunc.call(this, e4);
          var n4,
            i3 = 'string',
            r3 = null;
          if (e4.values[0] instanceof He) {
            var o3 = e4.values[0].values;
            o3.length >= 2 && (i3 = o3[1].stringValue()),
              (r3 = o3[0].stringValue());
          } else r3 = e4.values[0].stringValue();
          return (
            (n4 = this.createValueFromString(
              e4.values.length > 1 ? e4.values[1].stringValue() : null,
              i3,
            )),
            this.element && this.element.hasAttribute(r3)
              ? this.createValueFromString(this.element.getAttribute(r3), i3)
              : n4
          );
        }),
        e3
      );
    })(Ie);
    var Bo = (function (t3) {
      function e3(e4, n4, i3) {
        var r3;
        return (
          ((r3 = t3.call(this) || this).cascade = e4),
          (r3.element = n4),
          (r3.counterResolver = i3),
          r3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.visitIdent = function (t4) {
          var e4 = this.cascade,
            n4 = e4.quotes,
            i3 = Math.floor(n4.length / 2) - 1;
          switch (t4.name) {
            case 'open-quote':
              var r3 = n4[2 * Math.min(i3, e4.quoteDepth)];
              return e4.quoteDepth++, r3;
            case 'close-quote':
              return (
                e4.quoteDepth > 0 && e4.quoteDepth--,
                n4[2 * Math.min(i3, e4.quoteDepth) + 1]
              );
            case 'no-open-quote':
              return e4.quoteDepth++, new Le('');
            case 'no-close-quote':
              return e4.quoteDepth > 0 && e4.quoteDepth--, new Le('');
          }
          return t4;
        }),
        (n3.format = function (t4, e4) {
          var n4,
            i3 = false,
            r3 = false;
          null != (n4 = e4.match(/^upper-(.*)/))
            ? ((i3 = true), (e4 = n4[1]))
            : null != (n4 = e4.match(/^lower-(.*)/)) &&
              ((r3 = true), (e4 = n4[1]));
          var o3 = '';
          return (
            Mo[e4]
              ? (o3 = (function (t5, e5) {
                  if (e5 > t5[0] || e5 <= 0 || e5 != Math.round(e5)) return '';
                  for (var n5 = '', i4 = 1; i4 < t5.length; i4 += 2) {
                    var r4 = t5[i4],
                      o4 = Math.floor(e5 / r4);
                    if (o4 > 20) return '';
                    for (e5 -= o4 * r4; o4 > 0; ) (n5 += t5[i4 + 1]), o4--;
                  }
                  return n5;
                })(Mo[e4], t4))
              : Uo[e4]
              ? (o3 = (function (t5, e5) {
                  if (e5 <= 0 || e5 != Math.round(e5)) return '';
                  var n5 = (function (t6) {
                      for (var e6 = [], n6 = 0; n6 < t6.length; )
                        if ('-' == t6.substr(n6 + 1, 1)) {
                          var i5 = t6.charCodeAt(n6),
                            r5 = t6.charCodeAt(n6 + 2);
                          n6 += 3;
                          for (var o4 = i5; o4 <= r5; o4++)
                            e6.push(String.fromCharCode(o4));
                        } else e6.push(t6.substr(n6++, 1));
                      return e6;
                    })(t5),
                    i4 = '';
                  do {
                    var r4 = --e5 % n5.length;
                    (i4 = n5[r4] + i4), (e5 = (e5 - r4) / n5.length);
                  } while (e5 > 0);
                  return i4;
                })(Uo[e4], t4))
              : null != Vo[e4]
              ? (o3 = Vo[e4])
              : 'decimal-leading-zero' == e4
              ? 1 == (o3 = '' + t4).length && (o3 = '0' + o3)
              : (o3 =
                  'cjk-ideographic' == e4 || 'trad-chinese-informal' == e4
                    ? (function (t5, e5) {
                        if (t5 > 9999 || t5 < -9999) return '' + t5;
                        if (0 == t5) return e5.digits.charAt(0);
                        var n5 = new et();
                        if (
                          (t5 < 0 && (n5.append(e5.negative), (t5 = -t5)),
                          t5 < 10)
                        )
                          n5.append(e5.digits.charAt(t5));
                        else if (!e5.formal && t5 <= 19)
                          n5.append(e5.markers.charAt(0)),
                            0 != t5 && n5.append(e5.digits.charAt(t5 - 10));
                        else {
                          var i4 = Math.floor(t5 / 1e3);
                          i4 &&
                            (n5.append(e5.digits.charAt(i4)),
                            n5.append(e5.markers.charAt(2)));
                          var r4 = Math.floor(t5 / 100) % 10;
                          r4 &&
                            (n5.append(e5.digits.charAt(r4)),
                            n5.append(e5.markers.charAt(1)));
                          var o4 = Math.floor(t5 / 10) % 10;
                          o4 &&
                            (n5.append(e5.digits.charAt(o4)),
                            n5.append(e5.markers.charAt(0)));
                          var a3 = t5 % 10;
                          a3 && n5.append(e5.digits.charAt(a3));
                        }
                        return n5.toString();
                      })(t4, Ho)
                    : '' + t4),
            i3 ? o3.toUpperCase() : r3 ? o3.toLowerCase() : o3
          );
        }),
        (n3.visitFuncCounter = function (t4) {
          var e4 = t4[0].toString(),
            n4 = t4.length > 1 ? t4[1].stringValue() : 'decimal',
            i3 = this.cascade.counters[e4];
          if (i3 && i3.length)
            return new Le(
              this.format((i3 && i3.length && i3[i3.length - 1]) || 0, n4),
            );
          var r3 = this,
            o3 = new We(
              this.counterResolver.getPageCounterVal(e4, function (t5) {
                return r3.format(t5 || 0, n4);
              }),
            );
          return new He([o3]);
        }),
        (n3.visitFuncCounters = function (t4) {
          var e4 = t4[0].toString(),
            n4 = t4[1].stringValue(),
            i3 = t4.length > 2 ? t4[2].stringValue() : 'decimal',
            r3 = this.cascade.counters[e4],
            o3 = new et();
          if (r3 && r3.length)
            for (var a3 = 0; a3 < r3.length; a3++)
              a3 > 0 && o3.append(n4), o3.append(this.format(r3[a3], i3));
          var s3 = this,
            l3 = new We(
              this.counterResolver.getPageCountersVal(e4, function (t5) {
                var e5 = [];
                if (t5.length)
                  for (var r4 = 0; r4 < t5.length; r4++)
                    e5.push(s3.format(t5[r4], i3));
                var a4 = o3.toString();
                return (
                  a4.length && e5.push(a4),
                  e5.length ? e5.join(n4) : s3.format(0, i3)
                );
              }),
            );
          return new He([l3]);
        }),
        (n3.visitFuncTargetCounter = function (t4) {
          var e4,
            n4 = t4[0];
          e4 = n4 instanceof Ue ? n4.url : n4.stringValue();
          var i3 = t4[1].toString(),
            r3 = t4.length > 2 ? t4[2].stringValue() : 'decimal',
            o3 = this,
            a3 = new We(
              this.counterResolver.getTargetCounterVal(e4, i3, function (t5) {
                return o3.format(t5 || 0, r3);
              }),
            );
          return new He([a3]);
        }),
        (n3.visitFuncTargetCounters = function (t4) {
          var e4,
            n4 = t4[0];
          e4 = n4 instanceof Ue ? n4.url : n4.stringValue();
          var i3 = t4[1].toString(),
            r3 = t4[2].stringValue(),
            o3 = t4.length > 3 ? t4[3].stringValue() : 'decimal',
            a3 = this,
            s3 = new We(
              this.counterResolver.getTargetCountersVal(e4, i3, function (t5) {
                var e5 = t5.map(function (t6) {
                  return a3.format(t6, o3);
                });
                return e5.length ? e5.join(r3) : a3.format(0, o3);
              }),
            );
          return new He([s3]);
        }),
        (n3.visitFunc = function (t4) {
          switch (t4.name) {
            case 'counter':
              if (t4.values.length <= 2)
                return this.visitFuncCounter(t4.values);
              break;
            case 'counters':
              if (t4.values.length <= 3)
                return this.visitFuncCounters(t4.values);
              break;
            case 'target-counter':
              if (t4.values.length <= 3)
                return this.visitFuncTargetCounter(t4.values);
              break;
            case 'target-counters':
              if (t4.values.length <= 4)
                return this.visitFuncTargetCounters(t4.values);
          }
          return c2.warn('E_CSS_CONTENT_PROP:', t4.toString()), new Le('');
        }),
        e3
      );
    })(Ie);
    var Mo = {
      roman: [
        4999,
        1e3,
        'M',
        900,
        'CM',
        500,
        'D',
        400,
        'CD',
        100,
        'C',
        90,
        'XC',
        50,
        'L',
        40,
        'XL',
        10,
        'X',
        9,
        'IX',
        5,
        'V',
        4,
        'IV',
        1,
        'I',
      ],
      armenian: [
        9999,
        9e3,
        '',
        8e3,
        '',
        7e3,
        '',
        6e3,
        '',
        5e3,
        '',
        4e3,
        '',
        3e3,
        '',
        2e3,
        '',
        1e3,
        '',
        900,
        '',
        800,
        '',
        700,
        '',
        600,
        '',
        500,
        '',
        400,
        '',
        300,
        '',
        200,
        '',
        100,
        '',
        90,
        '',
        80,
        '',
        70,
        '',
        60,
        '',
        50,
        '',
        40,
        '',
        30,
        '',
        20,
        '',
        10,
        '',
        9,
        '',
        8,
        '',
        7,
        '',
        6,
        '',
        5,
        '',
        4,
        '',
        3,
        '',
        2,
        '',
        1,
        '',
      ],
      georgian: [
        19999,
        1e4,
        '',
        9e3,
        '',
        8e3,
        '',
        7e3,
        '',
        6e3,
        '',
        5e3,
        '',
        4e3,
        '',
        3e3,
        '',
        2e3,
        '',
        1e3,
        '',
        900,
        '',
        800,
        '',
        700,
        '',
        600,
        '',
        500,
        '',
        400,
        '',
        300,
        '',
        200,
        '',
        100,
        '',
        90,
        '',
        80,
        '',
        70,
        '',
        60,
        '',
        50,
        '',
        40,
        '',
        30,
        '',
        20,
        '',
        10,
        '',
        9,
        '',
        8,
        '',
        7,
        '',
        6,
        '',
        5,
        '',
        4,
        '',
        3,
        '',
        2,
        '',
        1,
        '',
      ],
      hebrew: [
        999,
        400,
        '',
        300,
        '',
        200,
        '',
        100,
        '',
        90,
        '',
        80,
        '',
        70,
        '',
        60,
        '',
        50,
        '',
        40,
        '',
        30,
        '',
        20,
        '',
        19,
        '',
        18,
        '',
        17,
        '',
        16,
        '',
        15,
        '',
        10,
        '',
        9,
        '',
        8,
        '',
        7,
        '',
        6,
        '',
        5,
        '',
        4,
        '',
        3,
        '',
        2,
        '',
        1,
        '',
      ],
    };
    var Uo = {
      latin: 'a-z',
      alpha: 'a-z',
      greek: '--',
      russian: '---',
    };
    var Vo = { square: '', disc: '', circle: '', none: '' };
    var Ho = {
      formal: false,
      digits: '',
      markers: '',
      negative: '',
    };
    function zo(t3, e3) {
      for (var n3 in t3) e3[n3] = t3[n3].clone();
    }
    var Go;
    var Wo = (function () {
      function t3() {
        (this.nsCount = 0),
          (this.nsPrefix = {}),
          (this.tags = {}),
          (this.nstags = {}),
          (this.epubtypes = {}),
          (this.classes = {}),
          (this.ids = {}),
          (this.pagetypes = {}),
          (this.order = 0);
      }
      var e3 = t3.prototype;
      return (
        (e3.clone = function () {
          var e4 = new t3();
          for (var n3 in ((e4.nsCount = this.nsCount), this.nsPrefix))
            e4.nsPrefix[n3] = this.nsPrefix[n3];
          return (
            zo(this.tags, e4.tags),
            zo(this.nstags, e4.nstags),
            zo(this.epubtypes, e4.epubtypes),
            zo(this.classes, e4.classes),
            zo(this.ids, e4.ids),
            zo(this.pagetypes, e4.pagetypes),
            (e4.order = this.order),
            e4
          );
        }),
        (e3.insertInTable = function (t4, e4, n3) {
          var i3 = t4[e4];
          i3 && (n3 = i3.mergeWith(n3)), (t4[e4] = n3);
        }),
        (e3.createInstance = function (t4, e4, n3, i3) {
          return new Xo(this, t4, e4, n3, i3);
        }),
        (e3.nextOrder = function () {
          return (this.order += 1 / 1048576);
        }),
        t3
      );
    })();
    var Xo = (function () {
      function t3(t4, e4, n3, i3, r3) {
        (this.context = e4),
          (this.counterListener = n3),
          (this.counterResolver = i3),
          (this.stack = [[], []]),
          (this.conditions = {}),
          (this.currentElement = null),
          (this.currentElementOffset = null),
          (this.currentStyle = null),
          (this.currentClassNames = null),
          (this.currentLocalName = ''),
          (this.currentNamespace = ''),
          (this.currentId = ''),
          (this.currentXmlId = ''),
          (this.currentNSTag = ''),
          (this.currentEpubTypes = null),
          (this.currentPageType = null),
          (this.isFirst = true),
          (this.isRoot = true),
          (this.counters = {}),
          (this.counterScoping = [{}]),
          (this.quoteDepth = 0),
          (this.lang = ''),
          (this.siblingOrderStack = [0]),
          (this.currentSiblingOrder = 0),
          (this.siblingTypeCountsStack = [{}]),
          (this.currentFollowingSiblingOrder = null),
          (this.followingSiblingTypeCountsStack = [{}]),
          (this.viewConditions = {}),
          (this.dependentConditions = []),
          (this.code = t4),
          (this.quotes = [new Le(''), new Le(''), new Le(''), new Le('')]),
          (this.currentSiblingTypeCounts = this.siblingTypeCountsStack[0]),
          (this.followingSiblingOrderStack = [
            this.currentFollowingSiblingOrder,
          ]),
          (this.currentFollowingSiblingTypeCounts = this.siblingTypeCountsStack[0]);
      }
      var e3 = t3.prototype;
      return (
        (e3.pushConditionItem = function (t4) {
          this.stack[this.stack.length - 1].push(t4);
        }),
        (e3.increment = function (t4, e4) {
          (this.conditions[t4] = (this.conditions[t4] || 0) + 1),
            e4 &&
              (this.viewConditions[t4]
                ? this.viewConditions[t4].push(e4)
                : (this.viewConditions[t4] = [e4]));
        }),
        (e3.decrement = function (t4, e4) {
          this.conditions[t4]--,
            this.viewConditions[t4] &&
              ((this.viewConditions[t4] = this.viewConditions[t4].filter(
                function (t5) {
                  return t5 !== e4;
                },
              )),
              0 === this.viewConditions[t4].length &&
                delete this.viewConditions[t4]);
        }),
        (e3.buildViewConditionMatcher = function (t4) {
          var e4 = this,
            n3 = null;
          t4 &&
            (n3 = wr.buildViewConditionMatcher(this.currentElementOffset, t4));
          var i3 = this.dependentConditions
            .map(function (t5) {
              var n4 = e4.viewConditions[t5];
              return n4 && n4.length > 0
                ? 1 === n4.length
                  ? n4[0]
                  : wr.buildAnyMatcher([].concat(n4))
                : null;
            })
            .filter(function (t5) {
              return t5;
            });
          return i3.length <= 0
            ? n3
            : null === n3
            ? 1 === i3.length
              ? i3[0]
              : wr.buildAllMatcher(i3)
            : wr.buildAllMatcher([n3].concat(i3));
        }),
        (e3.applyAction = function (t4, e4) {
          var n3 = t4[e4];
          n3 && n3.apply(this);
        }),
        (e3.pushRule = function (t4, e4, n3) {
          (this.currentElement = null),
            (this.currentElementOffset = null),
            (this.currentStyle = n3),
            (this.currentNamespace = ''),
            (this.currentLocalName = ''),
            (this.currentId = ''),
            (this.currentXmlId = ''),
            (this.currentClassNames = t4),
            (this.currentNSTag = ''),
            (this.currentEpubTypes = jo),
            (this.currentPageType = e4),
            this.applyActions();
        }),
        (e3.defineCounter = function (t4, e4) {
          this.counters[t4]
            ? this.counters[t4].push(e4)
            : (this.counters[t4] = [e4]);
          var n3 = this.counterScoping[this.counterScoping.length - 1];
          n3 || (this.counterScoping[this.counterScoping.length - 1] = n3 = {}),
            (n3[t4] = true);
        }),
        (e3.pushCounters = function (t4) {
          var e4 = Ye.inline,
            n3 = t4.display;
          n3 && (e4 = n3.evaluate(this.context));
          var i3 = null,
            r3 = null,
            o3 = null,
            a3 = t4['counter-reset'];
          if (a3) {
            var s3 = a3.evaluate(this.context);
            s3 && (i3 = Pn(s3, true));
          }
          var l3 = t4['counter-set'];
          if (l3) {
            var u3 = l3.evaluate(this.context);
            u3 && (o3 = Pn(u3, false));
          }
          var h3 = t4['counter-increment'];
          if (h3) {
            var c3 = h3.evaluate(this.context);
            c3 && (r3 = Pn(c3, false));
          }
          if (
            (('ol' != this.currentLocalName && 'ul' != this.currentLocalName) ||
              this.currentNamespace != H2.XHTML ||
              (i3 || (i3 = {}), (i3['ua-list-item'] = 0)),
            e4 === Ye.list_item && (r3 || (r3 = {}), (r3['ua-list-item'] = 1)),
            i3)
          )
            for (var f3 in i3) this.defineCounter(f3, i3[f3]);
          if (o3)
            for (var d3 in o3)
              if (this.counters[d3]) {
                var p3 = this.counters[d3];
                p3[p3.length - 1] = o3[d3];
              } else this.defineCounter(d3, o3[d3]);
          if (r3)
            for (var g3 in r3) {
              this.counters[g3] || this.defineCounter(g3, 0);
              var m3 = this.counters[g3];
              m3[m3.length - 1] += r3[g3];
            }
          if (e4 === Ye.list_item) {
            var v3 = this.counters['ua-list-item'];
            t4['ua-list-item-count'] = new kr(new _e(v3[v3.length - 1]), 0);
          }
          this.counterScoping.push(null);
        }),
        (e3.popCounters = function () {
          var t4 = this.counterScoping.pop();
          if (t4)
            for (var e4 in t4) {
              var n3 = this.counters[e4];
              n3 && (1 == n3.length ? delete this.counters[e4] : n3.pop());
            }
        }),
        (e3.processPseudoelementProps = function (t4, e4) {
          this.pushCounters(t4),
            t4.content &&
              (t4.content = t4.content.filterValue(
                new Bo(this, e4, this.counterResolver),
              )),
            this.popCounters();
        }),
        (e3.pushElement = function (t4, e4, n3) {
          var i3 = this;
          (this.currentPageType = null),
            (this.currentElement = t4),
            (this.currentElementOffset = n3),
            (this.currentStyle = e4),
            (this.currentNamespace = t4.namespaceURI),
            (this.currentLocalName = t4.localName);
          var r3 = this.code.nsPrefix[this.currentNamespace];
          (this.currentNSTag = r3 ? r3 + this.currentLocalName : ''),
            (this.currentId = t4.getAttribute('id')),
            (this.currentXmlId = t4.getAttributeNS(H2.XML, 'id'));
          var o3 = t4.getAttribute('class');
          this.currentClassNames = o3 ? o3.split(/\s+/) : jo;
          var a3 = t4.getAttributeNS(H2.epub, 'type');
          if (
            ((this.currentEpubTypes = a3 ? a3.split(/\s+/) : jo),
            'style' == this.currentLocalName && this.currentNamespace == H2.FB2)
          ) {
            var s3 = t4.getAttribute('name') || '';
            this.currentClassNames = [s3];
          }
          var l3 = tt(t4);
          l3 &&
            (this.stack[this.stack.length - 1].push(new Fo(this.lang)),
            (this.lang = l3.toLowerCase()));
          var u3 = this.isRoot,
            h3 = this.siblingOrderStack;
          (this.currentSiblingOrder = ++h3[h3.length - 1]), h3.push(0);
          var c3 = this.siblingTypeCountsStack,
            f3 = (this.currentSiblingTypeCounts = c3[c3.length - 1]),
            d3 = f3[this.currentNamespace];
          d3 || (d3 = f3[this.currentNamespace] = {}),
            (d3[this.currentLocalName] = (d3[this.currentLocalName] || 0) + 1),
            c3.push({});
          var p3 = this.followingSiblingOrderStack;
          (this.currentFollowingSiblingOrder =
            null !== p3[p3.length - 1] ? --p3[p3.length - 1] : null),
            p3.push(null);
          var g3 = this.followingSiblingTypeCountsStack,
            m3 = (this.currentFollowingSiblingTypeCounts = g3[g3.length - 1]);
          m3 &&
            m3[this.currentNamespace] &&
            m3[this.currentNamespace][this.currentLocalName]--,
            g3.push({}),
            this.applyActions(),
            this.applyAttrFilter(t4);
          var v3 = e4.quotes,
            E2 = null;
          if (v3) {
            var y3 = v3.evaluate(this.context);
            y3 &&
              ((E2 = new Do(this.quotes)),
              y3 === Ye.none
                ? (this.quotes = [new Le(''), new Le('')])
                : y3 instanceof He && (this.quotes = y3.values));
          }
          this.pushCounters(this.currentStyle);
          var w3 =
            this.currentId ||
            this.currentXmlId ||
            t4.getAttribute('name') ||
            '';
          if (u3 || w3) {
            var N3 = {};
            Object.keys(this.counters).forEach(function (t5) {
              N3[t5] = Array.from(i3.counters[t5]);
            }),
              this.counterListener.countersOfId(w3, N3);
          }
          var b3 = zr(this.currentStyle, '_pseudos');
          if (b3)
            for (var S3, C3 = true, T3 = D(Yo); !(S3 = T3()).done; ) {
              var x3 = S3.value;
              x3 || (C3 = false);
              var I3 = b3[x3];
              I3 &&
                (C3
                  ? this.processPseudoelementProps(I3, t4)
                  : this.stack[this.stack.length - 2].push(new ko(I3, t4)));
            }
          E2 && this.stack[this.stack.length - 2].push(E2);
        }),
        (e3.applyAttrFilterInner = function (t4, e4) {
          for (var n3 in e4) Mr(n3) && (e4[n3] = e4[n3].filterValue(t4));
        }),
        (e3.applyAttrFilter = function (t4) {
          var e4 = new _o(t4),
            n3 = this.currentStyle,
            i3 = zr(n3, '_pseudos');
          for (var r3 in i3) this.applyAttrFilterInner(e4, i3[r3]);
          this.applyAttrFilterInner(e4, n3);
        }),
        (e3.applyActions = function () {
          var t4;
          for (t4 = 0; t4 < this.currentClassNames.length; t4++)
            this.applyAction(this.code.classes, this.currentClassNames[t4]);
          for (t4 = 0; t4 < this.currentEpubTypes.length; t4++)
            this.applyAction(this.code.epubtypes, this.currentEpubTypes[t4]);
          this.applyAction(this.code.ids, this.currentId),
            this.applyAction(this.code.tags, this.currentLocalName),
            '' != this.currentLocalName &&
              this.applyAction(this.code.tags, '*'),
            this.applyAction(this.code.nstags, this.currentNSTag),
            null !== this.currentPageType &&
              (this.applyAction(this.code.pagetypes, this.currentPageType),
              this.applyAction(this.code.pagetypes, '*')),
            (this.currentElement = null),
            (this.currentDoc = null),
            this.stack.push([]);
          for (var e4 = 1; e4 >= -1; --e4) {
            var n3 = this.stack[this.stack.length - e4 - 2];
            for (t4 = 0; t4 < n3.length; )
              n3[t4].push(this, e4) ? n3.splice(t4, 1) : t4++;
          }
          (this.isFirst = true), (this.isRoot = false);
        }),
        (e3.pop = function () {
          for (var t4 = 1; t4 >= -1; --t4)
            for (
              var e4 = this.stack[this.stack.length - t4 - 2], n3 = 0;
              n3 < e4.length;

            )
              e4[n3].pop(this, t4) ? e4.splice(n3, 1) : n3++;
          this.stack.pop(), (this.isFirst = false);
        }),
        (e3.popRule = function () {
          this.pop();
        }),
        (e3.popElement = function (t4) {
          this.siblingOrderStack.pop(),
            this.siblingTypeCountsStack.pop(),
            this.followingSiblingOrderStack.pop(),
            this.followingSiblingTypeCountsStack.pop(),
            this.pop(),
            this.popCounters();
        }),
        t3
      );
    })();
    var jo = [];
    var Yo = [
      'before',
      'transclusion-before',
      'footnote-call',
      'footnote-marker',
      'inner',
      'first-letter',
      'first-line',
      '',
      'transclusion-after',
      'after',
    ];
    !(function (t3) {
      (t3[(t3.TOP = 0)] = 'TOP'),
        (t3[(t3.SELECTOR = 1)] = 'SELECTOR'),
        (t3[(t3.RULE = 2)] = 'RULE');
    })(Go || (Go = {}));
    var Ko = null;
    var qo = (function (t3) {
      function e3(e4, n4, i3, r3, o3, a3, s3) {
        var l3;
        return (
          ((l3 = t3.call(this, e4, n4, s3) || this).condition = i3),
          (l3.regionId = o3),
          (l3.validatorSet = a3),
          (l3.chain = null),
          (l3.specificity = 0),
          (l3.elementStyle = null),
          (l3.conditionCount = 0),
          (l3.pseudoelement = null),
          (l3.footnoteContent = false),
          (l3.viewConditionId = null),
          (l3.cascade = r3 ? r3.cascade : Ko ? Ko.clone() : new Wo()),
          (l3.state = Go.TOP),
          l3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.insertNonPrimary = function (t4) {
          this.cascade.insertInTable(this.cascade.tags, '*', t4);
        }),
        (n3.processChain = function (t4) {
          var e4 = Kr(this.chain, t4);
          (e4 !== t4 && e4.makePrimary(this.cascade)) ||
            this.insertNonPrimary(e4);
        }),
        (n3.isInsideSelectorRule = function (t4) {
          return this.state != Go.TOP && (this.reportAndSkip(t4), true);
        }),
        (n3.tagSelector = function (t4, e4) {
          (e4 || t4) &&
            ((this.specificity += 1),
            this.chain.push(
              e4 && t4
                ? new oo(t4, e4.toLowerCase())
                : e4
                ? new ro(e4.toLowerCase())
                : new so(t4),
            ));
        }),
        (n3.classSelector = function (t4) {
          if (this.pseudoelement)
            return (
              c2.warn('::' + this.pseudoelement, 'followed by .' + t4),
              void this.chain.push(new To(''))
            );
          (this.specificity += 256), this.chain.push(new no(t4));
        }),
        (n3.pseudoclassSelector = function (t4, e4) {
          if (this.pseudoelement)
            return (
              c2.warn('::' + this.pseudoelement, 'followed by :' + t4),
              void this.chain.push(new To(''))
            );
          switch (t4.toLowerCase()) {
            case 'enabled':
              this.chain.push(new bo());
              break;
            case 'disabled':
              this.chain.push(new So());
              break;
            case 'checked':
              this.chain.push(new Co());
              break;
            case 'root':
              this.chain.push(new go());
              break;
            case 'link':
              this.chain.push(new ro('a')), this.chain.push(new lo('', 'href'));
              break;
            case '-adapt-href-epub-type':
            case 'href-epub-type':
              if (e4 && 1 == e4.length && 'string' == typeof e4[0]) {
                var n4 = new RegExp('(^|s)' + lt(e4[0]) + '($|s)');
                this.chain.push(new ao(n4));
              } else this.chain.push(new To(''));
              break;
            case '-adapt-footnote-content':
            case 'footnote-content':
              this.footnoteContent = true;
              break;
            case 'visited':
            case 'active':
            case 'hover':
            case 'focus':
              this.chain.push(new To(''));
              break;
            case 'lang':
              this.chain.push(
                e4 && 1 == e4.length && 'string' == typeof e4[0]
                  ? new fo(new RegExp('^' + lt(e4[0].toLowerCase()) + '($|-)'))
                  : new To(''),
              );
              break;
            case 'nth-child':
            case 'nth-last-child':
            case 'nth-of-type':
            case 'nth-last-of-type':
              var i3 = Qo[t4.toLowerCase()];
              this.chain.push(
                e4 && 2 == e4.length ? new i3(e4[0], e4[1]) : new To(''),
              );
              break;
            case 'first-child':
              this.chain.push(new po());
              break;
            case 'last-child':
              this.chain.push(new yo(0, 1));
              break;
            case 'first-of-type':
              this.chain.push(new Eo(0, 1));
              break;
            case 'last-of-type':
              this.chain.push(new wo(0, 1));
              break;
            case 'only-child':
              this.chain.push(new po()), this.chain.push(new yo(0, 1));
              break;
            case 'only-of-type':
              this.chain.push(new Eo(0, 1)), this.chain.push(new wo(0, 1));
              break;
            case 'empty':
              this.chain.push(new No());
              break;
            case 'before':
            case 'after':
            case 'first-line':
            case 'first-letter':
              return void this.pseudoelementSelector(t4, e4);
            default:
              c2.warn('unknown pseudo-class selector: ' + t4),
                this.chain.push(new To(''));
          }
          this.specificity += 256;
        }),
        (n3.pseudoelementSelector = function (t4, e4) {
          switch (t4) {
            case 'before':
            case 'after':
            case 'first-line':
            case 'first-letter':
            case 'footnote-call':
            case 'footnote-marker':
            case 'inner':
            case 'after-if-continues':
              this.pseudoelement
                ? (c2.warn(
                    'Double pseudoelement ::' + this.pseudoelement + '::' + t4,
                  ),
                  this.chain.push(new To('')))
                : (this.pseudoelement = t4);
              break;
            case 'first-n-lines':
              if (e4 && 1 == e4.length && 'number' == typeof e4[0]) {
                var n4 = Math.round(e4[0]);
                if (n4 > 0 && n4 == e4[0]) {
                  this.pseudoelement
                    ? (c2.warn(
                        'Double pseudoelement ::' +
                          this.pseudoelement +
                          '::' +
                          t4,
                      ),
                      this.chain.push(new To('')))
                    : (this.pseudoelement = 'first-' + n4 + '-lines');
                  break;
                }
              }
              this.chain.push(new To(''));
              break;
            case 'nth-fragment':
              e4 && 2 == e4.length
                ? (this.viewConditionId = 'NFS_' + e4[0] + '_' + e4[1])
                : this.chain.push(new To(''));
              break;
            default:
              c2.warn('Unrecognized pseudoelement: ::' + t4),
                this.chain.push(new To(''));
          }
          this.specificity += 1;
        }),
        (n3.idSelector = function (t4) {
          (this.specificity += 65536), this.chain.push(new io(t4));
        }),
        (n3.attributeSelector = function (t4, e4, n4, i3) {
          var r3;
          switch (
            ((this.specificity += 256),
            (e4 = e4.toLowerCase()),
            (i3 = i3 || ''),
            n4)
          ) {
            case Ln.EOF:
              r3 = new lo(t4, e4);
              break;
            case Ln.EQ:
              r3 = new uo(t4, e4, i3);
              break;
            case Ln.TILDE_EQ:
              r3 =
                !i3 || i3.match(/\s/)
                  ? new To('')
                  : new co(t4, e4, new RegExp('(^|\\s)' + lt(i3) + '($|\\s)'));
              break;
            case Ln.BAR_EQ:
              r3 = new co(t4, e4, new RegExp('^' + lt(i3) + '($|-)'));
              break;
            case Ln.HAT_EQ:
              r3 = i3 ? new co(t4, e4, new RegExp('^' + lt(i3))) : new To('');
              break;
            case Ln.DOLLAR_EQ:
              r3 = i3 ? new co(t4, e4, new RegExp(lt(i3) + '$')) : new To('');
              break;
            case Ln.STAR_EQ:
              r3 = i3 ? new co(t4, e4, new RegExp(lt(i3))) : new To('');
              break;
            case Ln.COL_COL:
              'supported' == i3
                ? (r3 = new ho(t4, e4))
                : (c2.warn('Unsupported :: attr selector op:', i3),
                  (r3 = new To('')));
              break;
            default:
              c2.warn('Unsupported attr selector:', n4), (r3 = new To(''));
          }
          this.chain.push(r3);
        }),
        (n3.descendantSelector = function () {
          var t4 = 'd' + Zo++;
          this.processChain(new $r(new Ro(t4, this.viewConditionId, null))),
            (this.chain = [new To(t4)]),
            (this.viewConditionId = null);
        }),
        (n3.childSelector = function () {
          var t4 = 'c' + Zo++;
          this.processChain(new $r(new Ao(t4, this.viewConditionId, null))),
            (this.chain = [new To(t4)]),
            (this.viewConditionId = null);
        }),
        (n3.adjacentSiblingSelector = function () {
          var t4 = 'a' + Zo++;
          this.processChain(new $r(new Lo(t4, this.viewConditionId, null))),
            (this.chain = [new To(t4)]),
            (this.viewConditionId = null);
        }),
        (n3.followingSiblingSelector = function () {
          var t4 = 'f' + Zo++;
          this.processChain(new $r(new Oo(t4, this.viewConditionId, null))),
            (this.chain = [new To(t4)]),
            (this.viewConditionId = null);
        }),
        (n3.nextSelector = function () {
          this.finishChain(),
            (this.pseudoelement = null),
            (this.footnoteContent = false),
            (this.specificity = 0),
            (this.chain = []);
        }),
        (n3.startSelectorRule = function () {
          this.isInsideSelectorRule('E_CSS_UNEXPECTED_SELECTOR') ||
            ((this.state = Go.SELECTOR),
            (this.elementStyle = {}),
            (this.pseudoelement = null),
            (this.specificity = 0),
            (this.footnoteContent = false),
            (this.chain = []));
        }),
        (n3.error = function (e4, n4) {
          t3.prototype.error.call(this, e4, n4),
            this.state == Go.SELECTOR && (this.state = Go.TOP);
        }),
        (n3.startStylesheet = function (e4) {
          t3.prototype.startStylesheet.call(this, e4), (this.state = Go.TOP);
        }),
        (n3.startRuleBody = function () {
          this.finishChain(),
            t3.prototype.startRuleBody.call(this),
            this.state == Go.SELECTOR && (this.state = Go.TOP);
        }),
        (n3.endRule = function () {
          t3.prototype.endRule.call(this), (this.insideSelectorRule = Go.TOP);
        }),
        (n3.finishChain = function () {
          if (this.chain) {
            var t4 = this.specificity + this.cascade.nextOrder();
            this.processChain(this.makeApplyRuleAction(t4)),
              (this.chain = null),
              (this.pseudoelement = null),
              (this.viewConditionId = null),
              (this.footnoteContent = false),
              (this.specificity = 0);
          }
        }),
        (n3.makeApplyRuleAction = function (t4) {
          var e4 = this.regionId;
          return (
            this.footnoteContent && (e4 = e4 ? 'xxx-bogus-xxx' : 'footnote'),
            new to(
              this.elementStyle,
              t4,
              this.pseudoelement,
              e4,
              this.viewConditionId,
            )
          );
        }),
        (n3.special = function (t4, e4) {
          var n4;
          (n4 = this.condition ? new Fr(e4, 0, this.condition) : new kr(e4, 0)),
            jr(this.elementStyle, t4).push(n4);
        }),
        (n3.property = function (t4, e4, n4) {
          this.validatorSet.validatePropertyAndHandleShorthand(
            t4,
            e4,
            n4,
            this,
          );
        }),
        (n3.invalidPropertyValue = function (t4, e4) {
          this.report('E_INVALID_PROPERTY_VALUE ' + t4 + ': ' + e4.toString());
        }),
        (n3.unknownProperty = function (t4, e4) {
          this.report('E_INVALID_PROPERTY ' + t4 + ': ' + e4.toString());
        }),
        (n3.simpleProperty = function (t4, e4, n4) {
          'display' != t4 ||
            (e4 !== Ye.oeb_page_head && e4 !== Ye.oeb_page_foot) ||
            (this.simpleProperty(
              'flow-options',
              new He([Ye.exclusive, Ye._static]),
              n4,
            ),
            this.simpleProperty('flow-into', e4, n4),
            (e4 = Ye.block)),
            g2('SIMPLE_PROPERTY').forEach(function (i4) {
              var r4 = i4({ name: t4, value: e4, important: n4 });
              (t4 = r4.name), (e4 = r4.value), (n4 = r4.important);
            });
          var i3 = n4
              ? this.getImportantSpecificity()
              : this.getBaseSpecificity(),
            r3 = this.condition
              ? new Fr(e4, i3, this.condition)
              : new kr(e4, i3);
          Hr(this.elementStyle, t4, r3);
        }),
        (n3.finish = function () {
          return this.cascade;
        }),
        (n3.startFuncWithSelector = function (t4) {
          switch (t4) {
            case 'not':
              var e4 = new $o(this);
              e4.startSelectorRule(), this.owner.pushHandler(e4);
          }
        }),
        e3
      );
    })(Yi);
    var Qo = {
      'nth-child': vo,
      'nth-of-type': Eo,
      'nth-last-child': yo,
      'nth-last-of-type': wo,
    };
    var Zo = 0;
    var $o = (function (t3) {
      function e3(e4) {
        var n4;
        return (
          ((n4 =
            t3.call(
              this,
              e4.scope,
              e4.owner,
              e4.condition,
              e4,
              e4.regionId,
              e4.validatorSet,
              false,
            ) || this).parent = e4),
          (n4.parentChain = e4.chain),
          n4
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.startFuncWithSelector = function (t4) {
          'not' == t4 && this.reportAndSkip('E_CSS_UNEXPECTED_NOT');
        }),
        (n3.startRuleBody = function () {
          this.reportAndSkip('E_CSS_UNEXPECTED_RULE_BODY');
        }),
        (n3.nextSelector = function () {
          this.reportAndSkip('E_CSS_UNEXPECTED_NEXT_SELECTOR');
        }),
        (n3.endFuncWithSelector = function () {
          this.chain &&
            this.chain.length > 0 &&
            this.parentChain.push(new Io(this.chain)),
            (this.parent.specificity += this.specificity),
            this.owner.popHandler();
        }),
        (n3.error = function (e4, n4) {
          t3.prototype.error.call(this, e4, n4), this.owner.popHandler();
        }),
        e3
      );
    })(qo);
    var Jo = (function (t3) {
      function e3(e4, n3) {
        return t3.call(this, e4, n3, false) || this;
      }
      return (
        I2(e3, t3),
        (e3.prototype.property = function (t4, e4, n3) {
          if (this.scope.values[t4])
            this.error('E_CSS_NAME_REDEFINED ' + t4, this.getCurrentToken());
          else {
            var i3 = t4.match(/height|^(top|bottom)$/) ? 'vh' : 'vw',
              r3 = new fe(this.scope, 100, i3);
            this.scope.defineName(t4, e4.toExpr(this.scope, r3));
          }
        }),
        e3
      );
    })(Yi);
    var ta = (function (t3) {
      function e3(e4, n4, i3, r3, o3) {
        var a3;
        return (
          ((a3 = t3.call(this, e4, n4, false) || this).condition = i3),
          (a3.elementStyle = r3),
          (a3.validatorSet = o3),
          (a3.order = 0),
          a3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.property = function (t4, e4, n4) {
          n4
            ? c2.warn('E_IMPORTANT_NOT_ALLOWED')
            : this.validatorSet.validatePropertyAndHandleShorthand(
                t4,
                e4,
                n4,
                this,
              );
        }),
        (n3.invalidPropertyValue = function (t4, e4) {
          c2.warn('E_INVALID_PROPERTY_VALUE', t4 + ':', e4.toString());
        }),
        (n3.unknownProperty = function (t4, e4) {
          c2.warn('E_INVALID_PROPERTY', t4 + ':', e4.toString());
        }),
        (n3.simpleProperty = function (t4, e4, n4) {
          var i3 = n4
            ? this.getImportantSpecificity()
            : this.getBaseSpecificity();
          (i3 += this.order), (this.order += 1 / 1048576);
          var r3 = this.condition
            ? new Fr(e4, i3, this.condition)
            : new kr(e4, i3);
          Hr(this.elementStyle, t4, r3);
        }),
        e3
      );
    })(Yi);
    var ea = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return (
          ((i3 = t3.call(this, e4) || this).validatorSet = n4),
          (i3.elementStyle = {}),
          (i3.order = 0),
          i3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.property = function (t4, e4, n4) {
          this.validatorSet.validatePropertyAndHandleShorthand(
            t4,
            e4,
            n4,
            this,
          );
        }),
        (n3.invalidPropertyValue = function (t4, e4) {
          c2.warn('E_INVALID_PROPERTY_VALUE', t4 + ':', e4.toString());
        }),
        (n3.unknownProperty = function (t4, e4) {
          c2.warn('E_INVALID_PROPERTY', t4 + ':', e4.toString());
        }),
        (n3.simpleProperty = function (t4, e4, n4) {
          var i3 = n4 ? 67108864 : 50331648;
          (i3 += this.order), (this.order += 1 / 1048576);
          var r3 = new kr(e4, i3);
          Hr(this.elementStyle, t4, r3);
        }),
        e3
      );
    })(hr);
    function na(t3, e3) {
      var n3 = Wr(t3);
      n3 &&
        n3.forEach(function (t4) {
          t4.matcher.matches() && e3(t4.styles);
        });
    }
    function ia(t3, e3, n3) {
      na(n3, function (n4) {
        la(t3, n4, e3);
      });
    }
    function ra(t3, e3, n3) {
      var i3 = t3['writing-mode'];
      if (i3) {
        var r3 = i3.evaluate(e3, 'writing-mode');
        if (r3 && r3 !== Ye.inherit) return r3 === Ye.vertical_rl;
      }
      return n3;
    }
    function oa(t3, e3, n3) {
      var i3 = t3.direction;
      if (i3) {
        var r3 = i3.evaluate(e3, 'direction');
        if (r3 && r3 !== Ye.inherit) return r3 === Ye.rtl;
      }
      return n3;
    }
    function aa(t3, e3, n3, i3, r3) {
      var o3 = {};
      for (var a3 in t3) Mr(a3) && (o3[a3] = Vr(t3, a3));
      return (
        ia(o3, e3, t3),
        sa(t3, n3, i3, function (t4, n4) {
          la(o3, n4, e3), ia(o3, e3, n4);
        }),
        o3
      );
    }
    function sa(t3, e3, n3, i3) {
      var r3 = zr(t3, '_regions');
      if ((e3 || n3) && r3) {
        if (n3) {
          var o3 = ['footnote'];
          e3 = e3 ? e3.concat(o3) : o3;
        }
        for (var a3, s3 = D(e3); !(a3 = s3()).done; ) {
          var l3 = a3.value,
            u3 = r3[l3];
          u3 && i3(l3, u3);
        }
      }
    }
    function la(t3, e3, n3) {
      for (var i3 in e3)
        if (Mr(i3)) {
          var r3 = Vr(e3, i3);
          t3[i3] = Dr(n3, t3[i3], r3);
        }
    }
    var ua = function (t3, e3, n3, i3, r3) {
      var o3 = n3 ? (i3 ? Lr : Rr) : i3 ? Or : Ar;
      for (var a3 in t3)
        if (t3.hasOwnProperty(a3)) {
          var s3 = t3[a3];
          if (!s3) continue;
          var l3 = o3[a3],
            u3 = void 0;
          if (l3) {
            var h3 = t3[l3];
            if (h3 && h3.priority > s3.priority) continue;
            u3 = Ir[l3] ? l3 : a3;
          } else u3 = a3;
          e3[u3] = r3(a3, s3);
        }
    };
    function ha(t3, e3) {
      var n3 = {};
      return (
        Object.keys(t3).forEach(function (i3) {
          var r3 = (n3[i3] = {}),
            o3 = t3[i3];
          Object.keys(o3).forEach(function (t4) {
            r3[t4] = o3[t4].map(function (t5) {
              var n4 = e3 ? t5.physical : t5.logical;
              return {
                regexp: new RegExp(
                  '(-?)' + (e3 ? t5.logical : t5.physical) + '(-?)',
                ),
                to: '$1' + n4 + '$2',
              };
            });
          });
        }),
        n3
      );
    }
    function ca(t3, e3, n3, i3) {
      var r3 = i3[e3];
      if (!r3) throw new Error('unknown writing-mode: ' + e3);
      var o3 = r3[n3 || 'ltr'];
      if (!o3) throw new Error('unknown direction: ' + n3);
      for (var a3, s3 = D(o3); !(a3 = s3()).done; ) {
        var l3 = a3.value,
          u3 = t3.replace(l3.regexp, l3.to);
        if (u3 !== t3) return u3;
      }
      return t3;
    }
    var fa;
    var da;
    var pa;
    var ga;
    var ma;
    var va;
    var Ea;
    var ya = {
      'horizontal-tb': {
        ltr: [
          { logical: 'inline-start', physical: 'left' },
          { logical: 'inline-end', physical: 'right' },
          { logical: 'block-start', physical: 'top' },
          { logical: 'block-end', physical: 'bottom' },
          { logical: 'inline-size', physical: 'width' },
          { logical: 'block-size', physical: 'height' },
        ],
        rtl: [
          { logical: 'inline-start', physical: 'right' },
          { logical: 'inline-end', physical: 'left' },
          { logical: 'block-start', physical: 'top' },
          { logical: 'block-end', physical: 'bottom' },
          { logical: 'inline-size', physical: 'width' },
          { logical: 'block-size', physical: 'height' },
        ],
      },
      'vertical-rl': {
        ltr: [
          { logical: 'inline-start', physical: 'top' },
          { logical: 'inline-end', physical: 'bottom' },
          { logical: 'block-start', physical: 'right' },
          { logical: 'block-end', physical: 'left' },
          { logical: 'inline-size', physical: 'height' },
          { logical: 'block-size', physical: 'width' },
        ],
        rtl: [
          { logical: 'inline-start', physical: 'bottom' },
          { logical: 'inline-end', physical: 'top' },
          { logical: 'block-start', physical: 'right' },
          { logical: 'block-end', physical: 'left' },
          { logical: 'inline-size', physical: 'height' },
          { logical: 'block-size', physical: 'width' },
        ],
      },
      'vertical-lr': {
        ltr: [
          { logical: 'inline-start', physical: 'top' },
          { logical: 'inline-end', physical: 'bottom' },
          { logical: 'block-start', physical: 'left' },
          { logical: 'block-end', physical: 'right' },
          { logical: 'inline-size', physical: 'height' },
          { logical: 'block-size', physical: 'width' },
        ],
        rtl: [
          { logical: 'inline-start', physical: 'bottom' },
          { logical: 'inline-end', physical: 'top' },
          { logical: 'block-start', physical: 'left' },
          { logical: 'block-end', physical: 'right' },
          { logical: 'inline-size', physical: 'height' },
          { logical: 'block-size', physical: 'width' },
        ],
      },
    };
    var wa = ha(ya, true);
    var Na = ha(ya, false);
    function ba(t3, e3, n3) {
      var i3 = {
          display: e3.style.display,
          position: e3.style.position,
          width: e3.style.width,
          maxWidth: e3.style.maxWidth,
          minWidth: e3.style.minWidth,
          height: e3.style.height,
          maxHeight: e3.style.maxHeight,
          minHeight: e3.style.minHeight,
        },
        r3 = e3.parentNode,
        o3 = e3.ownerDocument.createElement('div');
      function a3(n4) {
        return t3.getElementComputedStyle(e3).getPropertyValue(n4);
      }
      $2(o3, 'position', i3.position),
        r3.insertBefore(o3, e3),
        o3.appendChild(e3),
        $2(e3, 'width', 'auto'),
        $2(e3, 'max-width', 'none'),
        $2(e3, 'min-width', '0'),
        $2(e3, 'height', 'auto'),
        $2(e3, 'max-height', 'none'),
        $2(e3, 'min-height', '0');
      var s3 = Z('writing-mode'),
        l3 = (s3 ? a3(s3[0]) : null) || a3('writing-mode'),
        u3 =
          'vertical-rl' === l3 ||
          'tb-rl' === l3 ||
          'vertical-lr' === l3 ||
          'tb-lr' === l3,
        h3 = u3 ? 'height' : 'width',
        c3 = u3 ? 'width' : 'height';
      function f3() {
        return $2(e3, 'display', 'block'), $2(e3, 'position', 'static'), a3(h3);
      }
      function d3() {
        $2(e3, 'display', 'inline-block'), $2(o3, h3, '99999999px');
        var t4 = a3(h3);
        return $2(o3, h3, ''), t4;
      }
      function p3() {
        $2(e3, 'display', 'inline-block'), $2(o3, h3, '0');
        var t4 = a3(h3);
        return $2(o3, h3, ''), t4;
      }
      function g3() {
        var t4 = f3(),
          e4 = p3(),
          n4 = parseFloat(t4);
        if (n4 <= parseFloat(e4)) return e4;
        var i4 = d3();
        return n4 <= parseFloat(i4) ? t4 : i4;
      }
      function m3() {
        return a3(c3);
      }
      function v3() {
        throw new Error('Getting fill-available block size is not implemented');
      }
      var E2 = {};
      return (
        n3.forEach(function (t4) {
          var n4;
          switch (t4) {
            case fa.FILL_AVAILABLE_INLINE_SIZE:
              n4 = f3();
              break;
            case fa.MAX_CONTENT_INLINE_SIZE:
              n4 = d3();
              break;
            case fa.MIN_CONTENT_INLINE_SIZE:
              n4 = p3();
              break;
            case fa.FIT_CONTENT_INLINE_SIZE:
              n4 = g3();
              break;
            case fa.FILL_AVAILABLE_BLOCK_SIZE:
              n4 = v3();
              break;
            case fa.MAX_CONTENT_BLOCK_SIZE:
            case fa.MIN_CONTENT_BLOCK_SIZE:
            case fa.FIT_CONTENT_BLOCK_SIZE:
              n4 = m3();
              break;
            case fa.FILL_AVAILABLE_WIDTH:
              n4 = u3 ? v3() : f3();
              break;
            case fa.FILL_AVAILABLE_HEIGHT:
              n4 = u3 ? f3() : v3();
              break;
            case fa.MAX_CONTENT_WIDTH:
              n4 = u3 ? m3() : d3();
              break;
            case fa.MAX_CONTENT_HEIGHT:
              n4 = u3 ? d3() : m3();
              break;
            case fa.MIN_CONTENT_WIDTH:
              n4 = u3 ? m3() : p3();
              break;
            case fa.MIN_CONTENT_HEIGHT:
              n4 = u3 ? p3() : m3();
              break;
            case fa.FIT_CONTENT_WIDTH:
              n4 = u3 ? m3() : g3();
              break;
            case fa.FIT_CONTENT_HEIGHT:
              n4 = u3 ? g3() : m3();
          }
          (E2[t4] = parseFloat(n4)),
            $2(e3, 'position', i3.position),
            $2(e3, 'display', i3.display);
        }),
        $2(e3, 'width', i3.width),
        $2(e3, 'max-width', i3.maxWidth),
        $2(e3, 'min-width', i3.minWidth),
        $2(e3, 'height', i3.height),
        $2(e3, 'max-height', i3.maxHeight),
        $2(e3, 'min-height', i3.minHeight),
        r3.insertBefore(e3, o3),
        r3.removeChild(o3),
        E2
      );
    }
    function Sa(t3) {
      return t3.reduce(function (t4, e3) {
        return e3[0] === i2.DELETE ? t4 : t4 + e3[1];
      }, '');
    }
    function Ca(t3, e3, n3) {
      var r3 = 0,
        o3 = 0;
      return (
        t3.some(function (t4) {
          for (var a3 = 0; a3 < t4[1].length; a3++) {
            switch (t4[0] * n3) {
              case i2.INSERT:
                r3++;
                break;
              case i2.DELETE:
                r3--, o3++;
                break;
              case i2.EQUAL:
                o3++;
            }
            if (o3 > e3) return true;
          }
          return false;
        }),
        Math.max(Math.min(e3, o3 - 1) + r3, 0)
      );
    }
    !(function (t3) {
      (t3.FILL_AVAILABLE_INLINE_SIZE = 'fill-available inline size'),
        (t3.FILL_AVAILABLE_BLOCK_SIZE = 'fill-available block size'),
        (t3.FILL_AVAILABLE_WIDTH = 'fill-available width'),
        (t3.FILL_AVAILABLE_HEIGHT = 'fill-available height'),
        (t3.MAX_CONTENT_INLINE_SIZE = 'max-content inline size'),
        (t3.MAX_CONTENT_BLOCK_SIZE = 'max-content block size'),
        (t3.MAX_CONTENT_WIDTH = 'max-content width'),
        (t3.MAX_CONTENT_HEIGHT = 'max-content height'),
        (t3.MIN_CONTENT_INLINE_SIZE = 'min-content inline size'),
        (t3.MIN_CONTENT_BLOCK_SIZE = 'min-content block size'),
        (t3.MIN_CONTENT_WIDTH = 'min-content width'),
        (t3.MIN_CONTENT_HEIGHT = 'min-content height'),
        (t3.FIT_CONTENT_INLINE_SIZE = 'fit-content inline size'),
        (t3.FIT_CONTENT_BLOCK_SIZE = 'fit-content block size'),
        (t3.FIT_CONTENT_WIDTH = 'fit-content width'),
        (t3.FIT_CONTENT_HEIGHT = 'fit-content height');
    })(fa || (fa = {})),
      (function (t3) {
        t3.isInstanceOfBlockFormattingContext = function (t4) {
          return t4 && 'Block' === t4.formattingContextType;
        };
      })(da || (da = {})),
      (function (t3) {
        !(function (t4) {
          (t4.INLINE = 'inline'),
            (t4.COLUMN = 'column'),
            (t4.REGION = 'region'),
            (t4.PAGE = 'page');
        })(t3.FloatReference || (t3.FloatReference = {}));
      })(pa || (pa = {})),
      (function (t3) {
        t3.isInstanceOfAfterIfContinuesLayoutConstraint = function (t4) {
          return t4 && 'AfterIfContinue' == t4.flagmentLayoutConstraintType;
        };
      })(ga || (ga = {})),
      (function (t3) {
        (t3.isInstanceOfRepetitiveElementsOwnerFormattingContext = function (
          t4,
        ) {
          return (
            !!t4 &&
            ('RepetitiveElementsOwner' === t4.formattingContextType ||
              va.isInstanceOfTableFormattingContext(t4))
          );
        }),
          (t3.isInstanceOfRepetitiveElementsOwnerLayoutConstraint = function (
            t4,
          ) {
            return (
              !!t4 &&
              ('RepetitiveElementsOwner' === t4.flagmentLayoutConstraintType ||
                va.isInstanceOfTableRowLayoutConstraint(t4))
            );
          });
      })(ma || (ma = {})),
      (function (t3) {
        (t3.isInstanceOfTableFormattingContext = function (t4) {
          return t4 && 'Table' === t4.formattingContextType;
        }),
          (t3.isInstanceOfTableRowLayoutConstraint = function (t4) {
            return t4 && 'TableRow' === t4.flagmentLayoutConstraintType;
          });
      })(va || (va = {})),
      (function (t3) {
        !(function (t4) {
          (t4[(t4.IGNORE = 0)] = 'IGNORE'),
            (t4[(t4.NEWLINE = 1)] = 'NEWLINE'),
            (t4[(t4.PRESERVE = 2)] = 'PRESERVE');
        })(t3.Whitespace || (t3.Whitespace = {})),
          (function (t4) {
            (t4[(t4.NONE = 0)] = 'NONE'),
              (t4[(t4.CONTENT = 1)] = 'CONTENT'),
              (t4[(t4.ROOTLESS = 2)] = 'ROOTLESS'),
              (t4[(t4.ROOTED = 3)] = 'ROOTED');
          })(t3.ShadowType || (t3.ShadowType = {}));
      })(Ea || (Ea = {}));
    var Ta = { transform: true, 'transform-origin': true };
    var xa = { top: true, bottom: true, left: true, right: true };
    var Ia = function (t3, e3, n3) {
      (this.target = t3), (this.name = e3), (this.value = n3);
    };
    var Pa = {
      show: function (t3) {
        t3.style.visibility = 'visible';
      },
      hide: function (t3) {
        t3.style.visibility = 'hidden';
      },
      play: function (t3) {
        (t3.currentTime = 0), t3.play();
      },
      pause: function (t3) {
        t3.pause();
      },
      resume: function (t3) {
        t3.play();
      },
      mute: function (t3) {
        t3.muted = true;
      },
      unmute: function (t3) {
        t3.muted = false;
      },
    };
    function Ra(t3, e3) {
      var n3 = Pa[e3];
      return n3
        ? function () {
            for (var e4 = 0; e4 < t3.length; e4++)
              try {
                n3(t3[e4]);
              } catch (t4) {}
          }
        : null;
    }
    var Aa = (function (t3) {
      function e3(e4, n4) {
        var i3;
        ((i3 = t3.call(this) || this).container = e4),
          (i3.bleedBox = n4),
          (i3.pageAreaElement = null),
          (i3.delayedItems = []),
          (i3.elementsById = {}),
          (i3.dimensions = { width: 0, height: 0 }),
          (i3.isFirstPage = false),
          (i3.isLastPage = false),
          (i3.isAutoPageWidth = true),
          (i3.isAutoPageHeight = true),
          (i3.spineIndex = 0),
          (i3.position = null),
          (i3.offset = -1),
          (i3.side = null),
          (i3.fetchers = []),
          (i3.marginBoxes = { top: {}, bottom: {}, left: {}, right: {} });
        var r3 = k2(i3);
        return (
          (i3.hrefHandler = function (t4) {
            var e5 = t4.currentTarget,
              n5 =
                e5.getAttribute('href') || e5.getAttributeNS(H2.XLINK, 'href');
            n5 &&
              r3.dispatchEvent({
                type: 'hyperlink',
                target: null,
                currentTarget: null,
                anchorElement: e5,
                href: n5,
                preventDefault: function () {
                  t4.preventDefault();
                },
              });
          }),
          i3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.setAutoPageWidth = function (t4) {
          (this.isAutoPageWidth = t4),
            t4
              ? this.container.setAttribute(
                  e3.AUTO_PAGE_WIDTH_ATTRIBUTE,
                  'true',
                )
              : this.container.removeAttribute(e3.AUTO_PAGE_WIDTH_ATTRIBUTE);
        }),
        (n3.setAutoPageHeight = function (t4) {
          (this.isAutoPageHeight = t4),
            t4
              ? this.container.setAttribute(
                  e3.AUTO_PAGE_HEIGHT_ATTRIBUTE,
                  'true',
                )
              : this.container.removeAttribute(e3.AUTO_PAGE_HEIGHT_ATTRIBUTE);
        }),
        (n3.registerElementWithId = function (t4, e4) {
          var n4 = this.elementsById[e4];
          n4 ? n4.push(t4) : (this.elementsById[e4] = [t4]);
        }),
        (n3.finish = function (t4, e4) {
          var n4 = this;
          Object.keys(this.elementsById).forEach(function (t5) {
            for (var e5 = n4.elementsById[t5], i4 = 0; i4 < e5.length; )
              n4.container.contains(e5[i4]) ? i4++ : e5.splice(i4, 1);
            0 === e5.length && delete n4.elementsById[t5];
          });
          for (var i3 = this.delayedItems, r3 = 0; r3 < i3.length; r3++) {
            var o3 = i3[r3];
            (o3.target !== this.container ||
              'transform' !== o3.name ||
              this.isAutoPageWidth ||
              this.isAutoPageHeight) &&
              $2(o3.target, o3.name, o3.value.toString());
          }
          var a3 = e4.getElementClientRect(this.container);
          (this.dimensions.width = a3.width),
            (this.dimensions.height = a3.height);
          for (var s3 = 0; s3 < t4.length; s3++) {
            var l3 = t4[s3],
              u3 = this.elementsById[l3.ref],
              h3 = this.elementsById[l3.observer];
            if (u3 && h3) {
              var c3 = Ra(u3, l3.action);
              if (c3)
                for (var f3 = 0; f3 < h3.length; f3++)
                  h3[f3].addEventListener(l3.event, c3, false);
            }
          }
        }),
        (n3.zoom = function (t4) {
          $2(this.container, 'transform', 'scale(' + t4 + ')');
        }),
        (n3.getPageAreaElement = function () {
          return this.pageAreaElement || this.container;
        }),
        e3
      );
    })(dt);
    (Aa.AUTO_PAGE_WIDTH_ATTRIBUTE = 'data-vivliostyle-auto-page-width'),
      (Aa.AUTO_PAGE_HEIGHT_ATTRIBUTE = 'data-vivliostyle-auto-page-height');
    var La = Ea.Whitespace;
    function Oa(t3) {
      switch (t3) {
        case 'normal':
        case 'nowrap':
          return La.IGNORE;
        case 'pre-line':
          return La.NEWLINE;
        case 'pre':
        case 'pre-wrap':
          return La.PRESERVE;
        default:
          return null;
      }
    }
    function ka(t3, e3) {
      if (1 == t3.nodeType) return false;
      var n3 = t3.textContent;
      switch (e3) {
        case La.IGNORE:
          return !!n3.match(/^\s*$/);
        case La.NEWLINE:
          return !!n3.match(/^[ \t\f]*$/);
        case La.PRESERVE:
          return 0 == n3.length;
      }
      throw new Error('Unexpected whitespace: ' + e3);
    }
    var Fa = function (t3, e3) {
      (this.flowName = t3),
        (this.parentFlowName = e3),
        (this.forcedBreakOffsets = []),
        (this.formattingContext = null);
    };
    var Da = (function () {
      function t3(t4, e3, n3, i3, r3, o3, a3, s3, l3) {
        (this.flowName = t4),
          (this.element = e3),
          (this.startOffset = n3),
          (this.priority = i3),
          (this.linger = r3),
          (this.exclusive = o3),
          (this.repeated = a3),
          (this.last = s3),
          (this.breakBefore = l3),
          (this.startPage = -1);
      }
      return (
        (t3.prototype.isBetter = function (t4) {
          return (
            !!this.exclusive &&
            (!t4.exclusive || this.priority > t4.priority || this.last)
          );
        }),
        t3
      );
    })();
    function _a(t3, e3) {
      return t3.top - e3.top;
    }
    function Ba(t3, e3) {
      return e3.right - t3.right;
    }
    function Ma(t3, e3) {
      return (
        t3 === e3 ||
        (!(!t3 || !e3) &&
          t3.node === e3.node &&
          t3.shadowType === e3.shadowType &&
          Wa(t3.shadowContext, e3.shadowContext) &&
          Wa(t3.nodeShadow, e3.nodeShadow) &&
          Ma(t3.shadowSibling, e3.shadowSibling))
      );
    }
    function Ua(t3, e3) {
      if (t3 === e3) return true;
      if (!t3 || !e3) return false;
      if (
        t3.offsetInNode !== e3.offsetInNode ||
        t3.after !== e3.after ||
        t3.steps.length !== e3.steps.length
      )
        return false;
      for (var n3 = 0; n3 < t3.steps.length; n3++)
        if (!Ma(t3.steps[n3], e3.steps[n3])) return false;
      return true;
    }
    function Va(t3, e3) {
      return {
        steps: [
          {
            node: t3.sourceNode,
            shadowType: za.NONE,
            shadowContext: t3.shadowContext,
            nodeShadow: null,
            shadowSibling: null,
            formattingContext: null,
            fragmentIndex: null != e3 ? e3 : t3.fragmentIndex,
          },
        ],
        offsetInNode: 0,
        after: false,
        preprocessedTextContent: t3.preprocessedTextContent,
      };
    }
    function Ha(t3, e3) {
      var n3 = new ja(t3.node, e3, 0);
      return (
        (n3.shadowType = t3.shadowType),
        (n3.shadowContext = t3.shadowContext),
        (n3.nodeShadow = t3.nodeShadow),
        (n3.shadowSibling = t3.shadowSibling
          ? Ha(t3.shadowSibling, e3.copy())
          : null),
        (n3.formattingContext = t3.formattingContext),
        (n3.fragmentIndex = t3.fragmentIndex + 1),
        n3
      );
    }
    var za = Ea.ShadowType;
    var Ga = (function () {
      function t3(t4, e3, n3, i3, r3, o3, a3) {
        (this.owner = t4),
          (this.root = e3),
          (this.xmldoc = n3),
          (this.parentShadow = i3),
          (this.type = o3),
          (this.styler = a3),
          (this.subShadow = null),
          r3 && (r3.subShadow = this);
      }
      return (
        (t3.prototype.equals = function (t4) {
          return (
            !!t4 &&
            this.owner === t4.owner &&
            this.xmldoc === t4.xmldoc &&
            this.type === t4.type &&
            Wa(this.parentShadow, t4.parentShadow)
          );
        }),
        t3
      );
    })();
    function Wa(t3, e3) {
      return t3 === e3 || (!!t3 && !!e3 && t3.equals(e3));
    }
    var Xa = function (t3, e3) {
      (this.outer = t3), (this.count = e3);
    };
    var ja = (function () {
      function t3(t4, e4, n3) {
        (this.sourceNode = t4),
          (this.parent = e4),
          (this.boxOffset = n3),
          (this.offsetInNode = 0),
          (this.after = false),
          (this.nodeShadow = null),
          (this.shadowSibling = null),
          (this.shared = false),
          (this.inline = true),
          (this.overflow = false),
          (this.display = null),
          (this.floatSide = null),
          (this.clearSide = null),
          (this.floatMinWrapBlock = null),
          (this.columnSpan = null),
          (this.verticalAlign = 'baseline'),
          (this.captionSide = 'top'),
          (this.inlineBorderSpacing = 0),
          (this.blockBorderSpacing = 0),
          (this.flexContainer = false),
          (this.establishesBFC = false),
          (this.containingBlockForAbsolute = false),
          (this.breakBefore = null),
          (this.breakAfter = null),
          (this.viewNode = null),
          (this.clearSpacer = null),
          (this.lang = null),
          (this.preprocessedTextContent = null),
          (this.repeatOnBreak = null),
          (this.pluginProps = {}),
          (this.fragmentIndex = 1),
          (this.afterIfContinues = null),
          (this.footnotePolicy = null),
          (this.shadowType = za.NONE),
          (this.shadowContext = e4 ? e4.shadowContext : null),
          (this.breakPenalty = e4 ? e4.breakPenalty : 0),
          (this.floatReference = pa.FloatReference.INLINE),
          (this.whitespace = e4 ? e4.whitespace : La.IGNORE),
          (this.hyphenateCharacter = e4 ? e4.hyphenateCharacter : null),
          (this.breakWord = !!e4 && e4.breakWord),
          (this.inheritedProps = e4 ? e4.inheritedProps : {}),
          (this.vertical = !!e4 && e4.vertical),
          (this.direction = e4 ? e4.direction : 'ltr'),
          (this.firstPseudo = e4 ? e4.firstPseudo : null),
          (this.formattingContext = e4 ? e4.formattingContext : null);
      }
      var e3 = t3.prototype;
      return (
        (e3.resetView = function () {
          (this.inline = true),
            (this.breakPenalty = this.parent ? this.parent.breakPenalty : 0),
            (this.viewNode = null),
            (this.clearSpacer = null),
            (this.offsetInNode = 0),
            (this.after = false),
            (this.display = null),
            (this.floatReference = pa.FloatReference.INLINE),
            (this.floatSide = null),
            (this.clearSide = null),
            (this.floatMinWrapBlock = null),
            (this.columnSpan = null),
            (this.verticalAlign = 'baseline'),
            (this.flexContainer = false),
            (this.whitespace = this.parent
              ? this.parent.whitespace
              : La.IGNORE),
            (this.hyphenateCharacter = this.parent
              ? this.parent.hyphenateCharacter
              : null),
            (this.breakWord = !!this.parent && this.parent.breakWord),
            (this.breakBefore = null),
            (this.breakAfter = null),
            (this.nodeShadow = null),
            (this.establishesBFC = false),
            (this.containingBlockForAbsolute = false),
            (this.vertical = !!this.parent && this.parent.vertical),
            (this.nodeShadow = null),
            (this.preprocessedTextContent = null),
            (this.formattingContext = this.parent
              ? this.parent.formattingContext
              : null),
            (this.repeatOnBreak = null),
            (this.pluginProps = {}),
            (this.fragmentIndex = 1),
            (this.afterIfContinues = null),
            (this.footnotePolicy = null);
        }),
        (e3.cloneItem = function () {
          var e4 = new t3(this.sourceNode, this.parent, this.boxOffset);
          return (
            (e4.offsetInNode = this.offsetInNode),
            (e4.after = this.after),
            (e4.nodeShadow = this.nodeShadow),
            (e4.shadowType = this.shadowType),
            (e4.shadowContext = this.shadowContext),
            (e4.shadowSibling = this.shadowSibling),
            (e4.inline = this.inline),
            (e4.breakPenalty = this.breakPenalty),
            (e4.display = this.display),
            (e4.floatReference = this.floatReference),
            (e4.floatSide = this.floatSide),
            (e4.clearSide = this.clearSide),
            (e4.floatMinWrapBlock = this.floatMinWrapBlock),
            (e4.columnSpan = this.columnSpan),
            (e4.verticalAlign = this.verticalAlign),
            (e4.captionSide = this.captionSide),
            (e4.inlineBorderSpacing = this.inlineBorderSpacing),
            (e4.blockBorderSpacing = this.blockBorderSpacing),
            (e4.establishesBFC = this.establishesBFC),
            (e4.containingBlockForAbsolute = this.containingBlockForAbsolute),
            (e4.flexContainer = this.flexContainer),
            (e4.whitespace = this.whitespace),
            (e4.hyphenateCharacter = this.hyphenateCharacter),
            (e4.breakWord = this.breakWord),
            (e4.breakBefore = this.breakBefore),
            (e4.breakAfter = this.breakAfter),
            (e4.viewNode = this.viewNode),
            (e4.clearSpacer = this.clearSpacer),
            (e4.firstPseudo = this.firstPseudo),
            (e4.vertical = this.vertical),
            (e4.overflow = this.overflow),
            (e4.preprocessedTextContent = this.preprocessedTextContent),
            (e4.formattingContext = this.formattingContext),
            (e4.repeatOnBreak = this.repeatOnBreak),
            (e4.pluginProps = Object.create(this.pluginProps)),
            (e4.fragmentIndex = this.fragmentIndex),
            (e4.afterIfContinues = this.afterIfContinues),
            (e4.footnotePolicy = this.footnotePolicy),
            e4
          );
        }),
        (e3.modify = function () {
          return this.shared ? this.cloneItem() : this;
        }),
        (e3.copy = function () {
          var t4 = this;
          do {
            if (t4.shared) break;
            (t4.shared = true), (t4 = t4.parent);
          } while (t4);
          return this;
        }),
        (e3.clone = function () {
          for (
            var t4, e4 = this.cloneItem(), n3 = e4;
            null != (t4 = n3.parent);

          )
            (t4 = t4.cloneItem()), (n3.parent = t4), (n3 = t4);
          return e4;
        }),
        (e3.toNodePositionStep = function () {
          return {
            node: this.sourceNode,
            shadowType: this.shadowType,
            shadowContext: this.shadowContext,
            nodeShadow: this.nodeShadow,
            shadowSibling: this.shadowSibling
              ? this.shadowSibling.toNodePositionStep()
              : null,
            formattingContext: this.formattingContext,
            fragmentIndex: this.fragmentIndex,
          };
        }),
        (e3.toNodePosition = function () {
          var t4 = this,
            e4 = [];
          do {
            (t4.firstPseudo &&
              t4.parent &&
              t4.parent.firstPseudo !== t4.firstPseudo) ||
              e4.push(t4.toNodePositionStep()),
              (t4 = t4.parent);
          } while (t4);
          return {
            steps: e4,
            offsetInNode: this.preprocessedTextContent
              ? Ca(this.preprocessedTextContent, this.offsetInNode, -1)
              : this.offsetInNode,
            after: this.after,
            preprocessedTextContent: this.preprocessedTextContent,
          };
        }),
        (e3.isInsideBFC = function () {
          for (var t4 = this.parent; t4; ) {
            if (t4.establishesBFC) return true;
            t4 = t4.parent;
          }
          return false;
        }),
        (e3.getContainingBlockForAbsolute = function () {
          for (var t4 = this.parent; t4; ) {
            if (t4.containingBlockForAbsolute) return t4;
            t4 = t4.parent;
          }
          return null;
        }),
        (e3.walkUpBlocks = function (t4) {
          for (var e4 = this; e4; ) e4.inline || t4(e4), (e4 = e4.parent);
        }),
        (e3.belongsTo = function (t4) {
          return (
            this.formattingContext === t4 &&
            !!this.parent &&
            this.parent.formattingContext === t4
          );
        }),
        t3
      );
    })();
    var Ya = (function () {
      function t3(t4) {
        (this.primary = t4), (this.floats = null);
      }
      var e3 = t3.prototype;
      return (
        (e3.clone = function () {
          var e4 = new t3(this.primary);
          if (this.floats) {
            e4.floats = [];
            for (var n3 = 0; n3 < this.floats.length; ++n3)
              e4.floats[n3] = this.floats[n3];
          }
          return e4;
        }),
        (e3.isSamePosition = function (t4) {
          if (!t4) return false;
          if (this === t4) return true;
          if (!Ua(this.primary, t4.primary)) return false;
          if (this.floats) {
            if (!t4.floats || this.floats.length !== t4.floats.length)
              return false;
            for (var e4 = 0; e4 < this.floats.length; e4++)
              if (!Ua(this.floats[e4], t4.floats[e4])) return false;
          } else if (t4.floats) return false;
          return true;
        }),
        t3
      );
    })();
    var Ka = (function () {
      function t3(t4, e4) {
        (this.chunkPosition = t4), (this.flowChunk = e4);
      }
      var e3 = t3.prototype;
      return (
        (e3.clone = function () {
          return new t3(this.chunkPosition.clone(), this.flowChunk);
        }),
        (e3.isSamePosition = function (t4) {
          return (
            !!t4 &&
            (this === t4 || this.chunkPosition.isSamePosition(t4.chunkPosition))
          );
        }),
        t3
      );
    })();
    var qa = (function () {
      function t3() {
        (this.positions = []),
          (this.startSide = 'any'),
          (this.breakAfter = null);
      }
      var e3 = t3.prototype;
      return (
        (e3.clone = function () {
          for (
            var e4 = new t3(), n3 = this.positions, i3 = e4.positions, r3 = 0;
            r3 < n3.length;
            r3++
          )
            i3[r3] = n3[r3].clone();
          return (
            (e4.startSide = this.startSide),
            (e4.breakAfter = this.breakAfter),
            e4
          );
        }),
        (e3.isSamePosition = function (t4) {
          if (this === t4) return true;
          if (!t4 || this.positions.length !== t4.positions.length)
            return false;
          for (var e4 = 0; e4 < this.positions.length; e4++)
            if (!this.positions[e4].isSamePosition(t4.positions[e4]))
              return false;
          return true;
        }),
        (e3.hasContent = function (t4) {
          return (
            this.positions.length > 0 &&
            this.positions[0].flowChunk.startOffset <= t4
          );
        }),
        t3
      );
    })();
    var Qa = (function () {
      function t3() {
        (this.page = 0),
          (this.flows = {}),
          (this.flowPositions = {}),
          (this.highestSeenOffset = 0);
      }
      var e3 = t3.prototype;
      return (
        (e3.clone = function () {
          var e4 = new t3();
          for (var n3 in ((e4.page = this.page),
          (e4.highestSeenNode = this.highestSeenNode),
          (e4.highestSeenOffset = this.highestSeenOffset),
          (e4.lookupPositionOffset = this.lookupPositionOffset),
          (e4.flows = this.flows),
          this.flowPositions))
            e4.flowPositions[n3] = this.flowPositions[n3].clone();
          return e4;
        }),
        (e3.isSamePosition = function (t4) {
          if (this === t4) return true;
          if (
            !t4 ||
            this.page !== t4.page ||
            this.highestSeenOffset !== t4.highestSeenOffset
          )
            return false;
          var e4 = Object.keys(this.flowPositions),
            n3 = Object.keys(t4.flowPositions);
          if (e4.length !== n3.length) return false;
          for (var i3 = 0, r3 = e4; i3 < r3.length; i3++) {
            var o3 = r3[i3];
            if (!this.flowPositions[o3].isSamePosition(t4.flowPositions[o3]))
              return false;
          }
          return true;
        }),
        (e3.hasContent = function (t4, e4) {
          var n3 = this.flowPositions[t4];
          return !!n3 && n3.hasContent(e4);
        }),
        (e3.startSideOfFlow = function (t4) {
          var e4 = this.flowPositions[t4];
          return e4 ? e4.startSide : 'any';
        }),
        (e3.firstFlowChunkOfFlow = function (t4) {
          var e4 = this.flowPositions[t4];
          if (!e4) return null;
          var n3 = e4.positions[0];
          return n3 ? n3.flowChunk : null;
        }),
        t3
      );
    })();
    var Za = (function () {
      function t3(t4) {
        (this.element = t4),
          (this.left = 0),
          (this.top = 0),
          (this.marginLeft = 0),
          (this.marginRight = 0),
          (this.marginTop = 0),
          (this.marginBottom = 0),
          (this.borderLeft = 0),
          (this.borderRight = 0),
          (this.borderTop = 0),
          (this.borderBottom = 0),
          (this.paddingLeft = 0),
          (this.paddingRight = 0),
          (this.paddingTop = 0),
          (this.paddingBottom = 0),
          (this.width = 0),
          (this.height = 0),
          (this.originX = 0),
          (this.originY = 0),
          (this.exclusions = null),
          (this.innerShape = null),
          (this.computedBlockSize = 0),
          (this.snapWidth = 0),
          (this.snapHeight = 0),
          (this.snapOffsetX = 0),
          (this.snapOffsetY = 0),
          (this.vertical = false);
      }
      var e3 = t3.prototype;
      return (
        (e3.getInsetTop = function () {
          return this.marginTop + this.borderTop + this.paddingTop;
        }),
        (e3.getInsetBottom = function () {
          return this.marginBottom + this.borderBottom + this.paddingBottom;
        }),
        (e3.getInsetLeft = function () {
          return this.marginLeft + this.borderLeft + this.paddingLeft;
        }),
        (e3.getInsetRight = function () {
          return this.marginRight + this.borderRight + this.paddingRight;
        }),
        (e3.getInsetBefore = function () {
          return this.vertical ? this.getInsetRight() : this.getInsetTop();
        }),
        (e3.getInsetAfter = function () {
          return this.vertical ? this.getInsetLeft() : this.getInsetBottom();
        }),
        (e3.getInsetStart = function () {
          return this.vertical ? this.getInsetTop() : this.getInsetLeft();
        }),
        (e3.getInsetEnd = function () {
          return this.vertical ? this.getInsetBottom() : this.getInsetRight();
        }),
        (e3.getBeforeEdge = function (t4) {
          return this.vertical ? t4.right : t4.top;
        }),
        (e3.getAfterEdge = function (t4) {
          return this.vertical ? t4.left : t4.bottom;
        }),
        (e3.getStartEdge = function (t4) {
          return this.vertical ? t4.top : t4.left;
        }),
        (e3.getEndEdge = function (t4) {
          return this.vertical ? t4.bottom : t4.right;
        }),
        (e3.getInlineSize = function (t4) {
          return this.vertical ? t4.bottom - t4.top : t4.right - t4.left;
        }),
        (e3.getBoxSize = function (t4) {
          return this.vertical ? t4.right - t4.left : t4.bottom - t4.top;
        }),
        (e3.getBoxDir = function () {
          return this.vertical ? -1 : 1;
        }),
        (e3.getInlineDir = function () {
          return 1;
        }),
        (e3.copyFrom = function (t4) {
          (this.element = t4.element),
            (this.left = t4.left),
            (this.top = t4.top),
            (this.marginLeft = t4.marginLeft),
            (this.marginRight = t4.marginRight),
            (this.marginTop = t4.marginTop),
            (this.marginBottom = t4.marginBottom),
            (this.borderLeft = t4.borderLeft),
            (this.borderRight = t4.borderRight),
            (this.borderTop = t4.borderTop),
            (this.borderBottom = t4.borderBottom),
            (this.paddingLeft = t4.paddingLeft),
            (this.paddingRight = t4.paddingRight),
            (this.paddingTop = t4.paddingTop),
            (this.paddingBottom = t4.paddingBottom),
            (this.width = t4.width),
            (this.height = t4.height),
            (this.originX = t4.originX),
            (this.originY = t4.originY),
            (this.innerShape = t4.innerShape),
            (this.exclusions = t4.exclusions),
            (this.computedBlockSize = t4.computedBlockSize),
            (this.snapWidth = t4.snapWidth),
            (this.snapHeight = t4.snapHeight),
            (this.vertical = t4.vertical);
        }),
        (e3.setVerticalPosition = function (t4, e4) {
          (this.top = t4),
            (this.height = e4),
            $2(this.element, 'top', t4 + 'px'),
            $2(this.element, 'height', e4 + 'px');
        }),
        (e3.setHorizontalPosition = function (t4, e4) {
          (this.left = t4),
            (this.width = e4),
            $2(this.element, 'left', t4 + 'px'),
            $2(this.element, 'width', e4 + 'px');
        }),
        (e3.setBlockPosition = function (t4, e4) {
          this.vertical
            ? this.setHorizontalPosition(t4 + e4 * this.getBoxDir(), e4)
            : this.setVerticalPosition(t4, e4);
        }),
        (e3.setInlinePosition = function (t4, e4) {
          this.vertical
            ? this.setVerticalPosition(t4, e4)
            : this.setHorizontalPosition(t4, e4);
        }),
        (e3.clear = function () {
          for (var t4, e4 = this.element; (t4 = e4.lastChild); )
            e4.removeChild(t4);
        }),
        (e3.getInnerShape = function () {
          var t4 = this.getInnerRect();
          return this.innerShape
            ? this.innerShape.withOffset(t4.x1, t4.y1)
            : un(t4.x1, t4.y1, t4.x2, t4.y2);
        }),
        (e3.getInnerRect = function () {
          var t4 = this.originX + this.left + this.getInsetLeft(),
            e4 = this.originY + this.top + this.getInsetTop();
          return new tn(t4, e4, t4 + this.width, e4 + this.height);
        }),
        (e3.getPaddingRect = function () {
          var t4 = this.originX + this.left + this.marginLeft + this.borderLeft,
            e4 = this.originY + this.top + this.marginTop + this.borderTop;
          return new tn(
            t4,
            e4,
            t4 + (this.paddingLeft + this.width + this.paddingRight),
            e4 + (this.paddingTop + this.height + this.paddingBottom),
          );
        }),
        (e3.getOuterShape = function (t4, e4) {
          var n3 = this.getOuterRect();
          return xn(t4, n3.x1, n3.y1, n3.x2 - n3.x1, n3.y2 - n3.y1, e4);
        }),
        (e3.getOuterRect = function () {
          var t4 = this.originX + this.left,
            e4 = this.originY + this.top,
            n3 = this.getInsetLeft() + this.width + this.getInsetRight(),
            i3 = this.getInsetTop() + this.height + this.getInsetBottom();
          return new tn(t4, e4, t4 + n3, e4 + i3);
        }),
        t3
      );
    })();
    var $a = (function (t3) {
      function e3(e4, n4, i3, r3) {
        var o3;
        return (
          ((o3 = t3.call(this) || this).elem = e4),
          (o3.context = n4),
          (o3.rootContentValue = i3),
          (o3.exprContentListener = r3),
          o3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.visitStrInner = function (t4, e4) {
          e4 || (e4 = this.elem.ownerDocument.createTextNode(t4)),
            this.elem.appendChild(e4);
        }),
        (n3.visitStr = function (t4) {
          return this.visitStrInner(t4.str), null;
        }),
        (n3.visitURL = function (t4) {
          if (this.rootContentValue.url) this.elem.setAttribute('src', t4.url);
          else {
            var e4 = this.elem.ownerDocument.createElementNS(H2.XHTML, 'img');
            e4.setAttribute('src', t4.url), this.elem.appendChild(e4);
          }
          return null;
        }),
        (n3.visitSpaceList = function (t4) {
          return this.visitValues(t4.values), null;
        }),
        (n3.visitExpr = function (t4) {
          var e4 = t4.toExpr(),
            n4 = e4.evaluate(this.context);
          if ('string' == typeof n4) {
            e4 instanceof de &&
              (n4 = dr(e4.scope, new Ei(n4, null), '').stringValue());
            var i3 = this.exprContentListener(e4, n4, this.elem.ownerDocument);
            this.visitStrInner(n4, i3);
          }
          return null;
        }),
        e3
      );
    })(xe);
    function Ja(t3) {
      return (
        null != t3 && t3 !== Ye.normal && t3 !== Ye.none && t3 !== Ye.inherit
      );
    }
    var ts = pa.FloatReference;
    function es(t3) {
      switch (t3) {
        case ts.INLINE:
          return false;
        case ts.COLUMN:
        case ts.REGION:
        case ts.PAGE:
          return true;
        default:
          throw new Error('Unknown float-reference: ' + t3);
      }
    }
    var ns = (function () {
      function t3(t4, e4, n3, i3, r3, o3) {
        (this.nodePosition = t4),
          (this.floatReference = e4),
          (this.floatSide = n3),
          (this.clearSide = i3),
          (this.flowName = r3),
          (this.floatMinWrapBlock = o3),
          (this.order = null),
          (this.id = null);
      }
      var e3 = t3.prototype;
      return (
        (e3.getOrder = function () {
          if (null === this.order)
            throw new Error('The page float is not yet added');
          return this.order;
        }),
        (e3.getId = function () {
          if (!this.id) throw new Error('The page float is not yet added');
          return this.id;
        }),
        (e3.isAllowedOnContext = function (t4) {
          return t4.isAnchorAlreadyAppeared(this.getId());
        }),
        (e3.isAllowedToPrecede = function (t4) {
          return false;
        }),
        t3
      );
    })();
    var is = (function () {
      function t3() {
        (this.floats = []), (this.nextPageFloatIndex = 0);
      }
      var e3 = t3.prototype;
      return (
        (e3.nextOrder = function () {
          return this.nextPageFloatIndex++;
        }),
        (e3.createPageFloatId = function (t4) {
          return 'pf' + t4;
        }),
        (e3.addPageFloat = function (t4) {
          if (
            this.floats.findIndex(function (e5) {
              return Ua(e5.nodePosition, t4.nodePosition);
            }) >= 0
          )
            throw new Error(
              'A page float with the same source node is already registered',
            );
          var e4 = (t4.order = this.nextOrder());
          (t4.id = this.createPageFloatId(e4)), this.floats.push(t4);
        }),
        (e3.findPageFloatByNodePosition = function (t4) {
          var e4 = this.floats.findIndex(function (e5) {
            return Ua(e5.nodePosition, t4);
          });
          return e4 >= 0 ? this.floats[e4] : null;
        }),
        (e3.findPageFloatById = function (t4) {
          var e4 = this.floats.findIndex(function (e5) {
            return e5.id === t4;
          });
          return e4 >= 0 ? this.floats[e4] : null;
        }),
        t3
      );
    })();
    var rs = (function () {
      function t3(t4, e4, n3, i3, r3) {
        (this.floatReference = t4),
          (this.floatSide = e4),
          (this.continuations = n3),
          (this.area = i3),
          (this.continues = r3);
      }
      var e3 = t3.prototype;
      return (
        (e3.hasFloat = function (t4) {
          return this.continuations.some(function (e4) {
            return e4.float === t4;
          });
        }),
        (e3.findNotAllowedFloat = function (t4) {
          for (var e4 = this.continuations.length - 1; e4 >= 0; e4--) {
            var n3 = this.continuations[e4].float;
            if (!n3.isAllowedOnContext(t4)) return n3;
          }
          return null;
        }),
        (e3.getOuterShape = function () {
          return this.area.getOuterShape(null, null);
        }),
        (e3.getOuterRect = function () {
          return this.area.getOuterRect();
        }),
        (e3.getOrder = function () {
          var t4 = this.continuations.map(function (t5) {
            return t5.float;
          });
          return Math.min.apply(
            null,
            t4.map(function (t5) {
              return t5.getOrder();
            }),
          );
        }),
        (e3.shouldBeStashedBefore = function (t4) {
          return this.getOrder() < t4.getOrder();
        }),
        (e3.addContinuations = function (t4) {
          var e4 = this;
          t4.forEach(function (t5) {
            e4.continuations.push(t5);
          });
        }),
        (e3.getFlowName = function () {
          var t4 = this.continuations[0].float.flowName;
          return (
            this.continuations.every(function (e4) {
              return e4.float.flowName === t4;
            }),
            t4
          );
        }),
        t3
      );
    })();
    var os = (function () {
      function t3(t4, e3) {
        (this.float = t4), (this.nodePosition = e3);
      }
      return (
        (t3.prototype.equals = function (t4) {
          return (
            !!t4 &&
            (this === t4 ||
              (this.float === t4.float &&
                Ua(this.nodePosition, t4.nodePosition)))
          );
        }),
        t3
      );
    })();
    var as = (function () {
      function t3(t4, e4, n3, i3, r3, o3, a3) {
        (this.parent = t4),
          (this.floatReference = e4),
          (this.container = n3),
          (this.flowName = i3),
          (this.generatingNodePosition = r3),
          (this.children = []),
          (this.invalidated = false),
          (this.forbiddenFloats = []),
          (this.floatFragments = []),
          (this.stashedFloatFragments = []),
          (this.floatAnchors = {}),
          (this.floatsDeferredToNext = []),
          (this.layoutConstraints = []),
          (this.locked = false),
          t4 && t4.children.push(this),
          (this.writingMode = o3 || (t4 && t4.writingMode) || Ye.horizontal_tb),
          (this.direction = a3 || (t4 && t4.direction) || Ye.ltr),
          (this.floatStore = t4 ? t4.floatStore : new is());
        var s3 = this.getPreviousSibling();
        this.floatsDeferredFromPrevious = s3
          ? [].concat(s3.floatsDeferredToNext)
          : [];
      }
      var e3 = t3.prototype;
      return (
        (e3.getParent = function (t4) {
          if (!this.parent)
            throw new Error('No PageFloatLayoutContext for ' + t4);
          return this.parent;
        }),
        (e3.getPreviousSiblingOf = function (t4, e4, n3, i3) {
          var r3 = this.children.indexOf(t4);
          r3 < 0 && (r3 = this.children.length);
          for (var o3 = r3 - 1; o3 >= 0; o3--) {
            var a3 = this.children[o3];
            if (
              a3.floatReference === e4 &&
              a3.flowName === n3 &&
              Ua(a3.generatingNodePosition, i3)
            )
              return a3;
            if ((a3 = a3.getPreviousSiblingOf(null, e4, n3, i3))) return a3;
          }
          return null;
        }),
        (e3.getPreviousSibling = function () {
          for (var t4, e4 = this, n3 = this.parent; n3; ) {
            if (
              (t4 = n3.getPreviousSiblingOf(
                e4,
                this.floatReference,
                this.flowName,
                this.generatingNodePosition,
              ))
            )
              return t4;
            (e4 = n3), (n3 = n3.parent);
          }
          return null;
        }),
        (e3.getContainer = function (t4) {
          return t4 && t4 !== this.floatReference
            ? this.getParent(t4).getContainer(t4)
            : this.container;
        }),
        (e3.setContainer = function (t4) {
          (this.container = t4), this.reattachFloatFragments();
        }),
        (e3.addPageFloat = function (t4) {
          this.floatStore.addPageFloat(t4);
        }),
        (e3.getPageFloatLayoutContext = function (t4) {
          return t4 === this.floatReference
            ? this
            : this.getParent(t4).getPageFloatLayoutContext(t4);
        }),
        (e3.findPageFloatByNodePosition = function (t4) {
          return this.floatStore.findPageFloatByNodePosition(t4);
        }),
        (e3.forbid = function (t4) {
          var e4 = t4.getId(),
            n3 = t4.floatReference;
          n3 === this.floatReference
            ? this.forbiddenFloats.includes(e4) ||
              (this.forbiddenFloats.push(e4),
              new ls().findByFloat(t4).forbid(t4, this))
            : this.getParent(n3).forbid(t4);
        }),
        (e3.isForbidden = function (t4) {
          var e4 = t4.getId(),
            n3 = t4.floatReference;
          return n3 === this.floatReference
            ? this.forbiddenFloats.includes(e4)
            : this.getParent(n3).isForbidden(t4);
        }),
        (e3.addPageFloatFragment = function (t4, e4) {
          var n3 = t4.floatReference;
          n3 !== this.floatReference
            ? this.getParent(n3).addPageFloatFragment(t4, e4)
            : this.floatFragments.includes(t4) ||
              (this.floatFragments.push(t4),
              this.floatFragments.sort(function (t5, e5) {
                return t5.getOrder() - e5.getOrder();
              })),
            e4 || this.invalidate();
        }),
        (e3.removePageFloatFragment = function (t4, e4) {
          var n3 = t4.floatReference;
          if (n3 !== this.floatReference)
            this.getParent(n3).removePageFloatFragment(t4, e4);
          else {
            var i3 = this.floatFragments.indexOf(t4);
            if (i3 >= 0) {
              var r3 = this.floatFragments.splice(i3, 1)[0],
                o3 = r3.area && r3.area.element;
              o3 && o3.parentNode && o3.parentNode.removeChild(o3),
                e4 || this.invalidate();
            }
          }
        }),
        (e3.findPageFloatFragment = function (t4) {
          if (t4.floatReference !== this.floatReference)
            return this.getParent(t4.floatReference).findPageFloatFragment(t4);
          var e4 = this.floatFragments.findIndex(function (e5) {
            return e5.hasFloat(t4);
          });
          return e4 >= 0 ? this.floatFragments[e4] : null;
        }),
        (e3.hasFloatFragments = function (t4) {
          return (
            !(
              !(this.floatFragments.length > 0) ||
              (t4 && !this.floatFragments.some(t4))
            ) ||
            (!!this.parent && this.parent.hasFloatFragments(t4))
          );
        }),
        (e3.hasContinuingFloatFragmentsInFlow = function (t4) {
          return this.hasFloatFragments(function (e4) {
            return e4.continues && e4.getFlowName() === t4;
          });
        }),
        (e3.registerPageFloatAnchor = function (t4, e4) {
          this.floatAnchors[t4.getId()] = e4;
        }),
        (e3.collectPageFloatAnchors = function () {
          var t4 = Object.assign({}, this.floatAnchors);
          return this.children.reduce(function (t5, e4) {
            return Object.assign(t5, e4.collectPageFloatAnchors());
          }, t4);
        }),
        (e3.isAnchorAlreadyAppeared = function (t4) {
          if (
            this.getDeferredPageFloatContinuations().some(function (e5) {
              return e5.float.getId() === t4;
            })
          )
            return true;
          var e4 = this.collectPageFloatAnchors()[t4];
          return (
            !!e4 &&
            !(!this.container || !this.container.element) &&
            this.container.element.contains(e4)
          );
        }),
        (e3.deferPageFloat = function (t4) {
          var e4 = t4.float;
          if (e4.floatReference === this.floatReference) {
            var n3 = this.floatsDeferredToNext.findIndex(function (t5) {
              return t5.float === e4;
            });
            n3 >= 0
              ? this.floatsDeferredToNext.splice(n3, 1, t4)
              : this.floatsDeferredToNext.push(t4);
          } else this.getParent(e4.floatReference).deferPageFloat(t4);
        }),
        (e3.hasPrecedingFloatsDeferredToNext = function (t4, e4) {
          if (!e4 && t4.floatReference !== this.floatReference)
            return this.getParent(
              t4.floatReference,
            ).hasPrecedingFloatsDeferredToNext(t4, false);
          var n3 = t4.getOrder();
          return (
            !!this.floatsDeferredToNext.some(function (e5) {
              return (
                e5.float.getOrder() < n3 && !t4.isAllowedToPrecede(e5.float)
              );
            }) ||
            (!!this.parent &&
              this.parent.hasPrecedingFloatsDeferredToNext(t4, true))
          );
        }),
        (e3.getLastFollowingFloatInFragments = function (t4) {
          var e4 = t4.getOrder(),
            n3 = null;
          if (
            (this.floatFragments.forEach(function (t5) {
              t5.continuations.forEach(function (t6) {
                var i4 = t6.float,
                  r3 = i4.getOrder();
                r3 > e4 && (!n3 || r3 > n3.getOrder()) && (n3 = i4);
              });
            }),
            this.parent)
          ) {
            var i3 = this.parent.getLastFollowingFloatInFragments(t4);
            i3 && (!n3 || i3.getOrder() > n3.getOrder()) && (n3 = i3);
          }
          return n3;
        }),
        (e3.getDeferredPageFloatContinuations = function (t4) {
          t4 = t4 || this.flowName;
          var e4 = this.floatsDeferredFromPrevious.filter(function (e5) {
            return !t4 || e5.float.flowName === t4;
          });
          return (
            this.parent &&
              (e4 = this.parent
                .getDeferredPageFloatContinuations(t4)
                .concat(e4)),
            e4.sort(function (t5, e5) {
              return t5.float.getOrder() - e5.float.getOrder();
            })
          );
        }),
        (e3.getPageFloatContinuationsDeferredToNext = function (t4) {
          t4 = t4 || this.flowName;
          var e4 = this.floatsDeferredToNext.filter(function (e5) {
            return !t4 || e5.float.flowName === t4;
          });
          return this.parent
            ? this.parent.getPageFloatContinuationsDeferredToNext(t4).concat(e4)
            : e4;
        }),
        (e3.getFloatsDeferredToNextInChildContexts = function () {
          for (
            var t4 = [], e4 = [], n3 = this.children.length - 1;
            n3 >= 0;
            n3--
          ) {
            var i3 = this.children[n3];
            e4.includes(i3.flowName) ||
              (e4.push(i3.flowName),
              (t4 = (t4 = t4.concat(
                i3.floatsDeferredToNext.map(function (t5) {
                  return t5.float;
                }),
              )).concat(i3.getFloatsDeferredToNextInChildContexts())));
          }
          return t4;
        }),
        (e3.checkAndForbidNotAllowedFloat = function () {
          if (this.checkAndForbidFloatFollowingDeferredFloat()) return true;
          for (var t4 = this.floatFragments.length - 1; t4 >= 0; t4--) {
            var e4 = this.floatFragments[t4],
              n3 = e4.findNotAllowedFloat(this);
            if (n3)
              return (
                this.locked
                  ? this.invalidate()
                  : (this.removePageFloatFragment(e4),
                    this.forbid(n3),
                    this.removeEndFloatFragments(e4.floatSide)),
                true
              );
          }
          return (
            !(this.floatReference !== ts.REGION || !this.parent.locked) &&
            this.parent.checkAndForbidNotAllowedFloat()
          );
        }),
        (e3.checkAndForbidFloatFollowingDeferredFloat = function () {
          var t4 = this,
            e4 = this.getFloatsDeferredToNextInChildContexts(),
            n3 = this.floatFragments.reduce(function (t5, e5) {
              return t5.concat(
                e5.continuations.map(function (t6) {
                  return t6.float;
                }),
              );
            }, []);
          n3.sort(function (t5, e5) {
            return e5.getOrder() - t5.getOrder();
          });
          for (
            var i3,
              r3 = function () {
                var n4 = i3.value,
                  r4 = n4.getOrder();
                if (
                  e4.some(function (t5) {
                    return !n4.isAllowedToPrecede(t5) && r4 > t5.getOrder();
                  })
                ) {
                  if (t4.locked) t4.invalidate();
                  else {
                    t4.forbid(n4);
                    var o4 = t4.findPageFloatFragment(n4);
                    t4.removePageFloatFragment(o4);
                  }
                  return { v: true };
                }
              },
              o3 = D(n3);
            !(i3 = o3()).done;

          ) {
            var a3 = r3();
            if ('object' == typeof a3) return a3.v;
          }
          return false;
        }),
        (e3.finish = function () {
          var t4 = this;
          if (!this.checkAndForbidNotAllowedFloat()) {
            for (var e4 = this.floatsDeferredToNext.length - 1; e4 >= 0; e4--)
              if (
                !this.floatsDeferredToNext[e4].float.isAllowedOnContext(this)
              ) {
                if (this.locked) return void this.invalidate();
                this.floatsDeferredToNext.splice(e4, 1);
              }
            this.floatsDeferredFromPrevious.forEach(function (e5) {
              t4.floatsDeferredToNext.findIndex(function (t5) {
                return e5.equals(t5);
              }) >= 0 ||
                t4.floatFragments.some(function (t5) {
                  return t5.hasFloat(e5.float);
                }) ||
                t4.floatsDeferredToNext.push(e5);
            });
          }
        }),
        (e3.hasSameContainerAs = function (t4) {
          return (
            !!this.container &&
            !!t4.container &&
            this.container.element === t4.container.element
          );
        }),
        (e3.invalidate = function () {
          var t4 = this;
          (this.invalidated = true),
            this.locked ||
              (this.container &&
                (this.children.forEach(function (e4) {
                  t4.hasSameContainerAs(e4) &&
                    e4.floatFragments.forEach(function (t5) {
                      var e5 = t5.area.element;
                      e5 && e5.parentNode && e5.parentNode.removeChild(e5);
                    });
                }),
                this.container.clear()),
              this.children.forEach(function (t5) {
                t5.layoutConstraints.splice(0);
              }),
              this.children.splice(0),
              Object.keys(this.floatAnchors).forEach(function (e4) {
                delete t4.floatAnchors[e4];
              }));
        }),
        (e3.detachChildren = function () {
          var t4 = this.children.splice(0);
          return (
            t4.forEach(function (t5) {
              t5.floatFragments.forEach(function (t6) {
                var e4 = t6.area.element;
                e4 && e4.parentNode && e4.parentNode.removeChild(e4);
              });
            }),
            t4
          );
        }),
        (e3.attachChildren = function (t4) {
          var e4 = this;
          t4.forEach(function (t5) {
            e4.children.push(t5), t5.reattachFloatFragments();
          });
        }),
        (e3.isInvalidated = function () {
          return (
            this.invalidated || (!!this.parent && this.parent.isInvalidated())
          );
        }),
        (e3.validate = function () {
          this.invalidated = false;
        }),
        (e3.toLogical = function (t4) {
          return ca(
            t4,
            this.writingMode.toString(),
            this.direction.toString() || null,
            Na,
          );
        }),
        (e3.toPhysical = function (t4) {
          return ca(
            t4,
            this.writingMode.toString(),
            this.direction.toString() || null,
            wa,
          );
        }),
        (e3.removeEndFloatFragments = function (t4) {
          var e4 = this.toLogical(t4);
          if ('block-end' === e4 || 'inline-end' === e4)
            for (var n3 = 0; n3 < this.floatFragments.length; ) {
              var i3 = this.floatFragments[n3];
              this.toLogical(i3.floatSide) === e4
                ? this.removePageFloatFragment(i3)
                : n3++;
            }
        }),
        (e3.stashEndFloatFragments = function (t4) {
          var e4 = t4.floatReference;
          if (e4 === this.floatReference) {
            var n3 = this.toLogical(t4.floatSide);
            if (
              'block-end' === n3 ||
              'snap-block' === n3 ||
              'inline-end' === n3
            )
              for (var i3 = 0; i3 < this.floatFragments.length; ) {
                var r3 = this.floatFragments[i3],
                  o3 = this.toLogical(r3.floatSide);
                (o3 === n3 || ('snap-block' === n3 && 'block-end' === o3)) &&
                r3.shouldBeStashedBefore(t4)
                  ? (this.stashedFloatFragments.push(r3),
                    this.floatFragments.splice(i3, 1))
                  : i3++;
              }
          } else this.getParent(e4).stashEndFloatFragments(t4);
        }),
        (e3.restoreStashedFragments = function (t4) {
          var e4 = this;
          t4 === this.floatReference
            ? (this.stashedFloatFragments.forEach(function (t5) {
                e4.addPageFloatFragment(t5, true);
              }),
              this.stashedFloatFragments.splice(0))
            : this.getParent(t4).restoreStashedFragments(t4);
        }),
        (e3.discardStashedFragments = function (t4) {
          t4 === this.floatReference
            ? this.stashedFloatFragments.splice(0)
            : this.getParent(t4).discardStashedFragments(t4);
        }),
        (e3.getStashedFloatFragments = function (t4) {
          return t4 === this.floatReference
            ? this.stashedFloatFragments.concat().sort(function (t5, e4) {
                return e4.getOrder() - t5.getOrder();
              })
            : this.getParent(t4).getStashedFloatFragments(t4);
        }),
        (e3.getLimitValue = function (t4, e4, n3, i3) {
          var r3 = this.toLogical(t4),
            o3 = this.toPhysical(t4),
            a3 = this.getLimitValueInner(r3, e4, n3, i3);
          if (this.parent && this.parent.container) {
            var s3 = this.parent.getLimitValue(o3, e4, n3, i3);
            switch (o3) {
              case 'top':
              case 'left':
                return Math.max(a3, s3);
              case 'bottom':
              case 'right':
                return Math.min(a3, s3);
            }
          }
          return a3;
        }),
        (e3.getLimitValueInner = function (t4, e4, n3, i3) {
          var r3 = this.getLimitValuesInner(e4, n3, i3);
          switch (t4) {
            case 'block-start':
              return this.container.vertical ? r3.right : r3.top;
            case 'block-end':
              return this.container.vertical ? r3.left : r3.bottom;
            case 'inline-start':
              return this.container.vertical ? r3.top : r3.left;
            case 'inline-end':
              return this.container.vertical ? r3.bottom : r3.right;
            default:
              throw new Error('Unknown logical side: ' + t4);
          }
        }),
        (e3.getLimitValuesInner = function (t4, e4, n3) {
          var i3 = this,
            r3 = this.container.originX,
            o3 = this.container.originY,
            a3 = this.container.getPaddingRect(),
            s3 = {
              top: a3.y1 - o3,
              left: a3.x1 - r3,
              bottom: a3.y2 - o3,
              right: a3.x2 - r3,
              floatMinWrapBlockStart: 0,
              floatMinWrapBlockEnd: 0,
            };
          function l3(n4, i4, r4) {
            return '%' === n4.unit
              ? (r4 * n4.num) / 100
              : t4.convertLengthToPx(n4, i4, e4);
          }
          var u3 = this.floatFragments;
          return (
            u3.length > 0 &&
              (s3 = u3.reduce(function (t5, e5) {
                if (n3 && !n3(e5, i3)) return t5;
                var r4 = i3.toLogical(e5.floatSide),
                  o4 = e5.area,
                  s4 = e5.continuations[0].float.floatMinWrapBlock,
                  u4 = t5.top,
                  h3 = t5.left,
                  c3 = t5.bottom,
                  f3 = t5.right,
                  d3 = t5.floatMinWrapBlockStart,
                  p3 = t5.floatMinWrapBlockEnd;
                switch (r4) {
                  case 'inline-start':
                    o4.vertical
                      ? (u4 = Math.max(u4, o4.top + o4.height))
                      : (h3 = Math.max(h3, o4.left + o4.width));
                    break;
                  case 'block-start':
                    o4.vertical
                      ? (s4 &&
                          o4.left < f3 &&
                          (d3 = l3(s4, o4.rootViewNodes[0], a3.x2 - a3.x1)),
                        (f3 = Math.min(f3, o4.left)))
                      : (s4 &&
                          o4.top + o4.height > u4 &&
                          (d3 = l3(s4, o4.rootViewNodes[0], a3.y2 - a3.y1)),
                        (u4 = Math.max(u4, o4.top + o4.height)));
                    break;
                  case 'inline-end':
                    o4.vertical
                      ? (c3 = Math.min(c3, o4.top))
                      : (f3 = Math.min(f3, o4.left));
                    break;
                  case 'block-end':
                    o4.vertical
                      ? (s4 &&
                          o4.left + o4.width > h3 &&
                          (p3 = l3(s4, o4.rootViewNodes[0], a3.x2 - a3.x1)),
                        (h3 = Math.max(h3, o4.left + o4.width)))
                      : (s4 &&
                          o4.top < c3 &&
                          (p3 = l3(s4, o4.rootViewNodes[0], a3.y2 - a3.y1)),
                        (c3 = Math.min(c3, o4.top)));
                    break;
                  default:
                    throw new Error('Unknown logical float side: ' + r4);
                }
                return {
                  top: u4,
                  left: h3,
                  bottom: c3,
                  right: f3,
                  floatMinWrapBlockStart: d3,
                  floatMinWrapBlockEnd: p3,
                };
              }, s3)),
            (s3.left += r3),
            (s3.right += r3),
            (s3.top += o3),
            (s3.bottom += o3),
            s3
          );
        }),
        (e3.setFloatAreaDimensions = function (t4, e4, n3, i3, r3, o3, a3) {
          if (e4 !== this.floatReference)
            return this.getParent(e4).setFloatAreaDimensions(
              t4,
              e4,
              n3,
              i3,
              r3,
              o3,
              a3,
            );
          var s3 = this.toLogical(n3);
          if ('snap-block' === s3) {
            if (!a3['block-start'] && !a3['block-end']) return null;
          } else if (!a3[s3]) return null;
          var l3,
            u3,
            h3,
            c3,
            f3 = this.getLimitValue(
              'block-start',
              t4.layoutContext,
              t4.clientLayout,
            ),
            d3 = this.getLimitValue(
              'block-end',
              t4.layoutContext,
              t4.clientLayout,
            ),
            p3 = this.getLimitValue(
              'inline-start',
              t4.layoutContext,
              t4.clientLayout,
            ),
            g3 = this.getLimitValue(
              'inline-end',
              t4.layoutContext,
              t4.clientLayout,
            ),
            m3 = t4.vertical ? t4.originX : t4.originY,
            v3 = t4.vertical ? t4.originY : t4.originX;
          function E2(e5, n4) {
            var i4 = e5(t4.bands, n4);
            return i4
              ? (t4.vertical && (i4 = mn(i4)),
                (f3 = t4.vertical ? Math.min(f3, i4.x2) : Math.max(f3, i4.y1)),
                (d3 = t4.vertical ? Math.max(d3, i4.x1) : Math.min(d3, i4.y2)),
                true)
              : o3;
          }
          if (
            ((f3 = t4.vertical
              ? Math.min(
                  f3,
                  t4.left +
                    t4.getInsetLeft() +
                    t4.width +
                    t4.getInsetRight() +
                    m3,
                )
              : Math.max(f3, t4.top + m3)),
            (d3 = t4.vertical
              ? Math.max(d3, t4.left + m3)
              : Math.min(
                  d3,
                  t4.top +
                    t4.getInsetTop() +
                    t4.height +
                    t4.getInsetBottom() +
                    m3,
                )),
            r3)
          ) {
            var y3 = t4.vertical
              ? gn(new tn(d3, p3, f3, g3))
              : new tn(p3, f3, g3, d3);
            if (
              ('block-start' === s3 ||
                'snap-block' === s3 ||
                'inline-start' === s3) &&
              !E2(wn, y3)
            )
              return null;
            if (
              ('block-end' === s3 ||
                'snap-block' === s3 ||
                'inline-end' === s3) &&
              !E2(Nn, y3)
            )
              return null;
            if (
              ((l3 =
                (h3 = (d3 - f3) * t4.getBoxDir()) -
                t4.getInsetBefore() -
                t4.getInsetAfter()),
              (u3 = (c3 = g3 - p3) - t4.getInsetStart() - t4.getInsetEnd()),
              !o3 && (l3 <= 0 || u3 <= 0))
            )
              return null;
          } else {
            h3 =
              (l3 = t4.computedBlockSize) +
              t4.getInsetBefore() +
              t4.getInsetAfter();
            var w3 = (d3 - f3) * t4.getBoxDir();
            if ('snap-block' === s3) {
              if (null === i3) s3 = 'block-start';
              else {
                var N3 = this.container.getPaddingRect();
                s3 =
                  this.container.getBoxDir() *
                    (i3 - (this.container.vertical ? N3.x2 : N3.y1)) <=
                  this.container.getBoxDir() *
                    ((this.container.vertical ? N3.x1 : N3.y2) - i3 - h3)
                    ? 'block-start'
                    : 'block-end';
              }
              if (!a3[s3]) {
                if (!a3['block-end']) return null;
                s3 = 'block-end';
              }
            }
            if (!o3 && w3 < h3) return null;
            if (
              ((c3 =
                (u3 =
                  'inline-start' === s3 || 'inline-end' === s3
                    ? ba(t4.clientLayout, t4.element, [
                        fa.FIT_CONTENT_INLINE_SIZE,
                      ])[fa.FIT_CONTENT_INLINE_SIZE]
                    : t4.adjustContentRelativeSize
                    ? t4.getContentInlineSize()
                    : t4.vertical
                    ? t4.height
                    : t4.width) +
                t4.getInsetStart() +
                t4.getInsetEnd()),
              !o3 && g3 - p3 < c3)
            )
              return null;
          }
          switch (((f3 -= m3), (d3 -= m3), (p3 -= v3), (g3 -= v3), s3)) {
            case 'inline-start':
            case 'block-start':
            case 'snap-block':
              t4.setInlinePosition(p3, u3), t4.setBlockPosition(f3, l3);
              break;
            case 'inline-end':
            case 'block-end':
              t4.setInlinePosition(g3 - c3, u3),
                t4.setBlockPosition(d3 - h3 * t4.getBoxDir(), l3);
              break;
            default:
              throw new Error('unknown float direction: ' + n3);
          }
          return s3;
        }),
        (e3.getFloatFragmentExclusions = function () {
          var t4 = this.floatFragments.map(function (t5) {
            return t5.getOuterShape();
          });
          return this.parent
            ? this.parent.getFloatFragmentExclusions().concat(t4)
            : t4;
        }),
        (e3.reattachFloatFragments = function () {
          var t4 = this.container.element && this.container.element.parentNode;
          t4 &&
            this.floatFragments.forEach(function (e4) {
              t4.appendChild(e4.area.element);
            });
        }),
        (e3.getMaxReachedAfterEdge = function () {
          var t4 = this.getContainer().vertical;
          return this.floatFragments.reduce(
            function (e4, n3) {
              var i3 = n3.getOuterRect();
              return t4 ? Math.min(e4, i3.x1) : Math.max(e4, i3.y2);
            },
            t4 ? Infinity : 0,
          );
        }),
        (e3.getBlockStartEdgeOfBlockEndFloats = function () {
          var t4 = this.getContainer().vertical;
          return this.floatFragments
            .filter(function (t5) {
              return 'block-end' === t5.floatSide;
            })
            .reduce(
              function (e4, n3) {
                var i3 = n3.getOuterRect();
                return t4 ? Math.max(e4, i3.x2) : Math.min(e4, i3.y1);
              },
              t4 ? 0 : Infinity,
            );
        }),
        (e3.getPageFloatClearEdge = function (t4, e4) {
          function n3(t5) {
            return function (e5) {
              return t5.isAnchorAlreadyAppeared(e5.float.getId());
            };
          }
          function i3(t5, e5) {
            return t5.continuations.some(n3(e5));
          }
          for (
            var r3 = e4.getPaddingRect(),
              o3 = e4.vertical ? r3.x1 : r3.y2,
              a3 = this;
            a3;

          ) {
            if (a3.floatsDeferredToNext.some(n3(a3))) return o3;
            a3 = a3.parent;
          }
          var s3 = this.getLimitValue(
            'block-start',
            e4.layoutContext,
            e4.clientLayout,
            i3,
          );
          return this.getLimitValue(
            'block-end',
            e4.layoutContext,
            e4.clientLayout,
            i3,
          ) *
            e4.getBoxDir() <
            o3 * e4.getBoxDir()
            ? o3
            : s3;
        }),
        (e3.getPageFloatPlacementCondition = function (t4, e4, n3) {
          var i3 = this;
          if (t4.floatReference !== this.floatReference)
            return this.getParent(
              t4.floatReference,
            ).getPageFloatPlacementCondition(t4, e4, n3);
          var r3 = {
            'block-start': true,
            'block-end': true,
            'inline-start': true,
            'inline-end': true,
          };
          if (!n3) return r3;
          var o3,
            a3 = this.toLogical(e4),
            s3 = this.toLogical(n3);
          o3 =
            'all' === s3
              ? ['block-start', 'block-end', 'inline-start', 'inline-end']
              : 'both' === s3
              ? ['inline-start', 'inline-end']
              : 'same' === s3
              ? 'snap-block' === a3
                ? ['block-start', 'block-end']
                : [a3]
              : [s3];
          var l3 = t4.getOrder();
          function u3(t5) {
            return function (e5) {
              return e5.floatSide === t5 && e5.getOrder() < l3;
            };
          }
          return (
            o3.forEach(function (t5) {
              switch (t5) {
                case 'block-start':
                case 'inline-start':
                  r3[t5] = !(function t6(e5, n4) {
                    return e5.children.some(function (e6) {
                      return e6.floatFragments.some(u3(n4)) || t6(e6, n4);
                    });
                  })(i3, t5);
                  break;
                case 'block-end':
                case 'inline-end':
                  r3[t5] = !(function t6(e5, n4) {
                    var i4 = e5.parent;
                    return (
                      !!i4 && (i4.floatFragments.some(u3(n4)) || t6(i4, n4))
                    );
                  })(i3, t5);
                  break;
                default:
                  throw new Error('Unexpected side: ' + t5);
              }
            }),
            r3
          );
        }),
        (e3.getLayoutConstraints = function () {
          return (this.parent ? this.parent.getLayoutConstraints() : []).concat(
            this.layoutConstraints,
          );
        }),
        (e3.addLayoutConstraint = function (t4, e4) {
          e4 === this.floatReference
            ? this.layoutConstraints.push(t4)
            : this.getParent(e4).addLayoutConstraint(t4, e4);
        }),
        (e3.isColumnFullWithPageFloats = function (t4) {
          for (
            var e4 = t4.layoutContext,
              n3 = t4.clientLayout,
              i3 = this,
              r3 = null;
            i3 && i3.container;

          ) {
            var o3 = i3.getLimitValuesInner(e4, n3);
            r3
              ? t4.vertical
                ? (o3.right < r3.right &&
                    ((r3.right = o3.right),
                    (r3.floatMinWrapBlockStart = o3.floatMinWrapBlockStart)),
                  o3.left > r3.left &&
                    ((r3.left = o3.left),
                    (r3.floatMinWrapBlockEnd = o3.floatMinWrapBlockEnd)))
                : (o3.top > r3.top &&
                    ((r3.top = o3.top),
                    (r3.floatMinWrapBlockStart = o3.floatMinWrapBlockStart)),
                  o3.bottom < r3.bottom &&
                    ((r3.bottom = o3.bottom),
                    (r3.floatMinWrapBlockEnd = o3.floatMinWrapBlockEnd)))
              : (r3 = o3),
              (i3 = i3.parent);
          }
          var a3 = Math.max(r3.floatMinWrapBlockStart, r3.floatMinWrapBlockEnd);
          return (t4.vertical ? r3.right - r3.left : r3.bottom - r3.top) <= a3;
        }),
        (e3.getMaxBlockSizeOfPageFloats = function () {
          var t4 = this.getContainer().vertical;
          return this.floatFragments.length
            ? Math.max.apply(
                null,
                this.floatFragments.map(function (e4) {
                  var n3 = e4.area;
                  return t4 ? n3.width : n3.height;
                }),
              )
            : 0;
        }),
        (e3.lock = function () {
          this.locked = true;
        }),
        (e3.unlock = function () {
          this.locked = false;
        }),
        (e3.isLocked = function () {
          return this.locked;
        }),
        t3
      );
    })();
    var ss = [];
    var ls = (function () {
      function t3() {}
      t3.register = function (t4) {
        ss.push(t4);
      };
      var e3 = t3.prototype;
      return (
        (e3.findByNodeContext = function (t4) {
          for (var e4 = ss.length - 1; e4 >= 0; e4--) {
            var n3 = ss[e4];
            if (n3.appliesToNodeContext(t4)) return n3;
          }
          throw new Error('No PageFloatLayoutStrategy found for ' + t4);
        }),
        (e3.findByFloat = function (t4) {
          for (var e4 = ss.length - 1; e4 >= 0; e4--) {
            var n3 = ss[e4];
            if (n3.appliesToFloat(t4)) return n3;
          }
          throw new Error('No PageFloatLayoutStrategy found for ' + t4);
        }),
        t3
      );
    })();
    ls.register(
      new ((function () {
        function t3() {}
        var e3 = t3.prototype;
        return (
          (e3.appliesToNodeContext = function (t4) {
            return es(t4.floatReference);
          }),
          (e3.appliesToFloat = function (t4) {
            return true;
          }),
          (e3.createPageFloat = function (t4, e4, n3) {
            var i3 = t4.floatReference,
              r3 = t4.floatSide,
              o3 = t4.toNodePosition();
            return n3
              .resolveFloatReferenceFromColumnSpan(i3, t4.columnSpan, t4)
              .thenAsync(function (n4) {
                var a3 = new ns(
                  o3,
                  (i3 = n4),
                  r3,
                  t4.clearSide,
                  e4.flowName,
                  t4.floatMinWrapBlock,
                );
                return e4.addPageFloat(a3), Si(a3);
              });
          }),
          (e3.createPageFloatFragment = function (t4, e4, n3, i3) {
            return new rs(t4[0].float.floatReference, e4, t4, n3, i3);
          }),
          (e3.findPageFloatFragment = function (t4, e4) {
            return e4.findPageFloatFragment(t4);
          }),
          (e3.adjustPageFloatArea = function (t4, e4, n3) {}),
          (e3.forbid = function (t4, e4) {}),
          t3
        );
      })())(),
    );
    var us = rs;
    var hs = (function (t3) {
      function e3(e4, n3, i3, r3, o3) {
        var a3;
        return (
          ((a3 =
            t3.call(this, e4, n3, 'block-end', null, i3, o3) ||
            this).footnotePolicy = r3),
          a3
        );
      }
      return (
        I2(e3, t3),
        (e3.prototype.isAllowedToPrecede = function (t4) {
          return !(t4 instanceof e3);
        }),
        e3
      );
    })(ns);
    var cs = (function (t3) {
      function e3(e4, n4, i3, r3) {
        return t3.call(this, e4, 'block-end', n4, i3, r3) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getOrder = function () {
          return Infinity;
        }),
        (n3.shouldBeStashedBefore = function (t4) {
          return t4 instanceof hs || this.getOrder() < t4.getOrder();
        }),
        e3
      );
    })(us);
    var fs = (function () {
      function t3(t4) {
        this.footnote = t4;
      }
      return (
        (t3.prototype.allowLayout = function (t4) {
          return !Ua(t4.toNodePosition(), this.footnote.nodePosition);
        }),
        t3
      );
    })();
    ls.register(
      new ((function () {
        function t3() {}
        var e3 = t3.prototype;
        return (
          (e3.appliesToNodeContext = function (t4) {
            return 'footnote' === t4.floatSide;
          }),
          (e3.appliesToFloat = function (t4) {
            return t4 instanceof hs;
          }),
          (e3.createPageFloat = function (t4, e4, n3) {
            var i3 = ts.REGION,
              r3 = e4.getPageFloatLayoutContext(i3);
            e4.getPageFloatLayoutContext(ts.PAGE).hasSameContainerAs(r3) &&
              (i3 = ts.PAGE);
            var o3 = t4.toNodePosition(),
              a3 = new hs(
                o3,
                i3,
                e4.flowName,
                t4.footnotePolicy,
                t4.floatMinWrapBlock,
              );
            return e4.addPageFloat(a3), Si(a3);
          }),
          (e3.createPageFloatFragment = function (t4, e4, n3, i3) {
            return new cs(t4[0].float.floatReference, t4, n3, i3);
          }),
          (e3.findPageFloatFragment = function (t4, e4) {
            return (
              e4
                .getPageFloatLayoutContext(t4.floatReference)
                .floatFragments.filter(function (t5) {
                  return t5 instanceof cs;
                })[0] || null
            );
          }),
          (e3.adjustPageFloatArea = function (t4, e4, n3) {
            (t4.isFootnote = true), (t4.adjustContentRelativeSize = false);
            var i3 = t4.element;
            (t4.vertical = n3.layoutContext.applyFootnoteStyle(
              e4.vertical,
              n3.layoutContext.nodeContext &&
                'rtl' === n3.layoutContext.nodeContext.direction,
              i3,
            )),
              t4.convertPercentageSizesToPx(i3),
              n3.setComputedInsets(i3, t4),
              n3.setComputedWidthAndHeight(i3, t4);
          }),
          (e3.forbid = function (t4, e4) {
            var n3 = t4;
            switch (n3.footnotePolicy) {
              case Ye.line:
                var i3 = new fs(n3);
                e4.addLayoutConstraint(i3, n3.floatReference);
            }
          }),
          t3
        );
      })())(),
    );
    var ds = {
      page: true,
      left: true,
      right: true,
      recto: true,
      verso: true,
      column: true,
      region: true,
    };
    function ps(t3) {
      return !!ds[t3];
    }
    var gs = {
      avoid: true,
      'avoid-page': true,
      'avoid-column': true,
      'avoid-region': true,
    };
    function ms(t3) {
      return !!gs[t3];
    }
    function vs(t3, e3) {
      if (!t3) return e3;
      if (!e3) return t3;
      var n3 = ps(t3),
        i3 = ps(e3);
      if (!n3 || !i3) return i3 ? e3 : n3 ? t3 : ms(e3) ? e3 : ms(t3) ? t3 : e3;
      switch (e3) {
        case 'column':
          return t3;
        case 'region':
          return 'column' === t3 ? e3 : t3;
        default:
          return e3;
      }
    }
    function Es(t3) {
      switch (t3) {
        case 'left':
        case 'right':
        case 'recto':
        case 'verso':
          return t3;
        default:
          return 'any';
      }
    }
    function ys(t3) {
      switch (t3) {
        case 'left':
        case 'right':
        case 'recto':
        case 'verso':
          return t3;
        default:
          return null;
      }
    }
    function ws(t3, e3, n3, i3) {
      var r3 = t3.viewNode;
      if (!r3) return NaN;
      if (1 == r3.nodeType) {
        if (t3.after || !t3.inline) {
          var o3 = e3.getElementClientRect(r3);
          if (o3.right >= o3.left && o3.bottom >= o3.top)
            return t3.after
              ? i3
                ? o3.left
                : o3.bottom
              : i3
              ? o3.right
              : o3.top;
        }
        return NaN;
      }
      var a3 = NaN,
        s3 = r3.ownerDocument.createRange(),
        l3 = r3.textContent.length;
      if (!l3) return NaN;
      t3.after && (n3 += l3),
        n3 >= l3 && (n3 = l3 - 1),
        s3.setStart(r3, n3),
        s3.setEnd(r3, n3 + 1);
      var u3 = e3.getRangeClientRects(s3);
      i3 &&
        (function (t4) {
          if (null == pt) {
            var e4 = t4.ownerDocument,
              n4 = e4.createElement('div');
            (n4.style.position = 'absolute'),
              (n4.style.top = '0px'),
              (n4.style.left = '0px'),
              (n4.style.width = '100px'),
              (n4.style.height = '100px'),
              (n4.style.overflow = 'hidden'),
              (n4.style.lineHeight = '16px'),
              (n4.style.fontSize = '16px'),
              $2(n4, 'writing-mode', 'vertical-rl'),
              t4.appendChild(n4);
            var i4 = e4.createTextNode('a a a a a a a a a a a a a a a a');
            n4.appendChild(i4);
            var r4 = e4.createRange();
            r4.setStart(i4, 0), r4.setEnd(i4, 1);
            var o4 = r4.getBoundingClientRect();
            (pt = o4.right - o4.left < 10), t4.removeChild(n4);
          }
          return pt;
        })(document.body) &&
        (u3 = (function (t4, e4, n4) {
          var i4 = n4.ownerDocument.createRange();
          i4.setStart(n4, 0), i4.setEnd(n4, n4.textContent.length);
          for (
            var r4, o4 = t4.getRangeClientRects(i4), a4 = [], s4 = D(e4);
            !(r4 = s4()).done;

          ) {
            var l4 = r4.value,
              u4 = void 0;
            for (u4 = 0; u4 < o4.length; u4++) {
              var h4 = o4[u4];
              if (
                l4.top >= h4.top &&
                l4.bottom <= h4.bottom &&
                Math.abs(l4.left - h4.left) < 1
              ) {
                a4.push({
                  top: l4.top,
                  left: h4.left,
                  bottom: l4.bottom,
                  right: h4.right,
                });
                break;
              }
            }
            u4 == o4.length &&
              (c2.warn('Could not fix character box'), a4.push(l4));
          }
          return a4;
        })(e3, u3, r3));
      for (var h3, f3 = 0, d3 = D(u3); !(h3 = d3()).done; ) {
        var p3 = h3.value,
          g3 = i3 ? p3.bottom - p3.top : p3.right - p3.left;
        p3.right > p3.left &&
          p3.bottom > p3.top &&
          (isNaN(a3) || g3 > f3) &&
          ((a3 = i3 ? p3.left : p3.bottom), (f3 = g3));
      }
      return a3;
    }
    function Ns(t3, e3, n3) {
      var i3 = e3.clientLayout.getElementClientRect(t3),
        r3 = e3.getComputedMargin(t3);
      return n3
        ? i3.width + r3.left + r3.right
        : i3.height + r3.top + r3.bottom;
    }
    function bs(t3) {
      for (; t3; ) {
        if (t3.parentNode === t3.ownerDocument) return false;
        t3 = t3.parentNode;
      }
      return true;
    }
    function Ss(t3, e3) {
      if (t3) for (var n3; (n3 = t3.lastChild) != e3; ) t3.removeChild(n3);
    }
    function Cs(t3) {
      return !!t3.getAttribute('data-adapt-spec');
    }
    function Ts(t3) {
      if (!t3) return false;
      var e3 = t3.viewNode;
      return !(!e3 || 1 !== e3.nodeType) && Cs(e3);
    }
    d2('SIMPLE_PROPERTY', function (t3) {
      var e3 = t3.name,
        n3 = t3.value;
      switch (e3) {
        case 'page-break-before':
        case 'page-break-after':
        case 'page-break-inside':
          return {
            name: e3.replace(/^page-/, ''),
            value: n3 === Ye.always ? Ye.page : n3,
            important: t3.important,
          };
        default:
          return t3;
      }
    });
    var xs = (function () {
      function t3() {}
      var e3 = t3.prototype;
      return (
        (e3.calculateOffset = function (t4) {
          return Is(this.getNodeContext(), t4.collectElementsOffset());
        }),
        (e3.breakPositionChosen = function (t4) {}),
        (e3.getNodeContext = function () {
          return null;
        }),
        t3
      );
    })();
    function Is(t3, e3) {
      return {
        current: e3.reduce(function (e4, n3) {
          return e4 + n3.calculateOffset(t3);
        }, 0),
        minimum: e3.reduce(function (e4, n3) {
          return e4 + n3.calculateMinimumOffset(t3);
        }, 0),
      };
    }
    var Ps = (function (t3) {
      function e3(e4, n4, i3, r3) {
        var o3;
        return (
          ((o3 = t3.call(this) || this).position = e4),
          (o3.breakOnEdge = n4),
          (o3.overflows = i3),
          (o3.computedBlockSize = r3),
          (o3.isEdgeUpdated = false),
          (o3.edge = 0),
          (o3.overflowIfRepetitiveElementsDropped = i3),
          o3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.findAcceptableBreak = function (t4, e4) {
          return (
            this.updateOverflows(t4),
            e4 < this.getMinBreakPenalty()
              ? null
              : t4.findEdgeBreakPosition(this)
          );
        }),
        (n3.getMinBreakPenalty = function () {
          if (!this.isEdgeUpdated)
            throw new Error(
              'EdgeBreakPosition.prototype.updateEdge not called',
            );
          var t4 =
            this.isFirstContentOfRepetitiveElementsOwner() &&
            !this.overflowIfRepetitiveElementsDropped;
          return (
            (ms(this.breakOnEdge) ? 1 : 0) +
            (this.overflows && !t4 ? 3 : 0) +
            (this.position.parent ? this.position.parent.breakPenalty : 0)
          );
        }),
        (n3.updateEdge = function (t4) {
          var e4 = t4.calculateClonedPaddingBorder(this.position);
          (this.edge = ws(this.position, t4.clientLayout, 0, t4.vertical) + e4),
            (this.isEdgeUpdated = true);
        }),
        (n3.updateOverflows = function (t4) {
          this.isEdgeUpdated || this.updateEdge(t4);
          var e4 = this.edge,
            n4 = this.calculateOffset(t4);
          (this.overflowIfRepetitiveElementsDropped = t4.isOverflown(
            e4 + (t4.vertical ? -1 : 1) * n4.minimum,
          )),
            (this.overflows = this.position.overflow = t4.isOverflown(
              e4 + (t4.vertical ? -1 : 1) * n4.current,
            ));
        }),
        (n3.getNodeContext = function () {
          return this.position;
        }),
        (n3.isFirstContentOfRepetitiveElementsOwner = function () {
          var t4 = this.getNodeContext();
          if (!t4 || !t4.parent) return false;
          var e4 = t4.parent.formattingContext;
          if (!ma.isInstanceOfRepetitiveElementsOwnerFormattingContext(e4))
            return false;
          var n4 = e4.getRepetitiveElements();
          return !!n4 && n4.isFirstContentNode(t4);
        }),
        e3
      );
    })(xs);
    function Rs(t3) {
      var e3,
        n3 = t3.toString();
      switch (n3) {
        case 'inline-flex':
          e3 = 'flex';
          break;
        case 'inline-grid':
          e3 = 'grid';
          break;
        case 'inline-table':
          e3 = 'table';
          break;
        case 'inline':
        case 'table-row-group':
        case 'table-column':
        case 'table-column-group':
        case 'table-header-group':
        case 'table-footer-group':
        case 'table-row':
        case 'table-cell':
        case 'table-caption':
        case 'inline-block':
          e3 = 'block';
          break;
        default:
          e3 = n3;
      }
      return Fe(e3);
    }
    function As(t3) {
      return t3 === Ye.absolute || t3 === Ye.fixed;
    }
    function Ls(t3, e3, n3, i3) {
      return (
        t3 === Ye.none ||
          (As(e3)
            ? ((n3 = Ye.none), (t3 = Rs(t3)))
            : ((n3 && n3 !== Ye.none) || i3) && (t3 = Rs(t3))),
        { display: t3, position: e3, float: n3 }
      );
    }
    function Os(t3, e3, n3, i3) {
      return Ls(t3, e3, n3, i3).display === Ye.block;
    }
    function ks(t3) {
      switch (t3.toString()) {
        case 'inline':
        case 'inline-block':
        case 'inline-list-item':
        case 'inline-flex':
        case 'inline-grid':
        case 'ruby':
        case 'inline-table':
          return true;
        default:
          return false;
      }
    }
    var Fs = (function () {
      function t3() {}
      return (
        (t3.prototype.find = function (t4) {
          for (
            var e3 = g2(exports.HOOKS.RESOLVE_LAYOUT_PROCESSOR), n3 = 0;
            n3 < e3.length;
            n3++
          ) {
            var i3 = e3[n3](t4);
            if (i3) return i3;
          }
          throw new Error(
            'No processor found for a formatting context: ' + t4.getName(),
          );
        }),
        t3
      );
    })();
    var Ds = (function () {
      function t3() {}
      var e3 = t3.prototype;
      return (
        (e3.layout = function (t4, e4, n3) {
          return e4.isFloatNodeContext(t4)
            ? e4.layoutFloatOrFootnote(t4)
            : e4.isBreakable(t4)
            ? e4.layoutBreakableBlock(t4)
            : e4.layoutUnbreakable(t4);
        }),
        (e3.createEdgeBreakPosition = function (t4, e4, n3, i3) {
          return new Ps(t4.copy(), e4, n3, i3);
        }),
        (e3.startNonInlineElementNode = function (t4) {
          return false;
        }),
        (e3.afterNonInlineElementNode = function (t4, e4) {
          return false;
        }),
        (e3.clearOverflownViewNodes = function (t4, e4, n3, i3) {
          if (n3.viewNode && n3.viewNode.parentNode) {
            var r3 = n3.viewNode.parentNode;
            Ss(r3, n3.viewNode), i3 && r3.removeChild(n3.viewNode);
          }
        }),
        (e3.finishBreak = function (t4, e4, n3, i3) {
          var r3 =
            n3 ||
            (null != e4.viewNode && 1 == e4.viewNode.nodeType && !e4.after);
          return (
            t4.clearOverflownViewNodes(e4, r3),
            i3 &&
              (t4.fixJustificationIfNeeded(e4, true),
              t4.layoutContext.processFragmentedBlockEdge(r3 ? e4 : e4.parent)),
            Si(true)
          );
        }),
        t3
      );
    })();
    var _s = (function () {
      function t3(t4) {
        (this.parent = t4), (this.formattingContextType = 'Block');
      }
      var e3 = t3.prototype;
      return (
        (e3.getName = function () {
          return 'Block formatting context (BlockFormattingContext)';
        }),
        (e3.isFirstTime = function (t4, e4) {
          return e4;
        }),
        (e3.getParent = function () {
          return this.parent;
        }),
        (e3.saveState = function () {}),
        (e3.restoreState = function (t4) {}),
        t3
      );
    })();
    var Bs = new Ds();
    var Ms = da.isInstanceOfBlockFormattingContext;
    d2(exports.HOOKS.RESOLVE_FORMATTING_CONTEXT, function (
      t3,
      e3,
      n3,
      i3,
      r3,
      o3,
    ) {
      var a3 = t3.parent;
      return (!a3 && t3.formattingContext) ||
        (a3 && t3.formattingContext !== a3.formattingContext)
        ? null
        : t3.establishesBFC || (!t3.formattingContext && Os(n3, i3, r3, o3))
        ? new _s(a3 ? a3.formattingContext : null)
        : null;
    }),
      d2(exports.HOOKS.RESOLVE_LAYOUT_PROCESSOR, function (t3) {
        return t3 instanceof _s ? Bs : null;
      });
    var Us = (function () {
      function t3() {
        (this.initialBreakPositions = null),
          (this.initialStateOfFormattingContext = null);
      }
      var e3 = t3.prototype;
      return (
        (e3.layout = function (t4, e4) {
          return this.prepareLayout(t4, e4), this.tryLayout(t4, e4);
        }),
        (e3.tryLayout = function (t4, e4) {
          var n3 = this,
            i3 = bi('AbstractLayoutRetryer.tryLayout');
          this.saveState(t4, e4);
          var r3 = this.resolveLayoutMode(t4);
          return (
            r3.doLayout(t4, e4).then(function (o3) {
              var a3 = r3.accept(o3, e4);
              (a3 = r3.postLayout(o3, n3.initialPosition, e4, a3))
                ? i3.finish(o3)
                : (n3.clearNodes(n3.initialPosition),
                  n3.restoreState(t4, e4),
                  n3.tryLayout(n3.initialPosition, e4).thenFinish(i3));
            }),
            i3.result()
          );
        }),
        (e3.prepareLayout = function (t4, e4) {}),
        (e3.clearNodes = function (t4) {
          for (
            var e4, n3, i3 = t4.viewNode || t4.parent.viewNode;
            (e4 = i3.lastChild);

          )
            i3.removeChild(e4);
          for (; (n3 = i3.nextSibling); ) n3.parentNode.removeChild(n3);
        }),
        (e3.saveState = function (t4, e4) {
          (this.initialPosition = t4.copy()),
            (this.initialBreakPositions = [].concat(e4.breakPositions)),
            (this.initialFragmentLayoutConstraints = [].concat(
              e4.fragmentLayoutConstraints,
            )),
            t4.formattingContext &&
              (this.initialStateOfFormattingContext = t4.formattingContext.saveState());
        }),
        (e3.restoreState = function (t4, e4) {
          (e4.breakPositions = this.initialBreakPositions),
            (e4.fragmentLayoutConstraints = this.initialFragmentLayoutConstraints),
            t4.formattingContext &&
              t4.formattingContext.restoreState(
                this.initialStateOfFormattingContext,
              );
        }),
        t3
      );
    })();
    var Vs = (function () {
      function t3() {}
      var e3 = t3.prototype;
      return (
        (e3.initialState = function (t4) {
          return { nodeContext: t4, atUnforcedBreak: false, break: false };
        }),
        (e3.startNonDisplayableNode = function (t4) {}),
        (e3.afterNonDisplayableNode = function (t4) {}),
        (e3.startIgnoredTextNode = function (t4) {}),
        (e3.afterIgnoredTextNode = function (t4) {}),
        (e3.startNonElementNode = function (t4) {}),
        (e3.afterNonElementNode = function (t4) {}),
        (e3.startInlineElementNode = function (t4) {}),
        (e3.afterInlineElementNode = function (t4) {}),
        (e3.startNonInlineElementNode = function (t4) {}),
        (e3.afterNonInlineElementNode = function (t4) {}),
        (e3.finish = function (t4) {}),
        t3
      );
    })();
    var Hs = (function () {
      function t3(t4, e3) {
        (this.strategy = t4), (this.layoutContext = e3);
      }
      return (
        (t3.prototype.iterate = function (t4) {
          var e3 = this,
            n3 = this.strategy,
            i3 = n3.initialState(t4),
            r3 = bi('LayoutIterator');
          return (
            r3
              .loopWithFrame(function (t5) {
                for (var r4; i3.nodeContext; ) {
                  var o3 = ((r4 = i3.nodeContext.viewNode
                    ? 1 !== i3.nodeContext.viewNode.nodeType
                      ? ka(i3.nodeContext.viewNode, i3.nodeContext.whitespace)
                        ? i3.nodeContext.after
                          ? n3.afterIgnoredTextNode(i3)
                          : n3.startIgnoredTextNode(i3)
                        : i3.nodeContext.after
                        ? n3.afterNonElementNode(i3)
                        : n3.startNonElementNode(i3)
                      : i3.nodeContext.inline
                      ? i3.nodeContext.after
                        ? n3.afterInlineElementNode(i3)
                        : n3.startInlineElementNode(i3)
                      : i3.nodeContext.after
                      ? n3.afterNonInlineElementNode(i3)
                      : n3.startNonInlineElementNode(i3)
                    : i3.nodeContext.after
                    ? n3.afterNonDisplayableNode(i3)
                    : n3.startNonDisplayableNode(i3)) && r4.isPending()
                    ? r4
                    : Si(true)
                  ).thenAsync(function () {
                    return i3.break
                      ? Si(null)
                      : e3.layoutContext.nextInTree(
                          i3.nodeContext,
                          i3.atUnforcedBreak,
                        );
                  });
                  if (o3.isPending())
                    return void o3.then(function (e4) {
                      i3.break
                        ? t5.breakLoop()
                        : ((i3.nodeContext = e4), t5.continueLoop());
                    });
                  if (i3.break) return void t5.breakLoop();
                  i3.nodeContext = o3.get();
                }
                n3.finish(i3), t5.breakLoop();
              })
              .then(function () {
                r3.finish(i3.nodeContext);
              }),
            r3.result()
          );
        }),
        t3
      );
    })();
    var zs = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).leadingEdge = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.startNonInlineBox = function (t4) {}),
        (n3.endEmptyNonInlineBox = function (t4) {}),
        (n3.endNonInlineBox = function (t4) {}),
        (n3.initialState = function (t4) {
          return {
            nodeContext: t4,
            atUnforcedBreak: !!this.leadingEdge && t4.after,
            break: false,
            leadingEdge: this.leadingEdge,
            breakAtTheEdge: null,
            onStartEdges: false,
            leadingEdgeContexts: [],
            lastAfterNodeContext: null,
          };
        }),
        (n3.processForcedBreak = function (t4, e4) {
          var n4 = !t4.leadingEdge && ps(t4.breakAtTheEdge);
          if (n4) {
            var i3 = (t4.nodeContext =
              t4.leadingEdgeContexts[0] || t4.nodeContext);
            i3.viewNode.parentNode.removeChild(i3.viewNode),
              (e4.pageBreakType = t4.breakAtTheEdge);
          }
          return n4;
        }),
        (n3.saveEdgeAndProcessOverflow = function (t4, e4) {
          var n4 = e4.checkOverflowAndSaveEdgeAndBreakPosition(
            t4.lastAfterNodeContext,
            null,
            true,
            t4.breakAtTheEdge,
          );
          return (
            n4 &&
              ((t4.nodeContext = (
                t4.lastAfterNodeContext || t4.nodeContext
              ).modify()),
              (t4.nodeContext.overflow = true)),
            n4
          );
        }),
        (n3.processLayoutConstraint = function (t4, e4, n4) {
          var i3 = t4.nodeContext,
            r3 = !e4.allowLayout(i3);
          return (
            r3 &&
              (n4.checkOverflowAndSaveEdgeAndBreakPosition(
                t4.lastAfterNodeContext,
                null,
                false,
                t4.breakAtTheEdge,
              ),
              ((i3 = t4.nodeContext = i3.modify()).overflow = true)),
            r3
          );
        }),
        (n3.startNonElementNode = function (t4) {
          t4.onStartEdges = false;
        }),
        (n3.startNonInlineElementNode = function (t4) {
          return (
            t4.leadingEdgeContexts.push(t4.nodeContext.copy()),
            (t4.breakAtTheEdge = vs(
              t4.breakAtTheEdge,
              t4.nodeContext.breakBefore,
            )),
            (t4.onStartEdges = true),
            this.startNonInlineBox(t4)
          );
        }),
        (n3.afterNonInlineElementNode = function (t4) {
          var e4;
          return (t4.onStartEdges
            ? ((e4 = this.endEmptyNonInlineBox(t4)) && e4.isPending()
                ? e4
                : Si(true)
              ).thenAsync(function () {
                return (
                  t4.break ||
                    ((t4.leadingEdgeContexts = []),
                    (t4.leadingEdge = false),
                    (t4.atUnforcedBreak = false),
                    (t4.breakAtTheEdge = null)),
                  Si(true)
                );
              })
            : (e4 = this.endNonInlineBox(t4)) && e4.isPending()
            ? e4
            : Si(true)
          ).thenAsync(function () {
            return (
              t4.break ||
                ((t4.onStartEdges = false),
                (t4.lastAfterNodeContext = t4.nodeContext.copy()),
                (t4.breakAtTheEdge = vs(
                  t4.breakAtTheEdge,
                  t4.nodeContext.breakAfter,
                ))),
              Si(true)
            );
          });
        }),
        e3
      );
    })(Vs);
    var Gs = [];
    var Ws = new DOMParser().parseFromString(
      '<root xmlns="' + H2.SHADOW + '"/>',
      'text/xml',
    );
    var Xs = [
      'footnote-marker',
      'first-5-lines',
      'first-4-lines',
      'first-3-lines',
      'first-2-lines',
      'first-line',
      'first-letter',
      'before',
      '',
      'after',
    ];
    function js(t3) {
      return t3.getAttribute('data-adapt-pseudo') || '';
    }
    function Ys(t3, e3) {
      t3.setAttribute('data-adapt-pseudo', e3);
    }
    var Ks = (function () {
      function t3(t4, e4, n3, i3, r3) {
        (this.element = t4),
          (this.style = e4),
          (this.styler = n3),
          (this.context = i3),
          (this.exprContentListener = r3),
          (this.contentProcessed = {});
      }
      var e3 = t3.prototype;
      return (
        (e3.getStyle = function (t4, e4) {
          var n3 = js(t4);
          this.styler &&
            n3 &&
            n3.match(/after$/) &&
            ((this.style = this.styler.getStyle(this.element, true)),
            (this.styler = null));
          var i3 = zr(this.style, '_pseudos')[n3] || {};
          if (n3.match(/^first-/) && !i3['x-first-pseudo']) {
            var r3,
              o3 = 1;
            'first-letter' == n3
              ? (o3 = 0)
              : null != (r3 = n3.match(/^first-([0-9]+)-lines$/)) &&
                (o3 = r3[1] - 0),
              (i3['x-first-pseudo'] = new kr(new Be(o3), 0));
          }
          return i3;
        }),
        (e3.processContent = function (t4, e4) {
          var n3 = js(t4);
          if (!this.contentProcessed[n3]) {
            this.contentProcessed[n3] = true;
            var i3 = e4.content;
            i3 &&
              Ja(i3) &&
              i3.visit(new $a(t4, this.context, i3, this.exprContentListener));
          }
        }),
        t3
      );
    })();
    var qs = yr.registerFragmentIndex;
    var Qs = (function () {
      function t3(t4, e4) {
        (this.sourceNode = t4), (this.styler = e4);
      }
      var e3 = t3.prototype;
      return (
        (e3.createElement = function (t4, e4) {
          var n3 = this,
            i3 = e4.viewNode.ownerDocument.createElement('div'),
            r3 = new al(t4, i3, e4),
            o3 = r3.getColumn().pageBreakType;
          return (
            (r3.getColumn().pageBreakType = null),
            r3
              .layout(this.createNodePositionForPseudoElement(), true)
              .thenAsync(function () {
                (n3.styler.contentProcessed['after-if-continues'] = false),
                  (r3.getColumn().pageBreakType = o3);
                var t5 = i3.firstChild;
                return $2(t5, 'display', 'block'), Si(t5);
              })
          );
        }),
        (e3.createNodePositionForPseudoElement = function () {
          var t4 = Ws.createElementNS(H2.XHTML, 'div');
          Ys(t4, 'after-if-continues');
          var e4 = this.createShadowContext(t4);
          return new Ya({
            steps: [
              {
                node: t4,
                shadowType: e4.type,
                shadowContext: e4,
                nodeShadow: null,
                shadowSibling: null,
              },
            ],
            offsetInNode: 0,
            after: false,
            preprocessedTextContent: null,
          });
        }),
        (e3.createShadowContext = function (t4) {
          return new Ga(
            this.sourceNode,
            t4,
            null,
            null,
            null,
            Ea.ShadowType.ROOTED,
            this.styler,
          );
        }),
        t3
      );
    })();
    var Zs = (function () {
      function t3(t4, e4, n3) {
        (this.nodeContext = t4),
          (this.afterIfContinues = e4),
          (this.pseudoElementHeight = n3),
          (this.flagmentLayoutConstraintType = 'AfterIfContinue');
      }
      var e3 = t3.prototype;
      return (
        (e3.allowLayout = function (t4, e4, n3) {
          return !((e4 && !t4) || (t4 && t4.overflow));
        }),
        (e3.nextCandidate = function (t4) {
          return false;
        }),
        (e3.postLayout = function (t4, e4, n3, i3) {}),
        (e3.finishBreak = function (t4, e4) {
          var n3 = this;
          return this.getRepetitiveElements().affectTo(t4)
            ? this.afterIfContinues
                .createElement(e4, this.nodeContext)
                .thenAsync(function (t5) {
                  return n3.nodeContext.viewNode.appendChild(t5), Si(true);
                })
            : Si(true);
        }),
        (e3.getRepetitiveElements = function () {
          return new $s(this.nodeContext, this.pseudoElementHeight);
        }),
        (e3.equalsTo = function (e4) {
          return (
            e4 instanceof t3 && this.afterIfContinues == e4.afterIfContinues
          );
        }),
        (e3.getPriorityOfFinishBreak = function () {
          return 9;
        }),
        t3
      );
    })();
    var $s = (function () {
      function t3(t4, e4) {
        (this.nodeContext = t4), (this.pseudoElementHeight = e4);
      }
      var e3 = t3.prototype;
      return (
        (e3.calculateOffset = function (t4) {
          return this.affectTo(t4) ? this.pseudoElementHeight : 0;
        }),
        (e3.calculateMinimumOffset = function (t4) {
          return this.calculateOffset(t4);
        }),
        (e3.affectTo = function (t4) {
          if (!t4) return false;
          var e4 = t4.shadowContext ? t4.shadowContext.owner : t4.sourceNode;
          if (e4 === this.nodeContext.sourceNode) return !!t4.after;
          for (var n3 = e4.parentNode; n3; n3 = n3.parentNode)
            if (n3 === this.nodeContext.sourceNode) return true;
          return false;
        }),
        t3
      );
    })();
    function Js(t3, e3) {
      if (!t3 || !t3.afterIfContinues || t3.after || e3.isFloatNodeContext(t3))
        return Si(t3);
      var n3 = t3.afterIfContinues;
      return n3.createElement(e3, t3).thenAsync(function (i3) {
        var r3 = (function (t4, e4, n4) {
          var i4 = t4.viewNode;
          i4.appendChild(n4);
          var r4 = Ns(n4, e4, t4.vertical);
          return i4.removeChild(n4), r4;
        })(t3, e3, i3);
        return e3.fragmentLayoutConstraints.push(new Zs(t3, n3, r3)), Si(t3);
      });
    }
    function tl(t3, e3) {
      return t3.thenAsync(function (t4) {
        return Js(t4, e3);
      });
    }
    var el = { img: true, svg: true, audio: true, video: true };
    var nl = (function () {
      function t3(t4) {
        this.constraints = t4;
      }
      return (
        (t3.prototype.allowLayout = function (t4) {
          return this.constraints.every(function (e3) {
            return e3.allowLayout(t4);
          });
        }),
        t3
      );
    })();
    var il = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return (
          ((i3 = t3.call(this) || this).checkPoints = e4),
          (i3.penalty = n4),
          (i3.alreadyEvaluated = false),
          (i3.breakNodeContext = null),
          i3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.findAcceptableBreak = function (t4, e4) {
          return e4 < this.getMinBreakPenalty()
            ? null
            : (this.alreadyEvaluated ||
                ((this.breakNodeContext = t4.findBoxBreakPosition(
                  this,
                  e4 > 0,
                )),
                (this.alreadyEvaluated = true)),
              this.breakNodeContext);
        }),
        (n3.getMinBreakPenalty = function () {
          return this.penalty;
        }),
        (n3.getNodeContext = function () {
          return this.alreadyEvaluated
            ? this.breakNodeContext
            : this.checkPoints[this.checkPoints.length - 1];
        }),
        e3
      );
    })(xs);
    function rl(t3) {
      switch (t3) {
        case 'ruby':
        case 'inline-block':
        case 'inline-flex':
        case 'inline-grid':
        case 'inline-list-item':
        case 'inline-table':
          return true;
      }
      return false;
    }
    var ol = (function (t3) {
      function e3(e4, n4, i3, r3, o3) {
        var a3;
        return (
          ((a3 = t3.call(this, e4) || this).layoutContext = n4),
          (a3.clientLayout = i3),
          (a3.layoutConstraint = r3),
          (a3.pageFloatLayoutContext = o3),
          (a3.flowRootFormattingContext = null),
          (a3.isFloat = false),
          (a3.isFootnote = false),
          (a3.startEdge = 0),
          (a3.endEdge = 0),
          (a3.beforeEdge = 0),
          (a3.afterEdge = 0),
          (a3.footnoteEdge = 0),
          (a3.box = null),
          (a3.chunkPositions = null),
          (a3.bands = null),
          (a3.overflown = false),
          (a3.breakPositions = null),
          (a3.pageBreakType = null),
          (a3.forceNonfitting = true),
          (a3.leftFloatEdge = 0),
          (a3.rightFloatEdge = 0),
          (a3.bottommostFloatTop = 0),
          (a3.stopAtOverflow = true),
          (a3.lastAfterPosition = null),
          (a3.fragmentLayoutConstraints = []),
          (a3.pseudoParent = null),
          (a3.nodeContextOverflowingDueToRepetitiveElements = null),
          (a3.blockDistanceToBlockEndFloats = NaN),
          (a3.last = e4.lastChild),
          (a3.viewDocument = e4.ownerDocument),
          o3.setContainer(k2(a3)),
          a3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getTopEdge = function () {
          return this.vertical ? this.startEdge : this.beforeEdge;
        }),
        (n3.getBottomEdge = function () {
          return this.vertical ? this.endEdge : this.afterEdge;
        }),
        (n3.getLeftEdge = function () {
          return this.vertical ? this.afterEdge : this.startEdge;
        }),
        (n3.getRightEdge = function () {
          return this.vertical ? this.beforeEdge : this.endEdge;
        }),
        (n3.isFloatNodeContext = function (t4) {
          return !(!t4.floatSide || (this.isFloat && !t4.parent));
        }),
        (n3.stopByOverflow = function (t4) {
          return this.stopAtOverflow && !!t4 && t4.overflow;
        }),
        (n3.isOverflown = function (t4) {
          return this.vertical
            ? t4 < this.footnoteEdge
            : t4 > this.footnoteEdge;
        }),
        (n3.getExclusions = function () {
          var t4 = this.pageFloatLayoutContext.getFloatFragmentExclusions();
          return this.exclusions.concat(t4);
        }),
        (n3.openAllViews = function (t4) {
          var e4 = this,
            n4 = bi('openAllViews'),
            i3 = t4.steps;
          e4.layoutContext.setViewRoot(e4.element, e4.isFootnote);
          var r3 = i3.length - 1,
            o3 = null;
          return (
            n4
              .loop(function () {
                for (
                  ;
                  r3 >= 0 &&
                  ((o3 = Ha(i3[r3], o3)),
                  r3 !== i3.length - 1 ||
                    o3.formattingContext ||
                    (o3.formattingContext = e4.flowRootFormattingContext),
                  0 != r3 ||
                    ((o3.offsetInNode = e4.calculateOffsetInNodeForNodeContext(
                      t4,
                    )),
                    (o3.after = t4.after),
                    (o3.preprocessedTextContent = t4.preprocessedTextContent),
                    !o3.after));

                ) {
                  var n5 = e4.layoutContext.setCurrent(
                    o3,
                    0 == r3 && 0 == o3.offsetInNode,
                  );
                  if ((r3--, n5.isPending())) return n5;
                }
                return Si(false);
              })
              .then(function () {
                n4.finish(o3);
              }),
            n4.result()
          );
        }),
        (n3.calculateOffsetInNodeForNodeContext = function (t4) {
          return t4.preprocessedTextContent
            ? Ca(t4.preprocessedTextContent, t4.offsetInNode, 1)
            : t4.offsetInNode;
        }),
        (n3.maybePeelOff = function (t4, e4) {
          if (
            t4.firstPseudo &&
            t4.inline &&
            !t4.after &&
            0 == t4.firstPseudo.count &&
            1 != t4.viewNode.nodeType
          ) {
            var n4 = t4.viewNode.textContent.match(sl);
            return this.layoutContext.peelOff(t4, n4[0].length);
          }
          return Si(t4);
        }),
        (n3.buildViewToNextBlockEdge = function (t4, e4) {
          var n4 = this,
            i3 = false,
            r3 = bi('buildViewToNextBlockEdge');
          return (
            r3
              .loopWithFrame(function (r4) {
                t4.viewNode && !Ts(t4) && e4.push(t4.copy()),
                  n4.maybePeelOff(t4, 0).then(function (o3) {
                    o3 !== t4 && (Ts((t4 = o3)) || e4.push(t4.copy())),
                      n4.nextInTree(t4).then(function (e5) {
                        (t4 = e5)
                          ? ((!i3 && n4.layoutConstraint.allowLayout(t4)) ||
                              ((i3 = true),
                              ((t4 = t4.modify()).overflow = true)),
                            n4.isFloatNodeContext(t4) && !n4.vertical
                              ? n4
                                  .layoutFloatOrFootnote(t4)
                                  .then(function (e6) {
                                    (t4 = e6),
                                      n4.pageFloatLayoutContext.isInvalidated() &&
                                        (t4 = null),
                                      t4 ? r4.continueLoop() : r4.breakLoop();
                                  })
                              : t4.inline
                              ? r4.continueLoop()
                              : r4.breakLoop())
                          : r4.breakLoop();
                      });
                  });
              })
              .then(function () {
                r3.finish(t4);
              }),
            r3.result()
          );
        }),
        (n3.nextInTree = function (t4, e4) {
          return tl(this.layoutContext.nextInTree(t4, e4), this);
        }),
        (n3.buildDeepElementView = function (t4) {
          if (!t4.viewNode) return Si(t4);
          var e4 = [],
            n4 = t4.sourceNode,
            i3 = this,
            r3 = bi('buildDeepElementView');
          return (
            r3
              .loopWithFrame(function (r4) {
                t4.viewNode && t4.inline && !Ts(t4)
                  ? e4.push(t4.copy())
                  : (e4.length > 0 && i3.postLayoutBlock(t4, e4), (e4 = [])),
                  i3.maybePeelOff(t4, 0).then(function (o3) {
                    var a3 = o3;
                    if (a3 !== t4) {
                      for (var s3 = a3; s3 && s3.sourceNode != n4; )
                        s3 = s3.parent;
                      if (null == s3) return (t4 = a3), void r4.breakLoop();
                      Ts(a3) || e4.push(a3.copy());
                    }
                    i3.nextInTree(a3).then(function (e5) {
                      (t4 = e5) && t4.sourceNode != n4
                        ? i3.layoutConstraint.allowLayout(t4)
                          ? r4.continueLoop()
                          : (((t4 = t4.modify()).overflow = true),
                            i3.stopAtOverflow
                              ? r4.breakLoop()
                              : r4.continueLoop())
                        : r4.breakLoop();
                    });
                  });
              })
              .then(function () {
                e4.length > 0 && i3.postLayoutBlock(t4, e4), r3.finish(t4);
              }),
            r3.result()
          );
        }),
        (n3.createFloat = function (t4, e4, n4, i3) {
          var r3 = this.viewDocument.createElement('div');
          return (
            this.vertical
              ? (i3 >= this.height && (i3 -= 0.1),
                $2(r3, 'height', n4 + 'px'),
                $2(r3, 'width', i3 + 'px'))
              : (n4 >= this.width && (n4 -= 0.1),
                $2(r3, 'width', n4 + 'px'),
                $2(r3, 'height', i3 + 'px')),
            $2(r3, 'float', e4),
            $2(r3, 'clear', e4),
            this.element.insertBefore(r3, t4),
            r3
          );
        }),
        (n3.killFloats = function () {
          for (var t4 = this.element.firstChild; t4; ) {
            var e4 = t4.nextSibling;
            if (1 == t4.nodeType) {
              var n4 = t4,
                i3 = n4.style.cssFloat;
              if ('left' != i3 && 'right' != i3) break;
              this.element.removeChild(n4);
            }
            t4 = e4;
          }
        }),
        (n3.createFloats = function () {
          for (
            var t4,
              e4 = this.element.firstChild,
              n4 = this.bands,
              i3 = this.vertical ? this.getTopEdge() : this.getLeftEdge(),
              r3 = this.vertical ? this.getBottomEdge() : this.getRightEdge(),
              o3 = D(n4);
            !(t4 = o3()).done;

          ) {
            var a3 = t4.value,
              s3 = a3.y2 - a3.y1;
            (a3.left = this.createFloat(e4, 'left', a3.x1 - i3, s3)),
              (a3.right = this.createFloat(e4, 'right', r3 - a3.x2, s3));
          }
        }),
        (n3.calculateEdge = function (t4, e4, n4, i3) {
          var r3;
          if (t4 && bs(t4.viewNode)) return NaN;
          if (
            t4 &&
            t4.after &&
            !t4.inline &&
            ((r3 = ws(t4, this.clientLayout, 0, this.vertical)), !isNaN(r3))
          )
            return r3;
          for (var o3 = i3 - (t4 = e4[n4]).boxOffset; ; ) {
            if (
              ((r3 = ws(t4, this.clientLayout, o3, this.vertical)), !isNaN(r3))
            )
              return r3;
            if (o3 > 0) o3--;
            else {
              if (--n4 < 0) return this.beforeEdge;
              1 != (t4 = e4[n4]).viewNode.nodeType &&
                (o3 = t4.viewNode.textContent.length);
            }
          }
        }),
        (n3.parseComputedLength = function (t4) {
          if ('number' == typeof t4) return t4;
          var e4 = t4.match(/^(-?[0-9]*(\.[0-9]*)?)px$/);
          return e4 ? parseFloat(e4[0]) : 0;
        }),
        (n3.getComputedMargin = function (t4) {
          var e4 = this.clientLayout.getElementComputedStyle(t4),
            n4 = new nn(0, 0, 0, 0);
          return (
            e4 &&
              ((n4.left = this.parseComputedLength(e4.marginLeft)),
              (n4.top = this.parseComputedLength(e4.marginTop)),
              (n4.right = this.parseComputedLength(e4.marginRight)),
              (n4.bottom = this.parseComputedLength(e4.marginBottom))),
            n4
          );
        }),
        (n3.getComputedPaddingBorder = function (t4) {
          var e4 = this.clientLayout.getElementComputedStyle(t4),
            n4 = new nn(0, 0, 0, 0);
          return (
            e4 &&
              ((n4.left =
                this.parseComputedLength(e4.borderLeftWidth) +
                this.parseComputedLength(e4.paddingLeft)),
              (n4.top =
                this.parseComputedLength(e4.borderTopWidth) +
                this.parseComputedLength(e4.paddingTop)),
              (n4.right =
                this.parseComputedLength(e4.borderRightWidth) +
                this.parseComputedLength(e4.paddingRight)),
              (n4.bottom =
                this.parseComputedLength(e4.borderBottomWidth) +
                this.parseComputedLength(e4.paddingBottom))),
            n4
          );
        }),
        (n3.getComputedInsets = function (t4) {
          var e4 = this.clientLayout.getElementComputedStyle(t4),
            n4 = new nn(0, 0, 0, 0);
          if (e4) {
            if ('border-box' == e4.boxSizing) return this.getComputedMargin(t4);
            (n4.left =
              this.parseComputedLength(e4.marginLeft) +
              this.parseComputedLength(e4.borderLeftWidth) +
              this.parseComputedLength(e4.paddingLeft)),
              (n4.top =
                this.parseComputedLength(e4.marginTop) +
                this.parseComputedLength(e4.borderTopWidth) +
                this.parseComputedLength(e4.paddingTop)),
              (n4.right =
                this.parseComputedLength(e4.marginRight) +
                this.parseComputedLength(e4.borderRightWidth) +
                this.parseComputedLength(e4.paddingRight)),
              (n4.bottom =
                this.parseComputedLength(e4.marginBottom) +
                this.parseComputedLength(e4.borderBottomWidth) +
                this.parseComputedLength(e4.paddingBottom));
          }
          return n4;
        }),
        (n3.setComputedInsets = function (t4, e4) {
          var n4 = this.clientLayout.getElementComputedStyle(t4);
          n4 &&
            ((e4.marginLeft = this.parseComputedLength(n4.marginLeft)),
            (e4.borderLeft = this.parseComputedLength(n4.borderLeftWidth)),
            (e4.paddingLeft = this.parseComputedLength(n4.paddingLeft)),
            (e4.marginTop = this.parseComputedLength(n4.marginTop)),
            (e4.borderTop = this.parseComputedLength(n4.borderTopWidth)),
            (e4.paddingTop = this.parseComputedLength(n4.paddingTop)),
            (e4.marginRight = this.parseComputedLength(n4.marginRight)),
            (e4.borderRight = this.parseComputedLength(n4.borderRightWidth)),
            (e4.paddingRight = this.parseComputedLength(n4.paddingRight)),
            (e4.marginBottom = this.parseComputedLength(n4.marginBottom)),
            (e4.borderBottom = this.parseComputedLength(n4.borderBottomWidth)),
            (e4.paddingBottom = this.parseComputedLength(n4.paddingBottom)));
        }),
        (n3.setComputedWidthAndHeight = function (t4, e4) {
          var n4 = this.clientLayout.getElementComputedStyle(t4);
          n4 &&
            ((e4.width = this.parseComputedLength(n4.width)),
            (e4.height = this.parseComputedLength(n4.height)));
        }),
        (n3.layoutUnbreakable = function (t4) {
          return this.buildDeepElementView(t4);
        }),
        (n3.layoutFloat = function (t4) {
          var e4 = this,
            n4 = bi('layoutFloat'),
            i3 = t4.viewNode,
            r3 = t4.floatSide;
          return (
            $2(i3, 'float', 'none'),
            $2(i3, 'display', 'inline-block'),
            $2(i3, 'vertical-align', 'top'),
            e4.buildDeepElementView(t4).then(function (o3) {
              for (
                var a3 = e4.clientLayout.getElementClientRect(i3),
                  s3 = e4.getComputedMargin(i3),
                  l3 = new tn(
                    a3.left - s3.left,
                    a3.top - s3.top,
                    a3.right + s3.right,
                    a3.bottom + s3.bottom,
                  ),
                  u3 = e4.startEdge,
                  h3 = e4.endEdge,
                  c3 = t4.parent;
                c3 && c3.inline;

              )
                c3 = c3.parent;
              if (c3) {
                var f3 = c3.viewNode.ownerDocument.createElement('div');
                (f3.style.left = '0px'),
                  (f3.style.top = '0px'),
                  e4.vertical
                    ? ((f3.style.bottom = '0px'), (f3.style.width = '1px'))
                    : ((f3.style.right = '0px'), (f3.style.height = '1px')),
                  c3.viewNode.appendChild(f3);
                var d3 = e4.clientLayout.getElementClientRect(f3);
                (u3 = Math.max(e4.getStartEdge(d3), u3)),
                  (h3 = Math.min(e4.getEndEdge(d3), h3)),
                  c3.viewNode.removeChild(f3);
                var p3 = e4.vertical ? l3.y2 - l3.y1 : l3.x2 - l3.x1;
                'left' == r3
                  ? (h3 = Math.max(h3, u3 + p3))
                  : (u3 = Math.min(u3, h3 - p3)),
                  c3.viewNode.appendChild(t4.viewNode);
              }
              var g3 = new tn(
                  u3,
                  e4.getBoxDir() * e4.beforeEdge,
                  h3,
                  e4.getBoxDir() * e4.afterEdge,
                ),
                m3 = l3;
              e4.vertical && (m3 = gn(l3));
              var v3 = e4.getBoxDir();
              if (m3.y1 < e4.bottommostFloatTop * v3) {
                var E2 = m3.y2 - m3.y1;
                (m3.y1 = e4.bottommostFloatTop * v3), (m3.y2 = m3.y1 + E2);
              }
              !(function (t5, e5, n5, i4) {
                for (
                  var r4 = n5.y1,
                    o4 = n5.x2 - n5.x1,
                    a4 = n5.y2 - n5.y1,
                    s4 = yn(e5, r4);
                  ;

                ) {
                  var l4 = r4 + a4;
                  if (l4 > t5.y2) return false;
                  for (
                    var u4 = t5.x1, h4 = t5.x2, c4 = s4;
                    c4 < e5.length && e5[c4].y1 < l4;
                    c4++
                  ) {
                    var f4 = e5[c4];
                    f4.x1 > u4 && (u4 = f4.x1), f4.x2 < h4 && (h4 = f4.x2);
                  }
                  if (u4 + o4 <= h4 || s4 >= e5.length)
                    return (
                      'left' == i4
                        ? ((n5.x1 = u4), (n5.x2 = u4 + o4))
                        : ((n5.x1 = h4 - o4), (n5.x2 = h4)),
                      (n5.y2 += r4 - n5.y1),
                      (n5.y1 = r4),
                      true
                    );
                  (r4 = e5[s4].y2), s4++;
                }
              })(g3, e4.bands, m3, r3),
                e4.vertical && (l3 = mn(m3));
              var y3,
                w3 = e4.getComputedInsets(i3);
              $2(i3, 'width', l3.x2 - l3.x1 - w3.left - w3.right + 'px'),
                $2(i3, 'height', l3.y2 - l3.y1 - w3.top - w3.bottom + 'px'),
                $2(i3, 'position', 'absolute'),
                $2(i3, 'display', t4.display);
              var N3 = null;
              if (
                (c3 &&
                  (N3 = c3.containingBlockForAbsolute
                    ? c3
                    : c3.getContainingBlockForAbsolute()),
                N3)
              ) {
                var b3 = N3.viewNode.ownerDocument.createElement('div');
                (b3.style.position = 'absolute'),
                  N3.vertical ? (b3.style.right = '0') : (b3.style.left = '0'),
                  (b3.style.top = '0'),
                  N3.viewNode.appendChild(b3),
                  (y3 = e4.clientLayout.getElementClientRect(b3)),
                  N3.viewNode.removeChild(b3);
              } else y3 = { left: e4.getLeftEdge() - e4.paddingLeft, right: e4.getRightEdge() + e4.paddingRight, top: e4.getTopEdge() - e4.paddingTop };
              (N3 ? N3.vertical : e4.vertical)
                ? $2(i3, 'right', y3.right - l3.x2 + 'px')
                : $2(i3, 'left', l3.x1 - y3.left + 'px'),
                $2(i3, 'top', l3.y1 - y3.top + 'px'),
                t4.clearSpacer &&
                  (t4.clearSpacer.parentNode.removeChild(t4.clearSpacer),
                  (t4.clearSpacer = null));
              var S3 = e4.vertical ? l3.x1 : l3.y2,
                C3 = e4.vertical ? l3.x2 : l3.y1;
              e4.isOverflown(S3) && 0 != e4.breakPositions.length
                ? (((t4 = t4.modify()).overflow = true), n4.finish(t4))
                : (e4.killFloats(),
                  (g3 = new tn(
                    e4.getLeftEdge(),
                    e4.getTopEdge(),
                    e4.getRightEdge(),
                    e4.getBottomEdge(),
                  )),
                  e4.vertical && (g3 = gn(g3)),
                  (function (t5, e5, n5, i4, r4) {
                    for (
                      i4 || (i4 = [new on(n5.y1, n5.y2, n5.x1, n5.x2)]);
                      i4.length > 0 && i4[0].y2 <= t5.y1;

                    )
                      i4.shift();
                    if (0 != i4.length) {
                      var o4;
                      i4[0].y1 < t5.y1 && (i4[0].y1 = t5.y1);
                      var a4 = 0 == e5.length ? t5.y1 : e5[e5.length - 1].y2;
                      a4 < t5.y2 && e5.push(new on(a4, t5.y2, t5.x1, t5.x2));
                      for (
                        var s4, l4 = yn(e5, i4[0].y1), u4 = D(i4);
                        !(s4 = u4()).done;

                      ) {
                        var h4 = s4.value;
                        if (l4 == e5.length) break;
                        for (
                          e5[l4].y1 < h4.y1 &&
                          ((o4 = e5[l4]),
                          l4++,
                          e5.splice(l4, 0, new on(h4.y1, o4.y2, o4.x1, o4.x2)),
                          (o4.y2 = h4.y1));
                          l4 < e5.length &&
                          ((o4 = e5[l4++]).y2 > h4.y2 &&
                            (e5.splice(
                              l4,
                              0,
                              new on(h4.y2, o4.y2, o4.x1, o4.x2),
                            ),
                            (o4.y2 = h4.y2)),
                          h4.x1 != h4.x2 &&
                            ('left' == r4
                              ? (o4.x1 = Math.min(h4.x2, t5.x2))
                              : (o4.x2 = Math.max(h4.x1, t5.x1))),
                          o4.y2 != h4.y2);

                        );
                      }
                      En(t5, e5);
                    }
                  })(g3, e4.bands, m3, null, r3),
                  e4.createFloats(),
                  'left' == r3
                    ? (e4.leftFloatEdge = S3)
                    : (e4.rightFloatEdge = S3),
                  (e4.bottommostFloatTop = C3),
                  e4.updateMaxReachedAfterEdge(S3),
                  n4.finish(o3));
            }),
            n4.result()
          );
        }),
        (n3.setupFloatArea = function (t4, e4, n4, i3, r3, o3) {
          var a3 = this.pageFloatLayoutContext,
            s3 = a3.getContainer(e4),
            l3 = t4.element;
          s3.element.parentNode.appendChild(l3),
            (t4.isFloat = true),
            (t4.originX = s3.originX),
            (t4.originY = s3.originY),
            (t4.vertical = s3.vertical),
            (t4.marginLeft = t4.marginRight = t4.marginTop = t4.marginBottom = 0),
            (t4.borderLeft = t4.borderRight = t4.borderTop = t4.borderBottom = 0),
            (t4.paddingLeft = t4.paddingRight = t4.paddingTop = t4.paddingBottom = 0),
            (t4.exclusions = (s3.exclusions || []).concat()),
            (t4.forceNonfitting = !a3.hasFloatFragments()),
            (t4.innerShape = null);
          var u3 = s3.getPaddingRect();
          t4.setHorizontalPosition(u3.x1 - s3.originX, u3.x2 - u3.x1),
            t4.setVerticalPosition(u3.y1 - s3.originY, u3.y2 - u3.y1),
            r3.adjustPageFloatArea(t4, s3, this),
            t4.init();
          var h3 = !!a3.setFloatAreaDimensions(
            t4,
            e4,
            n4,
            i3,
            true,
            !a3.hasFloatFragments(),
            o3,
          );
          return (
            h3
              ? (t4.killFloats(), t4.init())
              : s3.element.parentNode.removeChild(l3),
            h3
          );
        }),
        (n3.createPageFloatArea = function (t4, e4, n4, i3, r3) {
          var o3 = this.element.ownerDocument.createElement('div');
          $2(o3, 'position', 'absolute');
          var a3 = this.pageFloatLayoutContext.getPageFloatLayoutContext(
              t4.floatReference,
            ),
            s3 = new as(
              null,
              ts.COLUMN,
              null,
              this.pageFloatLayoutContext.flowName,
              t4.nodePosition,
              null,
              null,
            ),
            l3 = a3.getContainer(),
            u3 = new fl(
              e4,
              o3,
              this.layoutContext.clone(),
              this.clientLayout,
              this.layoutConstraint,
              s3,
              l3,
            );
          return (
            s3.setContainer(u3),
            this.setupFloatArea(u3, t4.floatReference, e4, n4, i3, r3)
              ? u3
              : null
          );
        }),
        (n3.layoutSinglePageFloatFragment = function (
          t4,
          e4,
          n4,
          i3,
          r3,
          o3,
          a3,
        ) {
          var s3 = this.pageFloatLayoutContext,
            l3 = (t4 = (a3 ? a3.continuations : []).concat(t4))[0].float,
            u3 = s3.getPageFloatPlacementCondition(l3, e4, n4),
            h3 = this.createPageFloatArea(l3, e4, o3, r3, u3),
            c3 = { floatArea: h3, pageFloatFragment: null, newPosition: null };
          if (!h3) return Si(c3);
          var f3 = bi('layoutSinglePageFloatFragment'),
            d3 = false,
            p3 = 0;
          return (
            f3
              .loopWithFrame(function (e5) {
                if (p3 >= t4.length) e5.breakLoop();
                else {
                  var n5 = new Ya(t4[p3].nodePosition);
                  h3.layout(n5, true).then(function (t5) {
                    (c3.newPosition = t5),
                      !t5 || i3
                        ? (p3++, e5.continueLoop())
                        : ((d3 = true), e5.breakLoop());
                  });
                }
              })
              .then(function () {
                if (!d3) {
                  var n5 = s3.setFloatAreaDimensions(
                    h3,
                    l3.floatReference,
                    e4,
                    o3,
                    false,
                    i3,
                    u3,
                  );
                  if (n5) {
                    var a4 = r3.createPageFloatFragment(
                      t4,
                      n5,
                      h3,
                      !!c3.newPosition,
                    );
                    s3.addPageFloatFragment(a4, true),
                      (c3.pageFloatFragment = a4);
                  } else d3 = true;
                }
                f3.finish(c3);
              }),
            f3.result()
          );
        }),
        (n3.layoutPageFloatInner = function (t4, e4, n4, i3) {
          var r3 = this.pageFloatLayoutContext,
            o3 = t4.float;
          function a3(e5, n5) {
            n5
              ? r3.removePageFloatFragment(n5, true)
              : e5 && e5.element.parentNode.removeChild(e5.element),
              r3.restoreStashedFragments(o3.floatReference),
              r3.deferPageFloat(t4);
          }
          r3.stashEndFloatFragments(o3);
          var s3 = bi('layoutPageFloatInner'),
            l3 = this;
          return (
            this.layoutSinglePageFloatFragment(
              [t4],
              o3.floatSide,
              o3.clearSide,
              !r3.hasFloatFragments(),
              e4,
              n4,
              i3,
            ).then(function (t5) {
              var e5 = t5.floatArea,
                n5 = t5.pageFloatFragment,
                u3 = t5.newPosition;
              n5
                ? l3
                    .layoutStashedPageFloats(o3.floatReference, [i3])
                    .then(function (t6) {
                      if (t6) {
                        if (
                          (r3.addPageFloatFragment(n5),
                          r3.discardStashedFragments(o3.floatReference),
                          u3)
                        ) {
                          var i4 = new os(o3, u3.primary);
                          r3.deferPageFloat(i4);
                        }
                        s3.finish(true);
                      } else a3(e5, n5), s3.finish(false);
                    })
                : (a3(e5, n5), s3.finish(false));
            }),
            s3.result()
          );
        }),
        (n3.layoutStashedPageFloats = function (t4, e4) {
          var n4 = this.pageFloatLayoutContext,
            i3 = n4.getStashedFloatFragments(t4),
            r3 = [],
            o3 = [],
            a3 = false,
            s3 = bi('layoutStashedPageFloats'),
            l3 = this,
            u3 = 0;
          return (
            s3
              .loopWithFrame(function (t5) {
                if (u3 >= i3.length) t5.breakLoop();
                else {
                  var n5 = i3[u3];
                  if (e4.includes(n5)) return u3++, void t5.continueLoop();
                  var s4 = new ls().findByFloat(n5.continuations[0].float);
                  l3.layoutSinglePageFloatFragment(
                    n5.continuations,
                    n5.floatSide,
                    null,
                    false,
                    s4,
                    null,
                  ).then(function (e5) {
                    var n6 = e5.floatArea;
                    n6 && r3.push(n6);
                    var i4 = e5.pageFloatFragment;
                    i4
                      ? (o3.push(i4), u3++, t5.continueLoop())
                      : ((a3 = true), t5.breakLoop());
                  });
                }
              })
              .then(function () {
                a3
                  ? (o3.forEach(function (t5) {
                      n4.removePageFloatFragment(t5, true);
                    }),
                    r3.forEach(function (t5) {
                      var e5 = t5.element;
                      e5 && e5.parentNode && e5.parentNode.removeChild(e5);
                    }))
                  : i3.forEach(function (t5) {
                      var e5 = t5.area.element;
                      e5 && e5.parentNode && e5.parentNode.removeChild(e5);
                    }),
                  s3.finish(!a3);
              }),
            s3.result()
          );
        }),
        (n3.setFloatAnchorViewNode = function (t4) {
          var e4 = t4.viewNode.parentNode,
            n4 = e4.ownerDocument.createElement('span');
          n4.setAttribute('data-adapt-spec', '1'),
            'footnote' === t4.floatSide &&
              this.layoutContext.applyPseudoelementStyle(
                t4,
                'footnote-call',
                n4,
              ),
            e4.appendChild(n4),
            e4.removeChild(t4.viewNode);
          var i3 = t4.modify();
          return (i3.after = true), (i3.viewNode = n4), i3;
        }),
        (n3.resolveFloatReferenceFromColumnSpan = function (t4, e4, n4) {
          var i3 = this,
            r3 = bi('resolveFloatReferenceFromColumnSpan'),
            o3 = this.pageFloatLayoutContext,
            a3 = o3.getPageFloatLayoutContext(ts.REGION);
          return (
            o3.getContainer().width < a3.getContainer().width &&
            t4 === ts.COLUMN
              ? e4 === Ye.auto
                ? this.buildDeepElementView(n4.copy()).then(function (e5) {
                    var n5 = e5.viewNode,
                      o4 = ba(i3.clientLayout, n5, [
                        fa.MIN_CONTENT_INLINE_SIZE,
                      ])[fa.MIN_CONTENT_INLINE_SIZE],
                      a4 = i3.getComputedMargin(n5);
                    r3.finish(
                      (o4 += i3.vertical
                        ? a4.top + a4.bottom
                        : a4.left + a4.right) > i3.width
                        ? ts.REGION
                        : t4,
                    );
                  })
                : r3.finish(e4 === Ye.all ? ts.REGION : t4)
              : r3.finish(t4),
            r3.result()
          );
        }),
        (n3.layoutPageFloat = function (t4) {
          var e4 = this,
            n4 = this.pageFloatLayoutContext,
            i3 = new ls().findByNodeContext(t4),
            r3 = n4.findPageFloatByNodePosition(t4.toNodePosition());
          return (r3 ? Si(r3) : i3.createPageFloat(t4, n4, this)).thenAsync(
            function (r4) {
              var o3 = Va(t4, 0),
                a3 = e4.setFloatAnchorViewNode(t4),
                s3 = i3.findPageFloatFragment(r4, n4),
                l3 = new os(r4, o3);
              if (s3 && s3.hasFloat(r4))
                return n4.registerPageFloatAnchor(r4, a3.viewNode), Si(a3);
              if (n4.isForbidden(r4) || n4.hasPrecedingFloatsDeferredToNext(r4))
                return (
                  n4.deferPageFloat(l3),
                  n4.registerPageFloatAnchor(r4, a3.viewNode),
                  Si(a3)
                );
              if (e4.nodeContextOverflowingDueToRepetitiveElements)
                return Si(null);
              var u3 = ws(a3, e4.clientLayout, 0, e4.vertical);
              return e4.isOverflown(u3)
                ? Si(a3)
                : e4
                    .layoutPageFloatInner(l3, i3, u3, s3)
                    .thenAsync(function (t5) {
                      return t5
                        ? Si(null)
                        : (n4.registerPageFloatAnchor(r4, a3.viewNode), Si(a3));
                    });
            },
          );
        }),
        (n3.createJustificationAdjustmentElement = function (t4, e4, n4, i3) {
          var r3 = e4.createElement('span');
          (r3.style.visibility = 'hidden'),
            (r3.style.verticalAlign = 'top'),
            r3.setAttribute('data-adapt-spec', '1');
          var o3 = e4.createElement('span');
          (o3.style.fontSize = '0'),
            (o3.style.lineHeight = '0'),
            (o3.textContent = ' #'),
            r3.appendChild(o3),
            (r3.style.display = 'block'),
            (r3.style.textIndent = '0'),
            (r3.style.textAlign = 'left'),
            n4.insertBefore(r3, t4);
          var a3 = this.clientLayout.getElementClientRect(o3);
          r3.style.textAlign = 'right';
          var s3 = this.clientLayout.getElementClientRect(o3);
          (r3.style.textAlign = ''),
            (r3.style.display = (function (t5) {
              if (null === gt) {
                var e5 = t5.ownerDocument,
                  n5 = e5.createElement('div');
                (n5.style.position = 'absolute'),
                  (n5.style.top = '0px'),
                  (n5.style.left = '0px'),
                  (n5.style.width = '30px'),
                  (n5.style.height = '100px'),
                  (n5.style.lineHeight = '16px'),
                  (n5.style.fontSize = '16px'),
                  (n5.style.textAlign = 'justify'),
                  t5.appendChild(n5);
                var i4 = e5.createTextNode('a | ');
                n5.appendChild(i4);
                var r4 = e5.createElement('span');
                (r4.style.display = 'inline-block'),
                  (r4.style.width = '30px'),
                  n5.appendChild(r4);
                var o4 = e5.createRange();
                o4.setStart(i4, 0), o4.setEnd(i4, 3);
                var a4 = o4.getBoundingClientRect();
                (gt = a4.right < 27), t5.removeChild(n5);
              }
              return gt;
            })(document.body)
              ? 'inline'
              : 'inline-block');
          var l3 = i3 ? s3.top - a3.top : s3.left - a3.left,
            u3 = l3 >= 1 ? l3 - 1 + 'px' : '100%';
          return (
            i3 ? (r3.style.paddingTop = u3) : (r3.style.paddingLeft = u3), r3
          );
        }),
        (n3.addAndAdjustJustificationElement = function (
          t4,
          e4,
          n4,
          i3,
          r3,
          o3,
        ) {
          return (
            (function (t5, e5, n5, i4) {
              if (
                (function (t6) {
                  if (null === mt) {
                    var e6 = t6.ownerDocument,
                      n6 = e6.createElement('div');
                    (n6.style.position = 'absolute'),
                      (n6.style.top = '0px'),
                      (n6.style.left = '0px'),
                      (n6.style.width = '40px'),
                      (n6.style.height = '100px'),
                      (n6.style.lineHeight = '16px'),
                      (n6.style.fontSize = '16px'),
                      (n6.style.textAlign = 'justify'),
                      t6.appendChild(n6);
                    var i5 = e6.createTextNode('a a-');
                    n6.appendChild(i5);
                    var r5 = e6.createElement('span');
                    (r5.style.display = 'inline-block'),
                      (r5.style.width = '40px'),
                      n6.appendChild(r5);
                    var o5 = e6.createRange();
                    o5.setStart(i5, 2), o5.setEnd(i5, 4);
                    var a4 = o5.getBoundingClientRect();
                    (mt = a4.right < 37), t6.removeChild(n6);
                  }
                  return mt;
                })(document.body)
              ) {
                var r4 = ul(t5),
                  o4 = e5 ? n5 : n5.previousSibling,
                  a3 = o4 ? o4.textContent : '';
                if (a3.charAt(a3.length - 1) === r4) {
                  var s3 = n5.ownerDocument,
                    l3 = n5.parentNode;
                  !(function (t6) {
                    if (null === vt) {
                      var e6 = t6.ownerDocument,
                        n6 = e6.createElement('div');
                      (n6.style.position = 'absolute'),
                        (n6.style.top = '0px'),
                        (n6.style.left = '0px'),
                        (n6.style.width = '40px'),
                        (n6.style.height = '100px'),
                        (n6.style.lineHeight = '16px'),
                        (n6.style.fontSize = '16px'),
                        (n6.style.textAlign = 'justify'),
                        t6.appendChild(n6);
                      var i5 = e6.createTextNode('a a-');
                      n6.appendChild(i5),
                        n6.appendChild(e6.createElement('wbr'));
                      var r5 = e6.createElement('span');
                      (r5.style.display = 'inline-block'),
                        (r5.style.width = '40px'),
                        n6.appendChild(r5);
                      var o5 = e6.createRange();
                      o5.setStart(i5, 2), o5.setEnd(i5, 4);
                      var a4 = o5.getBoundingClientRect();
                      (vt = a4.right < 37), t6.removeChild(n6);
                    }
                    return vt;
                  })(document.body)
                    ? l3.insertBefore(s3.createElement('wbr'), i4)
                    : l3.insertBefore(s3.createTextNode(' '), i4);
                }
              }
            })(t4, e4, n4, i3),
            this.createJustificationAdjustmentElement(i3, r3, o3, t4.vertical)
          );
        }),
        (n3.compensateJustificationLineHeight = function (t4, e4, n4) {
          var i3 = this.clientLayout.getElementClientRect(t4),
            r3 = this.clientLayout.getElementClientRect(e4);
          n4.vertical
            ? ((e4.style.marginRight = r3.right - i3.right + 'px'),
              (e4.style.width = '0px'))
            : ((e4.style.marginTop = i3.top - r3.top + 'px'),
              (e4.style.height = '0px')),
            e4.setAttribute('data-adapt-spec', '1');
        }),
        (n3.fixJustificationIfNeeded = function (t4, e4) {
          if (!t4.after || t4.inline) {
            if (e4) {
              for (var n4 = '', i3 = t4.parent; i3 && !n4; i3 = i3.parent)
                !i3.inline && i3.viewNode && (n4 = i3.viewNode.style.textAlign);
              if ('justify' !== n4) return;
            }
            var r3 = t4.viewNode,
              o3 = r3.ownerDocument,
              a3 = e4 && (t4.after || 1 != r3.nodeType),
              s3 = a3 ? r3.nextSibling : r3;
            s3 && !s3.parentNode && (s3 = null);
            var l3 = r3.parentNode || (t4.parent && t4.parent.viewNode);
            if (l3) {
              var u3 = this.addAndAdjustJustificationElement(
                t4,
                a3,
                r3,
                s3,
                o3,
                l3,
              );
              if (!e4) {
                var h3 = o3.createElement('div');
                l3.insertBefore(h3, s3),
                  this.compensateJustificationLineHeight(u3, h3, t4);
              }
            }
          }
        }),
        (n3.processLineStyling = function (t4, e4, n4) {
          var i3 = this,
            r3 = bi('processLineStyling'),
            o3 = n4.concat([]);
          n4.splice(0, n4.length);
          var a3 = 0,
            s3 = t4.firstPseudo;
          return (
            0 == s3.count && (s3 = s3.outer),
            r3
              .loopWithFrame(function (n5) {
                if (s3) {
                  var r4 = i3.findLinePositions(o3),
                    l3 = s3.count - a3;
                  if (r4.length <= l3) n5.breakLoop();
                  else {
                    var u3 = i3.findAcceptableBreakInside(o3, r4[l3 - 1], true);
                    null != u3
                      ? i3.finishBreak(u3, false, false).then(function () {
                          (a3 += l3),
                            i3.layoutContext.peelOff(u3, 0).then(function (r5) {
                              i3.fixJustificationIfNeeded((t4 = r5), false),
                                (s3 = t4.firstPseudo),
                                i3
                                  .buildViewToNextBlockEdge(t4, (o3 = []))
                                  .then(function (t5) {
                                    (e4 = t5), n5.continueLoop();
                                  });
                            });
                        })
                      : n5.breakLoop();
                  }
                } else n5.breakLoop();
              })
              .then(function () {
                Array.prototype.push.apply(n4, o3), r3.finish(e4);
              }),
            r3.result()
          );
        }),
        (n3.isLoneImage = function (t4) {
          return (
            !(2 != t4.length && this.breakPositions.length > 0) &&
            t4[0].sourceNode == t4[1].sourceNode &&
            el[t4[0].sourceNode.localName]
          );
        }),
        (n3.getTrailingMarginEdgeAdjustment = function (t4) {
          for (var e4 = 0, n4 = 0, i3 = t4.length - 1; i3 >= 0; i3--) {
            var r3 = t4[i3];
            if (!r3.after || !r3.viewNode || 1 != r3.viewNode.nodeType) break;
            var o3 = this.getComputedMargin(r3.viewNode),
              a3 = this.vertical ? -o3.left : o3.bottom;
            a3 > 0 ? (e4 = Math.max(e4, a3)) : (n4 = Math.min(n4, a3));
          }
          return e4 - n4;
        }),
        (n3.layoutBreakableBlock = function (t4) {
          var e4 = this,
            n4 = bi('layoutBreakableBlock'),
            i3 = [];
          return (
            e4.buildViewToNextBlockEdge(t4, i3).then(function (r3) {
              var o3 = i3.length - 1;
              if (o3 < 0) n4.finish(r3);
              else {
                var a3 = e4.calculateEdge(r3, i3, o3, i3[o3].boxOffset),
                  s3 = false;
                if (!r3 || !bs(r3.viewNode)) {
                  var l3 = Is(r3, e4.collectElementsOffset());
                  (s3 = e4.isOverflown(
                    a3 + (e4.vertical ? -1 : 1) * l3.minimum,
                  )),
                    e4.isOverflown(a3 + (e4.vertical ? -1 : 1) * l3.current) &&
                      !e4.nodeContextOverflowingDueToRepetitiveElements &&
                      (e4.nodeContextOverflowingDueToRepetitiveElements = r3);
                }
                null == r3 && (a3 += e4.getTrailingMarginEdgeAdjustment(i3)),
                  e4.updateMaxReachedAfterEdge(a3),
                  (t4.firstPseudo
                    ? e4.processLineStyling(t4, r3, i3)
                    : Si(r3)
                  ).then(function (t5) {
                    e4.postLayoutBlock(t5, i3),
                      i3.length > 0 &&
                        (e4.saveBoxBreakPosition(i3),
                        s3 &&
                          !e4.isLoneImage(i3) &&
                          t5 &&
                          ((t5 = t5.modify()).overflow = true)),
                      n4.finish(t5);
                  });
              }
            }),
            n4.result()
          );
        }),
        (n3.postLayoutBlock = function (t4, e4) {
          var n4 = this;
          g2(exports.HOOKS.POST_LAYOUT_BLOCK).forEach(function (i3) {
            i3(t4, e4, n4);
          });
        }),
        (n3.findEndOfLine = function (t4, e4, n4) {
          for (
            var i3,
              r3 = this.vertical ? t4 - 1 : t4 + 1,
              o3 = 0,
              a3 = e4[0].boxOffset,
              s3 = o3,
              l3 = e4.length - 1,
              u3 = e4[l3].boxOffset;
            a3 < u3;

          ) {
            (i3 = a3 + Math.ceil((u3 - a3) / 2)), (s3 = o3);
            for (var h3 = l3; s3 < h3; ) {
              var c3 = s3 + Math.ceil((h3 - s3) / 2);
              e4[c3].boxOffset > i3 ? (h3 = c3 - 1) : (s3 = c3);
            }
            var f3 = this.calculateEdge(null, e4, s3, i3);
            if (this.vertical ? f3 <= r3 : f3 >= r3) {
              for (u3 = i3 - 1; e4[s3].boxOffset == i3; ) s3--;
              l3 = s3;
            } else
              n4 && this.updateMaxReachedAfterEdge(f3), (a3 = i3), (o3 = s3);
          }
          return { nodeContext: e4[s3], index: a3, checkPointIndex: s3 };
        }),
        (n3.findAcceptableBreakInside = function (t4, e4, n4) {
          var i3 = this.findEndOfLine(e4, t4, true),
            r3 = i3.nodeContext,
            o3 = r3.viewNode;
          if (1 != o3.nodeType) {
            var a3 = o3;
            r3 = this.resolveTextNodeBreaker(r3).breakTextNode(
              a3,
              r3,
              i3.index,
              t4,
              i3.checkPointIndex,
              n4,
            );
          }
          return this.clearOverflownViewNodes(r3, false), r3;
        }),
        (n3.resolveTextNodeBreaker = function (t4) {
          return g2(exports.HOOKS.RESOLVE_TEXT_NODE_BREAKER).reduce(function (
            e4,
            n4,
          ) {
            return n4(t4) || e4;
          },
          ll.instance);
        }),
        (n3.getRangeBoxes = function (t4, e4) {
          for (
            var n4 = [],
              i3 = t4.ownerDocument.createRange(),
              r3 = false,
              o3 = t4,
              a3 = null,
              s3 = false,
              l3 = true;
            l3;

          ) {
            var u3 = true;
            do {
              var h3 = null;
              o3 == e4 && (l3 = 1 === e4.nodeType && !(!e4.firstChild || r3)),
                1 != o3.nodeType
                  ? (s3 || (i3.setStartBefore(o3), (s3 = true)), (a3 = o3))
                  : r3
                  ? (r3 = false)
                  : Cs(o3)
                  ? (u3 = !s3)
                  : 'ruby' == o3.localName ||
                    rl(this.clientLayout.getElementComputedStyle(o3).display)
                  ? ((u3 = !s3) &&
                      (i3.setStartBefore(o3), (s3 = true), (a3 = o3)),
                    o3.contains(e4) && (l3 = false))
                  : (h3 = o3.firstChild),
                h3 ||
                  (h3 = o3.nextSibling) ||
                  ((r3 = true), (h3 = o3.parentNode)),
                (o3 = h3);
            } while (u3 && l3);
            if (s3) {
              i3.setEndAfter(a3);
              for (
                var c3 = this.clientLayout.getRangeClientRects(i3), f3 = 0;
                f3 < c3.length;
                f3++
              )
                n4.push(c3[f3]);
              s3 = false;
            }
          }
          return n4;
        }),
        (n3.findLinePositions = function (t4) {
          var e4 = [],
            n4 = this.getRangeBoxes(t4[0].viewNode, t4[t4.length - 1].viewNode);
          n4.sort(this.vertical ? Ba : _a);
          for (
            var i3 = 0, r3 = 0, o3 = 0, a3 = 0, s3 = 0, l3 = this.getBoxDir();
            ;

          ) {
            if (s3 < n4.length) {
              var u3 = n4[s3],
                h3 = 1;
              if (a3 > 0) {
                var c3 = Math.max(this.getBoxSize(u3), 1);
                h3 =
                  l3 * this.getBeforeEdge(u3) < l3 * i3
                    ? (l3 * (this.getAfterEdge(u3) - i3)) / c3
                    : l3 * this.getAfterEdge(u3) > l3 * r3
                    ? (l3 * (r3 - this.getBeforeEdge(u3))) / c3
                    : 1;
              }
              if (
                0 == a3 ||
                h3 >= 0.6 ||
                (h3 >= 0.2 && this.getStartEdge(u3) >= o3 - 1)
              ) {
                (o3 = this.getEndEdge(u3)),
                  this.vertical
                    ? ((i3 = 0 == a3 ? u3.right : Math.max(i3, u3.right)),
                      (r3 = 0 == a3 ? u3.left : Math.min(r3, u3.left)))
                    : ((i3 = 0 == a3 ? u3.top : Math.min(i3, u3.top)),
                      (r3 = 0 == a3 ? u3.bottom : Math.max(r3, u3.bottom))),
                  a3++,
                  s3++;
                continue;
              }
            }
            if ((a3 > 0 && (e4.push(r3), (a3 = 0)), s3 >= n4.length)) break;
          }
          return e4.sort(ht), this.vertical && e4.reverse(), e4;
        }),
        (n3.calculateClonedPaddingBorder = function (t4) {
          var e4 = this,
            n4 = 0;
          return (
            t4.walkUpBlocks(function (t5) {
              if ('clone' === t5.inheritedProps['box-decoration-break']) {
                var i3 = e4.getComputedPaddingBorder(t5.viewNode);
                (n4 += t5.vertical ? -i3.left : i3.bottom),
                  'table' === t5.display && (n4 += t5.blockBorderSpacing);
              }
            }),
            n4
          );
        }),
        (n3.getOffsetByRepetitiveElements = function (t4) {
          return (t4
            ? t4.calculateOffset(this)
            : Is(null, this.collectElementsOffset())
          ).current;
        }),
        (n3.findBoxBreakPosition = function (t4, e4) {
          for (
            var n4, i3, r3 = this, o3 = t4.checkPoints, a3 = o3[0];
            a3.parent && a3.inline;

          )
            a3 = a3.parent;
          e4
            ? ((n4 = 1), (i3 = 1))
            : ((n4 = Math.max((a3.inheritedProps.widows || 2) - 0, 1)),
              (i3 = Math.max((a3.inheritedProps.orphans || 2) - 0, 1)));
          var s3 = r3.calculateClonedPaddingBorder(a3),
            l3 = this.findLinePositions(o3),
            u3 = this.footnoteEdge - s3,
            h3 = this.getBoxDir(),
            c3 = this.getOffsetByRepetitiveElements(t4);
          u3 -= h3 * c3;
          var f3 = this.findFirstOverflowingEdgeAndCheckPoint(o3);
          isNaN(f3.edge) && (f3.edge = Infinity * h3);
          var d3,
            p3 = ut(l3.length, function (t5) {
              var e5 = l3[t5];
              return r3.vertical
                ? e5 < u3 || e5 <= f3.edge
                : e5 > u3 || e5 >= f3.edge;
            }),
            g3 = p3 <= 0;
          if (
            (g3 &&
              (p3 = ut(l3.length, function (t5) {
                return r3.vertical ? l3[t5] < u3 : l3[t5] > u3;
              })),
            (p3 = Math.min(l3.length - n4, p3)) < i3)
          )
            return null;
          if (
            ((u3 = l3[p3 - 1]),
            (d3 = g3
              ? f3.checkPoint
              : this.findAcceptableBreakInside(t4.checkPoints, u3, e4)))
          ) {
            var m3 = this.getAfterEdgeOfBlockContainer(d3);
            !isNaN(m3) && m3 < u3 && (u3 = m3),
              (this.computedBlockSize = h3 * (u3 - this.beforeEdge) + c3);
          }
          return d3;
        }),
        (n3.getAfterEdgeOfBlockContainer = function (t4) {
          var e4 = t4;
          do {
            e4 = e4.parent;
          } while (e4 && e4.inline);
          return e4
            ? (((e4 = e4.copy().modify()).after = true),
              ws(e4, this.clientLayout, 0, this.vertical))
            : NaN;
        }),
        (n3.findFirstOverflowingEdgeAndCheckPoint = function (t4) {
          var e4 = t4.findIndex(function (t5) {
            return t5.overflow;
          });
          if (e4 < 0) return { edge: NaN, checkPoint: null };
          var n4 = t4[e4];
          return {
            edge: this.calculateEdge(null, t4, e4, n4.boxOffset),
            checkPoint: n4,
          };
        }),
        (n3.findEdgeBreakPosition = function (t4) {
          return (
            (this.computedBlockSize =
              t4.computedBlockSize + this.getOffsetByRepetitiveElements(t4)),
            t4.position
          );
        }),
        (n3.finishBreak = function (t4, e4, n4) {
          var i3 = new Fs()
            .find(t4.formattingContext)
            .finishBreak(this, t4, e4, n4);
          return i3 || (i3 = Bs.finishBreak(this, t4, e4, n4)), i3;
        }),
        (n3.findAcceptableBreakPosition = function () {
          var t4 = null,
            e4 = null,
            n4 = 0,
            i3 = 0;
          do {
            (n4 = i3), (i3 = Number.MAX_VALUE);
            for (
              var r3 = this.breakPositions.length - 1;
              r3 >= 0 && !e4;
              --r3
            ) {
              e4 = (t4 = this.breakPositions[r3]).findAcceptableBreak(this, n4);
              var o3 = t4.getMinBreakPenalty();
              o3 > n4 && (i3 = Math.min(i3, o3));
            }
          } while (i3 > n4 && !e4 && this.forceNonfitting);
          return { breakPosition: e4 ? t4 : null, nodeContext: e4 };
        }),
        (n3.doFinishBreak = function (t4, e4, n4, i3) {
          if (
            this.pageFloatLayoutContext.isInvalidated() ||
            this.pageBreakType ||
            !e4
          )
            return Si(t4);
          var r3 = this,
            o3 = bi('doFinishBreak'),
            a3 = false;
          if (!t4) {
            if (this.forceNonfitting)
              return (
                c2.warn('Could not find any page breaks?!!'),
                r3.skipTailEdges(e4).then(function (t5) {
                  t5
                    ? (((t5 = t5.modify()).overflow = false),
                      r3.finishBreak(t5, a3, true).then(function () {
                        o3.finish(t5);
                      }))
                    : o3.finish(t5);
                }),
                o3.result()
              );
            (t4 = n4), (a3 = true), (r3.computedBlockSize = i3);
          }
          return (
            this.finishBreak(t4, a3, true).then(function () {
              o3.finish(t4);
            }),
            o3.result()
          );
        }),
        (n3.isBreakable = function (t4) {
          if (t4.after) return true;
          switch (t4.sourceNode.namespaceURI) {
            case H2.SVG:
              return false;
          }
          return !t4.flexContainer;
        }),
        (n3.zeroIndent = function (t4) {
          var e4 = t4.toString();
          return '' == e4 || 'auto' == e4 || !!e4.match(/^0+(.0*)?[^0-9]/);
        }),
        (n3.checkOverflowAndSaveEdge = function (t4, e4) {
          if (!t4) return false;
          if (bs(t4.viewNode)) return false;
          var n4 = ws(t4, this.clientLayout, 0, this.vertical),
            i3 = Is(t4, this.collectElementsOffset()),
            r3 = this.isOverflown(n4 + (this.vertical ? -1 : 1) * i3.minimum);
          if (
            this.isOverflown(n4 + (this.vertical ? -1 : 1) * i3.current) &&
            !this.nodeContextOverflowingDueToRepetitiveElements
          )
            this.nodeContextOverflowingDueToRepetitiveElements = t4;
          else if (e4) {
            var o3 = n4 + this.getTrailingMarginEdgeAdjustment(e4),
              a3 = this.footnoteEdge - this.getBoxDir() * i3.current;
            n4 = this.vertical
              ? Math.min(n4, Math.max(o3, a3))
              : Math.max(n4, Math.min(o3, a3));
          }
          return this.updateMaxReachedAfterEdge(n4), r3;
        }),
        (n3.checkOverflowAndSaveEdgeAndBreakPosition = function (
          t4,
          e4,
          n4,
          i3,
        ) {
          if (!t4) return false;
          if (bs(t4.viewNode)) return false;
          var r3 = this.checkOverflowAndSaveEdge(t4, e4);
          return (!n4 && r3) || this.saveEdgeBreakPosition(t4, i3, r3), r3;
        }),
        (n3.applyClearance = function (t4) {
          if (!t4.viewNode.parentNode) return false;
          var e4 = this.getComputedMargin(t4.viewNode),
            n4 = t4.viewNode.ownerDocument.createElement('div');
          this.vertical
            ? ((n4.style.bottom = '0px'),
              (n4.style.width = '1px'),
              (n4.style.marginRight = e4.right + 'px'))
            : ((n4.style.right = '0px'),
              (n4.style.height = '1px'),
              (n4.style.marginTop = e4.top + 'px')),
            t4.viewNode.parentNode.insertBefore(n4, t4.viewNode);
          var i3 = this.clientLayout.getElementClientRect(n4),
            r3 = this.getBeforeEdge(i3),
            o3 = this.getBoxDir(),
            a3 = t4.clearSide,
            s3 = Infinity * -this.getBoxDir();
          switch (
            ('all' === a3 &&
              (s3 = this.pageFloatLayoutContext.getPageFloatClearEdge(
                a3,
                this,
              )),
            a3)
          ) {
            case 'left':
              s3 = o3 * Math.max(s3 * o3, this.leftFloatEdge * o3);
              break;
            case 'right':
              s3 = o3 * Math.max(s3 * o3, this.rightFloatEdge * o3);
              break;
            default:
              s3 =
                o3 *
                Math.max(
                  s3 * o3,
                  Math.max(this.rightFloatEdge * o3, this.leftFloatEdge * o3),
                );
          }
          if (r3 * o3 >= s3 * o3)
            return t4.viewNode.parentNode.removeChild(n4), false;
          var l3 = Math.max(1, (s3 - r3) * o3);
          this.vertical
            ? (n4.style.width = l3 + 'px')
            : (n4.style.height = l3 + 'px'),
            (i3 = this.clientLayout.getElementClientRect(n4));
          var u3 = this.getAfterEdge(i3);
          if (this.vertical) {
            var h3 = u3 + e4.right - s3;
            h3 > 0 == e4.right >= 0 && (h3 += e4.right),
              (n4.style.marginLeft = h3 + 'px');
          } else {
            var c3 = s3 - (u3 + e4.top);
            c3 > 0 == e4.top >= 0 && (c3 += e4.top),
              (n4.style.marginBottom = c3 + 'px');
          }
          return (t4.clearSpacer = n4), true;
        }),
        (n3.isBFC = function (t4) {
          return (
            !!Ms(t4) ||
            !!ma.isInstanceOfRepetitiveElementsOwnerFormattingContext(t4)
          );
        }),
        (n3.skipEdges = function (t4, e4, n4) {
          var i3 = t4.after
            ? t4.parent && t4.parent.formattingContext
            : t4.formattingContext;
          if (i3 && !this.isBFC(i3)) return Si(t4);
          var r3 = this,
            o3 = bi('skipEdges'),
            a3 = !n4 && e4 && t4 && t4.after,
            s3 = n4,
            l3 = null,
            u3 = [],
            h3 = [],
            c3 = false;
          function f3() {
            return !!n4 || (!e4 && ps(s3));
          }
          function d3() {
            (t4 = u3[0] || t4).viewNode.parentNode.removeChild(t4.viewNode),
              (r3.pageBreakType = s3);
          }
          return (
            o3
              .loopWithFrame(function (n5) {
                for (; t4; ) {
                  var i4 = new Fs().find(t4.formattingContext);
                  do {
                    if (!t4.viewNode) break;
                    if (t4.inline && 1 != t4.viewNode.nodeType) {
                      if (ka(t4.viewNode, t4.whitespace)) break;
                      if (!t4.after)
                        return (
                          f3()
                            ? d3()
                            : r3.checkOverflowAndSaveEdgeAndBreakPosition(
                                l3,
                                null,
                                true,
                                s3,
                              )
                            ? ((t4 = (
                                (r3.stopAtOverflow && l3) ||
                                t4
                              ).modify()).overflow = true)
                            : ((t4 = t4.modify()).breakBefore = s3),
                          void n5.breakLoop()
                        );
                    }
                    if (!t4.after) {
                      if (i4 && i4.startNonInlineElementNode(t4)) break;
                      if (
                        (t4.clearSide &&
                          r3.applyClearance(t4) &&
                          e4 &&
                          0 === r3.breakPositions.length &&
                          r3.saveEdgeBreakPosition(t4.copy(), s3, false),
                        !r3.isBFC(t4.formattingContext) ||
                          ma.isInstanceOfRepetitiveElementsOwnerFormattingContext(
                            t4.formattingContext,
                          ) ||
                          r3.isFloatNodeContext(t4) ||
                          t4.flexContainer)
                      )
                        return (
                          u3.push(t4.copy()),
                          (s3 = vs(s3, t4.breakBefore)),
                          f3()
                            ? d3()
                            : (!r3.checkOverflowAndSaveEdgeAndBreakPosition(
                                l3,
                                null,
                                true,
                                s3,
                              ) &&
                                r3.layoutConstraint.allowLayout(t4)) ||
                              ((t4 = (
                                (r3.stopAtOverflow && l3) ||
                                t4
                              ).modify()).overflow = true),
                          void n5.breakLoop()
                        );
                    }
                    if (1 != t4.viewNode.nodeType) break;
                    var o4 = t4.viewNode.style;
                    if (t4.after) {
                      if (t4.inline) break;
                      if (
                        i4 &&
                        i4.afterNonInlineElementNode(t4, r3.stopAtOverflow)
                      )
                        break;
                      if (c3) {
                        if (f3()) return d3(), void n5.breakLoop();
                        (u3 = []), (e4 = false), (a3 = false), (s3 = null);
                      }
                      (c3 = false),
                        (l3 = t4.copy()),
                        h3.push(l3),
                        (s3 = vs(s3, t4.breakAfter)),
                        !o4 ||
                          (r3.zeroIndent(o4.paddingBottom) &&
                            r3.zeroIndent(o4.borderBottomWidth)) ||
                          (h3 = [l3]);
                    } else {
                      if (
                        (u3.push(t4.copy()),
                        (s3 = vs(s3, t4.breakBefore)),
                        !r3.layoutConstraint.allowLayout(t4) &&
                          (r3.checkOverflowAndSaveEdgeAndBreakPosition(
                            l3,
                            null,
                            !r3.stopAtOverflow,
                            s3,
                          ),
                          ((t4 = t4.modify()).overflow = true),
                          r3.stopAtOverflow))
                      )
                        return void n5.breakLoop();
                      if (el[t4.viewNode.localName])
                        return (
                          f3()
                            ? d3()
                            : r3.checkOverflowAndSaveEdgeAndBreakPosition(
                                l3,
                                null,
                                true,
                                s3,
                              ) &&
                              ((t4 = (
                                (r3.stopAtOverflow && l3) ||
                                t4
                              ).modify()).overflow = true),
                          void n5.breakLoop()
                        );
                      !o4 ||
                        (r3.zeroIndent(o4.paddingTop) &&
                          r3.zeroIndent(o4.borderTopWidth)) ||
                        ((a3 = false), (h3 = [])),
                        (c3 = true);
                    }
                  } while (0);
                  var p3 = r3.nextInTree(t4, a3);
                  if (p3.isPending())
                    return void p3.then(function (e5) {
                      (t4 = e5), n5.continueLoop();
                    });
                  t4 = p3.get();
                }
                r3.checkOverflowAndSaveEdgeAndBreakPosition(
                  l3,
                  h3,
                  !r3.stopAtOverflow,
                  s3,
                )
                  ? l3 &&
                    r3.stopAtOverflow &&
                    ((t4 = l3.modify()).overflow = true)
                  : ps(s3) && (r3.pageBreakType = s3),
                  n5.breakLoop();
              })
              .then(function () {
                l3 && (r3.lastAfterPosition = l3.toNodePosition()),
                  o3.finish(t4);
              }),
            o3.result()
          );
        }),
        (n3.skipTailEdges = function (t4) {
          var e4 = t4.copy(),
            n4 = this,
            i3 = bi('skipEdges'),
            r3 = null,
            o3 = false;
          return (
            i3
              .loopWithFrame(function (i4) {
                for (; t4; ) {
                  do {
                    if (!t4.viewNode) break;
                    if (t4.inline && 1 != t4.viewNode.nodeType) {
                      if (ka(t4.viewNode, t4.whitespace)) break;
                      if (!t4.after)
                        return (
                          ps(r3) && (n4.pageBreakType = r3), void i4.breakLoop()
                        );
                    }
                    if (
                      !t4.after &&
                      (n4.isFloatNodeContext(t4) || t4.flexContainer)
                    )
                      return (
                        ps((r3 = vs(r3, t4.breakBefore))) &&
                          (n4.pageBreakType = r3),
                        void i4.breakLoop()
                      );
                    if (1 != t4.viewNode.nodeType) break;
                    var a3 = t4.viewNode.style;
                    if (t4.after) {
                      if (o3) {
                        if (ps(r3))
                          return (n4.pageBreakType = r3), void i4.breakLoop();
                        r3 = null;
                      }
                      (o3 = false), (r3 = vs(r3, t4.breakAfter));
                    } else {
                      if (
                        ((r3 = vs(r3, t4.breakBefore)),
                        el[t4.viewNode.localName])
                      )
                        return (
                          ps(r3) && (n4.pageBreakType = r3), void i4.breakLoop()
                        );
                      if (
                        a3 &&
                        (!n4.zeroIndent(a3.paddingTop) ||
                          !n4.zeroIndent(a3.borderTopWidth))
                      )
                        return void i4.breakLoop();
                    }
                    o3 = true;
                  } while (0);
                  var s3 = n4.layoutContext.nextInTree(t4);
                  if (s3.isPending())
                    return void s3.then(function (e5) {
                      (t4 = e5), i4.continueLoop();
                    });
                  t4 = s3.get();
                }
                (e4 = null), i4.breakLoop();
              })
              .then(function () {
                i3.finish(e4);
              }),
            i3.result()
          );
        }),
        (n3.layoutFloatOrFootnote = function (t4) {
          return es(t4.floatReference) || 'footnote' === t4.floatSide
            ? this.layoutPageFloat(t4)
            : this.layoutFloat(t4);
        }),
        (n3.layoutNext = function (t4, e4, n4) {
          var i3 = this,
            r3 = bi('layoutNext');
          return (
            this.skipEdges(t4, e4, n4 || null).then(function (n5) {
              if (!(t4 = n5) || i3.pageBreakType || i3.stopByOverflow(t4))
                r3.finish(t4);
              else {
                var o3 = t4.formattingContext;
                new Fs().find(o3).layout(t4, i3, e4).thenFinish(r3);
              }
            }),
            r3.result()
          );
        }),
        (n3.clearOverflownViewNodes = function (t4, e4) {
          if (t4)
            for (var n4 = t4.parent; t4; t4 = n4, n4 = n4 ? n4.parent : null) {
              var i3 = (n4 || t4).formattingContext;
              new Fs().find(i3).clearOverflownViewNodes(this, n4, t4, e4),
                (e4 = false);
            }
        }),
        (n3.initGeom = function () {
          var t4 = this.element.ownerDocument.createElement('div');
          (t4.style.position = 'absolute'),
            (t4.style.top = this.paddingTop + 'px'),
            (t4.style.right = this.paddingRight + 'px'),
            (t4.style.bottom = this.paddingBottom + 'px'),
            (t4.style.left = this.paddingLeft + 'px'),
            this.element.appendChild(t4);
          var e4 = this.clientLayout.getElementClientRect(t4);
          this.element.removeChild(t4);
          var n4 = this.originX + this.left + this.getInsetLeft(),
            i3 = this.originY + this.top + this.getInsetTop();
          (this.box = new tn(n4, i3, n4 + this.width, i3 + this.height)),
            (this.startEdge = e4 ? (this.vertical ? e4.top : e4.left) : 0),
            (this.endEdge = e4 ? (this.vertical ? e4.bottom : e4.right) : 0),
            (this.beforeEdge = e4 ? (this.vertical ? e4.right : e4.top) : 0),
            (this.afterEdge = e4 ? (this.vertical ? e4.left : e4.bottom) : 0),
            (this.leftFloatEdge = this.beforeEdge),
            (this.rightFloatEdge = this.beforeEdge),
            (this.bottommostFloatTop = this.beforeEdge),
            (this.footnoteEdge = this.afterEdge),
            (this.bands = (function (t5, e5, n5, i4, r3, o3) {
              o3 &&
                ((t5 = gn(t5)),
                (e5 = e5.map(function (t6) {
                  return vn(t6);
                })),
                (n5 = n5.map(function (t6) {
                  return vn(t6);
                })));
              var a3,
                s3,
                l3,
                u3 = e5.length,
                h3 = n5 ? n5.length : 0,
                c3 = [],
                f3 = [];
              for (a3 = 0; a3 < u3; a3++) e5[a3].addSegments(f3, a3);
              for (a3 = 0; a3 < h3; a3++) n5[a3].addSegments(f3, a3 + u3);
              var d3 = f3.length;
              f3.sort(an);
              for (var p3 = 0; f3[p3].shapeId >= u3; ) p3++;
              var g3 = f3[p3].low.y;
              g3 > t5.y1 && c3.push(new on(t5.y1, g3, t5.x2, t5.x2));
              for (
                var m3, v3, E2 = 0, y3 = [];
                E2 < d3 && (l3 = f3[E2]).low.y < g3;

              )
                l3.high.y > g3 && y3.push(l3), E2++;
              for (; E2 < d3 || y3.length > 0; ) {
                var w3 = t5.y2,
                  N3 = Math.min(
                    ((m3 = Math.ceil(g3 + 8)),
                    (v3 = r3) ? Math.ceil(m3 / v3) * v3 : m3),
                    t5.y2,
                  );
                for (s3 = 0; s3 < y3.length && w3 > N3; s3++)
                  (l3 = y3[s3]).low.x == l3.high.x
                    ? l3.high.y < w3 && (w3 = Math.max(pn(l3.high.y, r3), N3))
                    : l3.low.x != l3.high.x && (w3 = N3);
                for (
                  w3 > t5.y2 && (w3 = t5.y2);
                  E2 < d3 && (l3 = f3[E2]).low.y < w3;

                )
                  if (l3.high.y < g3) E2++;
                  else {
                    if (!(l3.low.y < N3)) {
                      var b3 = pn(l3.low.y, r3);
                      b3 < w3 && (w3 = b3);
                      break;
                    }
                    (l3.low.y == l3.high.y && l3.low.y == g3) ||
                      (y3.push(l3), (w3 = N3)),
                      E2++;
                  }
                var S3 = [];
                for (s3 = 0; s3 < y3.length; s3++) fn(S3, y3[s3], g3, w3);
                S3.sort(function (t6, e6) {
                  return t6.x - e6.x || t6.lowOrHigh - e6.lowOrHigh;
                });
                var C3 = dn(S3, u3, h3);
                if (0 == C3.length) c3.push(new on(g3, w3, t5.x2, t5.x2));
                else {
                  var T3 = 0,
                    x3 = t5.x1;
                  for (s3 = 0; s3 < C3.length; s3 += 2) {
                    var I3 = Math.max(t5.x1, C3[s3]),
                      P3 = Math.min(t5.x2, C3[s3 + 1]) - I3;
                    P3 > T3 && ((T3 = P3), (x3 = I3));
                  }
                  c3.push(
                    0 == T3
                      ? new on(g3, w3, t5.x2, t5.x2)
                      : new on(
                          g3,
                          w3,
                          Math.max(x3, t5.x1),
                          Math.min(x3 + T3, t5.x2),
                        ),
                  );
                }
                if (w3 == t5.y2) break;
                for (g3 = w3, s3 = y3.length - 1; s3 >= 0; s3--)
                  y3[s3].high.y <= w3 && y3.splice(s3, 1);
              }
              return En(t5, c3), c3;
            })(
              this.box,
              [this.getInnerShape()],
              this.getExclusions(),
              0,
              this.snapHeight,
              this.vertical,
            )),
            this.createFloats();
        }),
        (n3.init = function () {
          (this.chunkPositions = []),
            $2(this.element, 'width', this.width + 'px'),
            $2(this.element, 'height', this.height + 'px'),
            this.initGeom(),
            (this.computedBlockSize = 0),
            (this.overflown = false),
            (this.pageBreakType = null),
            (this.lastAfterPosition = null);
        }),
        (n3.saveEdgeBreakPosition = function (t4, e4, n4) {
          var i3 = t4.copy(),
            r3 = new Fs().find(t4.formattingContext),
            o3 = this.calculateClonedPaddingBorder(i3),
            a3 = r3.createEdgeBreakPosition(
              i3,
              e4,
              n4,
              this.computedBlockSize + o3,
            );
          this.breakPositions.push(a3);
        }),
        (n3.saveBoxBreakPosition = function (t4) {
          var e4 = new il(t4, t4[0].breakPenalty);
          this.breakPositions.push(e4);
        }),
        (n3.updateMaxReachedAfterEdge = function (t4) {
          if (!isNaN(t4)) {
            var e4 = this.getBoxDir() * (t4 - this.beforeEdge);
            this.computedBlockSize = Math.max(e4, this.computedBlockSize);
          }
        }),
        (n3.layout = function (t4, e4, n4) {
          if (
            (this.chunkPositions.push(t4),
            t4.primary.after && (this.lastAfterPosition = t4.primary),
            this.stopAtOverflow && this.overflown)
          )
            return Si(t4);
          if (this.isFullWithPageFloats())
            return Si(
              t4.primary.after && 1 === t4.primary.steps.length ? null : t4,
            );
          var i3 = this,
            r3 = bi('layout');
          return (
            i3.openAllViews(t4.primary).then(function (t5) {
              var o3 = null;
              t5.viewNode
                ? (o3 = t5.copy())
                : i3.layoutContext.addEventListener('nextInTree', function t6(
                    e5,
                  ) {
                    e5.nodeContext.viewNode &&
                      ((o3 = e5.nodeContext),
                      i3.layoutContext.removeEventListener('nextInTree', t6));
                  });
              var a3 = new hl(e4, n4);
              a3.layout(t5, i3).then(function (t6) {
                i3.doFinishBreak(
                  t6,
                  a3.context.overflownNodeContext,
                  o3,
                  a3.initialComputedBlockSize,
                ).then(function (t7) {
                  (i3.pseudoParent
                    ? Si(null)
                    : i3.doFinishBreakOfFragmentLayoutConstraints(t7)
                  ).then(function () {
                    if (i3.pageFloatLayoutContext.isInvalidated())
                      r3.finish(null);
                    else if (t7) {
                      i3.overflown = true;
                      var e5 = new Ya(t7.toNodePosition());
                      r3.finish(e5);
                    } else r3.finish(null);
                  });
                });
              });
            }),
            r3.result()
          );
        }),
        (n3.isFullWithPageFloats = function () {
          return this.pageFloatLayoutContext.isColumnFullWithPageFloats(this);
        }),
        (n3.getMaxBlockSizeOfPageFloats = function () {
          return this.pageFloatLayoutContext.getMaxBlockSizeOfPageFloats();
        }),
        (n3.doFinishBreakOfFragmentLayoutConstraints = function (t4) {
          var e4 = this,
            n4 = bi('doFinishBreakOfFragmentLayoutConstraints'),
            i3 = [].concat(this.fragmentLayoutConstraints);
          i3.sort(function (t5, e5) {
            return (
              t5.getPriorityOfFinishBreak() - e5.getPriorityOfFinishBreak()
            );
          });
          var r3 = 0;
          return (
            n4
              .loop(function () {
                return r3 < i3.length
                  ? i3[r3++].finishBreak(t4, e4).thenReturn(true)
                  : Si(false);
              })
              .then(function () {
                n4.finish(true);
              }),
            n4.result()
          );
        }),
        (n3.doLayout = function (t4, e4, n4) {
          var i3 = this,
            r3 = bi('doLayout'),
            o3 = null;
          return (
            (i3.breakPositions = []),
            (i3.nodeContextOverflowingDueToRepetitiveElements = null),
            r3
              .loopWithFrame(function (r4) {
                for (
                  var a3 = function () {
                    var a4 = true;
                    if (
                      (i3.layoutNext(t4, e4, n4 || null).then(function (s4) {
                        if (
                          ((e4 = false),
                          (n4 = null),
                          i3.nodeContextOverflowingDueToRepetitiveElements &&
                          i3.stopAtOverflow
                            ? ((i3.pageBreakType = null),
                              ((t4 =
                                i3.nodeContextOverflowingDueToRepetitiveElements).overflow = true))
                            : (t4 = s4),
                          i3.pageFloatLayoutContext.isInvalidated())
                        )
                          r4.breakLoop();
                        else if (i3.pageBreakType) r4.breakLoop();
                        else if (t4 && i3.stopByOverflow(t4)) {
                          o3 = t4;
                          var l3 = i3.findAcceptableBreakPosition();
                          (t4 = l3.nodeContext),
                            l3.breakPosition &&
                              l3.breakPosition.breakPositionChosen(i3),
                            r4.breakLoop();
                        } else a4 ? (a4 = false) : r4.continueLoop();
                      }),
                      a4)
                    )
                      return (a4 = false), { v: void 0 };
                  };
                  t4;

                ) {
                  var s3 = a3();
                  if ('object' == typeof s3) return s3.v;
                }
                (i3.computedBlockSize += i3.getOffsetByRepetitiveElements()),
                  r4.breakLoop();
              })
              .then(function () {
                r3.finish({ nodeContext: t4, overflownNodeContext: o3 });
              }),
            r3.result()
          );
        }),
        (n3.redoLayout = function () {
          for (
            var t4 = this.chunkPositions, e4 = this.element.lastChild;
            e4 != this.last;

          ) {
            var n4 = e4.previousSibling;
            (this.element === e4.parentNode &&
              this.layoutContext.isPseudoelement(e4)) ||
              this.element.removeChild(e4),
              (e4 = n4);
          }
          this.killFloats(), this.init();
          var i3 = this,
            r3 = bi('redoLayout'),
            o3 = 0,
            a3 = null,
            s3 = true;
          return (
            r3
              .loopWithFrame(function (e5) {
                if (o3 < t4.length) {
                  var n5 = t4[o3++];
                  i3.layout(n5, s3).then(function (t5) {
                    (s3 = false),
                      t5 ? ((a3 = t5), e5.breakLoop()) : e5.continueLoop();
                  });
                } else e5.breakLoop();
              })
              .then(function () {
                r3.finish(a3);
              }),
            r3.result()
          );
        }),
        (n3.saveDistanceToBlockEndFloats = function () {
          var t4 = this.pageFloatLayoutContext.getBlockStartEdgeOfBlockEndFloats();
          t4 > 0 &&
            isFinite(t4) &&
            (this.blockDistanceToBlockEndFloats =
              this.getBoxDir() *
              (t4 - this.beforeEdge - this.computedBlockSize));
        }),
        (n3.collectElementsOffset = function () {
          for (var t4 = this, e4 = [], n4 = this; n4; n4 = n4.pseudoParent)
            n4.fragmentLayoutConstraints.forEach(function (n5) {
              if (ma.isInstanceOfRepetitiveElementsOwnerLayoutConstraint(n5)) {
                var i3 = n5.getRepetitiveElements();
                e4.push(i3);
              }
              if (ga.isInstanceOfAfterIfContinuesLayoutConstraint(n5)) {
                var r3 = n5.getRepetitiveElements();
                e4.push(r3);
              }
              va.isInstanceOfTableRowLayoutConstraint(n5) &&
                n5.getElementsOffsetsForTableCell(t4).forEach(function (t5) {
                  e4.push(t5);
                });
            });
          return e4;
        }),
        e3
      );
    })(Za);
    var al = (function () {
      function t3(t4, e4, n3) {
        (this.startNodeContexts = []),
          (this.column = Object.create(t4)),
          (this.column.element = e4),
          (this.column.layoutContext = t4.layoutContext.clone()),
          (this.column.stopAtOverflow = false),
          (this.column.flowRootFormattingContext = n3.formattingContext),
          (this.column.pseudoParent = t4);
        var i3 = this.column.calculateClonedPaddingBorder(n3);
        this.column.footnoteEdge = this.column.footnoteEdge - i3;
        var r3 = this;
        this.column.openAllViews = function (t5) {
          return ol.prototype.openAllViews
            .call(this, t5)
            .thenAsync(function (t6) {
              return r3.startNodeContexts.push(t6.copy()), Si(t6);
            });
        };
      }
      var e3 = t3.prototype;
      return (
        (e3.layout = function (t4, e4) {
          return this.column.layout(t4, e4);
        }),
        (e3.findAcceptableBreakPosition = function (t4) {
          var e4 = this.column.findAcceptableBreakPosition();
          if (t4) {
            var n3 = this.startNodeContexts[0].copy(),
              i3 = new Ps(n3, null, n3.overflow, 0);
            if ((i3.findAcceptableBreak(this.column, 0), !e4.nodeContext))
              return { breakPosition: i3, nodeContext: n3 };
          }
          return e4;
        }),
        (e3.finishBreak = function (t4, e4, n3) {
          return this.column.finishBreak(t4, e4, n3);
        }),
        (e3.doFinishBreakOfFragmentLayoutConstraints = function (t4) {
          this.column.doFinishBreakOfFragmentLayoutConstraints(t4);
        }),
        (e3.isStartNodeContext = function (t4) {
          var e4 = this.startNodeContexts[0];
          return (
            e4.viewNode === t4.viewNode &&
            e4.after === t4.after &&
            e4.offsetInNode === t4.offsetInNode
          );
        }),
        (e3.isLastAfterNodeContext = function (t4) {
          return Ua(t4.toNodePosition(), this.column.lastAfterPosition);
        }),
        (e3.getColumnElement = function () {
          return this.column.element;
        }),
        (e3.getColumn = function () {
          return this.column;
        }),
        t3
      );
    })();
    var sl = /^[^A-Za-z0-9_\u009E\u009F\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02AF\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527]*([A-Za-z0-9_\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02AF\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527][^A-Za-z0-9_\u009E\u009F\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02AF\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527]*)?/;
    var ll = (function () {
      function t3() {}
      var e3 = t3.prototype;
      return (
        (e3.breakTextNode = function (t4, e4, n3, i3, r3, o3) {
          if (e4.after) e4.offsetInNode = t4.length;
          else {
            var a3 = n3 - e4.boxOffset,
              s3 = t4.data;
            (a3 =
              173 == s3.charCodeAt(a3)
                ? this.breakAfterSoftHyphen(t4, s3, a3, e4)
                : this.breakAfterOtherCharacter(t4, s3, a3, e4)) > 0 &&
              (e4 = this.updateNodeContext(e4, a3, t4));
          }
          return e4;
        }),
        (e3.breakAfterSoftHyphen = function (t4, e4, n3, i3) {
          return (
            t4.replaceData(n3, e4.length - n3, i3.breakWord ? '' : ul(i3)),
            n3 + 1
          );
        }),
        (e3.breakAfterOtherCharacter = function (t4, e4, n3, i3) {
          var r3 = e4.charAt(n3);
          n3++;
          var o3 = e4.charAt(n3);
          return (
            t4.replaceData(
              n3,
              e4.length - n3,
              !i3.breakWord && at(r3) && at(o3) ? ul(i3) : '',
            ),
            n3
          );
        }),
        (e3.updateNodeContext = function (t4, e4, n3) {
          return (
            ((t4 = t4.modify()).offsetInNode += e4), (t4.breakBefore = null), t4
          );
        }),
        t3
      );
    })();
    function ul(t3) {
      return (
        t3.hyphenateCharacter ||
        (t3.parent && t3.parent.hyphenateCharacter) ||
        '-'
      );
    }
    ll.instance = new ll();
    var hl = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return (
          ((i3 = t3.call(this) || this).leadingEdge = e4),
          (i3.initialPageBreakType = null),
          (i3.initialComputedBlockSize = 0),
          (i3.initialOverflown = false),
          (i3.context = { overflownNodeContext: null }),
          (i3.breakAfter = n4 || null),
          i3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.resolveLayoutMode = function (t4) {
          return new cl(this.leadingEdge, this.breakAfter, this.context);
        }),
        (n3.prepareLayout = function (t4, e4) {
          (e4.fragmentLayoutConstraints = []), e4.pseudoParent || (Gs = []);
        }),
        (n3.clearNodes = function (e4) {
          t3.prototype.clearNodes.call(this, e4);
          for (var n4 = e4; n4; ) {
            var i3 = n4.viewNode;
            i3 && Ss(i3.parentNode, i3), (n4 = n4.parent);
          }
        }),
        (n3.saveState = function (e4, n4) {
          t3.prototype.saveState.call(this, e4, n4),
            (this.initialPageBreakType = n4.pageBreakType),
            (this.initialComputedBlockSize = n4.computedBlockSize),
            (this.initialOverflown = n4.overflown);
        }),
        (n3.restoreState = function (e4, n4) {
          t3.prototype.restoreState.call(this, e4, n4),
            (n4.pageBreakType = this.initialPageBreakType),
            (n4.computedBlockSize = this.initialComputedBlockSize),
            (n4.overflown = this.initialOverflown);
        }),
        e3
      );
    })(Us);
    var cl = (function () {
      function t3(t4, e4, n3) {
        (this.leadingEdge = t4), (this.breakAfter = e4), (this.context = n3);
      }
      var e3 = t3.prototype;
      return (
        (e3.doLayout = function (t4, e4) {
          var n3 = this,
            i3 = bi('DefaultLayoutMode.doLayout');
          return (
            (function (t5, e5) {
              var n4 = bi('processAfterIfContinuesOfAncestors'),
                i4 = t5;
              return (
                n4
                  .loop(function () {
                    if (null !== i4) {
                      var t6 = Js(i4, e5);
                      return (i4 = i4.parent), t6.thenReturn(true);
                    }
                    return Si(false);
                  })
                  .then(function () {
                    n4.finish(true);
                  }),
                n4.result()
              );
            })(t4, e4).then(function () {
              e4.doLayout(t4, n3.leadingEdge, n3.breakAfter).then(function (
                t5,
              ) {
                (n3.context.overflownNodeContext = t5.overflownNodeContext),
                  i3.finish(t5.nodeContext);
              });
            }),
            i3.result()
          );
        }),
        (e3.accept = function (t4, e4) {
          var n3 = this;
          return (
            !(
              !e4.pageFloatLayoutContext.isInvalidated() && !e4.pageBreakType
            ) ||
            e4.fragmentLayoutConstraints.length <= 0 ||
            e4.fragmentLayoutConstraints.every(function (i3) {
              return i3.allowLayout(t4, n3.context.overflownNodeContext, e4);
            })
          );
        }),
        (e3.postLayout = function (t4, e4, n3, i3) {
          if (!i3) {
            var r3 = n3.fragmentLayoutConstraints.some(function (e5) {
              return e5.nextCandidate(t4);
            });
            i3 = !r3;
          }
          return (
            n3.fragmentLayoutConstraints.forEach(function (r4) {
              r4.postLayout(i3, t4, e4, n3);
            }),
            i3
          );
        }),
        t3
      );
    })();
    var fl = (function (t3) {
      function e3(e4, n4, i3, r3, o3, a3, s3) {
        var l3;
        return (
          ((l3 = t3.call(this, n4, i3, r3, o3, a3) || this).floatSide = e4),
          (l3.parentContainer = s3),
          (l3.rootViewNodes = []),
          (l3.floatMargins = []),
          (l3.adjustContentRelativeSize = true),
          l3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.openAllViews = function (e4) {
          var n4 = this;
          return t3.prototype.openAllViews
            .call(this, e4)
            .thenAsync(function (t4) {
              return t4 && n4.fixFloatSizeAndPosition(t4), Si(t4);
            });
        }),
        (n3.convertPercentageSizesToPx = function (t4) {
          var e4 = this.parentContainer.getPaddingRect(),
            n4 = e4.x2 - e4.x1,
            i3 = e4.y2 - e4.y1;
          function r3(e5, n5) {
            e5.forEach(function (e6) {
              var i4 = J(t4, e6);
              if (i4 && '%' === i4.charAt(i4.length - 1)) {
                var r4 = parseFloat(i4);
                $2(t4, e6, (n5 * r4) / 100 + 'px');
              }
            });
          }
          r3(['width', 'max-width', 'min-width'], n4),
            r3(['height', 'max-height', 'min-height'], i3),
            r3(
              [
                'margin-top',
                'margin-right',
                'margin-bottom',
                'margin-left',
                'padding-top',
                'padding-right',
                'padding-bottom',
                'padding-left',
              ],
              this.vertical ? i3 : n4,
            ),
            [
              'margin-top',
              'margin-right',
              'margin-bottom',
              'margin-left',
            ].forEach(function (e5) {
              'auto' === J(t4, e5) && $2(t4, e5, '0');
            });
        }),
        (n3.fixFloatSizeAndPosition = function (t4) {
          for (; t4.parent; ) t4 = t4.parent;
          var e4 = t4.viewNode;
          if (
            (this.rootViewNodes.push(e4),
            this.adjustContentRelativeSize &&
              this.convertPercentageSizesToPx(e4),
            this.floatMargins.push(this.getComputedMargin(e4)),
            this.adjustContentRelativeSize)
          ) {
            var n4 = this.floatSide;
            if (this.parentContainer.vertical) {
              if ('block-end' === n4 || 'left' === n4) {
                var i3 = J(e4, 'height');
                '' !== i3 && 'auto' !== i3 && $2(e4, 'margin-top', 'auto');
              }
            } else if ('block-end' === n4 || 'bottom' === n4) {
              var r3 = J(e4, 'width');
              '' !== r3 && 'auto' !== r3 && $2(e4, 'margin-left', 'auto');
            }
          }
        }),
        (n3.getContentInlineSize = function () {
          var t4 = this;
          return Math.max.apply(
            null,
            this.rootViewNodes.map(function (e4, n4) {
              var i3 = t4.clientLayout.getElementClientRect(e4),
                r3 = t4.floatMargins[n4];
              return t4.vertical
                ? r3.top + i3.height + r3.bottom
                : r3.left + i3.width + r3.right;
            }),
          );
        }),
        e3
      );
    })(ol);
    var dl = (function () {
      function t3(t4, e4) {
        (this.parent = t4),
          (this.rootSourceNode = e4),
          (this.formattingContextType = 'RepetitiveElementsOwner'),
          (this.isRoot = false),
          (this.repetitiveElements = null);
      }
      var e3 = t3.prototype;
      return (
        (e3.getName = function () {
          return 'Repetitive elements owner formatting context (RepetitiveElementsOwnerFormattingContext)';
        }),
        (e3.isFirstTime = function (t4, e4) {
          return e4;
        }),
        (e3.getParent = function () {
          return this.parent;
        }),
        (e3.getRepetitiveElements = function () {
          return this.repetitiveElements;
        }),
        (e3.getRootViewNode = function (t4) {
          var e4 = this.getRootNodeContext(t4);
          return e4 ? e4.viewNode : null;
        }),
        (e3.getRootNodeContext = function (t4) {
          do {
            if (!t4.belongsTo(this) && t4.sourceNode === this.rootSourceNode)
              return t4;
          } while ((t4 = t4.parent));
          return null;
        }),
        (e3.initializeRepetitiveElements = function (t4) {
          var e4 = this;
          this.repetitiveElements ||
            Gs.some(function (t5) {
              return (
                t5.root === e4.rootSourceNode &&
                ((e4.repetitiveElements = t5.elements), true)
              );
            }) ||
            ((this.repetitiveElements = new pl(t4, this.rootSourceNode)),
            Gs.push({
              root: this.rootSourceNode,
              elements: this.repetitiveElements,
            }));
        }),
        (e3.saveState = function () {}),
        (e3.restoreState = function (t4) {}),
        t3
      );
    })();
    var pl = (function () {
      function t3(t4, e4) {
        (this.vertical = t4),
          (this.ownerSourceNode = e4),
          (this.headerSourceNode = null),
          (this.footerSourceNode = null),
          (this.headerViewNode = null),
          (this.footerViewNode = null),
          (this.headerNodePosition = null),
          (this.footerNodePosition = null),
          (this.headerHeight = 0),
          (this.footerHeight = 0),
          (this.isSkipHeader = false),
          (this.isSkipFooter = false),
          (this.enableSkippingFooter = true),
          (this.enableSkippingHeader = true),
          (this.doneInitialLayout = false),
          (this.firstContentSourceNode = null),
          (this.lastContentSourceNode = null),
          (this.affectedNodeCache = []),
          (this.afterLastContentNodeCache = []),
          (this.allowInsert = false);
      }
      var e3 = t3.prototype;
      return (
        (e3.setHeaderNodeContext = function (t4) {
          this.headerNodePosition ||
            ((this.headerNodePosition = Va(t4, 0)),
            (this.headerSourceNode = t4.sourceNode),
            (this.headerViewNode = t4.viewNode));
        }),
        (e3.setFooterNodeContext = function (t4) {
          this.footerNodePosition ||
            ((this.footerNodePosition = Va(t4, 0)),
            (this.footerSourceNode = t4.sourceNode),
            (this.footerViewNode = t4.viewNode));
        }),
        (e3.updateHeight = function (t4) {
          this.headerViewNode &&
            ((this.headerHeight = Ns(this.headerViewNode, t4, this.vertical)),
            (this.headerViewNode = null)),
            this.footerViewNode &&
              ((this.footerHeight = Ns(this.footerViewNode, t4, this.vertical)),
              (this.footerViewNode = null));
        }),
        (e3.prepareLayoutFragment = function () {
          (this.isSkipHeader = this.isSkipFooter = false),
            (this.enableSkippingFooter = true),
            (this.enableSkippingHeader = true);
        }),
        (e3.appendHeaderToFragment = function (t4, e4, n3) {
          return !this.headerNodePosition || this.isSkipHeader
            ? Si(true)
            : this.appendElementToFragment(this.headerNodePosition, t4, e4, n3);
        }),
        (e3.appendFooterToFragment = function (t4, e4, n3) {
          return !this.footerNodePosition || this.isSkipFooter
            ? Si(true)
            : this.appendElementToFragment(this.footerNodePosition, t4, e4, n3);
        }),
        (e3.appendElementToFragment = function (t4, e4, n3, i3) {
          var r3 = this,
            o3 = e4.viewNode,
            a3 = e4.viewNode.ownerDocument.createElement('div');
          o3.appendChild(a3);
          var s3 = new al(i3, a3, e4),
            l3 = s3.getColumn().pageBreakType;
          return (
            (s3.getColumn().pageBreakType = null),
            (this.allowInsertRepeatitiveElements = true),
            s3.layout(new Ya(t4), true).thenAsync(function () {
              return (
                (r3.allowInsertRepeatitiveElements = false),
                o3.removeChild(a3),
                r3.moveChildren(a3, o3, n3),
                (s3.getColumn().pageBreakType = l3),
                Si(true)
              );
            })
          );
        }),
        (e3.moveChildren = function (t4, e4, n3) {
          if (e4)
            for (; t4.firstChild; ) {
              var i3 = t4.firstChild;
              t4.removeChild(i3),
                i3.setAttribute('data-adapt-spec', '1'),
                n3 ? e4.insertBefore(i3, n3) : e4.appendChild(i3);
            }
        }),
        (e3.calculateOffset = function (t4) {
          var e4 = 0;
          return (
            (t4 && !this.affectTo(t4)) ||
              ((!this.isSkipFooter || (t4 && this.isAfterLastContent(t4))) &&
                (e4 += this.footerHeight),
              this.isSkipHeader || (e4 += this.headerHeight)),
            e4
          );
        }),
        (e3.calculateMinimumOffset = function (t4) {
          var e4 = 0;
          return (
            (t4 && !this.affectTo(t4)) ||
              (t4 && this.isAfterLastContent(t4) && (e4 += this.footerHeight),
              this.enableSkippingHeader || (e4 += this.headerHeight)),
            e4
          );
        }),
        (e3.isAfterLastContent = function (t4) {
          var e4 = this;
          return this.findResultFromCache(
            t4,
            this.afterLastContentNodeCache,
            function (n3) {
              return e4.isAfterNodeContextOf(
                e4.lastContentSourceNode,
                t4,
                false,
              );
            },
          );
        }),
        (e3.affectTo = function (t4) {
          var e4 = this;
          return this.findResultFromCache(t4, this.affectedNodeCache, function (
            n3,
          ) {
            return e4.isAfterNodeContextOf(e4.ownerSourceNode, t4, true);
          });
        }),
        (e3.findResultFromCache = function (t4, e4, n3) {
          var i3 = e4.filter(function (e5) {
            return (
              e5.nodeContext.sourceNode === t4.sourceNode &&
              e5.nodeContext.after === t4.after
            );
          });
          if (i3.length > 0) return i3[0].result;
          var r3 = n3(t4);
          return e4.push({ nodeContext: t4, result: r3 }), r3;
        }),
        (e3.isAfterNodeContextOf = function (t4, e4, n3) {
          for (var i3 = [], r3 = t4; r3; r3 = r3.parentNode) {
            if (e4.sourceNode === r3) return e4.after;
            i3.push(r3);
          }
          for (var o3 = e4.sourceNode; o3; o3 = o3.parentNode) {
            var a3 = i3.indexOf(o3);
            if (a3 >= 0) return !!n3 && 0 === a3;
            for (var s3 = o3; s3; s3 = s3.previousElementSibling)
              if (i3.includes(s3)) return true;
          }
          return e4.after;
        }),
        (e3.isFirstContentNode = function (t4) {
          return t4 && this.firstContentSourceNode === t4.sourceNode;
        }),
        (e3.isEnableToUpdateState = function () {
          return !!(
            (!this.isSkipFooter &&
              this.enableSkippingFooter &&
              this.footerNodePosition) ||
            (!this.isSkipHeader &&
              this.enableSkippingHeader &&
              this.headerNodePosition)
          );
        }),
        (e3.updateState = function () {
          !this.isSkipFooter &&
          this.enableSkippingFooter &&
          this.footerNodePosition
            ? (this.isSkipFooter = true)
            : !this.isSkipHeader &&
              this.enableSkippingHeader &&
              this.headerNodePosition &&
              (this.isSkipHeader = true);
        }),
        (e3.preventSkippingHeader = function () {
          (this.isSkipHeader = false), (this.enableSkippingHeader = false);
        }),
        (e3.preventSkippingFooter = function () {
          (this.isSkipFooter = false), (this.enableSkippingFooter = false);
        }),
        (e3.isHeaderRegistered = function () {
          return !!this.headerNodePosition;
        }),
        (e3.isFooterRegistered = function () {
          return !!this.footerNodePosition;
        }),
        (e3.isHeaderSourceNode = function (t4) {
          return this.headerSourceNode === t4;
        }),
        (e3.isFooterSourceNode = function (t4) {
          return this.footerSourceNode === t4;
        }),
        t3
      );
    })();
    var gl = (function () {
      function t3(t4) {
        this.formattingContext = t4;
      }
      var e3 = t3.prototype;
      return (
        (e3.accept = function (t4, e4) {
          return !!t4;
        }),
        (e3.postLayout = function (t4, e4, n3, i3) {
          var r3 = this.formattingContext.getRepetitiveElements();
          return (
            r3 &&
              (r3.doneInitialLayout ||
                (r3.updateHeight(n3), (r3.doneInitialLayout = true))),
            i3
          );
        }),
        t3
      );
    })();
    var ml = (function () {
      function t3(t4) {
        this.formattingContext = t4;
      }
      var e3 = t3.prototype;
      return (
        (e3.accept = function (t4, e4) {
          return true;
        }),
        (e3.postLayout = function (t4, e4, n3, i3) {
          return i3;
        }),
        t3
      );
    })();
    var vl = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return ((i3 = t3.call(this, e4) || this).processor = n4), i3;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.doLayout = function (t4, e4) {
          return this.processor.doInitialLayout(t4, e4);
        }),
        (n3.accept = function (t4, e4) {
          return false;
        }),
        e3
      );
    })(gl);
    var El = (function (t3) {
      function e3(e4, n3) {
        var i3;
        return ((i3 = t3.call(this, e4) || this).processor = n3), i3;
      }
      return (
        I2(e3, t3),
        (e3.prototype.doLayout = function (t4, e4) {
          return (
            t4.belongsTo(this.formattingContext) ||
              t4.after ||
              e4.fragmentLayoutConstraints.unshift(new yl(t4)),
            this.processor.doLayout(t4, e4)
          );
        }),
        e3
      );
    })(ml);
    var yl = (function () {
      function t3(t4) {
        (this.flagmentLayoutConstraintType = 'RepetitiveElementsOwner'),
          (this.nodeContext = t4.formattingContext.getRootNodeContext(t4));
      }
      var e3 = t3.prototype;
      return (
        (e3.allowLayout = function (t4, e4, n3) {
          var i3 = this.getRepetitiveElements();
          return !(
            i3 &&
            !bs(this.nodeContext.viewNode) &&
            i3.isEnableToUpdateState() &&
            ((e4 && !t4) || (t4 && t4.overflow))
          );
        }),
        (e3.nextCandidate = function (t4) {
          var e4 = this.getRepetitiveElements();
          return (
            !!e4 && !!e4.isEnableToUpdateState() && (e4.updateState(), true)
          );
        }),
        (e3.postLayout = function (t4, e4, n3, i3) {
          var r3 = this.getRepetitiveElements();
          r3 &&
            t4 &&
            i3.stopAtOverflow &&
            (null == e4 || r3.isAfterLastContent(e4)) &&
            r3.preventSkippingFooter();
        }),
        (e3.finishBreak = function (t4, e4) {
          var n3 = this.nodeContext.formattingContext,
            i3 = this.getRepetitiveElements();
          if (!i3) return Si(true);
          var r3 = this.nodeContext;
          return (function (t5, e5, n4) {
            var i4 = t5.getRepetitiveElements();
            if (i4) {
              var r4 = t5.getRootNodeContext(e5);
              if (r4.viewNode)
                return i4.appendHeaderToFragment(
                  r4,
                  r4.viewNode.firstChild,
                  n4,
                );
            }
            return Si(true);
          })(n3, r3, e4).thenAsync(function () {
            return (function (t5, e5, n4) {
              var i4 = t5.getRepetitiveElements();
              if (i4 && !i4.isSkipFooter) {
                var r4 = t5.getRootNodeContext(e5);
                if (r4.viewNode) return i4.appendFooterToFragment(r4, null, n4);
              }
              return Si(true);
            })(n3, r3, e4).thenAsync(function () {
              return i3.prepareLayoutFragment(), Si(true);
            });
          });
        }),
        (e3.getRepetitiveElements = function () {
          return this.nodeContext.formattingContext.getRepetitiveElements();
        }),
        (e3.equalsTo = function (e4) {
          return (
            e4 instanceof t3 &&
            this.nodeContext.formattingContext ===
              e4.nodeContext.formattingContext
          );
        }),
        (e3.getPriorityOfFinishBreak = function () {
          return 10;
        }),
        t3
      );
    })();
    var wl = (function (t3) {
      function e3(e4, n3) {
        var i3;
        return (
          ((i3 = t3.call(this) || this).formattingContext = e4),
          (i3.processor = n3),
          i3
        );
      }
      return (
        I2(e3, t3),
        (e3.prototype.resolveLayoutMode = function (t4) {
          var e4 = this.formattingContext.getRepetitiveElements();
          return t4.belongsTo(this.formattingContext) || e4.doneInitialLayout
            ? (t4.belongsTo(this.formattingContext) ||
                t4.after ||
                (e4 && e4.preventSkippingHeader()),
              new El(this.formattingContext, this.processor))
            : new vl(this.formattingContext, this.processor);
        }),
        e3
      );
    })(Us);
    var Nl = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return (
          ((i3 = t3.call(this) || this).formattingContext = e4),
          (i3.column = n4),
          i3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.startNonInlineElementNode = function (t4) {
          var e4 = this.formattingContext,
            n4 = t4.nodeContext,
            i3 = e4.getRepetitiveElements();
          if (n4.parent && e4.rootSourceNode === n4.parent.sourceNode) {
            switch (n4.repeatOnBreak) {
              case 'header':
                if (!i3.isHeaderRegistered())
                  return i3.setHeaderNodeContext(n4), Si(true);
                n4.repeatOnBreak = 'none';
                break;
              case 'footer':
                if (!i3.isFooterRegistered())
                  return i3.setFooterNodeContext(n4), Si(true);
                n4.repeatOnBreak = 'none';
            }
            i3.firstContentSourceNode ||
              (i3.firstContentSourceNode = n4.sourceNode);
          }
          return zs.prototype.startNonInlineElementNode.call(this, t4);
        }),
        (n3.afterNonInlineElementNode = function (t4) {
          var e4 = this.formattingContext,
            n4 = t4.nodeContext;
          return (
            n4.sourceNode === e4.rootSourceNode &&
              ((e4.getRepetitiveElements().lastContentSourceNode =
                t4.lastAfterNodeContext && t4.lastAfterNodeContext.sourceNode),
              (t4.break = true)),
            'header' === n4.repeatOnBreak || 'footer' === n4.repeatOnBreak
              ? Si(true)
              : zs.prototype.afterNonInlineElementNode.call(this, t4)
          );
        }),
        e3
      );
    })(zs);
    function bl(t3, e3) {
      t3 &&
        (function (t4, e4) {
          for (var n3 = t4; n3; n3 = n3.parent) {
            var i3 = n3.formattingContext;
            i3 && i3 instanceof dl && !n3.belongsTo(i3) && e4(i3, n3);
          }
        })(t3.after ? t3.parent : t3, function (t4, n3) {
          va.isInstanceOfTableFormattingContext(t4) ||
            e3.fragmentLayoutConstraints.push(new yl(n3));
        });
    }
    var Sl = new ((function (t3) {
      function e3() {
        return t3.apply(this, arguments) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.layout = function (t4, e4, n4) {
          if (e4.isFloatNodeContext(t4)) return e4.layoutFloatOrFootnote(t4);
          var i3 = t4.formattingContext;
          return i3.getRootViewNode(t4)
            ? (n4 && bl(t4.parent, e4),
              t4.belongsTo(i3)
                ? Ds.prototype.layout.call(this, t4, e4, n4)
                : new wl(i3, this).layout(t4, e4))
            : e4.buildDeepElementView(t4);
        }),
        (n3.startNonInlineElementNode = function (t4) {
          var e4 = (function (t5) {
            var e5 = t5.formattingContext;
            return e5 && e5 instanceof dl ? e5 : null;
          })(t4).getRepetitiveElements();
          return (
            !!e4 &&
            (e4.allowInsertRepeatitiveElements ||
              (!e4.isHeaderSourceNode(t4.sourceNode) &&
                !e4.isFooterSourceNode(t4.sourceNode)) ||
              t4.viewNode.parentNode.removeChild(t4.viewNode),
            false)
          );
        }),
        (n3.doInitialLayout = function (t4, e4) {
          var n4 = bi('BlockLayoutProcessor.doInitialLayout');
          return this.layoutEntireBlock(t4, e4).thenFinish(n4), n4.result();
        }),
        (n3.layoutEntireBlock = function (t4, e4) {
          var n4 = new Nl(t4.formattingContext, e4);
          return new Hs(n4, e4.layoutContext).iterate(t4);
        }),
        (n3.doLayout = function (t4, e4) {
          var n4 = t4.formattingContext,
            i3 = bi('doLayout');
          return (
            tl(e4.layoutContext.nextInTree(t4, false), e4).then(function (t5) {
              var r3 = t5;
              i3.loopWithFrame(function (t6) {
                for (
                  var i4 = function () {
                    var i5 = true;
                    if (
                      (e4.layoutNext(r3, false).then(function (o4) {
                        (r3 = o4),
                          e4.pageFloatLayoutContext.isInvalidated() ||
                          e4.pageBreakType ||
                          (r3 && e4.stopByOverflow(r3)) ||
                          (r3 && r3.after && r3.sourceNode == n4.rootSourceNode)
                            ? t6.breakLoop()
                            : i5
                            ? (i5 = false)
                            : t6.continueLoop();
                      }),
                      i5)
                    )
                      return (i5 = false), { v: void 0 };
                  };
                  r3;

                ) {
                  var o3 = i4();
                  if ('object' == typeof o3) return o3.v;
                }
                t6.breakLoop();
              }).then(function () {
                i3.finish(r3);
              });
            }),
            i3.result()
          );
        }),
        (n3.finishBreak = function (t4, e4, n4, i3) {
          return Ds.prototype.finishBreak.call(this, t4, e4, n4, i3);
        }),
        (n3.clearOverflownViewNodes = function (t4, e4, n4, i3) {
          Ds.prototype.clearOverflownViewNodes(t4, e4, n4, i3);
        }),
        e3
      );
    })(Ds))();
    d2(exports.HOOKS.RESOLVE_LAYOUT_PROCESSOR, function (t3) {
      return t3 instanceof dl && !va.isInstanceOfTableFormattingContext(t3)
        ? Sl
        : null;
    });
    var Cl = (function () {
      function t3(t4, e4) {
        (this.rowIndex = t4), (this.sourceNode = e4), (this.cells = []);
      }
      var e3 = t3.prototype;
      return (
        (e3.addCell = function (t4) {
          this.cells.push(t4);
        }),
        (e3.getMinimumHeight = function () {
          return Math.min.apply(
            null,
            this.cells.map(function (t4) {
              return t4.height;
            }),
          );
        }),
        t3
      );
    })();
    var Tl = (function () {
      function t3(t4, e4, n3) {
        (this.rowIndex = t4),
          (this.columnIndex = e4),
          (this.height = 0),
          (this.anchorSlot = null),
          (this.viewElement = n3),
          (this.colSpan = n3.colSpan || 1),
          (this.rowSpan = n3.rowSpan || 1);
      }
      var e3 = t3.prototype;
      return (
        (e3.setHeight = function (t4) {
          this.height = t4;
        }),
        (e3.setAnchorSlot = function (t4) {
          this.anchorSlot = t4;
        }),
        t3
      );
    })();
    var xl = function (t3, e3, n3) {
      (this.rowIndex = t3), (this.columnIndex = e3), (this.cell = n3);
    };
    var Il = (function () {
      function t3(t4, e3, n3) {
        (this.column = t4),
          (this.cellNodeContext = n3),
          (this.empty = false),
          (this.pseudoColumn = new al(t4, e3, n3));
      }
      return (
        (t3.prototype.findAcceptableBreakPosition = function () {
          var t4 = this.cellNodeContext.viewNode,
            e3 = this.cellNodeContext.verticalAlign;
          ('middle' !== e3 && 'bottom' !== e3) ||
            $2(t4, 'vertical-align', 'top');
          var n3 = this.pseudoColumn.findAcceptableBreakPosition(true);
          return $2(t4, 'vertical-align', e3), n3;
        }),
        t3
      );
    })();
    var Pl = function (t3, e3) {
      (this.viewNode = t3), (this.side = e3);
    };
    var Rl = (function (t3) {
      function e3(e4, n4, i3, r3) {
        var o3;
        return (
          ((o3 =
            t3.call(this, e4, n4, i3, r3) ||
            this).acceptableCellBreakPositions = null),
          (o3.rowIndex = null),
          (o3.formattingContext = e4.formattingContext),
          o3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.findAcceptableBreak = function (e4, n4) {
          var i3 = t3.prototype.findAcceptableBreak.call(this, e4, n4);
          return n4 < this.getMinBreakPenalty()
            ? null
            : this.getAcceptableCellBreakPositions().every(function (t4) {
                return !!t4.nodeContext;
              })
            ? i3
            : null;
        }),
        (n3.getMinBreakPenalty = function () {
          var e4 = t3.prototype.getMinBreakPenalty.call(this);
          return (
            this.getAcceptableCellBreakPositions().forEach(function (t4) {
              e4 += t4.breakPosition.getMinBreakPenalty();
            }),
            e4
          );
        }),
        (n3.getAcceptableCellBreakPositions = function () {
          if (!this.acceptableCellBreakPositions) {
            var t4 = this.getCellFragments();
            this.acceptableCellBreakPositions = t4.map(function (t5) {
              return t5.findAcceptableBreakPosition();
            });
          }
          return this.acceptableCellBreakPositions;
        }),
        (n3.getRowIndex = function () {
          return null != this.rowIndex
            ? this.rowIndex
            : (this.rowIndex = this.formattingContext.findRowIndexBySourceNode(
                this.position.sourceNode,
              ));
        }),
        (n3.getCellFragments = function () {
          return this.formattingContext
            .getRowSpanningCellsOverflowingTheRow(this.getRowIndex())
            .map(
              this.formattingContext.getCellFragmentOfCell,
              this.formattingContext,
            );
        }),
        e3
      );
    })(Ps);
    var Al = (function (t3) {
      function e3(e4, n4, i3) {
        var r3;
        return (
          ((r3 = t3.call(this) || this).rowIndex = e4),
          (r3.beforeNodeContext = n4),
          (r3.formattingContext = i3),
          (r3.acceptableCellBreakPositions = null),
          r3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.findAcceptableBreak = function (t4, e4) {
          if (e4 < this.getMinBreakPenalty()) return null;
          var n4 = this.getCellFragments(),
            i3 = this.getAcceptableCellBreakPositions(),
            r3 =
              i3.every(function (t5) {
                return !!t5.nodeContext;
              }) &&
              i3.some(function (t5, e5) {
                var i4 = n4[e5].pseudoColumn,
                  r4 = t5.nodeContext;
                return (
                  !i4.isStartNodeContext(r4) && !i4.isLastAfterNodeContext(r4)
                );
              });
          return (
            (this.beforeNodeContext.overflow = i3.some(function (t5) {
              return t5.nodeContext && t5.nodeContext.overflow;
            })),
            r3 ? this.beforeNodeContext : null
          );
        }),
        (n3.getMinBreakPenalty = function () {
          var t4 = this.formattingContext,
            e4 = t4.getRowByIndex(this.rowIndex),
            n4 = 0;
          return (
            t4.isFreelyFragmentableRow(e4) || (n4 += 10),
            this.getAcceptableCellBreakPositions().forEach(function (t5) {
              n4 += t5.breakPosition.getMinBreakPenalty();
            }),
            n4
          );
        }),
        (n3.getAcceptableCellBreakPositions = function () {
          if (!this.acceptableCellBreakPositions) {
            var t4 = this.getCellFragments();
            this.acceptableCellBreakPositions = t4.map(function (t5) {
              return t5.findAcceptableBreakPosition();
            });
          }
          return this.acceptableCellBreakPositions;
        }),
        (n3.getCellFragments = function () {
          return this.formattingContext
            .getCellsFallingOnRow(this.rowIndex)
            .map(
              this.formattingContext.getCellFragmentOfCell,
              this.formattingContext,
            );
        }),
        e3
      );
    })(xs);
    var Ll = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return (
          ((i3 = t3.call(this, e4, n4) || this).tableSourceNode = n4),
          (i3.formattingContextType = 'Table'),
          (i3.vertical = false),
          (i3.columnCount = -1),
          (i3.tableWidth = 0),
          (i3.captions = []),
          (i3.colGroups = null),
          (i3.colWidths = null),
          (i3.inlineBorderSpacing = 0),
          (i3.rows = []),
          (i3.slots = []),
          (i3.cellFragments = []),
          (i3.lastRowViewNode = null),
          (i3.cellBreakPositions = []),
          (i3.repetitiveElements = null),
          i3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getName = function () {
          return 'Table formatting context (Table.TableFormattingContext)';
        }),
        (n3.isFirstTime = function (t4, e4) {
          if (!e4) return e4;
          switch (t4.display) {
            case 'table-row':
              return 0 === this.cellBreakPositions.length;
            case 'table-cell':
              return !this.cellBreakPositions.some(function (e5) {
                return e5.cellNodePosition.steps[0].node === t4.sourceNode;
              });
            default:
              return e4;
          }
        }),
        (n3.getParent = function () {
          return this.parent;
        }),
        (n3.finishFragment = function () {
          this.cellFragments = [];
        }),
        (n3.addRow = function (t4, e4) {
          this.rows[t4] = e4;
        }),
        (n3.getRowSlots = function (t4) {
          var e4 = this.slots[t4];
          return e4 || (e4 = this.slots[t4] = []), e4;
        }),
        (n3.addCell = function (t4, e4) {
          var n4 = this.rows[t4];
          n4 || (this.addRow(t4, new Cl(t4, null)), (n4 = this.rows[t4])),
            n4.addCell(e4);
          for (
            var i3 = t4 + e4.rowSpan, r3 = this.getRowSlots(t4), o3 = 0;
            r3[o3];

          )
            o3++;
          for (; t4 < i3; t4++) {
            r3 = this.getRowSlots(t4);
            for (var a3 = o3; a3 < o3 + e4.colSpan; a3++) {
              var s3 = (r3[a3] = new xl(t4, a3, e4));
              e4.anchorSlot || e4.setAnchorSlot(s3);
            }
          }
        }),
        (n3.getRowByIndex = function (t4) {
          return this.rows[t4];
        }),
        (n3.findRowIndexBySourceNode = function (t4) {
          return this.rows.findIndex(function (e4) {
            return t4 === e4.sourceNode;
          });
        }),
        (n3.addCellFragment = function (t4, e4, n4) {
          var i3 = this.cellFragments[t4];
          i3 || (i3 = this.cellFragments[t4] = []), (i3[e4] = n4);
        }),
        (n3.getCellsFallingOnRow = function (t4) {
          return this.getRowSlots(t4).reduce(function (t5, e4) {
            return e4.cell !== t5[t5.length - 1] ? t5.concat(e4.cell) : t5;
          }, []);
        }),
        (n3.getRowSpanningCellsOverflowingTheRow = function (t4) {
          return this.getCellsFallingOnRow(t4).filter(function (e4) {
            return e4.rowIndex + e4.rowSpan - 1 > t4;
          });
        }),
        (n3.getCellFragmentOfCell = function (t4) {
          return (
            this.cellFragments[t4.rowIndex] &&
            this.cellFragments[t4.rowIndex][t4.columnIndex]
          );
        }),
        (n3.isFreelyFragmentableRow = function (t4) {
          return t4.getMinimumHeight() > this.tableWidth / 2;
        }),
        (n3.getColumnCount = function () {
          return (
            this.columnCount < 0 &&
              (this.columnCount = Math.max.apply(
                null,
                this.rows.map(function (t4) {
                  return t4.cells.reduce(function (t5, e4) {
                    return t5 + e4.colSpan;
                  }, 0);
                }),
              )),
            this.columnCount
          );
        }),
        (n3.updateCellSizes = function (t4) {
          var e4 = this;
          this.rows.forEach(function (n4) {
            n4.cells.forEach(function (n5) {
              var i3 = t4.getElementClientRect(n5.viewElement);
              (n5.viewElement = null),
                n5.setHeight(e4.vertical ? i3.width : i3.height);
            });
          });
        }),
        (n3.findCellFromColumn = function (t4) {
          if (!t4) return null;
          var e4 = null,
            n4 = 0,
            i3 = 0;
          t: for (n4 = 0; n4 < this.cellFragments.length; n4++)
            if (this.cellFragments[n4]) {
              for (i3 = 0; i3 < this.cellFragments[n4].length; i3++)
                if (
                  this.cellFragments[n4][i3] &&
                  t4 === this.cellFragments[n4][i3].pseudoColumn.getColumn()
                ) {
                  e4 = this.rows[n4].cells[i3];
                  break t;
                }
            }
          if (!e4) return null;
          for (; n4 < this.slots.length; n4++)
            for (; i3 < this.slots[n4].length; i3++) {
              var r3 = this.slots[n4][i3];
              if (r3.cell === e4)
                return { rowIndex: r3.rowIndex, columnIndex: r3.columnIndex };
            }
          return null;
        }),
        (n3.collectElementsOffsetOfUpperCells = function (t4) {
          var e4 = this,
            n4 = [];
          return this.slots.reduce(function (i3, r3, o3) {
            if (o3 >= t4.rowIndex) return i3;
            var a3 =
              r3[t4.columnIndex] &&
              e4.getCellFragmentOfCell(r3[t4.columnIndex].cell);
            return (
              !a3 ||
                n4.includes(a3) ||
                (e4.collectElementsOffsetFromColumn(
                  a3.pseudoColumn.getColumn(),
                  i3,
                ),
                n4.push(a3)),
              i3
            );
          }, []);
        }),
        (n3.collectElementsOffsetOfHighestColumn = function () {
          var t4 = this,
            e4 = [];
          return (
            this.rows.forEach(function (n4) {
              n4.cells.forEach(function (n5, i3) {
                e4[i3] || (e4[i3] = { collected: [], elements: [] });
                var r3 = e4[i3],
                  o3 = t4.getCellFragmentOfCell(n5);
                o3 &&
                  !r3.collected.includes(o3) &&
                  (t4.collectElementsOffsetFromColumn(
                    o3.pseudoColumn.getColumn(),
                    r3.elements,
                  ),
                  r3.collected.push(o3));
              });
            }),
            [
              new Ol(
                e4.map(function (t5) {
                  return t5.elements;
                }),
              ),
            ]
          );
        }),
        (n3.collectElementsOffsetFromColumn = function (t4, e4) {
          t4.fragmentLayoutConstraints.forEach(function (t5) {
            if (ma.isInstanceOfRepetitiveElementsOwnerLayoutConstraint(t5)) {
              var n4 = t5.getRepetitiveElements();
              e4.push(n4);
            }
            va.isInstanceOfTableRowLayoutConstraint(t5) &&
              t5.getElementsOffsetsForTableCell(null).forEach(function (t6) {
                e4.push(t6);
              });
          });
        }),
        (n3.saveState = function () {
          return [].concat(this.cellBreakPositions);
        }),
        (n3.restoreState = function (t4) {
          this.cellBreakPositions = t4;
        }),
        e3
      );
    })(dl);
    var Ol = (function () {
      function t3(t4) {
        this.repeatitiveElementsInColumns = t4;
      }
      var e3 = t3.prototype;
      return (
        (e3.calculateOffset = function (t4) {
          return this.calculateMaxOffsetOfColumn(t4, function (t5) {
            return t5.current;
          });
        }),
        (e3.calculateMinimumOffset = function (t4) {
          return this.calculateMaxOffsetOfColumn(t4, function (t5) {
            return t5.minimum;
          });
        }),
        (e3.calculateMaxOffsetOfColumn = function (t4, e4) {
          var n3 = 0;
          return (
            this.repeatitiveElementsInColumns.forEach(function (i3) {
              var r3 = Is(t4, i3);
              n3 = Math.max(n3, e4(r3));
            }),
            n3
          );
        }),
        t3
      );
    })();
    function kl(t3) {
      return (
        (function (t4) {
          return (
            'table-row-group' === t4 ||
            'table-header-group' === t4 ||
            'table-footer-group' === t4
          );
        })(t3) ||
        (function (t4) {
          return 'table' === t4 || 'inline-table' === t4;
        })(t3)
      );
    }
    function Fl(t3, e3, n3) {
      var i3 = t3.nodeContext,
        r3 = i3.display,
        o3 = i3.parent ? i3.parent.display : null,
        a3 = false;
      if ('inline-table' === o3 && !(i3.formattingContext instanceof Ll)) {
        for (var s3 = i3.parent; s3; s3 = s3.parent)
          if (s3.formattingContext instanceof Ll) {
            a3 = s3.formattingContext === e3;
            break;
          }
      }
      return a3 ||
        ('table-row' === r3 && !kl(o3)) ||
        ('table-cell' === r3 && 'table-row' !== o3 && !kl(o3)) ||
        (i3.formattingContext instanceof Ll && i3.formattingContext !== e3)
        ? n3.buildDeepElementView(i3).thenAsync(function (e4) {
            return (t3.nodeContext = e4), Si(true);
          })
        : null;
    }
    var Dl = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return (
          ((i3 = t3.call(this) || this).formattingContext = e4),
          (i3.column = n4),
          (i3.rowIndex = -1),
          (i3.columnIndex = 0),
          (i3.inRow = false),
          (i3.checkPoints = []),
          (i3.inHeaderOrFooter = false),
          i3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.startNonInlineElementNode = function (e4) {
          var n4 = this.formattingContext,
            i3 = Fl(e4, n4, this.column);
          if (i3) return i3;
          this.postLayoutBlockContents(e4);
          var r3 = e4.nodeContext,
            o3 = r3.display,
            a3 = n4.getRepetitiveElements();
          switch (o3) {
            case 'table':
              n4.inlineBorderSpacing = r3.inlineBorderSpacing;
              break;
            case 'table-caption':
              var s3 = new Pl(r3.viewNode, r3.captionSide);
              n4.captions.push(s3);
              break;
            case 'table-header-group':
              return (
                a3.isHeaderRegistered() ||
                  ((this.inHeaderOrFooter = true), a3.setHeaderNodeContext(r3)),
                Si(true)
              );
            case 'table-footer-group':
              return (
                a3.isFooterRegistered() ||
                  ((this.inHeaderOrFooter = true), a3.setFooterNodeContext(r3)),
                Si(true)
              );
            case 'table-row':
              this.inHeaderOrFooter ||
                ((this.inRow = true),
                this.rowIndex++,
                (this.columnIndex = 0),
                n4.addRow(this.rowIndex, new Cl(this.rowIndex, r3.sourceNode)),
                a3.firstContentSourceNode ||
                  (a3.firstContentSourceNode = r3.sourceNode));
          }
          return t3.prototype.startNonInlineElementNode.call(this, e4);
        }),
        (n3.afterNonInlineElementNode = function (e4) {
          var n4 = this.formattingContext,
            i3 = e4.nodeContext,
            r3 = i3.display,
            o3 = this.column.clientLayout;
          if (
            (this.postLayoutBlockContents(e4),
            i3.sourceNode === n4.tableSourceNode)
          ) {
            var a3 = o3.getElementComputedStyle(n4.getRootViewNode(i3));
            (n4.tableWidth = parseFloat(a3[n4.vertical ? 'height' : 'width'])),
              (n4.getRepetitiveElements().lastContentSourceNode =
                e4.lastAfterNodeContext && e4.lastAfterNodeContext.sourceNode),
              (e4.break = true);
          } else
            switch (r3) {
              case 'table-header-group':
              case 'table-footer-group':
                if (this.inHeaderOrFooter)
                  return (this.inHeaderOrFooter = false), Si(true);
                break;
              case 'table-row':
                this.inHeaderOrFooter ||
                  ((n4.lastRowViewNode = i3.viewNode), (this.inRow = false));
                break;
              case 'table-cell':
                this.inHeaderOrFooter ||
                  (this.inRow ||
                    (this.rowIndex++,
                    (this.columnIndex = 0),
                    (this.inRow = true)),
                  n4.addCell(
                    this.rowIndex,
                    new Tl(this.rowIndex, this.columnIndex, i3.viewNode),
                  ),
                  this.columnIndex++);
            }
          return t3.prototype.afterNonInlineElementNode.call(this, e4);
        }),
        (n3.startNonElementNode = function (t4) {
          this.registerCheckPoint(t4);
        }),
        (n3.afterNonElementNode = function (t4) {
          this.registerCheckPoint(t4);
        }),
        (n3.startInlineElementNode = function (t4) {
          this.registerCheckPoint(t4);
        }),
        (n3.afterInlineElementNode = function (t4) {
          this.registerCheckPoint(t4);
        }),
        (n3.registerCheckPoint = function (t4) {
          var e4 = t4.nodeContext;
          e4 && e4.viewNode && !Ts(e4) && this.checkPoints.push(e4.clone());
        }),
        (n3.postLayoutBlockContents = function (t4) {
          this.checkPoints.length > 0 &&
            this.column.postLayoutBlock(t4.nodeContext, this.checkPoints),
            (this.checkPoints = []);
        }),
        e3
      );
    })(zs);
    var _l = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return (
          ((i3 = t3.call(this, true) || this).formattingContext = e4),
          (i3.column = n4),
          (i3.inRow = false),
          (i3.currentRowIndex = -1),
          (i3.currentColumnIndex = 0),
          (i3.originalStopAtOverflow = n4.stopAtOverflow),
          (n4.stopAtOverflow = false),
          i3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.resetColumn = function () {
          this.column.stopAtOverflow = this.originalStopAtOverflow;
        }),
        (n3.getColSpanningCellWidth = function (t4) {
          for (
            var e4 = this.formattingContext.colWidths, n4 = 0, i3 = 0;
            i3 < t4.colSpan;
            i3++
          )
            n4 += e4[t4.anchorSlot.columnIndex + i3];
          return (
            n4 + this.formattingContext.inlineBorderSpacing * (t4.colSpan - 1)
          );
        }),
        (n3.layoutCell = function (t4, e4, n4) {
          var i3 = t4.rowIndex,
            r3 = t4.columnIndex,
            o3 = e4.viewNode;
          t4.colSpan > 1 &&
            ($2(o3, 'box-sizing', 'border-box'),
            $2(
              o3,
              this.formattingContext.vertical ? 'height' : 'width',
              this.getColSpanningCellWidth(t4) + 'px',
            ));
          var a3 = o3.ownerDocument.createElement('div');
          o3.appendChild(a3);
          var s3 = new Il(this.column, a3, e4);
          return (
            this.formattingContext.addCellFragment(i3, r3, s3),
            1 === n4.primary.steps.length &&
              n4.primary.after &&
              (s3.empty = true),
            s3.pseudoColumn.layout(n4, true).thenReturn(true)
          );
        }),
        (n3.hasBrokenCellAtSlot = function (t4) {
          var e4 = this.formattingContext.cellBreakPositions[0];
          return !!e4 && e4.cell.anchorSlot.columnIndex === t4;
        }),
        (n3.extractRowSpanningCellBreakPositions = function () {
          var t4 = this.formattingContext.cellBreakPositions;
          if (0 === t4.length) return [];
          var e4 = [],
            n4 = 0;
          do {
            var i3 = t4[n4],
              r3 = i3.cell.rowIndex;
            if (r3 < this.currentRowIndex) {
              var o3 = e4[r3];
              o3 || (o3 = e4[r3] = []), o3.push(i3), t4.splice(n4, 1);
            } else n4++;
          } while (n4 < t4.length);
          return e4;
        }),
        (n3.layoutRowSpanningCellsFromPreviousFragment = function (t4) {
          var e4 = this,
            n4 = this.formattingContext,
            i3 = this.extractRowSpanningCellBreakPositions(),
            r3 = i3.reduce(function (t5) {
              return t5 + 1;
            }, 0);
          if (0 === r3) return Si(true);
          var o3 = this.column.layoutContext,
            a3 = t4.nodeContext;
          a3.viewNode.parentNode.removeChild(a3.viewNode);
          var s3 = bi('layoutRowSpanningCellsFromPreviousFragment'),
            l3 = Si(true),
            u3 = 0,
            h3 = [];
          return (
            i3.forEach(function (t5) {
              l3 = l3.thenAsync(function () {
                var i4 = Ha(t5[0].cellNodePosition.steps[1], a3.parent);
                return o3.setCurrent(i4, false).thenAsync(function () {
                  var a4 = Si(true),
                    s4 = 0;
                  function l4(t6) {
                    for (; s4 < t6; ) {
                      if (!h3.includes(s4)) {
                        var e5 = i4.viewNode.ownerDocument.createElement('td');
                        $2(e5, 'padding', '0'), i4.viewNode.appendChild(e5);
                      }
                      s4++;
                    }
                  }
                  return (
                    t5.forEach(function (t6) {
                      a4 = a4.thenAsync(function () {
                        var n5 = t6.cell;
                        l4(n5.anchorSlot.columnIndex);
                        var a5 = t6.cellNodePosition,
                          c3 = Ha(a5.steps[0], i4);
                        return (
                          (c3.offsetInNode = a5.offsetInNode),
                          (c3.after = a5.after),
                          (c3.fragmentIndex = a5.steps[0].fragmentIndex + 1),
                          o3.setCurrent(c3, false).thenAsync(function () {
                            for (
                              var i5 = t6.breakChunkPosition, o4 = 0;
                              o4 < n5.colSpan;
                              o4++
                            )
                              h3.push(s4 + o4);
                            return (
                              (s4 += n5.colSpan),
                              e4.layoutCell(n5, c3, i5).thenAsync(function () {
                                return (
                                  (c3.viewNode.rowSpan =
                                    n5.rowIndex +
                                    n5.rowSpan -
                                    e4.currentRowIndex +
                                    r3 -
                                    u3),
                                  Si(true)
                                );
                              })
                            );
                          })
                        );
                      });
                    }),
                    a4.thenAsync(function () {
                      return l4(n4.getColumnCount()), u3++, Si(true);
                    })
                  );
                });
              });
            }),
            l3.then(function () {
              o3.setCurrent(a3, true, t4.atUnforcedBreak).then(function () {
                s3.finish(true);
              });
            }),
            s3.result()
          );
        }),
        (n3.startTableRow = function (t4) {
          var e4 = this;
          if (this.inHeader || this.inFooter) return Si(true);
          var n4 = t4.nodeContext,
            i3 = this.formattingContext;
          return (
            this.currentRowIndex < 0
              ? (this.currentRowIndex = i3.findRowIndexBySourceNode(
                  n4.sourceNode,
                ))
              : this.currentRowIndex++,
            (this.currentColumnIndex = 0),
            (this.inRow = true),
            this.layoutRowSpanningCellsFromPreviousFragment(t4).thenAsync(
              function () {
                return (
                  e4.registerCellFragmentIndex(),
                  e4.column.checkOverflowAndSaveEdgeAndBreakPosition(
                    t4.lastAfterNodeContext,
                    null,
                    true,
                    t4.breakAtTheEdge,
                  ) &&
                    0 ===
                      i3.getRowSpanningCellsOverflowingTheRow(
                        e4.currentRowIndex - 1,
                      ).length &&
                    (e4.resetColumn(), (n4.overflow = true), (t4.break = true)),
                  Si(true)
                );
              },
            )
          );
        }),
        (n3.registerCellFragmentIndex = function () {
          var t4 = this;
          this.formattingContext
            .getRowByIndex(this.currentRowIndex)
            .cells.forEach(function (e4) {
              var n4 = t4.formattingContext.cellBreakPositions[e4.columnIndex];
              if (
                n4 &&
                n4.cell.anchorSlot.columnIndex == e4.anchorSlot.columnIndex
              ) {
                var i3 = n4.cellNodePosition.steps[0],
                  r3 = t4.column.layoutContext.xmldoc.getElementOffset(i3.node);
                qs(r3, i3.fragmentIndex + 1, 1);
              }
            });
        }),
        (n3.startTableCell = function (t4) {
          var e4 = this;
          if (this.inHeader || this.inFooter) return Si(true);
          var n4 = t4.nodeContext;
          this.inRow ||
            (this.currentRowIndex < 0
              ? (this.currentRowIndex = 0)
              : this.currentRowIndex++,
            (this.currentColumnIndex = 0),
            (this.inRow = true));
          var i3 = this.formattingContext.getRowByIndex(this.currentRowIndex)
              .cells[this.currentColumnIndex],
            r3 = n4.copy().modify();
          (r3.after = true), (t4.nodeContext = r3);
          var o3,
            a3 = bi('startTableCell');
          if (this.hasBrokenCellAtSlot(i3.anchorSlot.columnIndex)) {
            var s3 = this.formattingContext.cellBreakPositions.shift();
            (n4.fragmentIndex = s3.cellNodePosition.steps[0].fragmentIndex + 1),
              (o3 = Si(s3.breakChunkPosition));
          } else
            o3 = this.column
              .nextInTree(n4, t4.atUnforcedBreak)
              .thenAsync(function (t5) {
                t5.viewNode && n4.viewNode.removeChild(t5.viewNode);
                var e5 = Va(t5, 0);
                return Si(new Ya(e5));
              });
          return (
            o3.then(function (r4) {
              e4.layoutCell(i3, n4, r4).then(function () {
                e4.afterNonInlineElementNode(t4),
                  e4.currentColumnIndex++,
                  a3.finish(true);
              });
            }),
            a3.result()
          );
        }),
        (n3.startNonInlineBox = function (t4) {
          var e4 = Fl(t4, this.formattingContext, this.column);
          if (e4) return e4;
          var n4 = t4.nodeContext,
            i3 = this.formattingContext.getRepetitiveElements(),
            r3 = n4.display;
          return 'table-header-group' === r3 &&
            i3 &&
            i3.isHeaderSourceNode(n4.sourceNode)
            ? ((this.inHeader = true), Si(true))
            : 'table-footer-group' === r3 &&
              i3 &&
              i3.isFooterSourceNode(n4.sourceNode)
            ? ((this.inFooter = true), Si(true))
            : 'table-row' === r3
            ? this.startTableRow(t4)
            : 'table-cell' === r3
            ? this.startTableCell(t4)
            : Si(true);
        }),
        (n3.endNonInlineBox = function (t4) {
          var e4 = t4.nodeContext;
          if (
            'table-row' === e4.display &&
            ((this.inRow = false), !this.inHeader && !this.inFooter)
          ) {
            var n4 = e4.copy().modify();
            n4.after = false;
            var i3 = new Al(this.currentRowIndex, n4, this.formattingContext);
            this.column.breakPositions.push(i3);
          }
          return Si(true);
        }),
        (n3.afterNonInlineElementNode = function (n4) {
          var i3 = n4.nodeContext,
            r3 = this.formattingContext.getRepetitiveElements(),
            o3 = i3.display;
          if (
            ('table-header-group' === o3
              ? r3 &&
                !r3.allowInsertRepeatitiveElements &&
                r3.isHeaderSourceNode(i3.sourceNode)
                ? ((this.inHeader = false),
                  i3.viewNode.parentNode.removeChild(i3.viewNode))
                : $2(i3.viewNode, 'display', 'table-row-group')
              : 'table-footer-group' === o3 &&
                (r3 &&
                !r3.allowInsertRepeatitiveElements &&
                r3.isFooterSourceNode(i3.sourceNode)
                  ? ((this.inFooter = false),
                    i3.viewNode.parentNode.removeChild(i3.viewNode))
                  : $2(i3.viewNode, 'display', 'table-row-group')),
            o3 && e3.ignoreList[o3])
          )
            i3.viewNode.parentNode.removeChild(i3.viewNode);
          else {
            if (i3.sourceNode !== this.formattingContext.tableSourceNode)
              return t3.prototype.afterNonInlineElementNode.call(this, n4);
            (i3.overflow = this.column.checkOverflowAndSaveEdge(i3, null)),
              this.resetColumn(),
              (n4.break = true);
          }
          return Si(true);
        }),
        e3
      );
    })(zs);
    _l.ignoreList = {
      'table-caption': true,
      'table-column-group': true,
      'table-column': true,
    };
    var Bl = [];
    var Ml = (function () {
      function t3() {}
      var e3 = t3.prototype;
      return (
        (e3.layoutEntireTable = function (t4, e4) {
          var n3 = new Dl(t4.formattingContext, e4);
          return new Hs(n3, e4.layoutContext).iterate(t4);
        }),
        (e3.getColumnWidths = function (t4, e4, n3, i3) {
          for (
            var r3 = t4.ownerDocument,
              o3 = r3.createElement('tr'),
              a3 = [],
              s3 = 0;
            s3 < e4;
            s3++
          ) {
            var l3 = r3.createElement('td');
            o3.appendChild(l3), a3.push(l3);
          }
          t4.parentNode.insertBefore(o3, t4.nextSibling);
          var u3 = a3.map(function (t5) {
            var e5 = i3.getElementClientRect(t5);
            return n3 ? e5.height : e5.width;
          });
          return t4.parentNode.removeChild(o3), u3;
        }),
        (e3.getColGroupElements = function (t4) {
          for (var e4 = [], n3 = t4.firstElementChild; n3; )
            'colgroup' === n3.localName && e4.push(n3),
              (n3 = n3.nextElementSibling);
          return e4;
        }),
        (e3.normalizeAndGetColElements = function (t4) {
          var e4 = [];
          return (
            t4.forEach(function (t5) {
              var n3 = t5.span;
              t5.removeAttribute('span');
              for (var i3 = t5.firstElementChild; i3; ) {
                if ('col' === i3.localName) {
                  var r3 = i3.span;
                  for (i3.removeAttribute('span'), n3 -= r3; r3-- > 1; ) {
                    var o3 = i3.cloneNode(true);
                    t5.insertBefore(o3, i3), e4.push(o3);
                  }
                  e4.push(i3);
                }
                i3 = i3.nextElementSibling;
              }
              for (; n3-- > 0; )
                (i3 = t5.ownerDocument.createElement('col')),
                  t5.appendChild(i3),
                  e4.push(i3);
            }),
            e4
          );
        }),
        (e3.addMissingColElements = function (t4, e4, n3, i3) {
          if (t4.length < n3) {
            var r3 = i3.ownerDocument.createElement('colgroup');
            e4.push(r3);
            for (var o3 = t4.length; o3 < n3; o3++) {
              var a3 = i3.ownerDocument.createElement('col');
              r3.appendChild(a3), t4.push(a3);
            }
          }
        }),
        (e3.normalizeColGroups = function (t4, e4, n3) {
          var i3 = t4.vertical,
            r3 = t4.lastRowViewNode;
          if (r3) {
            t4.lastRowViewNode = null;
            var o3 = r3.ownerDocument.createDocumentFragment(),
              a3 = t4.getColumnCount();
            if (a3 > 0) {
              var s3 = (t4.colWidths = this.getColumnWidths(
                  r3,
                  a3,
                  i3,
                  n3.clientLayout,
                )),
                l3 = this.getColGroupElements(e4),
                u3 = this.normalizeAndGetColElements(l3);
              this.addMissingColElements(u3, l3, a3, e4),
                u3.forEach(function (t5, e5) {
                  $2(t5, i3 ? 'height' : 'width', s3[e5] + 'px');
                }),
                l3.forEach(function (t5) {
                  o3.appendChild(t5.cloneNode(true));
                }),
                (t4.colGroups = o3);
            } else t4.colGroups = o3;
          }
        }),
        (e3.doInitialLayout = function (t4, e4) {
          var n3 = this,
            i3 = t4.formattingContext;
          (i3.vertical = t4.vertical),
            i3.initializeRepetitiveElements(t4.vertical);
          var r3,
            o3,
            a3,
            s3 =
              ((r3 = t4.sourceNode),
              (o3 = Bl.findIndex(function (t5) {
                return t5.root === r3;
              })),
              (a3 = Bl[o3]) ? a3.tableLayoutOption : null);
          !(function (t5) {
            var e5 = Bl.findIndex(function (e6) {
              return e6.root === t5;
            });
            e5 >= 0 && Bl.splice(e5, 1);
          })(t4.sourceNode);
          var l3 = bi('TableLayoutProcessor.doInitialLayout'),
            u3 = t4.copy();
          return (
            this.layoutEntireTable(t4, e4).then(function (r4) {
              var o4 = r4.viewNode,
                a4 = e4.clientLayout.getElementClientRect(o4),
                h3 = e4.vertical ? a4.left : a4.bottom;
              if (
                ((h3 +=
                  (e4.vertical ? -1 : 1) *
                  Is(t4, e4.collectElementsOffset()).current),
                !(
                  e4.isOverflown(h3) ||
                  (s3 && s3.calculateBreakPositionsInside)
                ))
              )
                return e4.breakPositions.push(new Hl(u3)), void l3.finish(r4);
              n3.normalizeColGroups(i3, o4, e4),
                i3.updateCellSizes(e4.clientLayout),
                l3.finish(null);
            }),
            l3.result()
          );
        }),
        (e3.addCaptions = function (t4, e4, n3) {
          var i3 = t4.captions;
          i3.forEach(function (t5, r3) {
            t5 &&
              (e4.insertBefore(t5.viewNode, n3),
              'top' === t5.side && (i3[r3] = null));
          });
        }),
        (e3.addColGroups = function (t4, e4, n3) {
          t4.colGroups &&
            0 === this.getColGroupElements(e4).length &&
            e4.insertBefore(t4.colGroups.cloneNode(true), n3);
        }),
        (e3.removeColGroups = function (t4, e4) {
          if (t4.colGroups && e4) {
            var n3 = this.getColGroupElements(e4);
            n3 &&
              n3.forEach(function (t5) {
                e4.removeChild(t5);
              });
          }
        }),
        (e3.doLayout = function (t4, e4) {
          var n3 = t4.formattingContext,
            i3 = n3.getRootViewNode(t4),
            r3 = i3.firstChild;
          this.addCaptions(n3, i3, r3), this.addColGroups(n3, i3, r3);
          var o3 = new _l(n3, e4),
            a3 = new Hs(o3, e4.layoutContext),
            s3 = bi('TableFormattingContext.doLayout');
          return a3.iterate(t4).thenFinish(s3), s3.result();
        }),
        (e3.layout = function (t4, e4, n3) {
          var i3 = t4.formattingContext;
          return i3.getRootViewNode(t4)
            ? (n3 && bl(t4.parent, e4), new Ul(i3, this).layout(t4, e4))
            : e4.buildDeepElementView(t4);
        }),
        (e3.createEdgeBreakPosition = function (t4, e4, n3, i3) {
          return new Rl(t4, e4, n3, i3);
        }),
        (e3.startNonInlineElementNode = function (t4) {
          return false;
        }),
        (e3.afterNonInlineElementNode = function (t4, e4) {
          return false;
        }),
        (e3.finishBreak = function (t4, e4, n3, i3) {
          var r3 = e4.formattingContext;
          if ('table-row' === e4.display) {
            var o3,
              a3 = r3.findRowIndexBySourceNode(e4.sourceNode);
            if (
              ((r3.cellBreakPositions = []),
              (o3 = e4.after
                ? r3.getRowSpanningCellsOverflowingTheRow(a3)
                : r3.getCellsFallingOnRow(a3)).length)
            ) {
              var s3 = bi('TableLayoutProcessor.finishBreak'),
                l3 = 0;
              return (
                s3
                  .loopWithFrame(function (t5) {
                    if (l3 !== o3.length) {
                      var e5 = o3[l3++],
                        n4 = r3.getCellFragmentOfCell(e5),
                        i4 = n4.findAcceptableBreakPosition().nodeContext,
                        s4 = n4.cellNodeContext,
                        u3 = s4.toNodePosition(),
                        h3 = new Ya(i4.toNodePosition());
                      r3.cellBreakPositions.push({
                        cellNodePosition: u3,
                        breakChunkPosition: h3,
                        cell: e5,
                      });
                      var c3 = s4.viewNode;
                      n4.column.layoutContext.processFragmentedBlockEdge(
                        n4.cellNodeContext,
                      ),
                        a3 < e5.rowIndex + e5.rowSpan - 1 &&
                          (c3.rowSpan = a3 - e5.rowIndex + 1),
                        n4.empty
                          ? t5.continueLoop()
                          : n4.pseudoColumn
                              .finishBreak(i4, false, true)
                              .then(function () {
                                !(function (t6, e6, n5) {
                                  var i5 = e6.getRepetitiveElements();
                                  if (i5) {
                                    var r4 = e6.vertical,
                                      o4 = t6.column,
                                      a4 = t6.pseudoColumn.getColumnElement(),
                                      s5 = t6.cellNodeContext.viewNode,
                                      l4 = o4.clientLayout.getElementClientRect(
                                        s5,
                                      ),
                                      u4 = o4.getComputedPaddingBorder(s5);
                                    r4
                                      ? $2(
                                          a4,
                                          'max-width',
                                          l4.right -
                                            o4.footnoteEdge -
                                            i5.calculateOffset(n5) -
                                            u4.right +
                                            'px',
                                        )
                                      : $2(
                                          a4,
                                          'max-height',
                                          o4.footnoteEdge -
                                            i5.calculateOffset(n5) -
                                            l4.top -
                                            u4.top +
                                            'px',
                                        ),
                                      $2(a4, 'overflow', 'hidden');
                                  }
                                })(n4, r3, i4),
                                  t5.continueLoop();
                              });
                    } else t5.breakLoop();
                  })
                  .then(function () {
                    t4.clearOverflownViewNodes(e4, false),
                      t4.layoutContext.processFragmentedBlockEdge(e4),
                      r3.finishFragment(),
                      s3.finish(true);
                  }),
                s3.result()
              );
            }
          }
          return r3.finishFragment(), Bs.finishBreak(t4, e4, n3, i3);
        }),
        (e3.clearOverflownViewNodes = function (t4, e4, n3, i3) {
          Ds.prototype.clearOverflownViewNodes(t4, e4, n3, i3);
        }),
        t3
      );
    })();
    var Ul = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return (
          ((i3 = t3.call(this) || this).tableFormattingContext = e4),
          (i3.processor = n4),
          i3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.resolveLayoutMode = function (t4) {
          var e4 = this.tableFormattingContext.getRepetitiveElements();
          return e4 && e4.doneInitialLayout
            ? (t4.sourceNode !== this.tableFormattingContext.tableSourceNode ||
                t4.after ||
                (e4 && e4.preventSkippingHeader()),
              new Gl(this.tableFormattingContext, this.processor))
            : new Vl(this.tableFormattingContext, this.processor);
        }),
        (n3.clearNodes = function (e4) {
          t3.prototype.clearNodes.call(this, e4);
          var n4 = this.tableFormattingContext.getRootViewNode(e4);
          this.processor.removeColGroups(this.tableFormattingContext, n4);
        }),
        (n3.restoreState = function (e4, n4) {
          t3.prototype.restoreState.call(this, e4, n4),
            this.tableFormattingContext.finishFragment();
        }),
        e3
      );
    })(Us);
    var Vl = (function (t3) {
      function e3(e4, n3) {
        var i3;
        return ((i3 = t3.call(this, e4) || this).processor = n3), i3;
      }
      return (
        I2(e3, t3),
        (e3.prototype.doLayout = function (t4, e4) {
          return this.processor.doInitialLayout(t4, e4);
        }),
        e3
      );
    })(gl);
    var Hl = (function (t3) {
      function e3(e4) {
        return t3.call(this, e4, null, e4.overflow, 0) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.getMinBreakPenalty = function () {
          if (!this.isEdgeUpdated)
            throw new Error(
              'EdgeBreakPosition.prototype.updateEdge not called',
            );
          return (
            (this.overflows ? 3 : 0) +
            (this.position.parent ? this.position.parent.breakPenalty : 0)
          );
        }),
        (n3.breakPositionChosen = function (t4) {
          t4.fragmentLayoutConstraints.push(new zl(this.position.sourceNode));
        }),
        e3
      );
    })(Ps);
    var zl = (function () {
      function t3(t4) {
        (this.tableRootNode = t4),
          (this.flagmentLayoutConstraintType = 'EntireTable');
      }
      var e3 = t3.prototype;
      return (
        (e3.allowLayout = function (t4, e4, n3) {
          return false;
        }),
        (e3.nextCandidate = function (t4) {
          return true;
        }),
        (e3.postLayout = function (t4, e4, n3, i3) {
          Bl.push({
            root: e4.sourceNode,
            tableLayoutOption: { calculateBreakPositionsInside: true },
          });
        }),
        (e3.finishBreak = function (t4, e4) {
          return Si(true);
        }),
        (e3.equalsTo = function (e4) {
          return e4 instanceof t3 && e4.tableRootNode === this.tableRootNode;
        }),
        (e3.getPriorityOfFinishBreak = function () {
          return 0;
        }),
        t3
      );
    })();
    var Gl = (function (t3) {
      function e3(e4, n3) {
        var i3;
        return ((i3 = t3.call(this, e4) || this).processor = n3), i3;
      }
      return (
        I2(e3, t3),
        (e3.prototype.doLayout = function (t4, e4) {
          var n3 = this.formattingContext.getRepetitiveElements();
          if (n3 && !n3.isAfterLastContent(t4)) {
            var i3 = new Wl(t4);
            e4.fragmentLayoutConstraints.some(function (t5) {
              return i3.equalsTo(t5);
            }) || e4.fragmentLayoutConstraints.unshift(i3);
          }
          return this.processor.doLayout(t4, e4);
        }),
        e3
      );
    })(ml);
    var Wl = (function (t3) {
      function e3(e4) {
        var n4;
        return (
          ((n4 = t3.call(this, e4) || this).flagmentLayoutConstraintType =
            'TableRow'),
          (n4.cellFragmentLayoutConstraints = []),
          n4
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.allowLayout = function (t4, e4, n4) {
          var i3 = this.getRepetitiveElements();
          return !(
            i3 &&
            !n4.pseudoParent &&
            !bs(this.nodeContext.viewNode) &&
            i3.isEnableToUpdateState() &&
            ((e4 && !t4) || (t4 && t4.overflow))
          );
        }),
        (n3.nextCandidate = function (e4) {
          return (
            !!this.collectCellFragmentLayoutConstraints(
              e4,
              this.nodeContext.formattingContext,
            ).some(function (t4) {
              return t4.constraints.some(function (t5) {
                return t5.nextCandidate(e4);
              });
            }) || t3.prototype.nextCandidate.call(this, e4)
          );
        }),
        (n3.postLayout = function (e4, n4, i3, r3) {
          var o3 = this.nodeContext.formattingContext;
          if (
            ((this.cellFragmentLayoutConstraints = this.collectCellFragmentLayoutConstraints(
              n4,
              o3,
            )),
            this.cellFragmentLayoutConstraints.forEach(function (t4) {
              t4.constraints.forEach(function (n5) {
                n5.postLayout(e4, t4.breakPosition, i3, r3);
              });
            }),
            !e4)
          ) {
            var a3 = o3.getRootViewNode(this.nodeContext);
            new Ml().removeColGroups(o3, a3), this.removeDummyRowNodes(i3);
          }
          t3.prototype.postLayout.call(this, e4, n4, i3, r3);
        }),
        (n3.finishBreak = function (e4, n4) {
          var i3 = this,
            r3 = bi('finishBreak'),
            o3 = this.cellFragmentLayoutConstraints.reduce(function (t4, e5) {
              return t4.concat(
                e5.constraints.map(function (t5) {
                  return { constraint: t5, breakPosition: e5.breakPosition };
                }),
              );
            }, []),
            a3 = 0;
          return (
            r3
              .loop(function () {
                if (a3 < o3.length) {
                  var t4 = o3[a3++];
                  return t4.constraint
                    .finishBreak(t4.breakPosition, n4)
                    .thenReturn(true);
                }
                return Si(false);
              })
              .then(function () {
                r3.finish(true);
              }),
            r3.result().thenAsync(function () {
              return t3.prototype.finishBreak.call(i3, e4, n4);
            })
          );
        }),
        (n3.removeDummyRowNodes = function (t4) {
          if (t4 && 'table-row' === t4.display && t4.viewNode)
            for (; t4.viewNode.previousElementSibling; ) {
              var e4 = t4.viewNode.previousElementSibling;
              e4.parentNode && e4.parentNode.removeChild(e4);
            }
        }),
        (n3.collectCellFragmentLayoutConstraints = function (t4, e4) {
          return this.getCellFragemnts(t4, e4).map(function (t5) {
            return {
              constraints: t5.fragment.pseudoColumn.getColumn()
                .fragmentLayoutConstraints,
              breakPosition: t5.breakPosition,
            };
          });
        }),
        (n3.getCellFragemnts = function (t4, e4) {
          var n4 = Number.MAX_VALUE;
          t4 &&
            'table-row' === t4.display &&
            (n4 = e4.findRowIndexBySourceNode(t4.sourceNode) + 1),
            (n4 = Math.min(e4.cellFragments.length, n4));
          for (var i3 = [], r3 = 0; r3 < n4; r3++)
            e4.cellFragments[r3] &&
              e4.cellFragments[r3].forEach(function (t5) {
                t5 &&
                  i3.push({
                    fragment: t5,
                    breakPosition: t5.findAcceptableBreakPosition().nodeContext,
                  });
              });
          return i3;
        }),
        (n3.getElementsOffsetsForTableCell = function (t4) {
          var e4 = this.nodeContext.formattingContext,
            n4 = e4.findCellFromColumn(t4);
          return n4
            ? e4.collectElementsOffsetOfUpperCells(n4)
            : e4.collectElementsOffsetOfHighestColumn();
        }),
        (n3.equalsTo = function (t4) {
          return (
            t4 instanceof e3 &&
            this.nodeContext.formattingContext ===
              t4.nodeContext.formattingContext
          );
        }),
        e3
      );
    })(yl);
    var Xl = new Ml();
    function jl(t3) {
      return (
        t3.reduce(function (t4, e3) {
          return t4 + e3;
        }, 0) / t3.length
      );
    }
    d2(exports.HOOKS.RESOLVE_FORMATTING_CONTEXT, function (
      t3,
      e3,
      n3,
      i3,
      r3,
      o3,
    ) {
      if (!e3) return null;
      if (n3 === Ye.table) {
        var a3 = t3.parent;
        return new Ll(a3 ? a3.formattingContext : null, t3.sourceNode);
      }
      return null;
    }),
      d2(exports.HOOKS.RESOLVE_LAYOUT_PROCESSOR, function (t3) {
        return t3 instanceof Ll ? Xl : null;
      });
    var Yl = function (t3, e3) {
      (this.layoutResult = t3), (this.penalty = e3);
    };
    function Kl(t3) {
      return t3.vertical ? t3.width : t3.height;
    }
    function ql(t3, e3) {
      t3.vertical ? (t3.width = e3) : (t3.height = e3);
    }
    var Ql = (function () {
      function t3(t4, e4, n3) {
        (this.layoutContainer = t4),
          (this.columnGenerator = e4),
          (this.regionPageFloatLayoutContext = n3),
          (this.originalContainerBlockSize = Kl(t4));
      }
      var e3 = t3.prototype;
      return (
        (e3.balanceColumns = function (t4) {
          var e4 = this,
            n3 = bi('ColumnBalancer#balanceColumns');
          e4.preBalance(t4),
            e4.savePageFloatLayoutContexts(t4),
            e4.layoutContainer.clear();
          var i3 = [e4.createTrialResult(t4)];
          return (
            n3
              .loopWithFrame(function (t5) {
                e4.hasNextCandidate(i3)
                  ? (e4.updateCondition(i3),
                    e4.columnGenerator().then(function (n4) {
                      e4.savePageFloatLayoutContexts(n4),
                        e4.layoutContainer.clear(),
                        n4
                          ? (i3.push(e4.createTrialResult(n4)),
                            t5.continueLoop())
                          : t5.breakLoop();
                    }))
                  : t5.breakLoop();
              })
              .then(function () {
                var t5 = i3.reduce(function (t6, e5) {
                  return e5.penalty < t6.penalty ? e5 : t6;
                }, i3[0]);
                e4.restoreContents(t5.layoutResult),
                  e4.postBalance(),
                  n3.finish(t5.layoutResult);
              }),
            n3.result()
          );
        }),
        (e3.createTrialResult = function (t4) {
          var e4 = this.calculatePenalty(t4);
          return new Yl(t4, e4);
        }),
        (e3.preBalance = function (t4) {}),
        (e3.postBalance = function () {
          ql(this.layoutContainer, this.originalContainerBlockSize);
        }),
        (e3.savePageFloatLayoutContexts = function (t4) {
          var e4 = this.regionPageFloatLayoutContext.detachChildren();
          t4 && (t4.columnPageFloatLayoutContexts = e4);
        }),
        (e3.restoreContents = function (t4) {
          var e4 = this.layoutContainer.element;
          t4.columns.forEach(function (t5) {
            e4.appendChild(t5.element);
          }),
            this.regionPageFloatLayoutContext.attachChildren(
              t4.columnPageFloatLayoutContexts,
            );
        }),
        t3
      );
    })();
    function Zl(t3) {
      var e3 = t3[t3.length - 1];
      if (0 === e3.penalty) return false;
      var n3 = t3[t3.length - 2];
      if (n3 && e3.penalty >= n3.penalty) return false;
      var i3 = e3.layoutResult.columns;
      return (
        Math.max.apply(
          null,
          i3.map(function (t4) {
            return t4.computedBlockSize;
          }),
        ) >
        Math.max.apply(
          null,
          i3.map(function (t4) {
            return t4.getMaxBlockSizeOfPageFloats();
          }),
        ) +
          1
      );
    }
    function $l(t3, e3) {
      var n3 =
        Math.max.apply(
          null,
          t3[t3.length - 1].layoutResult.columns.map(function (t4) {
            return isNaN(t4.blockDistanceToBlockEndFloats)
              ? t4.computedBlockSize
              : t4.computedBlockSize - t4.blockDistanceToBlockEndFloats + 1;
          }),
        ) - 1;
      n3 < Kl(e3) ? ql(e3, n3) : ql(e3, Kl(e3) - 1);
    }
    var Jl = (function (t3) {
      function e3(e4, n4, i3, r3) {
        var o3;
        return (
          ((o3 = t3.call(this, i3, e4, n4) || this).columnCount = r3),
          (o3.originalPosition = null),
          (o3.foundUpperBound = false),
          o3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.preBalance = function (t4) {
          var e4 = t4.columns.reduce(function (t5, e5) {
            return t5 + e5.computedBlockSize;
          }, 0);
          ql(this.layoutContainer, e4 / this.columnCount),
            (this.originalPosition = t4.position);
        }),
        (n3.checkPosition = function (t4) {
          return this.originalPosition
            ? this.originalPosition.isSamePosition(t4)
            : null === t4;
        }),
        (n3.calculatePenalty = function (t4) {
          if (!this.checkPosition(t4.position)) return Infinity;
          var e4 = t4.columns;
          return tu(e4)
            ? Infinity
            : Math.max.apply(
                null,
                e4.map(function (t5) {
                  return t5.computedBlockSize;
                }),
              );
        }),
        (n3.hasNextCandidate = function (t4) {
          if (1 === t4.length) return true;
          if (this.foundUpperBound) return Zl(t4);
          var e4 = t4[t4.length - 1];
          return this.checkPosition(e4.layoutResult.position) &&
            !tu(e4.layoutResult.columns)
            ? ((this.foundUpperBound = true), true)
            : Kl(this.layoutContainer) < this.originalContainerBlockSize;
        }),
        (n3.updateCondition = function (t4) {
          if (this.foundUpperBound) $l(t4, this.layoutContainer);
          else {
            var e4 = Math.min(
              this.originalContainerBlockSize,
              Kl(this.layoutContainer) + 0.1 * this.originalContainerBlockSize,
            );
            ql(this.layoutContainer, e4);
          }
        }),
        e3
      );
    })(Ql);
    function tu(t3) {
      if (t3.length <= 1) return false;
      var e3 = t3[t3.length - 1].computedBlockSize;
      return t3.slice(0, t3.length - 1).every(function (t4) {
        return e3 > t4.computedBlockSize;
      });
    }
    var eu;
    var nu = (function (t3) {
      function e3(e4, n4, i3) {
        return t3.call(this, i3, e4, n4) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.calculatePenalty = function (t4) {
          if (
            t4.columns.every(function (t5) {
              return 0 === t5.computedBlockSize;
            })
          )
            return Infinity;
          var e4,
            n4,
            i3 = t4.columns
              .filter(function (t5) {
                return !t5.pageBreakType;
              })
              .map(function (t5) {
                return t5.computedBlockSize;
              });
          return (
            (n4 = jl((e4 = i3))),
            jl(
              e4.map(function (t5) {
                var e5 = t5 - n4;
                return e5 * e5;
              }),
            )
          );
        }),
        (n3.hasNextCandidate = function (t4) {
          return Zl(t4);
        }),
        (n3.updateCondition = function (t4) {
          $l(t4, this.layoutContainer);
        }),
        e3
      );
    })(Ql);
    var iu = function (t3, e3, n3) {
      (this.endStuckFixed = t3), (this.endFixed = e3), (this.endSlipped = n3);
    };
    var ru = (function () {
      function t3() {
        this.map = [];
      }
      var e3 = t3.prototype;
      return (
        (e3.getMaxFixed = function () {
          return 0 == this.map.length
            ? 0
            : this.map[this.map.length - 1].endFixed;
        }),
        (e3.getMaxSlipped = function () {
          return 0 == this.map.length
            ? 0
            : this.map[this.map.length - 1].endSlipped;
        }),
        (e3.addStuckRange = function (t4) {
          if (0 == this.map.length) this.map.push(new iu(t4, t4, t4));
          else {
            var e4 = this.map[this.map.length - 1],
              n3 = e4.endSlipped + t4 - e4.endFixed;
            e4.endFixed == e4.endStuckFixed
              ? ((e4.endFixed = t4),
                (e4.endStuckFixed = t4),
                (e4.endSlipped = n3))
              : this.map.push(new iu(t4, t4, n3));
          }
        }),
        (e3.addSlippedRange = function (t4) {
          0 == this.map.length
            ? this.map.push(new iu(t4, 0, 0))
            : (this.map[this.map.length - 1].endFixed = t4);
        }),
        (e3.slippedByFixed = function (t4) {
          var e4 = this,
            n3 = ut(this.map.length, function (n4) {
              return t4 <= e4.map[n4].endFixed;
            }),
            i3 = this.map[n3];
          return i3.endSlipped - Math.max(0, i3.endStuckFixed - t4);
        }),
        (e3.fixedBySlipped = function (t4) {
          var e4 = this,
            n3 = ut(this.map.length, function (n4) {
              return t4 <= e4.map[n4].endSlipped;
            }),
            i3 = this.map[n3];
          return i3.endStuckFixed - (i3.endSlipped - t4);
        }),
        t3
      );
    })();
    var ou = (function () {
      function t3(e4, n3, i3, r3, o3, a3, s3, l3) {
        if (
          ((this.context = e4),
          (this.style = n3),
          (this.offset = i3),
          (this.isRoot = r3),
          (this.flowChunk = o3),
          (this.atBlockStart = a3),
          (this.atFlowStart = s3),
          (this.isParentBoxDisplayed = l3),
          (this.isBlockValue = null),
          (this.hasBoxValue = null),
          (this.styleValues = {}),
          (this.beforeBox = null),
          (this.afterBox = null),
          (this.breakBefore = null),
          (this.flowName = o3.flowName),
          this.hasBox())
        ) {
          var u3 = n3._pseudos;
          if (u3 && u3.before) {
            var h3 = new t3(
              e4,
              u3.before,
              i3,
              false,
              o3,
              this.isBlock(),
              s3,
              true,
            );
            Ja(h3.styleValue('content')) &&
              ((this.beforeBox = h3), (this.breakBefore = h3.breakBefore));
          }
        }
        (this.breakBefore = vs(this.getBreakValue('before'), this.breakBefore)),
          this.atFlowStart &&
            ps(this.breakBefore) &&
            (o3.breakBefore = vs(o3.breakBefore, this.breakBefore));
      }
      var e3 = t3.prototype;
      return (
        (e3.buildAfterPseudoElementBox = function (e4, n3, i3) {
          if (this.hasBox()) {
            var r3 = this.style._pseudos;
            if (r3 && r3.after) {
              var o3 = new t3(
                this.context,
                r3.after,
                e4,
                false,
                this.flowChunk,
                n3,
                i3,
                true,
              );
              Ja(o3.styleValue('content')) && (this.afterBox = o3);
            }
          }
        }),
        (e3.styleValue = function (t4, e4) {
          if (!(t4 in this.styleValues)) {
            var n3 = this.style[t4];
            this.styleValues[t4] = n3
              ? n3.evaluate(this.context, t4)
              : e4 || null;
          }
          return this.styleValues[t4];
        }),
        (e3.displayValue = function () {
          return this.styleValue('display', Ye.inline);
        }),
        (e3.isBlock = function () {
          if (null === this.isBlockValue) {
            var t4 = this.displayValue(),
              e4 = this.styleValue('position'),
              n3 = this.styleValue('float');
            this.isBlockValue = Os(t4, e4, n3, this.isRoot);
          }
          return this.isBlockValue;
        }),
        (e3.hasBox = function () {
          return (
            null === this.hasBoxValue &&
              (this.hasBoxValue =
                this.isParentBoxDisplayed && this.displayValue() !== Ye.none),
            this.hasBoxValue
          );
        }),
        (e3.getBreakValue = function (t4) {
          var e4 = null;
          if (this.isBlock()) {
            var n3 = this.styleValue('break-' + t4);
            n3 && (e4 = n3.toString());
          }
          return e4;
        }),
        t3
      );
    })();
    var au = (function () {
      function t3(t4) {
        (this.context = t4),
          (this.stack = []),
          (this.atBlockStart = true),
          (this.atFlowStart = true),
          (this.atStartStack = []);
      }
      var e3 = t3.prototype;
      return (
        (e3.empty = function () {
          return 0 === this.stack.length;
        }),
        (e3.lastBox = function () {
          return this.stack[this.stack.length - 1];
        }),
        (e3.lastFlowName = function () {
          var t4 = this.lastBox();
          return t4 ? t4.flowChunk.flowName : null;
        }),
        (e3.isCurrentBoxDisplayed = function () {
          return this.stack.every(function (t4) {
            return t4.displayValue() !== Ye.none;
          });
        }),
        (e3.push = function (t4, e4, n3, i3) {
          var r3 = this.lastBox();
          i3 &&
            r3 &&
            i3.flowName !== r3.flowName &&
            this.atStartStack.push({
              atBlockStart: this.atBlockStart,
              atFlowStart: this.atFlowStart,
            });
          var o3 = i3 || r3.flowChunk,
            a3 = this.atFlowStart || !!i3,
            s3 = this.isCurrentBoxDisplayed(),
            l3 = new ou(
              this.context,
              t4,
              e4,
              n3,
              o3,
              a3 || this.atBlockStart,
              a3,
              s3,
            );
          return (
            this.stack.push(l3),
            (this.atBlockStart = l3.hasBox()
              ? !l3.beforeBox && l3.isBlock()
              : this.atBlockStart),
            (this.atFlowStart = l3.hasBox()
              ? !l3.beforeBox && a3
              : this.atFlowStart),
            l3
          );
        }),
        (e3.encounteredTextNode = function (t4) {
          var e4 = this.lastBox();
          (this.atBlockStart || this.atFlowStart) &&
            e4.hasBox() &&
            (ka(t4, Oa(e4.styleValue('white-space', Ye.normal).toString())) ||
              ((this.atBlockStart = false), (this.atFlowStart = false)));
        }),
        (e3.pop = function (t4) {
          var e4 = this.stack.pop();
          if (
            (e4.buildAfterPseudoElementBox(
              t4,
              this.atBlockStart,
              this.atFlowStart,
            ),
            this.atFlowStart && e4.afterBox)
          ) {
            var n3 = e4.afterBox.getBreakValue('before');
            e4.flowChunk.breakBefore = vs(e4.flowChunk.breakBefore, n3);
          }
          var i3 = this.lastBox();
          if (i3)
            if (i3.flowName === e4.flowName)
              e4.hasBox() && (this.atBlockStart = this.atFlowStart = false);
            else {
              var r3 = this.atStartStack.pop();
              (this.atBlockStart = r3.atBlockStart),
                (this.atFlowStart = r3.atFlowStart);
            }
          return e4;
        }),
        (e3.nearestBlockStartOffset = function (t4) {
          if (!t4.atBlockStart) return t4.offset;
          var e4 = this.stack.length - 1,
            n3 = this.stack[e4];
          for (n3 === t4 && (e4--, (n3 = this.stack[e4])); e4 >= 0; ) {
            if (n3.flowName !== t4.flowName) return t4.offset;
            if (!n3.atBlockStart) return n3.offset;
            if (n3.isRoot) return n3.offset;
            (t4 = n3), (n3 = this.stack[--e4]);
          }
          throw new Error('No block start offset found!');
        }),
        t3
      );
    })();
    var su = (function () {
      function t3(t4, e4, n3, i3, r3, o3, a3, s3) {
        (this.xmldoc = t4),
          (this.scope = n3),
          (this.context = i3),
          (this.primaryFlows = r3),
          (this.validatorSet = o3),
          (this.counterListener = a3),
          (this.rootStyle = {}),
          (this.styleMap = {}),
          (this.flows = {}),
          (this.flowChunks = []),
          (this.flowListener = null),
          (this.flowToReach = null),
          (this.idToReach = null),
          (this.primary = true),
          (this.primaryStack = []),
          (this.rootBackgroundAssigned = false),
          (this.rootLayoutAssigned = false),
          (this.breakBeforeValues = {}),
          (this.bodyReached = true),
          (this.root = t4.root),
          (this.cascadeHolder = e4),
          (this.last = this.root),
          (this.cascade = e4.createInstance(i3, a3, s3, t4.lang)),
          (this.offsetMap = new ru());
        var l3 = t4.getElementOffset(this.root);
        (this.lastOffset = l3),
          (this.boxStack = new au(i3)),
          this.offsetMap.addStuckRange(l3);
        var u3 = this.getAttrStyle(this.root);
        switch (
          (this.cascade.pushElement(this.root, u3, l3),
          this.postprocessTopStyle(u3, false),
          this.root.namespaceURI)
        ) {
          case H2.XHTML:
          case H2.FB2:
            this.bodyReached = false;
        }
        this.primaryStack.push(true),
          (this.styleMap = {}),
          (this.styleMap['e' + l3] = u3),
          this.lastOffset++,
          this.replayFlowElementsFromOffset(-1);
      }
      var e3 = t3.prototype;
      return (
        (e3.hasProp = function (t4, e4, n3) {
          var i3 = t4[n3];
          return i3 && i3.evaluate(this.context) !== e4[n3];
        }),
        (e3.transferPropsToRoot = function (t4, e4) {
          for (var n3 in e4) {
            var i3 = t4[n3];
            if (i3) (this.rootStyle[n3] = i3), delete t4[n3];
            else {
              var r3 = e4[n3];
              r3 && (this.rootStyle[n3] = new kr(r3, 33554432));
            }
          }
        }),
        (e3.postprocessTopStyle = function (t4, e4) {
          var n3 = this;
          if (
            (['writing-mode', 'direction'].forEach(function (i4) {
              !t4[i4] ||
                (e4 && n3.rootStyle[i4]) ||
                (n3.rootStyle[i4] = t4[i4]);
            }),
            !this.rootBackgroundAssigned)
          ) {
            var i3 = this.hasProp(
                t4,
                this.validatorSet.backgroundProps,
                'background-color',
              )
                ? t4['background-color'].evaluate(this.context)
                : null,
              r3 = this.hasProp(
                t4,
                this.validatorSet.backgroundProps,
                'background-image',
              )
                ? t4['background-image'].evaluate(this.context)
                : null;
            ((i3 && i3 !== Ye.inherit) || (r3 && r3 !== Ye.inherit)) &&
              (this.transferPropsToRoot(t4, this.validatorSet.backgroundProps),
              (this.rootBackgroundAssigned = true));
          }
          if (!this.rootLayoutAssigned) {
            for (var o3 = 0; o3 < lu.length; o3++)
              if (this.hasProp(t4, this.validatorSet.layoutProps, lu[o3])) {
                this.transferPropsToRoot(t4, this.validatorSet.layoutProps),
                  (this.rootLayoutAssigned = true);
                break;
              }
          }
          if (!e4) {
            var a3 = t4['font-size'];
            if (a3) {
              var s3 = a3.evaluate(this.context),
                l3 = s3.num;
              switch (s3.unit) {
                case 'em':
                case 'rem':
                  l3 *= this.context.initialFontSize;
                  break;
                case 'ex':
                  l3 *= (this.context.initialFontSize * Ut.ex) / Ut.em;
                  break;
                case '%':
                  l3 *= this.context.initialFontSize / 100;
                  break;
                default:
                  var u3 = Ut[s3.unit];
                  u3 && (l3 *= u3);
              }
              this.context.rootFontSize = l3;
            }
          }
        }),
        (e3.getTopContainerStyle = function () {
          for (
            var t4 = 0;
            !this.bodyReached &&
            this.styleUntil((t4 += 5e3), 0) != Number.POSITIVE_INFINITY;

          );
          return this.rootStyle;
        }),
        (e3.getAttrStyle = function (t4) {
          if (t4.style instanceof CSSStyleDeclaration) {
            var e4 = t4.getAttribute('style');
            if (e4)
              return (function (t5, e5, n3, i3) {
                var r3 = new ea(t5, e5),
                  o3 = new Ei(i3, r3);
                try {
                  !(function (t6, e6, n4) {
                    new ur(qi, t6, e6, n4).runParser(
                      Number.POSITIVE_INFINITY,
                      false,
                      true,
                      false,
                      false,
                    );
                  })(o3, r3, n3);
                } catch (t6) {
                  c2.warn(t6, 'Style attribute parse error:');
                }
                return r3.elementStyle;
              })(this.scope, this.validatorSet, this.xmldoc.url, e4);
          }
          return {};
        }),
        (e3.getReachedOffset = function () {
          return this.lastOffset;
        }),
        (e3.replayFlowElementsFromOffset = function (t4) {
          if (!(t4 >= this.lastOffset)) {
            var e4 = this.context,
              n3 = this.xmldoc.getElementOffset(this.root);
            if (t4 < n3) {
              var i3 = this.getStyle(this.root, false),
                r3 = Vr(i3, 'flow-into'),
                o3 = r3 ? r3.evaluate(e4, 'flow-into').toString() : 'body',
                a3 = this.encounteredFlowElement(o3, i3, this.root, n3);
              this.boxStack.empty() && this.boxStack.push(i3, n3, true, a3);
            }
            var s3 = this.xmldoc.getNodeByOffset(t4),
              l3 = this.xmldoc.getNodeOffset(s3, 0, false);
            if (!(l3 >= this.lastOffset))
              for (;;) {
                if (1 != s3.nodeType) l3 += s3.textContent.length;
                else {
                  var u3 = s3,
                    h3 = this.getStyle(u3, false),
                    c3 = h3['flow-into'];
                  if (c3) {
                    var f3 = c3.evaluate(e4, 'flow-into').toString();
                    this.encounteredFlowElement(f3, h3, u3, l3);
                  }
                  l3++;
                }
                if (l3 >= this.lastOffset) break;
                var d3 = s3.firstChild;
                if (null == d3) {
                  for (; !(d3 = s3.nextSibling); )
                    if ((s3 = s3.parentNode) === this.root) return;
                }
                s3 = d3;
              }
          }
        }),
        (e3.resetFlowChunkStream = function (t4) {
          this.flowListener = t4;
          for (var e4 = 0; e4 < this.flowChunks.length; e4++)
            this.flowListener.encounteredFlowChunk(
              this.flowChunks[e4],
              this.flows[this.flowChunks[e4].flowName],
            );
        }),
        (e3.styleUntilFlowIsReached = function (t4) {
          this.flowToReach = t4;
          for (
            var e4 = 0;
            null != this.flowToReach &&
            this.styleUntil((e4 += 5e3), 0) != Number.POSITIVE_INFINITY;

          );
        }),
        (e3.styleUntilIdIsReached = function (t4) {
          if (t4) {
            this.idToReach = t4;
            for (
              var e4 = 0;
              this.idToReach &&
              this.styleUntil((e4 += 5e3), 0) !== Number.POSITIVE_INFINITY;

            );
            this.idToReach = null;
          }
        }),
        (e3.encounteredFlowElement = function (t4, e4, n3, i3) {
          var r3 = 0,
            o3 = Number.POSITIVE_INFINITY,
            a3 = false,
            s3 = false,
            l3 = false,
            u3 = e4['flow-options'];
          if (u3) {
            var h3 = (function (t5) {
              if (t5) {
                var e5 = new bn();
                try {
                  return t5.visit(e5), e5.propSet;
                } catch (t6) {
                  c2.warn(t6, 'toSet:');
                }
              }
              return {};
            })(u3.evaluate(this.context, 'flow-options'));
            (a3 = !!h3.exclusive), (s3 = !!h3.static), (l3 = !!h3.last);
          }
          var f3 = e4['flow-linger'];
          f3 &&
            (o3 = Cn(
              f3.evaluate(this.context, 'flow-linger'),
              Number.POSITIVE_INFINITY,
            ));
          var d3 = e4['flow-priority'];
          d3 && (r3 = Cn(d3.evaluate(this.context, 'flow-priority'), 0));
          var p3 = this.breakBeforeValues[i3] || null,
            g3 = this.flows[t4];
          if (!g3) {
            var m3 = this.boxStack.lastFlowName();
            g3 = this.flows[t4] = new Fa(t4, m3);
          }
          var v3 = new Da(t4, n3, i3, r3, o3, a3, s3, l3, p3);
          return (
            this.flowChunks.push(v3),
            this.flowToReach == t4 && (this.flowToReach = null),
            this.flowListener && this.flowListener.encounteredFlowChunk(v3, g3),
            v3
          );
        }),
        (e3.registerForcedBreakOffset = function (t4, e4, n3) {
          if (ps(t4)) {
            var i3 = this.flows[n3].forcedBreakOffsets;
            (0 === i3.length || i3[i3.length - 1] < e4) && i3.push(e4);
          }
          this.breakBeforeValues[e4] = vs(this.breakBeforeValues[e4], t4);
        }),
        (e3.styleUntil = function (t4, e4) {
          var n3 = -1;
          if (
            t4 <= this.lastOffset &&
            (n3 = this.offsetMap.slippedByFixed(t4) + e4) <
              this.offsetMap.getMaxSlipped()
          )
            return this.offsetMap.fixedBySlipped(n3);
          if (null == this.last) return Number.POSITIVE_INFINITY;
          for (var i3 = this.context; ; ) {
            var r3 = this.last.firstChild;
            if (null == r3)
              for (;;) {
                if (1 == this.last.nodeType) {
                  this.cascade.popElement(this.last),
                    (this.primary = this.primaryStack.pop());
                  var o3 = this.boxStack.pop(this.lastOffset),
                    a3 = null;
                  if (o3.afterBox) {
                    var s3 = o3.afterBox.getBreakValue('before');
                    this.registerForcedBreakOffset(
                      s3,
                      o3.afterBox.atBlockStart
                        ? this.boxStack.nearestBlockStartOffset(o3)
                        : o3.afterBox.offset,
                      o3.flowName,
                    ),
                      (a3 = o3.afterBox.getBreakValue('after'));
                  }
                  (a3 = vs(a3, o3.getBreakValue('after'))),
                    this.registerForcedBreakOffset(
                      a3,
                      this.lastOffset,
                      o3.flowName,
                    );
                }
                if ((r3 = this.last.nextSibling)) break;
                if (
                  ((this.last = this.last.parentNode), this.last === this.root)
                )
                  return (
                    (this.last = null),
                    t4 < this.lastOffset &&
                    (n3 < 0 && (n3 = this.offsetMap.slippedByFixed(t4) + e4),
                    n3 <= this.offsetMap.getMaxSlipped())
                      ? this.offsetMap.fixedBySlipped(n3)
                      : Number.POSITIVE_INFINITY
                  );
              }
            if (((this.last = r3), 1 != this.last.nodeType))
              (this.lastOffset += this.last.textContent.length),
                this.boxStack.encounteredTextNode(this.last),
                this.primary
                  ? this.offsetMap.addStuckRange(this.lastOffset)
                  : this.offsetMap.addSlippedRange(this.lastOffset);
            else {
              var l3 = this.last,
                u3 = this.getAttrStyle(l3);
              this.primaryStack.push(this.primary),
                this.cascade.pushElement(l3, u3, this.lastOffset);
              var h3 = l3.getAttribute('id') || l3.getAttributeNS(H2.XML, 'id');
              h3 && h3 === this.idToReach && (this.idToReach = null),
                this.bodyReached ||
                  'body' != l3.localName ||
                  l3.parentNode != this.root ||
                  (this.postprocessTopStyle(u3, true),
                  (this.bodyReached = true));
              var c3 = void 0,
                f3 = u3['flow-into'];
              if (f3) {
                var d3 = f3.evaluate(i3, 'flow-into').toString(),
                  p3 = this.encounteredFlowElement(d3, u3, l3, this.lastOffset);
                (this.primary = !!this.primaryFlows[d3]),
                  (c3 = this.boxStack.push(
                    u3,
                    this.lastOffset,
                    l3 === this.root,
                    p3,
                  ));
              } else
                c3 = this.boxStack.push(u3, this.lastOffset, l3 === this.root);
              var g3 = this.boxStack.nearestBlockStartOffset(c3);
              if (
                (this.registerForcedBreakOffset(
                  c3.breakBefore,
                  g3,
                  c3.flowName,
                ),
                c3.beforeBox)
              ) {
                var m3 = c3.beforeBox.getBreakValue('after');
                this.registerForcedBreakOffset(
                  m3,
                  c3.beforeBox.atBlockStart ? g3 : c3.offset,
                  c3.flowName,
                );
              }
              if (
                (this.primary &&
                  c3.displayValue() === Ye.none &&
                  (this.primary = false),
                (this.styleMap['e' + this.lastOffset] = u3),
                this.lastOffset++,
                this.primary
                  ? this.offsetMap.addStuckRange(this.lastOffset)
                  : this.offsetMap.addSlippedRange(this.lastOffset),
                t4 < this.lastOffset &&
                  (n3 < 0 && (n3 = this.offsetMap.slippedByFixed(t4) + e4),
                  n3 <= this.offsetMap.getMaxSlipped()))
              )
                return this.offsetMap.fixedBySlipped(n3);
            }
          }
        }),
        (e3.getStyle = function (t4, e4) {
          var n3 = this.xmldoc.getElementOffset(t4),
            i3 = 'e' + n3;
          return (
            e4 && (n3 = this.xmldoc.getNodeOffset(t4, 0, true)),
            this.lastOffset <= n3 && this.styleUntil(n3, 0),
            this.styleMap[i3]
          );
        }),
        (e3.processContent = function (t4, e4) {}),
        t3
      );
    })();
    var lu = ['column-count', 'column-width', 'column-fill'];
    var uu = (function () {
      function t3(t4) {
        (this.validator = t4),
          (this.success = null),
          (this.failure = null),
          (this.code = 0);
      }
      var e3 = t3.prototype;
      return (
        (e3.isSpecial = function () {
          return 0 != this.code;
        }),
        (e3.markAsStartGroup = function () {
          this.code = -1;
        }),
        (e3.isStartGroup = function () {
          return -1 == this.code;
        }),
        (e3.markAsEndGroup = function () {
          this.code = -2;
        }),
        (e3.isEndGroup = function () {
          return -2 == this.code;
        }),
        (e3.markAsStartAlternate = function (t4) {
          this.code = 2 * t4 + 1;
        }),
        (e3.isStartAlternate = function () {
          return this.code > 0 && this.code % 2 != 0;
        }),
        (e3.markAsEndAlternate = function (t4) {
          this.code = 2 * t4 + 2;
        }),
        (e3.isEndAlternate = function () {
          return this.code > 0 && this.code % 2 == 0;
        }),
        (e3.getAlternate = function () {
          return Math.floor((this.code - 1) / 2);
        }),
        t3
      );
    })();
    var hu = function (t3, e3) {
      (this.where = t3), (this.success = e3), (this.what = -1);
    };
    !(function (t3) {
      (t3[(t3.FOLLOW = 1)] = 'FOLLOW'),
        (t3[(t3.OPTIONAL = 2)] = 'OPTIONAL'),
        (t3[(t3.REPEATED = 3)] = 'REPEATED'),
        (t3[(t3.ALTERNATE = 4)] = 'ALTERNATE');
    })(eu || (eu = {}));
    var cu = (function () {
      function t3() {
        (this.nodes = []),
          (this.connections = []),
          (this.match = []),
          (this.nomatch = []),
          (this.error = []),
          (this.emptyHead = true);
      }
      var e3 = t3.prototype;
      return (
        (e3.connect = function (t4, e4) {
          for (var n3 = 0; n3 < t4.length; n3++)
            this.connections[t4[n3]].what = e4;
          t4.splice(0, t4.length);
        }),
        (e3.clone = function () {
          for (
            var e4, n3, i3, r3 = new t3(), o3 = 0;
            o3 < this.nodes.length;
            o3++
          ) {
            var a3 = this.nodes[o3],
              s3 = new uu(a3.validator);
            (s3.code = a3.code), r3.nodes.push(s3);
          }
          for (var l3 = 0; l3 < this.connections.length; l3++) {
            var u3 = this.connections[l3],
              h3 = new hu(u3.where, u3.success);
            (h3.what = u3.what), r3.connections.push(h3);
          }
          return (
            (e4 = r3.match).push.apply(e4, this.match),
            (n3 = r3.nomatch).push.apply(n3, this.nomatch),
            (i3 = r3.error).push.apply(i3, this.error),
            r3
          );
        }),
        (e3.addSpecialToArr = function (t4, e4, n3) {
          var i3 = this.nodes.length,
            r3 = new uu(gu);
          n3 >= 0
            ? e4
              ? r3.markAsStartAlternate(n3)
              : r3.markAsEndAlternate(n3)
            : e4
            ? r3.markAsStartGroup()
            : r3.markAsEndGroup(),
            this.nodes.push(r3),
            this.connect(t4, i3);
          var o3 = new hu(i3, true),
            a3 = new hu(i3, false);
          t4.push(this.connections.length),
            this.connections.push(a3),
            t4.push(this.connections.length),
            this.connections.push(o3);
        }),
        (e3.endSpecialGroup = function () {
          for (
            var t4 = [this.match, this.nomatch, this.error], e4 = 0;
            e4 < t4.length;
            e4++
          )
            this.addSpecialToArr(t4[e4], false, -1);
        }),
        (e3.startSpecialGroup = function () {
          if (this.nodes.length) throw new Error('invalid call');
          this.addSpecialToArr(this.match, true, -1);
        }),
        (e3.endClause = function (t4) {
          this.addSpecialToArr(this.match, false, t4);
        }),
        (e3.startClause = function (t4) {
          if (this.nodes.length) throw new Error('invalid call');
          var e4 = new uu(gu);
          e4.markAsStartAlternate(t4), this.nodes.push(e4);
          var n3 = new hu(0, true),
            i3 = new hu(0, false);
          this.nomatch.push(this.connections.length),
            this.connections.push(i3),
            this.match.push(this.connections.length),
            this.connections.push(n3);
        }),
        (e3.addPrimitive = function (t4) {
          var e4 = this.nodes.length;
          this.nodes.push(new uu(t4));
          var n3 = new hu(e4, true),
            i3 = new hu(e4, false);
          this.connect(this.match, e4),
            this.emptyHead
              ? (this.nomatch.push(this.connections.length),
                (this.emptyHead = false))
              : this.error.push(this.connections.length),
            this.connections.push(i3),
            this.match.push(this.connections.length),
            this.connections.push(n3);
        }),
        (e3.isSimple = function () {
          return 1 == this.nodes.length && !this.nodes[0].isSpecial();
        }),
        (e3.isPrimitive = function () {
          return this.isSimple() && this.nodes[0].validator instanceof du;
        }),
        (e3.addGroup = function (t4, e4) {
          if (0 != t4.nodes.length) {
            var n3 = this.nodes.length;
            if (
              e4 == eu.ALTERNATE &&
              1 == n3 &&
              t4.isPrimitive() &&
              this.isPrimitive()
            )
              this.nodes[0].validator = this.nodes[0].validator.combine(
                t4.nodes[0].validator,
              );
            else {
              for (var i3 = 0; i3 < t4.nodes.length; i3++)
                this.nodes.push(t4.nodes[i3]);
              e4 == eu.ALTERNATE
                ? ((this.emptyHead = true), this.connect(this.nomatch, n3))
                : this.connect(this.match, n3);
              for (
                var r3 = this.connections.length, o3 = 0;
                o3 < t4.connections.length;
                o3++
              ) {
                var a3 = t4.connections[o3];
                (a3.where += n3),
                  a3.what >= 0 && (a3.what += n3),
                  this.connections.push(a3);
              }
              for (var s3 = 0; s3 < t4.match.length; s3++)
                this.match.push(t4.match[s3] + r3);
              if (
                (e4 == eu.REPEATED && this.connect(this.match, n3),
                e4 == eu.OPTIONAL || e4 == eu.REPEATED)
              )
                for (var l3 = 0; l3 < t4.nomatch.length; l3++)
                  this.match.push(t4.nomatch[l3] + r3);
              else if (this.emptyHead) {
                for (var u3 = 0; u3 < t4.nomatch.length; u3++)
                  this.nomatch.push(t4.nomatch[u3] + r3);
                this.emptyHead = t4.emptyHead;
              } else
                for (var h3 = 0; h3 < t4.nomatch.length; h3++)
                  this.error.push(t4.nomatch[h3] + r3);
              for (var c3 = 0; c3 < t4.error.length; c3++)
                this.error.push(t4.error[c3] + r3);
              (t4.nodes = null), (t4.connections = null);
            }
          }
        }),
        (e3.finish = function (t4, e4) {
          var n3 = this.nodes.length;
          this.nodes.push(t4),
            this.nodes.push(e4),
            this.connect(this.match, n3),
            this.connect(this.nomatch, n3 + 1),
            this.connect(this.error, n3 + 1);
          for (var i3, r3 = D(this.connections); !(i3 = r3()).done; ) {
            var o3 = i3.value;
            o3.success
              ? (this.nodes[o3.where].success = this.nodes[o3.what])
              : (this.nodes[o3.where].failure = this.nodes[o3.what]);
          }
          for (var a3 = 0; a3 < n3; a3++)
            if (
              null == this.nodes[a3].failure ||
              null == this.nodes[a3].success
            )
              throw new Error('Invalid validator state');
          return this.nodes[0];
        }),
        t3
      );
    })();
    var fu = (function (t3) {
      function e3() {
        return t3.call(this) || this;
      }
      return (
        I2(e3, t3),
        (e3.prototype.validateForShorthand = function (t4, e4) {
          var n3 = t4[e4].visit(this);
          return n3 ? [n3] : null;
        }),
        e3
      );
    })(xe);
    var du = (function (t3) {
      function e3(e4, n4, i3) {
        var r3;
        return (
          ((r3 = t3.call(this) || this).allowed = e4),
          (r3.idents = n4),
          (r3.units = i3),
          r3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.visitEmpty = function (t4) {
          return 1 & this.allowed ? t4 : null;
        }),
        (n3.visitSlash = function (t4) {
          return 2048 & this.allowed ? t4 : null;
        }),
        (n3.visitStr = function (t4) {
          return 2 & this.allowed ? t4 : null;
        }),
        (n3.visitIdent = function (t4) {
          return (
            this.idents[t4.name.toLowerCase()] || (4 & this.allowed ? t4 : null)
          );
        }),
        (n3.visitNumeric = function (t4) {
          return 0 != t4.num || 512 & this.allowed
            ? t4.num < 0 && !(256 & this.allowed)
              ? null
              : this.units[t4.unit]
              ? t4
              : null
            : '%' == t4.unit && 1024 & this.allowed
            ? t4
            : null;
        }),
        (n3.visitNum = function (t4) {
          return 0 == t4.num
            ? 512 & this.allowed
              ? t4
              : null
            : t4.num <= 0 && !(256 & this.allowed)
            ? null
            : 16 & this.allowed
            ? t4
            : null;
        }),
        (n3.visitInt = function (t4) {
          return 0 == t4.num
            ? 512 & this.allowed
              ? t4
              : null
            : t4.num <= 0 && !(256 & this.allowed)
            ? null
            : 48 & this.allowed
            ? t4
            : this.idents['' + t4.num] || null;
        }),
        (n3.visitColor = function (t4) {
          return 64 & this.allowed ? t4 : null;
        }),
        (n3.visitURL = function (t4) {
          return 128 & this.allowed ? t4 : null;
        }),
        (n3.visitSpaceList = function (t4) {
          return null;
        }),
        (n3.visitCommaList = function (t4) {
          return null;
        }),
        (n3.visitFunc = function (t4) {
          return null;
        }),
        (n3.visitExpr = function (t4) {
          return 2046 & this.allowed ? t4 : null;
        }),
        (n3.combine = function (t4) {
          var n4 = {},
            i3 = {};
          for (var r3 in this.idents) n4[r3] = this.idents[r3];
          for (var o3 in t4.idents) n4[o3] = t4.idents[o3];
          for (var a3 in this.units) i3[a3] = this.units[a3];
          for (var s3 in t4.units) i3[s3] = t4.units[s3];
          return new e3(this.allowed | t4.allowed, n4, i3);
        }),
        e3
      );
    })(fu);
    var pu = {};
    var gu = new du(0, pu, pu);
    var mu = (function (t3) {
      function e3(e4) {
        var n4;
        return (
          ((n4 = t3.call(this) || this).successTerminal = new uu(null)),
          (n4.failureTerminal = new uu(null)),
          (n4.first = e4.finish(n4.successTerminal, n4.failureTerminal)),
          n4
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.validateList = function (t4, e4, n4) {
          for (
            var i3 = e4 ? [] : t4,
              r3 = this.first,
              o3 = n4,
              a3 = null,
              s3 = null;
            r3 !== this.successTerminal && r3 !== this.failureTerminal;

          )
            if (o3 >= t4.length) r3 = r3.failure;
            else {
              var l3 = t4[o3],
                u3 = l3;
              if (r3.isSpecial()) {
                var h3 = true;
                r3.isStartGroup()
                  ? (a3 ? a3.push(s3) : (a3 = [s3]), (s3 = []))
                  : r3.isEndGroup()
                  ? (s3 = a3.length > 0 ? a3.pop() : null)
                  : r3.isEndAlternate()
                  ? (s3[r3.getAlternate()] = 'taken')
                  : (h3 = null == s3[r3.getAlternate()]),
                  (r3 = h3 ? r3.success : r3.failure);
              } else {
                if (
                  0 == o3 &&
                  !e4 &&
                  r3.validator instanceof vu &&
                  this instanceof vu
                ) {
                  if ((u3 = new He(t4).visit(r3.validator))) {
                    (o3 = t4.length), (r3 = r3.success);
                    continue;
                  }
                } else if (
                  0 == o3 &&
                  !e4 &&
                  r3.validator instanceof Eu &&
                  this instanceof vu
                ) {
                  if ((u3 = new ze(t4).visit(r3.validator))) {
                    (o3 = t4.length), (r3 = r3.success);
                    continue;
                  }
                } else u3 = l3.visit(r3.validator);
                if (!u3) {
                  r3 = r3.failure;
                  continue;
                }
                if (u3 !== l3 && t4 === i3) {
                  i3 = [];
                  for (var c3 = 0; c3 < o3; c3++) i3[c3] = t4[c3];
                }
                t4 !== i3 && (i3[o3 - n4] = u3), o3++, (r3 = r3.success);
              }
            }
          return r3 === this.successTerminal &&
            (e4 ? i3.length > 0 : o3 == t4.length)
            ? i3
            : null;
        }),
        (n3.validateSingle = function (t4) {
          for (
            var e4 = null, n4 = this.first;
            n4 !== this.successTerminal && n4 !== this.failureTerminal;

          )
            t4
              ? n4.isSpecial()
                ? (n4 = n4.success)
                : (e4 = t4.visit(n4.validator))
                ? ((t4 = null), (n4 = n4.success))
                : (n4 = n4.failure)
              : (n4 = n4.failure);
          return n4 === this.successTerminal ? e4 : null;
        }),
        (n3.visitEmpty = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitSlash = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitStr = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitIdent = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitNumeric = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitNum = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitInt = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitColor = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitURL = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitSpaceList = function (t4) {
          return null;
        }),
        (n3.visitCommaList = function (t4) {
          return null;
        }),
        (n3.visitFunc = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitExpr = function (t4) {
          return null;
        }),
        e3
      );
    })(fu);
    var vu = (function (t3) {
      function e3(e4) {
        return t3.call(this, e4) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.visitSpaceList = function (t4) {
          var e4 = this.validateList(t4.values, false, 0);
          return e4 === t4.values ? t4 : e4 ? new He(e4) : null;
        }),
        (n3.visitCommaList = function (t4) {
          for (var e4 = this.first, n4 = false; e4; ) {
            if (e4.validator instanceof Eu) {
              n4 = true;
              break;
            }
            e4 = e4.failure;
          }
          if (n4) {
            var i3 = this.validateList(t4.values, false, 0);
            return i3 === t4.values ? t4 : i3 ? new ze(i3) : null;
          }
          return null;
        }),
        (n3.validateForShorthand = function (t4, e4) {
          return this.validateList(t4, true, e4);
        }),
        e3
      );
    })(mu);
    var Eu = (function (t3) {
      function e3(e4) {
        return t3.call(this, e4) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.visitSpaceList = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitCommaList = function (t4) {
          var e4 = this.validateList(t4.values, false, 0);
          return e4 === t4.values ? t4 : e4 ? new ze(e4) : null;
        }),
        (n3.validateForShorthand = function (t4, e4) {
          for (var n4, i3 = this.first; i3 !== this.failureTerminal; ) {
            if ((n4 = i3.validator.validateForShorthand(t4, e4))) return n4;
            i3 = i3.failure;
          }
          return null;
        }),
        e3
      );
    })(mu);
    var yu = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return ((i3 = t3.call(this, n4) || this).name = e4), i3;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.validateSingle = function (t4) {
          return null;
        }),
        (n3.visitFunc = function (t4) {
          if (t4.name.toLowerCase() != this.name) return null;
          var e4 = this.validateList(t4.values, false, 0);
          return e4 === t4.values ? t4 : e4 ? new Ge(t4.name, e4) : null;
        }),
        e3
      );
    })(mu);
    var wu = (function () {
      function t3() {}
      var e3 = t3.prototype;
      return (
        (e3.tryParse = function (t4, e4, n3) {
          return e4;
        }),
        (e3.success = function (t4, e4) {}),
        t3
      );
    })();
    var Nu = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return (
          ((i3 = t3.call(this) || this).name = n4),
          (i3.validator = e4.validators[i3.name]),
          i3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.tryParse = function (t4, e4, n4) {
          if (n4.values[this.name]) return e4;
          var i3 = this.validator.validateForShorthand(t4, e4);
          if (i3) {
            var r3 = i3.length,
              o3 = r3 > 1 ? new He(i3) : i3[0];
            return this.success(o3, n4), e4 + r3;
          }
          return e4;
        }),
        (n3.success = function (t4, e4) {
          e4.values[this.name] = t4;
        }),
        e3
      );
    })(wu);
    var bu = (function (t3) {
      function e3(e4, n3) {
        var i3;
        return ((i3 = t3.call(this, e4, n3[0]) || this).names = n3), i3;
      }
      return (
        I2(e3, t3),
        (e3.prototype.success = function (t4, e4) {
          for (var n3 = 0; n3 < this.names.length; n3++)
            e4.values[this.names[n3]] = t4;
        }),
        e3
      );
    })(Nu);
    var Su = (function (t3) {
      function e3(e4, n3) {
        var i3;
        return ((i3 = t3.call(this) || this).nodes = e4), (i3.slash = n3), i3;
      }
      return (
        I2(e3, t3),
        (e3.prototype.tryParse = function (t4, e4, n3) {
          var i3 = e4;
          if (this.slash) {
            if (t4[e4] != Ae) return i3;
            if (++e4 == t4.length) return i3;
          }
          var r3 = this.nodes[0].tryParse(t4, e4, n3);
          if (r3 == e4) return i3;
          e4 = r3;
          for (
            var o3 = 1;
            o3 < this.nodes.length &&
            e4 < t4.length &&
            (r3 = this.nodes[o3].tryParse(t4, e4, n3)) != e4;
            o3++
          )
            e4 = r3;
          return e4;
        }),
        e3
      );
    })(wu);
    var Cu = (function (t3) {
      function e3() {
        var e4;
        return (
          ((e4 = t3.apply(this, arguments) || this).syntax = null),
          (e4.propList = null),
          (e4.error = false),
          (e4.values = {}),
          (e4.validatorSet = null),
          e4
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.setOwner = function (t4) {
          this.validatorSet = t4;
        }),
        (n3.syntaxNodeForProperty = function (t4) {
          return new Nu(this.validatorSet, t4);
        }),
        (n3.clone = function () {
          var t4 = new this.constructor();
          return (
            (t4.syntax = this.syntax),
            (t4.propList = this.propList),
            (t4.validatorSet = this.validatorSet),
            t4
          );
        }),
        (n3.init = function (t4, e4) {
          (this.syntax = t4), (this.propList = e4);
        }),
        (n3.finish = function (t4, e4) {
          if (!this.error) {
            for (var n4, i3 = D(this.propList); !(n4 = i3()).done; ) {
              var r3 = n4.value;
              e4.simpleProperty(
                r3,
                this.values[r3] || this.validatorSet.defaultValues[r3],
                t4,
              );
            }
            return true;
          }
          return false;
        }),
        (n3.propagateInherit = function (t4, e4) {
          for (var n4, i3 = D(this.propList); !(n4 = i3()).done; )
            e4.simpleProperty(n4.value, Ye.inherit, t4);
        }),
        (n3.validateList = function (t4) {
          return (this.error = true), 0;
        }),
        (n3.validateSingle = function (t4) {
          return this.validateList([t4]), null;
        }),
        (n3.visitEmpty = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitStr = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitIdent = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitNumeric = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitNum = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitInt = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitColor = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitURL = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitSpaceList = function (t4) {
          return this.validateList(t4.values), null;
        }),
        (n3.visitCommaList = function (t4) {
          return (this.error = true), null;
        }),
        (n3.visitFunc = function (t4) {
          return this.validateSingle(t4);
        }),
        (n3.visitExpr = function (t4) {
          return (this.error = true), null;
        }),
        e3
      );
    })(xe);
    var Tu = (function (t3) {
      function e3() {
        return t3.call(this) || this;
      }
      return (
        I2(e3, t3),
        (e3.prototype.validateList = function (t4) {
          for (var e4 = 0, n3 = 0; e4 < t4.length; ) {
            var i3 = this.syntax[n3].tryParse(t4, e4, this);
            if (i3 > e4) (e4 = i3), (n3 = 0);
            else if (++n3 == this.syntax.length) {
              this.error = true;
              break;
            }
          }
          return e4;
        }),
        e3
      );
    })(Cu);
    var xu = (function (t3) {
      function e3() {
        return t3.call(this) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.validateList = function (t4) {
          if (t4.length > this.syntax.length || 0 == t4.length)
            return (this.error = true), 0;
          for (var e4 = 0; e4 < this.syntax.length; e4++) {
            for (var n4 = e4; n4 >= t4.length; ) n4 = 1 == n4 ? 0 : n4 - 2;
            if (this.syntax[e4].tryParse(t4, n4, this) != n4 + 1)
              return (this.error = true), 0;
          }
          return t4.length;
        }),
        (n3.createSyntaxNode = function () {
          return new bu(this.validatorSet, this.propList);
        }),
        e3
      );
    })(Cu);
    var Iu = {
      SIMPLE: Tu,
      INSETS: xu,
      INSETS_SLASH: (function (t3) {
        function e3() {
          return t3.call(this) || this;
        }
        return (
          I2(e3, t3),
          (e3.prototype.validateList = function (t4) {
            for (var e4 = t4.length, n3 = 0; n3 < t4.length; n3++)
              if (t4[n3] === Ae) {
                e4 = n3;
                break;
              }
            if (e4 > this.syntax.length || 0 == t4.length)
              return (this.error = true), 0;
            for (var i3 = 0; i3 < this.syntax.length; i3++) {
              for (var r3 = i3; r3 >= e4; ) r3 = 1 == r3 ? 0 : r3 - 2;
              var o3 = void 0;
              if (e4 + 1 < t4.length)
                for (o3 = e4 + i3 + 1; o3 >= t4.length; )
                  o3 -= o3 == e4 + 2 ? 1 : 2;
              else o3 = r3;
              if (2 != this.syntax[i3].tryParse([t4[r3], t4[o3]], 0, this))
                return (this.error = true), 0;
            }
            return t4.length;
          }),
          e3
        );
      })(Cu),
      COMMA: (function (t3) {
        function e3() {
          return t3.call(this) || this;
        }
        I2(e3, t3);
        var n3 = e3.prototype;
        return (
          (n3.mergeIn = function (t4, e4) {
            for (var n4, i3 = D(this.propList); !(n4 = i3()).done; ) {
              var r3 = n4.value,
                o3 = e4[r3] || this.validatorSet.defaultValues[r3],
                a3 = t4[r3];
              a3 || (t4[r3] = a3 = []), a3.push(o3);
            }
          }),
          (n3.visitCommaList = function (t4) {
            for (var e4 = {}, n4 = 0; n4 < t4.values.length; n4++)
              if (
                ((this.values = {}),
                t4.values[n4] instanceof ze
                  ? (this.error = true)
                  : (t4.values[n4].visit(this),
                    this.mergeIn(e4, this.values),
                    this.values['background-color'] &&
                      n4 != t4.values.length - 1 &&
                      (this.error = true)),
                this.error)
              )
                return null;
            for (var i3 in ((this.values = {}), e4))
              this.values[i3] =
                'background-color' == i3 ? e4[i3].pop() : new ze(e4[i3]);
            return null;
          }),
          e3
        );
      })(Tu),
      FONT: (function (t3) {
        function e3() {
          return t3.call(this) || this;
        }
        I2(e3, t3);
        var n3 = e3.prototype;
        return (
          (n3.init = function (e4, n4) {
            t3.prototype.init.call(this, e4, n4),
              this.propList.push('font-family', 'line-height', 'font-size');
          }),
          (n3.validateList = function (e4) {
            var n4 = t3.prototype.validateList.call(this, e4);
            if (n4 + 2 > e4.length) return (this.error = true), n4;
            this.error = false;
            var i3 = this.validatorSet.validators;
            if (!e4[n4].visit(i3['font-size'])) return (this.error = true), n4;
            if (((this.values['font-size'] = e4[n4++]), e4[n4] === Ae)) {
              if (2 + ++n4 > e4.length) return (this.error = true), n4;
              if (!e4[n4].visit(i3['line-height']))
                return (this.error = true), n4;
              this.values['line-height'] = e4[n4++];
            }
            var r3 =
              n4 == e4.length - 1 ? e4[n4] : new He(e4.slice(n4, e4.length));
            return r3.visit(i3['font-family'])
              ? ((this.values['font-family'] = r3), e4.length)
              : ((this.error = true), n4);
          }),
          (n3.visitCommaList = function (t4) {
            if ((t4.values[0].visit(this), this.error)) return null;
            for (
              var e4 = [this.values['font-family']], n4 = 1;
              n4 < t4.values.length;
              n4++
            )
              e4.push(t4.values[n4]);
            var i3 = new ze(e4);
            return (
              i3.visit(this.validatorSet.validators['font-family'])
                ? (this.values['font-family'] = i3)
                : (this.error = true),
              null
            );
          }),
          (n3.visitIdent = function (t4) {
            var e4 = this.validatorSet.systemFonts[t4.name];
            if (e4) for (var n4 in e4) this.values[n4] = e4[n4];
            else this.error = true;
            return null;
          }),
          e3
        );
      })(Tu),
    };
    var Pu = (function () {
      function t3() {
        (this.validators = {}),
          (this.prefixes = {}),
          (this.defaultValues = {}),
          (this.namedValidators = {}),
          (this.systemFonts = {}),
          (this.shorthands = {}),
          (this.layoutProps = {}),
          (this.backgroundProps = {});
      }
      var e3 = t3.prototype;
      return (
        (e3.addReplacement = function (t4, e4) {
          var n3;
          if (e4.type == Ln.NUMERIC) n3 = new De(e4.num, e4.text);
          else if (e4.type == Ln.HASH) n3 = zi(e4.text);
          else {
            if (e4.type != Ln.IDENT) throw new Error('unexpected replacement');
            n3 = Fe(e4.text);
          }
          if (t4.isPrimitive()) {
            var i3 = t4.nodes[0].validator.idents;
            for (var r3 in i3) i3[r3] = n3;
            return t4;
          }
          throw new Error('unexpected replacement');
        }),
        (e3.newGroup = function (t4, e4) {
          var n3,
            i3 = new cu();
          if ('||' == t4) {
            for (var r3 = 0; r3 < e4.length; r3++) {
              var o3 = new cu();
              o3.startClause(r3),
                o3.addGroup(e4[r3], eu.FOLLOW),
                o3.endClause(r3),
                i3.addGroup(o3, 0 == r3 ? eu.FOLLOW : eu.ALTERNATE);
            }
            var a3 = new cu();
            return (
              a3.startSpecialGroup(),
              a3.addGroup(i3, eu.REPEATED),
              a3.endSpecialGroup(),
              a3
            );
          }
          switch (t4) {
            case ' ':
              n3 = eu.FOLLOW;
              break;
            case '|':
            case '||':
              n3 = eu.ALTERNATE;
              break;
            default:
              throw new Error('unexpected op');
          }
          for (var s3 = 0; s3 < e4.length; s3++)
            i3.addGroup(e4[s3], 0 == s3 ? eu.FOLLOW : n3);
          return i3;
        }),
        (e3.addCounts = function (t4, e4, n3) {
          for (var i3 = new cu(), r3 = 0; r3 < e4; r3++)
            i3.addGroup(t4.clone(), eu.FOLLOW);
          if (n3 == Number.POSITIVE_INFINITY) i3.addGroup(t4, eu.REPEATED);
          else
            for (var o3 = e4; o3 < n3; o3++)
              i3.addGroup(t4.clone(), eu.OPTIONAL);
          return i3;
        }),
        (e3.primitive = function (t4) {
          var e4 = new cu();
          return e4.addPrimitive(t4), e4;
        }),
        (e3.newFunc = function (t4, e4) {
          var n3;
          switch (t4) {
            case 'COMMA':
              n3 = new Eu(e4);
              break;
            case 'SPACE':
              n3 = new vu(e4);
              break;
            default:
              n3 = new yu(t4.toLowerCase(), e4);
          }
          return this.primitive(n3);
        }),
        (e3.initBuiltInValidators = function () {
          (this.namedValidators.HASHCOLOR = this.primitive(new du(64, pu, pu))),
            (this.namedValidators.POS_INT = this.primitive(new du(32, pu, pu))),
            (this.namedValidators.POS_NUM = this.primitive(new du(16, pu, pu))),
            (this.namedValidators.POS_PERCENTAGE = this.primitive(
              new du(8, pu, { '%': Re }),
            )),
            (this.namedValidators.NEGATIVE = this.primitive(
              new du(256, pu, pu),
            )),
            (this.namedValidators.ZERO = this.primitive(new du(512, pu, pu))),
            (this.namedValidators.ZERO_PERCENTAGE = this.primitive(
              new du(1024, pu, pu),
            )),
            (this.namedValidators.POS_LENGTH = this.primitive(
              new du(8, pu, {
                em: Re,
                ex: Re,
                ch: Re,
                rem: Re,
                vw: Re,
                vh: Re,
                vi: Re,
                vb: Re,
                vmin: Re,
                vmax: Re,
                pvw: Re,
                pvh: Re,
                pvi: Re,
                pvb: Re,
                pvmin: Re,
                pvmax: Re,
                cm: Re,
                mm: Re,
                in: Re,
                px: Re,
                pt: Re,
                pc: Re,
                q: Re,
              }),
            )),
            (this.namedValidators.POS_ANGLE = this.primitive(
              new du(8, pu, { deg: Re, grad: Re, rad: Re, turn: Re }),
            )),
            (this.namedValidators.POS_TIME = this.primitive(
              new du(8, pu, { s: Re, ms: Re }),
            )),
            (this.namedValidators.FREQUENCY = this.primitive(
              new du(8, pu, { Hz: Re, kHz: Re }),
            )),
            (this.namedValidators.RESOLUTION = this.primitive(
              new du(8, pu, { dpi: Re, dpcm: Re, dppx: Re }),
            )),
            (this.namedValidators.URI = this.primitive(new du(128, pu, pu))),
            (this.namedValidators.IDENT = this.primitive(new du(4, pu, pu))),
            (this.namedValidators.STRING = this.primitive(new du(2, pu, pu))),
            (this.namedValidators.SLASH = this.primitive(new du(2048, pu, pu)));
          var t4 = { 'font-family': Fe('sans-serif') };
          (this.systemFonts.caption = t4),
            (this.systemFonts.icon = t4),
            (this.systemFonts.menu = t4),
            (this.systemFonts['message-box'] = t4),
            (this.systemFonts['small-caption'] = t4),
            (this.systemFonts['status-bar'] = t4);
        }),
        (e3.isBuiltIn = function (t4) {
          return !!t4.match(/^[A-Z_0-9]+$/);
        }),
        (e3.readNameAndPrefixes = function (t4, e4) {
          var n3 = t4.token();
          if (n3.type == Ln.EOF) return null;
          var i3 = { '': true };
          if (n3.type == Ln.O_BRK) {
            do {
              if ((t4.consume(), (n3 = t4.token()).type != Ln.IDENT))
                throw new Error('Prefix name expected');
              (i3[n3.text] = true), t4.consume(), (n3 = t4.token());
            } while (n3.type == Ln.COMMA);
            if (n3.type != Ln.C_BRK) throw new Error("']' expected");
            t4.consume(), (n3 = t4.token());
          }
          if (n3.type != Ln.IDENT) throw new Error('Property name expected');
          if (2 == e4 ? 'SHORTHANDS' == n3.text : 'DEFAULTS' == n3.text)
            return t4.consume(), null;
          var r3 = n3.text;
          if ((t4.consume(), 2 != e4)) {
            if (t4.token().type != Ln.EQ) throw new Error("'=' expected");
            this.isBuiltIn(r3) || (this.prefixes[r3] = i3);
          } else if (t4.token().type != Ln.COLON)
            throw new Error("':' expected");
          return r3;
        }),
        (e3.parseValidators = function (t4) {
          for (
            var e4 = this,
              n3 = function () {
                var n4 = e4.readNameAndPrefixes(t4, 1);
                if (!n4) return { v: void 0 };
                for (
                  var i4 = [],
                    r3 = [],
                    o3 = '',
                    a3 = void 0,
                    s3 = true,
                    l3 = e4,
                    u3 = function () {
                      if (0 == i4.length) throw new Error('No values');
                      return 1 == i4.length ? i4[0] : l3.newGroup(o3, i4);
                    },
                    h3 = function (t5) {
                      if (s3) throw new Error("'" + t5 + "': unexpected");
                      if (o3 && o3 != t5)
                        throw new Error(
                          "mixed operators: '" + t5 + "' and '" + o3 + "'",
                        );
                      (o3 = t5), (s3 = true);
                    },
                    c3 = null;
                  !c3;

                ) {
                  t4.consume();
                  var f3 = t4.token();
                  switch (f3.type) {
                    case Ln.IDENT:
                      if ((s3 || h3(' '), e4.isBuiltIn(f3.text))) {
                        var d3 = e4.namedValidators[f3.text];
                        if (!d3)
                          throw new Error("'" + f3.text + "' unexpected");
                        i4.push(d3.clone());
                      } else {
                        var p3 = {};
                        (p3[f3.text.toLowerCase()] = Fe(f3.text)),
                          i4.push(e4.primitive(new du(0, p3, pu)));
                      }
                      s3 = false;
                      break;
                    case Ln.INT:
                      var g3 = {};
                      (g3['' + f3.num] = new Be(f3.num)),
                        i4.push(e4.primitive(new du(0, g3, pu))),
                        (s3 = false);
                      break;
                    case Ln.BAR:
                      h3('|');
                      break;
                    case Ln.BAR_BAR:
                      h3('||');
                      break;
                    case Ln.O_BRK:
                      s3 || h3(' '),
                        r3.push({ vals: i4, op: o3, b: '[' }),
                        (o3 = ''),
                        (i4 = []),
                        (s3 = true);
                      break;
                    case Ln.FUNC:
                      s3 || h3(' '),
                        r3.push({ vals: i4, op: o3, b: '(', fn: f3.text }),
                        (o3 = ''),
                        (i4 = []),
                        (s3 = true);
                      break;
                    case Ln.C_BRK:
                      a3 = u3();
                      var m3 = r3.pop();
                      if ('[' != m3.b) throw new Error("']' unexpected");
                      (i4 = m3.vals).push(a3), (o3 = m3.op), (s3 = false);
                      break;
                    case Ln.C_PAR:
                      a3 = u3();
                      var v3 = r3.pop();
                      if ('(' != v3.b) throw new Error("')' unexpected");
                      (i4 = v3.vals).push(e4.newFunc(v3.fn, a3)),
                        (o3 = v3.op),
                        (s3 = false);
                      break;
                    case Ln.COLON:
                      if (s3) throw new Error("':' unexpected");
                      t4.consume(),
                        i4.push(e4.addReplacement(i4.pop(), t4.token()));
                      break;
                    case Ln.QMARK:
                      if (s3) throw new Error("'?' unexpected");
                      i4.push(e4.addCounts(i4.pop(), 0, 1));
                      break;
                    case Ln.STAR:
                      if (s3) throw new Error("'*' unexpected");
                      i4.push(
                        e4.addCounts(i4.pop(), 0, Number.POSITIVE_INFINITY),
                      );
                      break;
                    case Ln.PLUS:
                      if (s3) throw new Error("'+' unexpected");
                      i4.push(
                        e4.addCounts(i4.pop(), 1, Number.POSITIVE_INFINITY),
                      );
                      break;
                    case Ln.O_BRC:
                      if ((t4.consume(), (f3 = t4.token()).type != Ln.INT))
                        throw new Error('<int> expected');
                      var E2 = f3.num,
                        y3 = E2;
                      if ((t4.consume(), (f3 = t4.token()).type == Ln.COMMA)) {
                        if ((t4.consume(), (f3 = t4.token()).type != Ln.INT))
                          throw new Error('<int> expected');
                        (y3 = f3.num), t4.consume(), (f3 = t4.token());
                      }
                      if (f3.type != Ln.C_BRC) throw new Error("'}' expected");
                      i4.push(e4.addCounts(i4.pop(), E2, y3));
                      break;
                    case Ln.SEMICOL:
                      if (((c3 = u3()), r3.length > 0))
                        throw new Error("unclosed '" + r3.pop().b + "'");
                      break;
                    default:
                      throw new Error('unexpected token');
                  }
                }
                t4.consume(),
                  e4.isBuiltIn(n4)
                    ? (e4.namedValidators[n4] = c3)
                    : (e4.validators[n4] = c3.isSimple()
                        ? c3.nodes[0].validator
                        : new vu(c3));
              };
            ;

          ) {
            var i3 = n3();
            if ('object' == typeof i3) return i3.v;
          }
        }),
        (e3.parseDefaults = function (t4) {
          for (;;) {
            var e4 = this.readNameAndPrefixes(t4, 2);
            if (!e4) return;
            for (var n3 = []; ; ) {
              t4.consume();
              var i3 = t4.token();
              if (i3.type == Ln.SEMICOL) {
                t4.consume();
                break;
              }
              switch (i3.type) {
                case Ln.IDENT:
                  n3.push(Fe(i3.text));
                  break;
                case Ln.NUM:
                  n3.push(new _e(i3.num));
                  break;
                case Ln.INT:
                  n3.push(new Be(i3.num));
                  break;
                case Ln.NUMERIC:
                  n3.push(new De(i3.num, i3.text));
                  break;
                default:
                  throw new Error('unexpected token');
              }
            }
            this.defaultValues[e4] = n3.length > 1 ? new He(n3) : n3[0];
          }
        }),
        (e3.parseShorthands = function (t4) {
          for (;;) {
            var e4 = this.readNameAndPrefixes(t4, 3);
            if (!e4) return;
            var n3 = t4.nthToken(1),
              i3 = void 0;
            n3.type == Ln.IDENT && Iu[n3.text]
              ? ((i3 = new Iu[n3.text]()), t4.consume())
              : (i3 = new Tu()),
              i3.setOwner(this);
            for (var r3 = false, o3 = [], a3 = false, s3 = [], l3 = []; !r3; )
              switch ((t4.consume(), (n3 = t4.token()).type)) {
                case Ln.IDENT:
                  if (this.validators[n3.text])
                    o3.push(i3.syntaxNodeForProperty(n3.text)),
                      l3.push(n3.text);
                  else {
                    if (!(this.shorthands[n3.text] instanceof xu))
                      throw new Error(
                        "'" +
                          n3.text +
                          "' is neither a simple property nor an inset shorthand",
                      );
                    var u3 = this.shorthands[n3.text];
                    o3.push(u3.createSyntaxNode()),
                      l3.push.apply(l3, u3.propList);
                  }
                  break;
                case Ln.SLASH:
                  if (o3.length > 0 || a3) throw new Error('unexpected slash');
                  a3 = true;
                  break;
                case Ln.O_BRK:
                  s3.push({ slash: a3, syntax: o3 }), (o3 = []), (a3 = false);
                  break;
                case Ln.C_BRK:
                  var h3 = new Su(o3, a3),
                    c3 = s3.pop();
                  (a3 = c3.slash), (o3 = c3.syntax).push(h3);
                  break;
                case Ln.SEMICOL:
                  (r3 = true), t4.consume();
                  break;
                default:
                  throw new Error('unexpected token');
              }
            i3.init(o3, l3), (this.shorthands[e4] = i3);
          }
        }),
        (e3.parse = function (t4) {
          var e4 = new Ei(t4, null);
          this.parseValidators(e4),
            this.parseDefaults(e4),
            this.parseShorthands(e4),
            (this.backgroundProps = this.makePropSet(['background'])),
            (this.layoutProps = this.makePropSet([
              'margin',
              'border',
              'padding',
              'columns',
              'column-gap',
              'column-rule',
              'column-fill',
            ]));
        }),
        (e3.makePropSet = function (t4) {
          for (var e4, n3 = {}, i3 = D(t4); !(e4 = i3()).done; )
            for (
              var r3,
                o3 = e4.value,
                a3 = this.shorthands[o3],
                s3 = D(a3 ? a3.propList : [o3]);
              !(r3 = s3()).done;

            ) {
              var l3 = r3.value,
                u3 = this.defaultValues[l3];
              u3
                ? (n3[l3] = u3)
                : c2.warn('Unknown property in makePropSet:', l3);
            }
          return n3;
        }),
        (e3.validatePropertyAndHandleShorthand = function (t4, e4, n3, i3) {
          var r3 = '',
            o3 = t4,
            a3 = (t4 = t4.toLowerCase()).match(/^-([a-z]+)-([-a-z0-9]+)$/);
          a3 && ((r3 = a3[1]), (t4 = a3[2]));
          var s3 = this.prefixes[t4];
          if (s3 && s3[r3]) {
            var l3 = this.validators[t4];
            if (l3) {
              var u3 = e4 === Ye.inherit || e4.isExpr() ? e4 : e4.visit(l3);
              u3
                ? i3.simpleProperty(t4, u3, n3)
                : i3.invalidPropertyValue(o3, e4);
            } else {
              var h3 = this.shorthands[t4].clone();
              e4 === Ye.inherit
                ? h3.propagateInherit(n3, i3)
                : (e4.visit(h3),
                  h3.finish(n3, i3) || i3.invalidPropertyValue(o3, e4));
            }
          } else i3.unknownProperty(o3, e4);
        }),
        t3
      );
    })();
    function Ru() {
      var t3 = new Pu();
      return (
        t3.initBuiltInValidators(),
        t3.parse(
          '\n/*\n * Copyright 2013 Google, Inc.\n * Copyright 2015 Trim-marks Inc.\n * Copyright 2019 Vivliostyle Foundation\n *\n * CSS property validation.\n */\nNUM = POS_NUM | ZERO | NEGATIVE;\nNNEG_NUM = POS_NUM | ZERO;\nINT = POS_INT | ZERO | NEGATIVE;\nNNEG_INT = POS_INT | ZERO;\nPERCENTAGE = POS_PERCENTAGE | ZERO | NEGATIVE;\nSTRICT_PERCENTAGE = POS_PERCENTAGE | ZERO_PERCENTAGE | NEGATIVE;\nNNEG_PERCENTAGE = POS_PERCENTAGE | ZERO;\nLENGTH = POS_LENGTH | ZERO | NEGATIVE;\nNNEG_LENGTH = POS_LENGTH | ZERO | NEGATIVE;\nPLENGTH = LENGTH | PERCENTAGE;\nPPLENGTH = POS_LENGTH | ZERO | POS_PERCENTAGE;\nALENGTH = LENGTH | auto;\nAPLENGTH = PLENGTH | auto;\nPAPLENGTH = PPLENGTH | auto;\nANGLE = POS_ANGLE | ZERO | NEGATIVE;\nLENGTH_OR_NUM = LENGTH | NUM;\nANGLE_OR_NUM = ANGLE | NUM;\nSCOLOR = HASHCOLOR | aliceblue: #F0F8FF | antiquewhite: #FAEBD7 | aqua: #00FFFF | aquamarine: #7FFFD4 | azure: #F0FFFF |\n    beige: #F5F5DC | bisque: #FFE4C4 | black: #000000 | blanchedalmond: #FFEBCD | blue: #0000FF | blueviolet: #8A2BE2 | brown: #A52A2A |\n    burlywood: #DEB887 | cadetblue: #5F9EA0 | chartreuse: #7FFF00 | chocolate: #D2691E | coral: #FF7F50 | cornflowerblue: #6495ED |\n    cornsilk: #FFF8DC | crimson: #DC143C | cyan: #00FFFF | darkblue: #00008B | darkcyan: #008B8B | darkgoldenrod: #B8860B |\n    darkgray: #A9A9A9 | darkgreen: #006400 | darkgrey: #A9A9A9 | darkkhaki: #BDB76B | darkmagenta: #8B008B | darkolivegreen: #556B2F |\n    darkorange: #FF8C00 | darkorchid: #9932CC | darkred: #8B0000 | darksalmon: #E9967A | darkseagreen: #8FBC8F | darkslateblue: #483D8B |\n    darkslategray: #2F4F4F | darkslategrey: #2F4F4F | darkturquoise: #00CED1 | darkviolet: #9400D3 | deeppink: #FF1493 |\n    deepskyblue: #00BFFF | dimgray: #696969 | dimgrey: #696969 | dodgerblue: #1E90FF | firebrick: #B22222 | floralwhite: #FFFAF0 |\n    forestgreen: #228B22 | fuchsia: #FF00FF | gainsboro: #DCDCDC | ghostwhite: #F8F8FF | gold: #FFD700 | goldenrod: #DAA520 |\n    gray: #808080 | green: #008000 | greenyellow: #ADFF2F | grey: #808080 | honeydew: #F0FFF0 | hotpink: #FF69B4 | indianred: #CD5C5C |\n    indigo: #4B0082 | ivory: #FFFFF0 | khaki: #F0E68C | lavender: #E6E6FA | lavenderblush: #FFF0F5 | lawngreen: #7CFC00 |\n    lemonchiffon: #FFFACD | lightblue: #ADD8E6 | lightcoral: #F08080 | lightcyan: #E0FFFF | lightgoldenrodyellow: #FAFAD2 |\n    lightgray: #D3D3D3 | lightgreen: #90EE90 | lightgrey: #D3D3D3 | lightpink: #FFB6C1 | lightsalmon: #FFA07A | lightseagreen: #20B2AA |\n    lightskyblue: #87CEFA | lightslategray: #778899 | lightslategrey: #778899 | lightsteelblue: #B0C4DE | lightyellow: #FFFFE0 |\n    lime: #00FF00 | limegreen: #32CD32 | linen: #FAF0E6 | magenta: #FF00FF | maroon: #800000 | mediumaquamarine: #66CDAA |\n    mediumblue: #0000CD | mediumorchid: #BA55D3 | mediumpurple: #9370DB | mediumseagreen: #3CB371 | mediumslateblue: #7B68EE |\n    mediumspringgreen: #00FA9A | mediumturquoise: #48D1CC | mediumvioletred: #C71585 | midnightblue: #191970 | mintcream: #F5FFFA |\n    mistyrose: #FFE4E1 | moccasin: #FFE4B5 | navajowhite: #FFDEAD | navy: #000080 | oldlace: #FDF5E6 | olive: #808000 |\n    olivedrab: #6B8E23 | orange: #FFA500 | orangered: #FF4500 | orchid: #DA70D6 | palegoldenrod: #EEE8AA | palegreen: #98FB98 |\n    paleturquoise: #AFEEEE | palevioletred: #DB7093 | papayawhip: #FFEFD5 | peachpuff: #FFDAB9 | peru: #CD853F | pink: #FFC0CB |\n    plum: #DDA0DD | powderblue: #B0E0E6 | purple: #800080 | rebeccapurple: #663399 | red: #FF0000 | rosybrown: #BC8F8F | royalblue: #4169E1 |\n    saddlebrown: #8B4513 | salmon: #FA8072 | sandybrown: #F4A460 | seagreen: #2E8B57 | seashell: #FFF5EE | sienna: #A0522D |\n    silver: #C0C0C0 | skyblue: #87CEEB | slateblue: #6A5ACD | slategray: #708090 | slategrey: #708090 | snow: #FFFAFA |\n    springgreen: #00FF7F | steelblue: #4682B4 | tan: #D2B48C | teal: #008080 | thistle: #D8BFD8 | tomato: #FF6347 |\n    turquoise: #40E0D0 | violet: #EE82EE | wheat: #F5DEB3 | white: #FFFFFF | whitesmoke: #F5F5F5 | yellow: #FFFF00 |\n    yellowgreen: #9ACD32 | transparent | currentcolor;\nRGBCOLOR = rgb(INT{3}) | rgb(STRICT_PERCENTAGE{3});\nRGBACOLOR = rgba(NUM{4}) | rgba(STRICT_PERCENTAGE{3} NUM);\nHSLCOLOR = hsl(NUM PERCENTAGE{2});\nHSLACOLOR = hsl(NUM PERCENTAGE{2} NUM);\nCOLOR = SCOLOR | RGBCOLOR | RGBACOLOR | HSLCOLOR | HSLACOLOR;\nBG_POSITION_TERM = PLENGTH | left | center | right | top | bottom;\nSIDE_OR_CORNER =  [left | right] || [top | bottom];\nCOLOR_STOP = SPACE(COLOR [PERCENTAGE | LENGTH]?);\nLINEAR_GRADIENT = linear-gradient([ANGLE | SPACE(to SIDE_OR_CORNER)]? COLOR_STOP+) |\n                  repeating-linear-gradient([ANGLE | SPACE(to SIDE_OR_CORNER)]? COLOR_STOP+) |;\nGRADIENT_EXTENT = closest-corner | closest-side | farthest-corner | farthest-side;\nGRADIENT_POSITION = at BG_POSITION_TERM{1,4};\nGRADIENT_SHAPE = SPACE(circle LENGTH? GRADIENT_POSITION?) | SPACE(ellipse PLENGTH{2}? GRADIENT_POSITION?)| SPACE([circle | ellipse] GRADIENT_EXTENT? GRADIENT_POSITION?);\nRADIAL_GRADIENT = radial-gradient([GRADIENT_SHAPE | SPACE(GRADIENT_POSITION)]? COLOR_STOP+) |\n                  repeating-radial-gradient([GRADIENT_SHAPE | SPACE(GRADIENT_POSITION)]? COLOR_STOP+);\nURI_OR_NONE = URI | none;\nIMAGE =  URI | LINEAR_GRADIENT | RADIAL_GRADIENT | none;\nazimuth = ANGLE | [[ left-side | far-left | left | center-left | center | center-right | right | far-right | right-side ] || behind ] | leftwards | rightwards;\nbackground-attachment = COMMA( [scroll | fixed | local]+ );\nbackground-color = COLOR;\nbackground-image = COMMA( IMAGE+ );\nbackground-position = COMMA( SPACE(BG_POSITION_TERM{1,4})+ ); /* relaxed */\nbackground-repeat = COMMA( [repeat | repeat-x | repeat-y | no-repeat]+ );\nborder-collapse = collapse | separate;\nBORDER_SIDE_COLOR = COLOR;\nBORDER_SIDE_STYLE = none | hidden | dotted | dashed | solid | double | groove | ridge | inset | outset;\nBORDER_SIDE_WIDTH = thin: 1px | medium: 3px | thick: 5px | NNEG_LENGTH;\nborder-spacing = LENGTH LENGTH?;\nborder-top-color = BORDER_SIDE_COLOR;\nborder-right-color = BORDER_SIDE_COLOR;\nborder-bottom-color = BORDER_SIDE_COLOR;\nborder-left-color = BORDER_SIDE_COLOR;\nborder-top-style = BORDER_SIDE_STYLE;\nborder-right-style = BORDER_SIDE_STYLE;\nborder-bottom-style = BORDER_SIDE_STYLE;\nborder-left-style = BORDER_SIDE_STYLE;\nborder-top-width = BORDER_SIDE_WIDTH;\nborder-right-width = BORDER_SIDE_WIDTH;\nborder-bottom-width = BORDER_SIDE_WIDTH;\nborder-left-width = BORDER_SIDE_WIDTH;\nBORDER_RADIUS = PLENGTH{1,2};\nborder-top-left-radius = BORDER_RADIUS;\nborder-top-right-radius = BORDER_RADIUS;\nborder-bottom-right-radius = BORDER_RADIUS;\nborder-bottom-left-radius = BORDER_RADIUS;\nborder-image-source = IMAGE;\nborder-image-slice = [NUM | PERCENTAGE]{1,4} || fill; /* relaxed */\nborder-image-width = [NUM | PLENGTH | auto]{1,4};\nborder-image-outset = [NUM | LENGTH]{1,4};\nborder-image-repeat = [ stretch | repeat | round | space ]{1,2};\nbottom = APLENGTH;\ncaption-side = top | bottom;\nclear = none | left | right | top | bottom | both | all | same;\nclip = rect(ALENGTH{4}) | rect(SPACE(ALENGTH{4})) | auto;\ncolor = COLOR;\nLIST_STYLE_TYPE = disc | circle | square | decimal | decimal-leading-zero | lower-roman |\n    upper-roman | lower-greek | lower-latin | upper-latin | armenian | georgian | lower-alpha |\n    upper-alpha | russian | upper-russian | lower-russian | cjk-ideographic | trad-chinese-informal |\n    hebrew | none;\nTYPE_OR_UNIT_IN_ATTR = string | color | url | integer | number | length | angle | time | frequency;\nATTR = attr(SPACE(IDENT TYPE_OR_UNIT_IN_ATTR?) [ STRING | IDENT | COLOR | INT | NUM | PLENGTH | ANGLE | POS_TIME | FREQUENCY]?);\nCONTENT = normal | none |\n    [ STRING | URI | counter(IDENT LIST_STYLE_TYPE?) |\n    counters(IDENT STRING LIST_STYLE_TYPE?) | ATTR |\n    target-counter([ STRING | URI ] IDENT LIST_STYLE_TYPE?) |\n    target-counter(ATTR IDENT LIST_STYLE_TYPE?) |\n    target-counters([ STRING | URI ] IDENT STRING LIST_STYLE_TYPE?) |\n    target-counters(ATTR IDENT STRING LIST_STYLE_TYPE?) |\n    open-quote | close-quote | no-open-quote | no-close-quote ]+;\ncontent = CONTENT;\nCOUNTER = [ IDENT INT? ]+ | none;\ncounter-increment = COUNTER;\ncounter-reset = COUNTER;\ncounter-set = COUNTER;\ncue-after = URI_OR_NONE;\ncue-before = URI_OR_NONE;\ncursor = COMMA(URI* [ auto | crosshair | default | pointer | move | e-resize | ne-resize | nw-resize |\n    n-resize | se-resize | sw-resize | s-resize | w-resize | text | wait | help | progress ]);\ndirection = ltr | rtl;\ndisplay = inline | block | list-item | inline-block | table | inline-table | table-row-group |\n    table-header-group | table-footer-group | table-row | table-column-group | table-column |\n    table-cell | table-caption | none | oeb-page-head | oeb-page-foot | flex | inline-flex |\n    ruby | ruby-base | ruby-text | ruby-base-container | ruby-text-container | run-in | compact | marker;\nelevation = ANGLE | below | level | above | higher | lower;\nempty-cells = show | hide;\nFAMILY = SPACE(IDENT+) | STRING;\nFAMILY_LIST = COMMA( FAMILY+ );\nfont-family = FAMILY_LIST;\nfont-size = xx-small | x-small | small | medium | large | x-large | xx-large | larger | smaller | PPLENGTH | POS_NUM;\nfont-style = normal | italic | oblique;\nfont-variant = normal | small-caps;\nfont-weight = normal | bold | bolder | lighter | 100 | 200 | 300 | 400 | 500 | 600 | 700 | 800 | 900;\nheight = PAPLENGTH | POS_NUM ;\nleft = APLENGTH;\nletter-spacing = normal | LENGTH_OR_NUM;\nline-height = normal | POS_NUM | PPLENGTH;\nlist-style-image = IMAGE;\nlist-style-position = inside | outside;\nlist-style-type = LIST_STYLE_TYPE;\nmargin-right = APLENGTH;\nmargin-left = APLENGTH;\nmargin-top = APLENGTH;\nmargin-bottom = APLENGTH;\nNPLENGTH = none | PLENGTH;\nmax-height = NPLENGTH;\nmax-width = NPLENGTH;\nmin-height = auto | PLENGTH;\nmin-width = auto | PLENGTH;\norphans = POS_INT;\noutline-offset = LENGTH;\noutline-color = COLOR | invert;\noutline-style = BORDER_SIDE_STYLE;\noutline-width = BORDER_SIDE_WIDTH;\noverflow = visible | hidden | scroll | auto;\npadding-right = PPLENGTH;\npadding-left = PPLENGTH;\npadding-top = PPLENGTH;\npadding-bottom = PPLENGTH;\nPAGE_BREAK = auto | always | avoid | left | right | recto | verso;\npage-break-after = PAGE_BREAK;\npage-break-before = PAGE_BREAK;\npage-break-inside = avoid | auto;\nPAUSE = POS_TIME | ZERO | POS_PERCENTAGE;\npause-after = PAUSE;\npause-before = PAUSE;\npitch-range = NUM;\npitch = FREQUENCY | x-low | low | medium | high | x-high;\nplay-during = [URI [ mix || repeat ]?] | auto | none;\nposition = static | relative | absolute | fixed;\nquotes = [STRING STRING]+ | none;\nrichness = NUM;\nright = APLENGTH;\nspeak-header = once | always;\nspeak-numeral = digits | continuous;\nspeak-punctuation = code | none;\nspeech-rate = NUM | x-slow | slow | medium | fast | x-fast | faster | slower;\nstress = NUM;\ntable-layout = auto | fixed;\ntext-align = left | right | center | justify | start | end;\ntext-decoration = none | [ underline || overline || line-through || blink ];\ntext-indent = PLENGTH;\ntext-transform = capitalize | uppercase | lowercase | none;\ntop = APLENGTH;\nvertical-align = baseline | sub | super | top | text-top | middle | bottom | text-bottom | PLENGTH;\nvisibility = visible | hidden | collapse;\nvoice-family = FAMILY_LIST;\nvolume = NUM | PERCENTAGE | silent | x-soft | soft | medium | loud | x-loud;\nwhite-space = normal | pre | nowrap | pre-wrap | pre-line;\nwidows = POS_INT;\nwidth = PAPLENGTH | POS_NUM ;\nword-spacing = normal | LENGTH_OR_NUM;\nz-index = auto | INT;\n\n[epub,moz,ms,webkit]hyphens = auto | manual | none;\n[webkit]hyphenate-character = auto | STRING;\n\n/* css-logical */\nmargin-block-start = APLENGTH;\nmargin-block-end = APLENGTH;\nmargin-inline-start = APLENGTH;\nmargin-inline-end = APLENGTH;\npadding-block-start = APLENGTH;\npadding-block-end = APLENGTH;\npadding-inline-start = APLENGTH;\npadding-inline-end = APLENGTH;\nborder-block-start-color = BORDER_SIDE_COLOR;\nborder-block-end-color = BORDER_SIDE_COLOR;\nborder-inline-start-color = BORDER_SIDE_COLOR;\nborder-inline-end-color = BORDER_SIDE_COLOR;\nborder-block-start-style = BORDER_SIDE_STYLE;\nborder-block-end-style = BORDER_SIDE_STYLE;\nborder-inline-start-style = BORDER_SIDE_STYLE;\nborder-inline-end-style = BORDER_SIDE_STYLE;\nborder-block-start-width = BORDER_SIDE_WIDTH;\nborder-block-end-width = BORDER_SIDE_WIDTH;\nborder-inline-start-width = BORDER_SIDE_WIDTH;\nborder-inline-end-width = BORDER_SIDE_WIDTH;\nblock-start = APLENGTH;\nblock-end = APLENGTH;\ninline-start = APLENGTH;\ninline-end = APLENGTH;\nblock-size = PAPLENGTH | POS_NUM;\ninline-size = PAPLENGTH | POS_NUM;\nmax-block-size = NPLENGTH;\nmax-inline-size = NPLENGTH;\nmin-block-size = auto | PLENGTH;\nmin-inline-size = auto | PLENGTH;\n\nSHAPE = auto | rectangle( PLENGTH{4} ) |  ellipse( PLENGTH{4} ) |  circle( PLENGTH{3} ) |\n    polygon( SPACE(PLENGTH+)+ );\n[epubx]shape-inside = SHAPE;\n[epubx,webkit]shape-outside = SHAPE;\n[epubx,ms]wrap-flow = auto | both | start | end | maximum | clear | around /* epub al */;\n\nTRANSFORM_FUNCTION = matrix(NUM{6}) | translate(PLENGTH{1,2}) | translateX(PLENGTH) | translateY(PLENGTH) |\n scale(NUM{1,2}) | scaleX(NUM) | scaleY(NUM) | rotate(ANGLE) | skewX(ANGLE) | skewY(ANGLE);\n[epub,ms]transform = none | TRANSFORM_FUNCTION+;\n[epub,ms]transform-origin = [[[ top | bottom | left | right] PLENGTH?] | center | PLENGTH]{1,2}; /* relaxed */\n\nBOX = border-box | padding-box | content-box;\nSHADOW = SPACE(inset || LENGTH{2,4} || COLOR); /* relaxed */\n[webkit]background-size = COMMA( SPACE( [PLENGTH | auto ]{1,2} | cover | contain)+ );\n[webkit]background-origin = COMMA( BOX+ );\n[webkit]background-clip = COMMA( BOX+ );\n[webkit]box-shadow = none | COMMA( SHADOW+ );\ntext-shadow = none |  COMMA( SHADOW+ );\n[webkit]box-decoration-break = slice | clone;\nFILTER_FUNCTION = blur(LENGTH) | brightness(NUM | PERCENTAGE) | contrast(NUM | PERCENTAGE) | drop-shadow(SPACE(LENGTH{2,3} COLOR?))\n                | grayscale(NUM | PERCENTAGE) | hue-rotate(ANGLE) | invert(NUM | PERCENTAGE) | opacity(NUM | PERCENTAGE)\n                | saturate(NUM | PERCENTAGE) | sepia(NUM | PERCENTAGE);\nFILTER_FUNCTION_LIST = FILTER_FUNCTION+;\n[webkit]filter = none | FILTER_FUNCTION_LIST;\n\nopacity = NUM;\n\n[moz,webkit]column-width = LENGTH | auto;\n[moz,webkit]column-count = INT | auto;\n[moz,webkit]column-gap = LENGTH | normal;\n[moz,webkit]column-rule-color = COLOR;\n[moz,webkit]column-rule-style = BORDER_SIDE_STYLE;\n[moz,webkit]column-rule-width = BORDER_SIDE_WIDTH;\nBREAK = auto | avoid | avoid-page | page | left | right | recto | verso | avoid-column | column | avoid-region | region;\nbreak-before = BREAK;\nbreak-after = BREAK;\nbreak-inside = auto | avoid | avoid-page | avoid-column | avoid-region;\n[webkit]column-span = none | auto | all;\n[moz]column-fill = auto | balance | balance-all;\n\nsrc = COMMA([SPACE(URI format(STRING+)?) | local(FAMILY)]+); /* for font-face */\n\n[epubx,webkit]flow-from = IDENT;\n[epubx,webkit]flow-into = IDENT;\n[epubx]flow-linger = INT | none;\n[epubx]flow-priority = INT;\n[epubx]flow-options = none | [ exclusive || last || static ];\n[epubx]page = INT | auto;\n[epubx]min-page-width = LENGTH;\n[epubx]min-page-height = LENGTH;\n[epubx]required = true | false;\n[epubx]enabled = true | false;\n[epubx]conflicting-partitions = COMMA(IDENT+);\n[epubx]required-partitions = COMMA(IDENT+);\n[epubx]snap-height = LENGTH | none;\n[epubx]snap-width = LENGTH | none;\n[epubx]flow-consume = all | some;\n[epubx]utilization = NUM;\n[epubx]text-zoom = font-size | scale;\n\n[adapt]template = URI_OR_NONE;\n[adapt]behavior = IDENT;\n\n/* CSS Fonts */\nfont-size-adjust = none | NNEG_NUM;\n[webkit]font-kerning = auto | normal | none;\nfont-variant-east-asian = normal | [[ jis78 | jis83 | jis90 | jis04 | simplified | traditional ] || [ full-width | proportional-width ] || ruby];\nfont-feature-settings = COMMA( SPACE( STRING [ on | off | INT ]? )+ );\nfont-stretch = normal | wider | narrower | ultra-condensed | extra-condensed | condensed | semi-condensed | semi-expanded | expanded | extra-expanded | ultra-expanded;\n\n/* CSS Images */\nimage-resolution = RESOLUTION;\nobject-fit = fill | contain | cover | none | scale-down;\nobject-position = COMMA( SPACE(BG_POSITION_TERM{1,4})+ ); /* relaxed */\n\n/* CSS Paged Media */\nPAGE_SIZE = a5 | a4 | a3 | b5 | b4 | jis-b5 | jis-b4 | letter | legal | ledger;\nbleed = auto | LENGTH;\nmarks = none | [ crop || cross ];\nsize = POS_LENGTH{1,2} | auto | [ PAGE_SIZE || [ portrait | landscape ] ];\n\n/* CSS Page Floats */\nfloat-reference = inline | column | region | page;\nfloat = block-start | block-end | inline-start | inline-end | snap-block | snap-inline | left | right | top | bottom | none | footnote;\nfloat-min-wrap-block = PPLENGTH;\n\n/* CSS Ruby */\nruby-align = start | center | space-between | space-around;\nruby-position = over | under | inter-character;\n\n/* CSS Size Adjust */\n[moz,ms]text-size-adjust = auto | none | POS_PERCENTAGE;\n\n/* CSS Text */\n[ms,webkit]line-break = auto | loose | normal | strict;\noverflow-wrap = normal | break-word;\n[moz]tab-size = NNEG_INT | NNEG_LENGTH;\n[moz,ms]text-align-last = auto | start | end | left | right | center | justify;\n[ms]text-justify = auto | none | inter-word | inter-character | inter-ideograph /* specified in UA stylesheet for IE */;\n[ms]word-break = normal | keep-all | break-all | break-word;\n[ms]word-wrap = normal | break-word;\n\n/* CSS Text Decoration */\n[webkit]text-decoration-color = COLOR;\n[webkit]text-decoration-line = none | [ underline || overline || line-through || blink ];\n[webkit]text-decoration-skip = none | [ objects || spaces || ink || edges || box-decoration ];\n[webkit]text-decoration-style = solid | double | dotted | dashed | wavy;\n[epub,webkit]text-emphasis-color = COLOR;\n[webkit]text-emphasis-position = [ over | under ] [ right | left ];\n[epub,webkit]text-emphasis-style = none | [[ filled | open ] || [ dot | circle | double-circle | triangle | sesame ]] | STRING;\n[ms,webkit]text-underline-position = auto | [ under || [ left | right ]];\n\n/* CSS Transforms */\n[ms,webkit]backface-visibility = visible | hidden;\n\n/* CSS UI */\nbox-sizing = content-box | padding-box | border-box;\n[ms]text-overflow = [clip | ellipsis | STRING]{1,2};\n\n/* CSS Writing Modes */\n[webkit]text-combine = none | horizontal;\n[epub,ms]text-combine-horizontal = none | all | [ digits POS_INT? ]; /* relaxed */\ntext-combine-upright = none | all | [ digits POS_INT? ]; /* relaxed */\n[epub,webkit]text-orientation = mixed | upright | sideways-right | sideways-left | sideways | use-glyph-orientation /* the following values are kept for backward-compatibility */ | vertical-right | rotate-right | rotate-left | rotate-normal | auto;\nunicode-bidi = normal | embed | isolate | bidi-override | isolate-override | plaintext;\n[epub,webkit]writing-mode = horizontal-tb | vertical-rl | lr-tb | rl-tb | tb-rl | lr | rl | tb;\n\n/* CSS Flex box */\nFLEX_BASIS = content | PAPLENGTH;\nflex-direction = row | row-reverse | column | column-reverse;\nflex-wrap = nowrap | wrap | wrap-reverse;\norder = INT;\nflex-grow = NNEG_NUM;\nflex-shrink = NNEG_NUM;\nflex-basis = FLEX_BASIS;\nflex = none | [ [ NNEG_NUM NNEG_NUM? ] || FLEX_BASIS ];\njustify-content = flex-start | flex-end | center | space-between | space-around;\nalign-items = flex-start | flex-end | center | baseline | stretch;\nalign-self = auto | flex-start | flex-end | center | baseline | stretch;\nalign-content = flex-start | flex-end | center | space-between | space-around | stretch;\n\n/* Pointer Events */\n[ms]touch-action = auto | none | [ pan-x || pan-y ] | manipulation;\n\n/* SVG 2 */\nOPACITY_VALUE = NUM | PERCENTAGE;\nDASH_ARRAY = COMMA( SPACE( [ LENGTH | PERCENTAGE | NUM ]+ )+ );\nPAINT = none | child | child(INT) | COLOR | SPACE( URI [none | COLOR]? ) | context-fill | context-stroke;\ncolor-interpolation = auto | sRGB | linearRGB;\ncolor-rendering = auto | optimizeSpeed | optimizeQuality;\nfill = PAINT;\nfill-opacity = OPACITY_VALUE;\nfill-rule = nonzero | evenodd;\nglyph-orientation-vertical = auto | NUM | ANGLE;\nimage-rendering = auto | optimizeSpeed | optimizeQuality | crisp-edges | pixelated;\nmarker-start = none | URI;\nmarker-mid = none | URI;\nmarker-end = none | URI;\npointer-events = bounding-box | visiblePainted | visibleFill | visibleStroke | visible | painted | fill | stroke | all | none;\npaint-order = normal | [ fill || stroke || markers ];\nshape-rendering = auto | optimizeSpeed | crispEdges | geometricPrecision;\nstop-color = COLOR;\nstop-opacity = OPACITY_VALUE;\nstroke = PAINT;\nstroke-dasharray = none | DASH_ARRAY;\nstroke-dashoffset = PERCENTAGE | LENGTH_OR_NUM;\nstroke-linecap = butt | round | square;\nstroke-linejoin = miter | round | bevel;\nstroke-miterlimit = NUM;\nstroke-opacity = OPACITY_VALUE;\nstroke-width = PERCENTAGE | LENGTH_OR_NUM;\ntext-anchor = start | middle | end;\ntext-rendering = auto | optimizeSpeed | optimizeLegibility | geometricPrecision;\nvector-effect = none | SPACE( [ non-scaling-stroke | non-scaling-size | non-rotation | fixed-position ]+ [ viewport | screen ]? );\n\n/* SVG 1.1 */\nalignment-baseline = auto | baseline | before-edge | text-before-edge | middle | central | after-edge | text-after-edge | ideographic | alphabetic | hanging | mathematical;\nbaseline-shift = baseline | sub | super | PERCENTAGE | LENGTH_OR_NUM;\ndominant-baseline = auto | use-script | no-change | reset-size | ideographic | alphabetic | hanging | mathematical | central | middle | text-after-edge | text-before-edge;\nmask = none | URI;\n\n/* css-masking-1 */\nSHAPE_RADIUS = PLENGTH | closest-side | farthest-side;\nFILL_RULE = nonzero | evenodd;\nSHAPE_BOX = BOX | margin-box;\nGEOMETRY_BOX = SHAPE_BOX | fill-box | stroke-box | view-box;\nBASIC_SHAPE =\n    inset( SPACE( PLENGTH{1,4} [ round PLENGTH{1,4} [ SLASH PLENGTH{1,4} ]? ]? ) )\n  | circle(  SPACE( [SHAPE_RADIUS]?    [at BG_POSITION_TERM{1,4}]? ) )\n  | ellipse( SPACE( SHAPE_RADIUS{2}? [at BG_POSITION_TERM{1,4}]? ) )\n  | polygon( FILL_RULE? COMMA( SPACE( PLENGTH{2} )+ )+ );\n[webkit]clip-path = none | URI | [ BASIC_SHAPE || GEOMETRY_BOX ];\nclip-rule = nonzero | evenodd;\n\n/* filters */\nflood-color = COLOR;\nflood-opacity = OPACITY_VALUE;\nlighting-color = COLOR;\n\n/* compositing-1 */\nBLEND_MODE = normal | multiply | screen | overlay | darken | lighten | color-dodge | color-burn | hard-light | soft-light | difference | exclusion | hue | saturation | color | luminosity;\nmix-blend-mode = BLEND_MODE;\nisolation = auto | isolate;\nbackground-blend-mode = COMMA( BLEND_MODE+ );\n\n/* CSS GCPM */\nfootnote-policy = auto | line;\n\n[viv]repeat-on-break = auto | none | header | footer;\n\nDEFAULTS\n\nbackground-attachment: scroll;\nbackground-color: transparent;\nbackground-image: none;\nbackground-repeat: repeat;\nbackground-position: 0% 0%;\nbackground-clip: border-box;\nbackground-origin: padding-box;\nbackground-size: auto;\nborder-top-color: currentColor;\nborder-right-color: currentColor;\nborder-bottom-color: currentColor;\nborder-left-color: currentColor;\nborder-top-style: none;\nborder-right-style: none;\nborder-bottom-style: none;\nborder-left-style: none;\nborder-top-width: 3px;\nborder-right-width: 3px;\nborder-bottom-width: 3px;\nborder-left-width: 3px;\nborder-top-left-radius: 0;\nborder-top-right-radius: 0;\nborder-bottom-right-radius: 0;\nborder-bottom-left-radius: 0;\nborder-image-source: none;\nborder-image-slice: 100%;\nborder-image-width: 1;\nborder-image-outset: 0;\nborder-image-repeat: stretch;\ncolumn-count: auto;\ncolumn-gap: normal;\ncolumn-width: auto;\ncolumn-rule-color: currentColor;\ncolumn-rule-style: none;\ncolumn-rule-width: 3px;\ncolumn-fill: balance;\noutline-color: currentColor;\noutline-style: none;\noutline-width: 3px;\nflex-direction: row;\nflex-wrap: nowrap;\nfont-family: serif;\nfont-style: normal;\nfont-size: medium;\nfont-variant: normal;\nfont-weight: normal;\nfont-stretch: normal;\nline-height: normal;\nlist-style-image: none;\nlist-style-position: outside;\nlist-style-type: disc;\nmargin-bottom: auto;\nmargin-left: auto;\nmargin-right: auto;\nmargin-top: auto;\npadding-bottom: auto;\npadding-left: auto;\npadding-right: auto;\npadding-top: auto;\ntext-emphasis-color: currentColor;\ntext-emphasis-style: none;\nmarker-start: none;\nmarker-mid: none;\nmarker-end: none;\n\n/* css-logical */\nborder-block-start-color: currentColor;\nborder-block-end-color: currentColor;\nborder-inline-start-color: currentColor;\nborder-inline-end-color: currentColor;\nborder-block-start-style: none;\nborder-block-end-style: none;\nborder-inline-start-style: none;\nborder-inline-end-style: none;\nborder-block-start-width: 3px;\nborder-block-end-width: 3px;\nborder-inline-start-width: 3px;\nborder-inline-end-width: 3px;\n\nSHORTHANDS\n\nbackground = COMMA background-image [background-position [ / background-size ]] background-repeat\n     background-attachment [background-origin background-clip] background-color; /* background-color is a special case, see the code */\nborder-top = border-top-width border-top-style border-top-color;\nborder-right = border-right-width border-right-style border-right-color;\nborder-bottom = border-bottom-width border-bottom-style border-bottom-color;\nborder-left = border-left-width border-left-style border-left-color;\nborder-width = INSETS border-top-width border-right-width border-bottom-width border-left-width;\nborder-style = INSETS border-top-style border-right-style border-bottom-style border-left-style;\nborder-color = INSETS border-top-color border-right-color border-bottom-color border-left-color;\nborder = border-width border-style border-color;\nborder-image = border-image-source border-image-slice [ / border-image-width [ / border-image-outset ] ]\n     border-image-repeat;\nborder-radius = INSETS_SLASH border-top-left-radius border-top-right-radius\n     border-bottom-right-radius border-bottom-left-radius;\n[moz,webkit]columns = column-width column-count;\n[moz,webkit]column-rule = column-rule-width column-rule-style column-rule-color;\nflex-flow = flex-direction flex-wrap;\noeb-column-number = column-count;\noutline = outline-width outline-style outline-color;\nlist-style = list-style-type list-style-position list-style-image;\nmargin = INSETS margin-top margin-right margin-bottom margin-left;\npadding = INSETS padding-top padding-right padding-bottom padding-left;\npause = INSETS pause-before pause-after;\nfont = FONT font-style font-variant font-weight font-stretch /* font-size line-height font-family are special-cased */;\n[epub,webkit]text-emphasis = text-emphasis-style text-emphasis-color;\nmarker = INSETS marker-start marker-mid marker-end;\n\n/* css-logical */\nmargin-block = INSETS margin-block-start margin-block-end;\nmargin-inline = INSETS margin-inline-start margin-inline-end;\npadding-block = INSETS padding-block-start padding-block-end;\npadding-inline = INSETS padding-inline-start padding-inline-end;\nborder-block-width = INSETS border-block-start-width border-block-end-width;\nborder-block-style = INSETS border-block-start-style border-block-end-style;\nborder-block-color = INSETS border-block-start-color border-block-end-color;\nborder-inline-width = INSETS border-inline-start-width border-inline-end-width;\nborder-inline-style = INSETS border-inline-start-style border-inline-end-style;\nborder-inline-color = INSETS border-inline-start-color border-inline-end-color;\nborder-block = border-block-width border-block-style border-block-color;\nborder-inline = border-inline-width border-inline-style border-inline-color;\nborder-block-start = border-block-start-width border-block-start-style border-block-start-color;\nborder-block-end = border-block-end-width border-block-end-style border-block-end-color;\nborder-inline-start = border-inline-start-width border-inline-start-style border-inline-start-color;\nborder-inline-end = border-inline-end-width border-inline-end-style border-inline-end-color;\ninset-block-start = block-start;\ninset-block-end = block-end;\ninset-inline-start = inline-start;\ninset-inline-end = inline-end;\ninset-block = INSETS block-start block-end;\ninset-inline = INSETS inline-start inline-end;\n\n/* old names  */\n[adapt,webkit]margin-before = margin-block-start;\n[adapt,webkit]margin-after = margin-block-end;\n[adapt,webkit]margin-start = margin-inline-start;\n[adapt,webkit]margin-end = margin-inline-end;\n[adapt,webkit]padding-before = padding-block-start;\n[adapt,webkit]padding-after = padding-block-end;\n[adapt,webkit]padding-start = padding-inline-start;\n[adapt,webkit]padding-end = padding-inline-end;\n[adapt,webkit]border-before-color = border-block-start-color;\n[adapt,webkit]border-after-color = border-block-end-color;\n[adapt,webkit]border-start-color = border-inline-start-color;\n[adapt,webkit]border-end-color = border-inline-end-color;\n[adapt,webkit]border-before-style = border-block-start-style;\n[adapt,webkit]border-after-style = border-block-end-style;\n[adapt,webkit]border-start-style = border-inline-start-style;\n[adapt,webkit]border-end-style = border-inline-end-style;\n[adapt,webkit]border-before-width = border-block-start-width;\n[adapt,webkit]border-after-width = border-block-end-width;\n[adapt,webkit]border-start-width = border-inline-start-width;\n[adapt,webkit]border-end-width = border-inline-end-width;\n[adapt,webkit]before = block-start;\n[adapt,webkit]after = block-end;\n[adapt,webkit]start = inline-start;\n[adapt,webkit]end = inline-end;\n\n',
        ),
        t3
      );
    }
    var Au = {
      'font-style': Ye.normal,
      'font-variant': Ye.normal,
      'font-weight': Ye.normal,
    };
    var Lu = 'OTTO' + new Date().valueOf();
    var Ou = 1;
    function ku(t3, e3) {
      var n3 = {};
      for (var i3 in t3) n3[i3] = Vr(t3, i3).evaluate(e3, i3);
      return (
        (function (t4) {
          for (var e4 in Au) t4[e4] || (t4[e4] = Au[e4]);
        })(n3),
        n3
      );
    }
    var Fu = (function () {
      function t3(t4) {
        (this.properties = t4),
          (this.blobURLs = []),
          (this.blobs = []),
          (this.fontTraitKey = (function (t5) {
            var e5 = new et();
            for (var n3 in Au) e5.append(' '), e5.append(t5[n3].toString());
            return e5.toString();
          })(this.properties)),
          (this.src = this.properties.src
            ? this.properties.src.toString()
            : null);
        var e4 = this.properties['font-family'];
        this.family = e4 ? e4.stringValue() : null;
      }
      var e3 = t3.prototype;
      return (
        (e3.traitsEqual = function (t4) {
          return this.fontTraitKey == t4.fontTraitKey;
        }),
        (e3.makeAtRule = function (t4, e4) {
          var n3 = new et();
          for (var i3 in (n3.append('@font-face {\n  font-family: '),
          n3.append(this.family),
          n3.append(';\n  '),
          Au))
            n3.append(i3),
              n3.append(': '),
              this.properties[i3].appendTo(n3, true),
              n3.append(';\n  ');
          if (e4) {
            n3.append('src: url("');
            var r3 = (window.URL || window.webkitURL).createObjectURL(e4);
            n3.append(r3),
              this.blobURLs.push(r3),
              this.blobs.push(e4),
              n3.append('")');
          } else n3.append('src: '), n3.append(t4);
          return n3.append(';\n}\n'), n3.toString();
        }),
        t3
      );
    })();
    var Du = (function () {
      function t3(t4) {
        (this.deobfuscator = t4), (this.familyMap = {});
      }
      var e3 = t3.prototype;
      return (
        (e3.registerFamily = function (t4, e4) {
          var n3 = t4.family,
            i3 = this.familyMap[n3],
            r3 = e4.family;
          if (i3) {
            if (i3 != r3)
              throw new Error('E_FONT_FAMILY_INCONSISTENT ' + t4.family);
          } else this.familyMap[n3] = r3;
        }),
        (e3.filterFontFamily = function (t4) {
          if (t4 instanceof ze) {
            for (var e4, n3 = [], i3 = D(t4.values); !(e4 = i3()).done; ) {
              var r3 = e4.value,
                o3 = this.familyMap[r3.stringValue()];
              o3 && n3.push(Fe(o3)), n3.push(r3);
            }
            return new ze(n3);
          }
          var a3 = this.familyMap[t4.stringValue()];
          return a3 ? new ze([Fe(a3), t4]) : t4;
        }),
        t3
      );
    })();
    var _u = (function () {
      function t3(t4, e4, n3) {
        (this.head = t4),
          (this.body = e4),
          (this.srcURLMap = {}),
          (this.familyCounter = 0),
          (this.familyPrefix = n3 || 'Fnt_');
      }
      var e3 = t3.prototype;
      return (
        (e3.getViewFontFamily = function (t4, e4) {
          var n3 = t4.family,
            i3 = e4.familyMap[n3];
          return (
            i3 ||
            ((i3 = this.familyPrefix + ++this.familyCounter),
            (e4.familyMap[n3] = i3),
            i3)
          );
        }),
        (e3.initFont = function (t4, e4, n3) {
          var i3 = bi('initFont'),
            r3 = this,
            o3 = t4.src,
            a3 = {};
          for (var s3 in Au) a3[s3] = t4.properties[s3];
          var l3 = r3.getViewFontFamily(t4, n3);
          a3['font-family'] = Fe(l3);
          var u3 = new Fu(a3),
            h3 = r3.body.ownerDocument.createElement('span');
          h3.textContent = 'M';
          var f3 = new Date().valueOf() + 1e3,
            d3 = r3.head.ownerDocument.createElement('style'),
            p3 = Lu + Ou++;
          for (var g3 in ((d3.textContent = u3.makeAtRule('', Mi([p3]))),
          r3.head.appendChild(d3),
          r3.body.appendChild(h3),
          (h3.style.visibility = 'hidden'),
          (h3.style.fontFamily = l3),
          Au))
            $2(h3, g3, a3[g3].toString());
          var m3 = h3.getBoundingClientRect(),
            v3 = m3.right - m3.left,
            E2 = m3.bottom - m3.top;
          (d3.textContent = u3.makeAtRule(o3, e4)),
            c2.info('Starting to load font:', o3);
          var y3 = false;
          return (
            i3
              .loop(function () {
                var t5 = h3.getBoundingClientRect();
                return v3 != t5.right - t5.left || E2 != t5.bottom - t5.top
                  ? ((y3 = true), Si(false))
                  : new Date().valueOf() > f3
                  ? Si(false)
                  : i3.sleep(10);
              })
              .then(function () {
                y3
                  ? c2.info('Loaded font:', o3)
                  : c2.warn('Failed to load font:', o3),
                  r3.body.removeChild(h3),
                  i3.finish(u3);
              }),
            i3.result()
          );
        }),
        (e3.loadFont = function (t4, e4) {
          var n3 = t4.src,
            i3 = this.srcURLMap[n3],
            r3 = this;
          return (
            i3
              ? i3.piggyback(function (i4) {
                  var r4 = i4;
                  r4.traitsEqual(t4)
                    ? (e4.registerFamily(t4, r4),
                      c2.warn('Found already-loaded font:', n3))
                    : c2.warn('E_FONT_FACE_INCOMPATIBLE', t4.src);
                })
              : ((i3 = new Fi(function () {
                  var i4 = bi('loadFont'),
                    o3 = e4.deobfuscator ? e4.deobfuscator(n3) : null;
                  return (
                    o3
                      ? Bi(n3, Ti.BLOB).then(function (n4) {
                          n4.responseBlob
                            ? o3(n4.responseBlob).then(function (n5) {
                                r3.initFont(t4, n5, e4).thenFinish(i4);
                              })
                            : i4.finish(null);
                        })
                      : r3.initFont(t4, null, e4).thenFinish(i4),
                    i4.result()
                  );
                }, 'loadFont ' + n3)),
                (this.srcURLMap[n3] = i3),
                i3.start()),
            i3
          );
        }),
        (e3.findOrLoadFonts = function (t4, e4) {
          for (var n3, i3 = [], r3 = D(t4); !(n3 = r3()).done; ) {
            var o3 = n3.value;
            o3.src && o3.family
              ? i3.push(this.loadFont(o3, e4))
              : c2.warn('E_FONT_FACE_INVALID');
          }
          return Di(i3);
        }),
        t3
      );
    })();
    var Bu = 1;
    var Mu = (function () {
      function t3(t4, e4, n3, i3, r3) {
        (this.name = e4),
          (this.pseudoName = n3),
          (this.classes = i3),
          (this.parent = r3),
          (this.specified = {}),
          (this.children = []),
          (this.pageMaster = null),
          (this.index = 0),
          (this._scope = t4),
          (this.key = 'p' + Bu++),
          r3 && ((this.index = r3.children.length), r3.children.push(this));
      }
      var e3 = t3.prototype;
      return (
        (e3.createInstance = function (t4) {
          throw new Error('E_UNEXPECTED_CALL');
        }),
        (e3.clone = function (t4) {
          throw new Error('E_UNEXPECTED_CALL');
        }),
        (e3.copySpecified = function (t4) {
          var e4 = this.specified,
            n3 = t4.specified;
          for (var i3 in e4)
            Object.prototype.hasOwnProperty.call(e4, i3) && (n3[i3] = e4[i3]);
        }),
        (e3.cloneChildren = function (t4) {
          for (var e4 = 0; e4 < this.children.length; e4++)
            this.children[e4].clone({ parent: t4 });
        }),
        x2(t3, [
          {
            key: 'scope',
            get: function () {
              return this._scope;
            },
          },
        ]),
        t3
      );
    })();
    var Uu = (function (t3) {
      function e3(e4) {
        var n3;
        return (
          ((n3 =
            t3.call(this, e4, null, null, [], null) ||
            this).specified.width = new kr(qe, 0)),
          (n3.specified.height = new kr(Qe, 0)),
          n3
        );
      }
      return I2(e3, t3), e3;
    })(Mu);
    var Vu = (function (t3) {
      function e3(e4, n3) {
        var i3;
        (i3 =
          t3.call(this, e4, function (t4, e5) {
            var n4 = t4.match(/^([^.]+)\.([^.]+)$/);
            if (n4) {
              var i4 = r3.pageMaster.keyMap[n4[1]];
              if (i4) {
                var o3 = this.lookupInstance(i4);
                if (o3)
                  return e5 ? o3.resolveFunc(n4[2]) : o3.resolveName(n4[2]);
              }
            }
            return null;
          }) || this).pageMaster = n3;
        var r3 = k2(i3);
        return i3;
      }
      return I2(e3, t3), e3;
    })(Bt);
    var Hu = (function (t3) {
      function e3(e4, n4, i3, r3, o3, a3, s3) {
        var l3;
        return (
          ((l3 = t3.call(this, e4, n4, i3, r3, o3) || this).condition = a3),
          (l3.specificity = s3),
          (l3.keyMap = {}),
          e4 instanceof Vu || (l3._scope = new Vu(e4, k2(l3))),
          (l3.pageMaster = k2(l3)),
          (l3.specified.width = new kr(qe, 0)),
          (l3.specified.height = new kr(Qe, 0)),
          (l3.specified['wrap-flow'] = new kr(Ye.auto, 0)),
          (l3.specified.position = new kr(Ye.relative, 0)),
          (l3.specified.overflow = new kr(Ye.visible, 0)),
          l3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.createInstance = function (t4) {
          return new ih(t4, this);
        }),
        (n3.clone = function (t4) {
          var n4 = new e3(
            this.scope,
            this.name,
            t4.pseudoName || this.pseudoName,
            this.classes,
            this.parent,
            this.condition,
            this.specificity,
          );
          return this.copySpecified(n4), this.cloneChildren(n4), n4;
        }),
        (n3.resetScope = function () {
          this.scope.pageMaster = this;
        }),
        e3
      );
    })(Mu);
    var zu = (function (t3) {
      function e3(e4, n4, i3, r3, o3) {
        var a3;
        return (
          ((a3 = t3.call(this, e4, n4, i3, r3, o3) || this).pageMaster =
            o3.pageMaster),
          n4 && (a3.pageMaster.keyMap[n4] = a3.key),
          (a3.specified['wrap-flow'] = new kr(Ye.auto, 0)),
          a3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.createInstance = function (t4) {
          return new rh(t4, this);
        }),
        (n3.clone = function (t4) {
          var n4 = new e3(
            t4.parent.scope,
            this.name,
            this.pseudoName,
            this.classes,
            t4.parent,
          );
          return this.copySpecified(n4), this.cloneChildren(n4), n4;
        }),
        e3
      );
    })(Mu);
    var Gu = (function (t3) {
      function e3(e4, n4, i3, r3, o3) {
        var a3;
        return (
          ((a3 = t3.call(this, e4, n4, i3, r3, o3) || this).pageMaster =
            o3.pageMaster),
          n4 && (a3.pageMaster.keyMap[n4] = a3.key),
          a3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.createInstance = function (t4) {
          return new oh(t4, this);
        }),
        (n3.clone = function (t4) {
          var n4 = new e3(
            t4.parent.scope,
            this.name,
            this.pseudoName,
            this.classes,
            t4.parent,
          );
          return this.copySpecified(n4), this.cloneChildren(n4), n4;
        }),
        e3
      );
    })(Mu);
    function Wu(t3, e3, n3) {
      return e3 && e3 !== Ye.auto ? e3.toExpr(t3, n3) : null;
    }
    function Xu(t3, e3, n3) {
      return e3 && e3 !== Ye.auto ? e3.toExpr(t3, n3) : t3.zero;
    }
    function ju(t3, e3, n3) {
      return e3 ? (e3 === Ye.auto ? null : e3.toExpr(t3, n3)) : t3.zero;
    }
    function Yu(t3, e3, n3, i3) {
      return e3 && n3 !== Ye.none ? e3.toExpr(t3, i3) : t3.zero;
    }
    function Ku(t3, e3, n3) {
      return e3
        ? e3 === Ye._true
          ? t3._true
          : e3 === Ye._false
          ? t3._false
          : e3.toExpr(t3, t3.zero)
        : n3;
    }
    var qu = (function () {
      function t3(t4, e4) {
        (this.parentInstance = t4),
          (this.pageBox = e4),
          (this.cascaded = {}),
          (this.style = {}),
          (this.autoWidth = null),
          (this.autoHeight = null),
          (this.children = []),
          (this.isAutoWidth = false),
          (this.isAutoHeight = false),
          (this.isTopDependentOnAutoHeight = false),
          (this.isRightDependentOnAutoWidth = false),
          (this.calculatedWidth = 0),
          (this.calculatedHeight = 0),
          (this.pageMasterInstance = null),
          (this.namedValues = {}),
          (this.namedFuncs = {}),
          (this.vertical = false),
          (this.rtl = false),
          (this.suppressEmptyBoxGeneration = false),
          t4 && t4.children.push(this);
      }
      var e3 = t3.prototype;
      return (
        (e3.reset = function () {
          (this.calculatedWidth = 0), (this.calculatedHeight = 0);
        }),
        (e3.addNamedValues = function (t4, e4) {
          var n3 = this.resolveName(t4),
            i3 = this.resolveName(e4);
          if (!n3 || !i3) throw new Error('E_INTERNAL');
          return be(this.pageBox.scope, n3, i3);
        }),
        (e3.resolveName = function (t4) {
          var e4 = this.namedValues[t4];
          if (e4) return e4;
          var n3 = this.style[t4];
          switch (
            (n3 &&
              (e4 = n3.toExpr(this.pageBox.scope, this.pageBox.scope.zero)),
            t4)
          ) {
            case 'margin-left-edge':
              e4 = this.resolveName('left');
              break;
            case 'margin-top-edge':
              e4 = this.resolveName('top');
              break;
            case 'margin-right-edge':
              e4 = this.addNamedValues('border-right-edge', 'margin-right');
              break;
            case 'margin-bottom-edge':
              e4 = this.addNamedValues('border-bottom-edge', 'margin-bottom');
              break;
            case 'border-left-edge':
              e4 = this.addNamedValues('margin-left-edge', 'margin-left');
              break;
            case 'border-top-edge':
              e4 = this.addNamedValues('margin-top-edge', 'margin-top');
              break;
            case 'border-right-edge':
              e4 = this.addNamedValues(
                'padding-right-edge',
                'border-right-width',
              );
              break;
            case 'border-bottom-edge':
              e4 = this.addNamedValues(
                'padding-bottom-edge',
                'border-bottom-width',
              );
              break;
            case 'padding-left-edge':
              e4 = this.addNamedValues('border-left-edge', 'border-left-width');
              break;
            case 'padding-top-edge':
              e4 = this.addNamedValues('border-top-edge', 'border-top-width');
              break;
            case 'padding-right-edge':
              e4 = this.addNamedValues('right-edge', 'padding-right');
              break;
            case 'padding-bottom-edge':
              e4 = this.addNamedValues('bottom-edge', 'padding-bottom');
              break;
            case 'left-edge':
              e4 = this.addNamedValues('padding-left-edge', 'padding-left');
              break;
            case 'top-edge':
              e4 = this.addNamedValues('padding-top-edge', 'padding-top');
              break;
            case 'right-edge':
              e4 = this.addNamedValues('left-edge', 'width');
              break;
            case 'bottom-edge':
              e4 = this.addNamedValues('top-edge', 'height');
          }
          if (!e4) {
            var i3;
            if ('extent' == t4) i3 = this.vertical ? 'width' : 'height';
            else if ('measure' == t4) i3 = this.vertical ? 'height' : 'width';
            else {
              var r3 = this.vertical ? Rr : Ar;
              for (var o3 in ((i3 = t4), r3)) i3 = i3.replace(o3, r3[o3]);
            }
            i3 != t4 && (e4 = this.resolveName(i3));
          }
          return e4 && (this.namedValues[t4] = e4), e4;
        }),
        (e3.resolveFunc = function (t4) {
          var e4 = this.namedFuncs[t4];
          if (e4) return e4;
          switch (t4) {
            case 'columns':
              var n3 = this.pageBox.scope,
                i3 = new we(n3, 0),
                r3 = this.resolveName('column-count'),
                o3 = this.resolveName('column-width'),
                a3 = this.resolveName('column-gap');
              e4 = Se(
                n3,
                Ce(n3, new me(n3, 'min', [i3, r3]), be(n3, o3, a3)),
                a3,
              );
          }
          return e4 && (this.namedFuncs[t4] = e4), e4;
        }),
        (e3.initEnabled = function () {
          var t4 = this.pageBox.scope,
            e4 = this.style,
            n3 = Ku(t4, e4.enabled, t4._true),
            i3 = Wu(t4, e4.page, t4.zero);
          if (i3) {
            var r3 = new de(t4, 'page-number');
            n3 = Ne(t4, n3, new oe(t4, i3, r3));
          }
          var o3 = Wu(t4, e4['min-page-width'], t4.zero);
          o3 && (n3 = Ne(t4, n3, new re(t4, new de(t4, 'page-width'), o3)));
          var a3 = Wu(t4, e4['min-page-height'], t4.zero);
          a3 && (n3 = Ne(t4, n3, new re(t4, new de(t4, 'page-height'), a3))),
            (n3 = this.boxSpecificEnabled(n3)),
            (e4.enabled = new We(n3));
        }),
        (e3.boxSpecificEnabled = function (t4) {
          return t4;
        }),
        (e3.initHorizontal = function () {
          var t4 = this.pageBox.scope,
            e4 = this.style,
            n3 = this.parentInstance
              ? this.parentInstance.style.width.toExpr(t4, null)
              : null,
            i3 = Wu(t4, e4.left, n3),
            r3 = Wu(t4, e4['margin-left'], n3),
            o3 = Yu(t4, e4['border-left-width'], e4['border-left-style'], n3),
            a3 = Xu(t4, e4['padding-left'], n3),
            s3 = Wu(t4, e4.width, n3),
            l3 = Wu(t4, e4['max-width'], n3),
            u3 = Xu(t4, e4['padding-right'], n3),
            h3 = Yu(t4, e4['border-right-width'], e4['border-right-style'], n3),
            c3 = Wu(t4, e4['margin-right'], n3),
            f3 = Wu(t4, e4.right, n3),
            d3 = be(t4, o3, a3),
            p3 = be(t4, o3, u3);
          if (i3 && f3 && s3) {
            var g3 = Se(t4, n3, be(t4, s3, be(t4, be(t4, i3, d3), p3)));
            r3
              ? c3
                ? (f3 = Se(t4, g3, c3))
                : (c3 = Se(t4, g3, be(t4, f3, r3)))
              : ((g3 = Se(t4, g3, f3)),
                c3
                  ? (r3 = Se(t4, g3, c3))
                  : (c3 = r3 = Ce(t4, g3, new Ee(t4, 0.5))));
          } else {
            r3 || (r3 = t4.zero),
              c3 || (c3 = t4.zero),
              i3 || f3 || s3 || (i3 = t4.zero),
              i3 || s3
                ? i3 || f3
                  ? s3 ||
                    f3 ||
                    ((s3 = this.autoWidth), (this.isAutoWidth = true))
                  : (i3 = t4.zero)
                : ((s3 = this.autoWidth), (this.isAutoWidth = true));
            var m3 = Se(t4, n3, be(t4, be(t4, r3, d3), be(t4, c3, p3)));
            this.isAutoWidth &&
              (l3 || (l3 = Se(t4, m3, i3 || f3)),
              this.vertical ||
                (!Wu(t4, e4['column-width'], null) &&
                  !Wu(t4, e4['column-count'], null)) ||
                ((s3 = l3), (this.isAutoWidth = false))),
              i3
                ? s3
                  ? f3 || (f3 = Se(t4, m3, be(t4, i3, s3)))
                  : (s3 = Se(t4, m3, be(t4, i3, f3)))
                : (i3 = Se(t4, m3, be(t4, f3, s3)));
          }
          var v3 = Xu(
            t4,
            e4['snap-width'] ||
              (this.parentInstance
                ? this.parentInstance.style['snap-width']
                : null),
            n3,
          );
          (e4.left = new We(i3)),
            (e4['margin-left'] = new We(r3)),
            (e4['border-left-width'] = new We(o3)),
            (e4['padding-left'] = new We(a3)),
            (e4.width = new We(s3)),
            (e4['max-width'] = new We(l3 || s3)),
            (e4['padding-right'] = new We(u3)),
            (e4['border-right-width'] = new We(h3)),
            (e4['margin-right'] = new We(c3)),
            (e4.right = new We(f3)),
            (e4['snap-width'] = new We(v3));
        }),
        (e3.initVertical = function () {
          var t4 = this.pageBox.scope,
            e4 = this.style,
            n3 = this.parentInstance
              ? this.parentInstance.style.width.toExpr(t4, null)
              : null,
            i3 = this.parentInstance
              ? this.parentInstance.style.height.toExpr(t4, null)
              : null,
            r3 = Wu(t4, e4.top, i3),
            o3 = Wu(t4, e4['margin-top'], n3),
            a3 = Yu(t4, e4['border-top-width'], e4['border-top-style'], n3),
            s3 = Xu(t4, e4['padding-top'], n3),
            l3 = Wu(t4, e4.height, i3),
            u3 = Wu(t4, e4['max-height'], i3),
            h3 = Xu(t4, e4['padding-bottom'], n3),
            c3 = Yu(
              t4,
              e4['border-bottom-width'],
              e4['border-bottom-style'],
              n3,
            ),
            f3 = Wu(t4, e4['margin-bottom'], n3),
            d3 = Wu(t4, e4.bottom, i3),
            p3 = be(t4, a3, s3),
            g3 = be(t4, c3, h3);
          if (r3 && d3 && l3) {
            var m3 = Se(t4, i3, be(t4, l3, be(t4, be(t4, r3, p3), g3)));
            o3
              ? f3
                ? (d3 = Se(t4, m3, o3))
                : (f3 = Se(t4, m3, be(t4, d3, o3)))
              : ((m3 = Se(t4, m3, d3)),
                f3
                  ? (o3 = Se(t4, m3, f3))
                  : (f3 = o3 = Ce(t4, m3, new Ee(t4, 0.5))));
          } else {
            o3 || (o3 = t4.zero),
              f3 || (f3 = t4.zero),
              r3 || d3 || l3 || (r3 = t4.zero),
              r3 || l3
                ? r3 || d3
                  ? l3 ||
                    d3 ||
                    ((l3 = this.autoHeight), (this.isAutoHeight = true))
                  : (r3 = t4.zero)
                : ((l3 = this.autoHeight), (this.isAutoHeight = true));
            var v3 = Se(t4, i3, be(t4, be(t4, o3, p3), be(t4, f3, g3)));
            this.isAutoHeight &&
              (u3 || (u3 = Se(t4, v3, r3 || d3)),
              this.vertical &&
                (Wu(t4, e4['column-width'], null) ||
                  Wu(t4, e4['column-count'], null)) &&
                ((l3 = u3), (this.isAutoHeight = false))),
              r3
                ? l3
                  ? d3 || (d3 = Se(t4, v3, be(t4, r3, l3)))
                  : (l3 = Se(t4, v3, be(t4, d3, r3)))
                : (r3 = Se(t4, v3, be(t4, d3, l3)));
          }
          var E2 = Xu(
            t4,
            e4['snap-height'] ||
              (this.parentInstance
                ? this.parentInstance.style['snap-height']
                : null),
            n3,
          );
          (e4.top = new We(r3)),
            (e4['margin-top'] = new We(o3)),
            (e4['border-top-width'] = new We(a3)),
            (e4['padding-top'] = new We(s3)),
            (e4.height = new We(l3)),
            (e4['max-height'] = new We(u3 || l3)),
            (e4['padding-bottom'] = new We(h3)),
            (e4['border-bottom-width'] = new We(c3)),
            (e4['margin-bottom'] = new We(f3)),
            (e4.bottom = new We(d3)),
            (e4['snap-height'] = new We(E2));
        }),
        (e3.initColumns = function () {
          var t4 = this.pageBox.scope,
            e4 = this.style,
            n3 = Wu(t4, e4[this.vertical ? 'height' : 'width'], null),
            i3 = Wu(t4, e4['column-width'], n3),
            r3 = Wu(t4, e4['column-count'], null),
            o3 = (function (t5, e5, n4) {
              return e5 && e5 !== Ye.normal ? e5.toExpr(t5, null) : null;
            })(t4, e4['column-gap']);
          o3 || (o3 = new fe(t4, 1, 'em')),
            i3 &&
              !r3 &&
              ((r3 = new me(t4, 'floor', [
                Te(t4, be(t4, n3, o3), be(t4, i3, o3)),
              ])),
              (r3 = new me(t4, 'max', [t4.one, r3]))),
            r3 || (r3 = t4.one),
            (i3 = Se(t4, Te(t4, be(t4, n3, o3), r3), o3)),
            (e4['column-width'] = new We(i3)),
            (e4['column-count'] = new We(r3)),
            (e4['column-gap'] = new We(o3));
        }),
        (e3.depends = function (t4, e4, n3) {
          return this.style[t4].toExpr(this.pageBox.scope, null).depend(e4, n3);
        }),
        (e3.init = function (t4) {
          t4.registerInstance(this.pageBox.key, this);
          var e4 = this.pageBox.scope,
            n3 = this.style,
            i3 = this,
            r3 = this.parentInstance
              ? this.parentInstance.getActiveRegions(t4)
              : null,
            o3 = aa(this.cascaded, t4, r3, false);
          (this.vertical = ra(
            o3,
            t4,
            !!this.parentInstance && this.parentInstance.vertical,
          )),
            (this.rtl = oa(
              o3,
              t4,
              !!this.parentInstance && this.parentInstance.rtl,
            )),
            ua(o3, n3, this.vertical, this.rtl, function (t5, e5) {
              return e5.value;
            }),
            (this.autoWidth = new ge(
              e4,
              function () {
                return i3.calculatedWidth;
              },
              'autoWidth',
            )),
            (this.autoHeight = new ge(
              e4,
              function () {
                return i3.calculatedHeight;
              },
              'autoHeight',
            )),
            this.initHorizontal(),
            this.initVertical(),
            this.initColumns(),
            this.initEnabled();
        }),
        (e3.getProp = function (t4, e4) {
          var n3 = this.style[e4];
          return n3 && (n3 = gr(t4, n3, e4)), n3;
        }),
        (e3.getPropAsNumber = function (t4, e4) {
          var n3 = this.style[e4];
          return n3 && (n3 = gr(t4, n3, e4)), Xe(n3, t4);
        }),
        (e3.getSpecial = function (t4, e4) {
          var n3 = Xr(this.cascaded, e4);
          if (n3) {
            for (var i3 = [], r3 = 0; r3 < n3.length; r3++) {
              var o3 = n3[r3].evaluate(t4, '');
              o3 && o3 !== Re && i3.push(o3);
            }
            if (i3.length) return i3;
          }
          return null;
        }),
        (e3.getActiveRegions = function (t4) {
          var e4 = this.getSpecial(t4, 'region-id');
          if (e4) {
            for (var n3 = [], i3 = 0; i3 < e4.length; i3++)
              n3[i3] = e4[i3].toString();
            return n3;
          }
          return null;
        }),
        (e3.propagateProperty = function (t4, e4, n3, i3) {
          this.propagatePropertyToElement(t4, e4.element, n3, i3);
        }),
        (e3.propagatePropertyToElement = function (t4, e4, n3, i3) {
          var r3 = this.getProp(t4, n3);
          r3 &&
            (r3.isNumeric() && Vt(r3.unit) && (r3 = je(r3, t4)),
            'font-family' === n3 && (r3 = i3.filterFontFamily(r3)),
            $2(e4, n3, r3.toString()));
        }),
        (e3.propagateDelayedProperty = function (t4, e4, n3, i3) {
          var r3 = this.getProp(t4, n3);
          r3 && i3.push(new Ia(e4.element, n3, r3));
        }),
        (e3.assignLeftPosition = function (t4, e4) {
          var n3 = this.getPropAsNumber(t4, 'left'),
            i3 = this.getPropAsNumber(t4, 'margin-left'),
            r3 = this.getPropAsNumber(t4, 'padding-left'),
            o3 = this.getPropAsNumber(t4, 'border-left-width'),
            a3 = this.getPropAsNumber(t4, 'width');
          e4.setHorizontalPosition(n3, a3),
            $2(e4.element, 'margin-left', i3 + 'px'),
            $2(e4.element, 'padding-left', r3 + 'px'),
            $2(e4.element, 'border-left-width', o3 + 'px'),
            (e4.marginLeft = i3),
            (e4.borderLeft = o3),
            (e4.paddingLeft = r3);
        }),
        (e3.assignRightPosition = function (t4, e4) {
          var n3 = this.getPropAsNumber(t4, 'right'),
            i3 = this.getPropAsNumber(t4, 'snap-height'),
            r3 = this.getPropAsNumber(t4, 'margin-right'),
            o3 = this.getPropAsNumber(t4, 'padding-right'),
            a3 = this.getPropAsNumber(t4, 'border-right-width');
          if (
            ($2(e4.element, 'margin-right', r3 + 'px'),
            $2(e4.element, 'padding-right', o3 + 'px'),
            $2(e4.element, 'border-right-width', a3 + 'px'),
            (e4.marginRight = r3),
            (e4.borderRight = a3),
            this.vertical && i3 > 0)
          ) {
            var s3 = n3 + e4.getInsetRight(),
              l3 = s3 - Math.floor(s3 / i3) * i3;
            l3 > 0 && ((e4.snapOffsetX = i3 - l3), (o3 += e4.snapOffsetX));
          }
          (e4.paddingRight = o3), (e4.snapWidth = i3);
        }),
        (e3.assignTopPosition = function (t4, e4) {
          var n3 = this.getPropAsNumber(t4, 'snap-height'),
            i3 = this.getPropAsNumber(t4, 'top'),
            r3 = this.getPropAsNumber(t4, 'margin-top'),
            o3 = this.getPropAsNumber(t4, 'padding-top'),
            a3 = this.getPropAsNumber(t4, 'border-top-width');
          if (
            ((e4.top = i3),
            (e4.marginTop = r3),
            (e4.borderTop = a3),
            (e4.snapHeight = n3),
            !this.vertical && n3 > 0)
          ) {
            var s3 = i3 + e4.getInsetTop(),
              l3 = s3 - Math.floor(s3 / n3) * n3;
            l3 > 0 && ((e4.snapOffsetY = n3 - l3), (o3 += e4.snapOffsetY));
          }
          (e4.paddingTop = o3),
            $2(e4.element, 'top', i3 + 'px'),
            $2(e4.element, 'margin-top', r3 + 'px'),
            $2(e4.element, 'padding-top', o3 + 'px'),
            $2(e4.element, 'border-top-width', a3 + 'px');
        }),
        (e3.assignBottomPosition = function (t4, e4) {
          var n3 = this.getPropAsNumber(t4, 'margin-bottom'),
            i3 = this.getPropAsNumber(t4, 'padding-bottom'),
            r3 = this.getPropAsNumber(t4, 'border-bottom-width'),
            o3 = this.getPropAsNumber(t4, 'height') - e4.snapOffsetY;
          $2(e4.element, 'height', o3 + 'px'),
            $2(e4.element, 'margin-bottom', n3 + 'px'),
            $2(e4.element, 'padding-bottom', i3 + 'px'),
            $2(e4.element, 'border-bottom-width', r3 + 'px'),
            (e4.height = o3 - e4.snapOffsetY),
            (e4.marginBottom = n3),
            (e4.borderBottom = r3),
            (e4.paddingBottom = i3);
        }),
        (e3.assignBeforePosition = function (t4, e4) {
          this.vertical
            ? this.assignRightPosition(t4, e4)
            : this.assignTopPosition(t4, e4);
        }),
        (e3.assignAfterPosition = function (t4, e4) {
          this.vertical
            ? this.assignLeftPosition(t4, e4)
            : this.assignBottomPosition(t4, e4);
        }),
        (e3.assignStartEndPosition = function (t4, e4) {
          this.vertical
            ? (this.assignTopPosition(t4, e4),
              this.assignBottomPosition(t4, e4))
            : (this.assignRightPosition(t4, e4),
              this.assignLeftPosition(t4, e4));
        }),
        (e3.sizeWithMaxHeight = function (t4, e4) {
          $2(e4.element, 'border-top-width', '0px');
          var n3 = this.getPropAsNumber(t4, 'max-height');
          this.isTopDependentOnAutoHeight
            ? e4.setVerticalPosition(0, n3)
            : (this.assignTopPosition(t4, e4),
              (e4.height = n3 -= e4.snapOffsetY),
              $2(e4.element, 'height', n3 + 'px'));
        }),
        (e3.sizeWithMaxWidth = function (t4, e4) {
          $2(e4.element, 'border-left-width', '0px');
          var n3 = this.getPropAsNumber(t4, 'max-width');
          if (this.isRightDependentOnAutoWidth) e4.setHorizontalPosition(0, n3);
          else {
            this.assignRightPosition(t4, e4), (e4.width = n3 -= e4.snapOffsetX);
            var i3 = this.getPropAsNumber(t4, 'right');
            $2(e4.element, 'right', i3 + 'px'),
              $2(e4.element, 'width', n3 + 'px');
          }
        }),
        (e3.prepareContainer = function (t4, e4, n3, i3, r3) {
          (this.parentInstance &&
            this.vertical == this.parentInstance.vertical) ||
            $2(
              e4.element,
              'writing-mode',
              this.vertical ? 'vertical-rl' : 'horizontal-tb',
            ),
            (this.vertical ? this.isAutoWidth : this.isAutoHeight)
              ? this.vertical
                ? this.sizeWithMaxWidth(t4, e4)
                : this.sizeWithMaxHeight(t4, e4)
              : (this.assignBeforePosition(t4, e4),
                this.assignAfterPosition(t4, e4)),
            (this.vertical ? this.isAutoHeight : this.isAutoWidth)
              ? this.vertical
                ? this.sizeWithMaxHeight(t4, e4)
                : this.sizeWithMaxWidth(t4, e4)
              : this.assignStartEndPosition(t4, e4);
          for (var o3 = 0; o3 < Qu.length; o3++)
            this.propagateProperty(t4, e4, Qu[o3], i3);
        }),
        (e3.transferContentProps = function (t4, e4, n3, i3) {
          for (var r3 = 0; r3 < $u.length; r3++)
            this.propagateProperty(t4, e4, $u[r3], i3);
        }),
        (e3.transferSinglUriContentProps = function (t4, e4, n3) {
          for (var i3 = 0; i3 < Ju.length; i3++)
            this.propagatePropertyToElement(t4, e4, Ju[i3], n3);
        }),
        (e3.finishContainer = function (t4, e4, n3, i3, r3, o3, a3) {
          this.vertical
            ? (this.calculatedWidth = e4.computedBlockSize + e4.snapOffsetX)
            : (this.calculatedHeight = e4.computedBlockSize + e4.snapOffsetY);
          var s3 = (this.vertical || !i3) && this.isAutoHeight,
            l3 = (!this.vertical || !i3) && this.isAutoWidth,
            u3 = null;
          if (
            ((l3 || s3) &&
              (l3 && $2(e4.element, 'width', 'auto'),
              s3 && $2(e4.element, 'height', 'auto'),
              (u3 = o3.getElementClientRect(i3 ? i3.element : e4.element)),
              l3 &&
                ((this.calculatedWidth = Math.ceil(
                  u3.right -
                    u3.left -
                    e4.paddingLeft -
                    e4.borderLeft -
                    e4.paddingRight -
                    e4.borderRight,
                )),
                this.vertical && (this.calculatedWidth += e4.snapOffsetX)),
              s3 &&
                ((this.calculatedHeight =
                  u3.bottom -
                  u3.top -
                  e4.paddingTop -
                  e4.borderTop -
                  e4.paddingBottom -
                  e4.borderBottom),
                this.vertical || (this.calculatedHeight += e4.snapOffsetY))),
            (this.vertical ? this.isAutoHeight : this.isAutoWidth) &&
              this.assignStartEndPosition(t4, e4),
            (this.vertical ? this.isAutoWidth : this.isAutoHeight) &&
              ((this.vertical
                ? this.isRightDependentOnAutoWidth
                : this.isTopDependentOnAutoHeight) &&
                this.assignBeforePosition(t4, e4),
              this.assignAfterPosition(t4, e4)),
            r3 > 1)
          ) {
            var h3 = this.getPropAsNumber(t4, 'column-rule-width'),
              c3 = this.getProp(t4, 'column-rule-style'),
              f3 = this.getProp(t4, 'column-rule-color');
            if (h3 > 0 && c3 && c3 != Ye.none && f3 != Ye.transparent)
              for (
                var d3 = this.getPropAsNumber(t4, 'column-gap'),
                  p3 = this.vertical ? e4.height : e4.width,
                  g3 = this.vertical ? 'border-top' : 'border-left',
                  m3 = 1;
                m3 < r3;
                m3++
              ) {
                var v3 =
                    ((p3 + d3) * m3) / r3 - d3 / 2 + e4.paddingLeft - h3 / 2,
                  E2 = e4.height + e4.paddingTop + e4.paddingBottom,
                  y3 = e4.element.ownerDocument.createElement('div');
                $2(y3, 'position', 'absolute'),
                  $2(y3, this.vertical ? 'left' : 'top', '0px'),
                  $2(y3, this.vertical ? 'top' : 'left', v3 + 'px'),
                  $2(y3, this.vertical ? 'height' : 'width', '0px'),
                  $2(y3, this.vertical ? 'width' : 'height', E2 + 'px'),
                  $2(
                    y3,
                    g3,
                    h3 +
                      'px ' +
                      c3.toString() +
                      (f3 ? ' ' + f3.toString() : ''),
                  ),
                  e4.element.insertBefore(y3, e4.element.firstChild);
              }
          }
          for (var w3 = 0; w3 < Zu.length; w3++)
            this.propagateProperty(t4, e4, Zu[w3], a3);
          for (var N3 = 0; N3 < th.length; N3++)
            this.propagateDelayedProperty(t4, e4, th[N3], n3.delayedItems);
        }),
        (e3.applyCascadeAndInit = function (t4, e4) {
          var n3 = this.cascaded,
            i3 = this.pageBox.specified;
          for (var r3 in i3) Mr(r3) && Hr(n3, r3, Vr(i3, r3));
          if (this.pageBox.pseudoName == eh)
            for (var o3 in e4)
              (o3.match(/^background-/) || 'writing-mode' == o3) &&
                (n3[o3] = e4[o3]);
          if ('layout-host' == this.pageBox.pseudoName)
            for (var a3 in e4)
              a3.match(/^background-/) ||
                'writing-mode' == a3 ||
                (n3[a3] = e4[a3]);
          t4.pushRule(this.pageBox.classes, null, n3),
            n3.content &&
              (n3.content = n3.content.filterValue(
                new Bo(t4, null, t4.counterResolver),
              )),
            this.init(t4.context);
          for (var s3, l3 = D(this.pageBox.children); !(s3 = l3()).done; )
            s3.value.createInstance(this).applyCascadeAndInit(t4, e4);
          t4.popRule();
        }),
        (e3.resolveAutoSizing = function (t4) {
          this.isAutoWidth &&
            (this.isRightDependentOnAutoWidth =
              this.depends('right', this.autoWidth, t4) ||
              this.depends('margin-right', this.autoWidth, t4) ||
              this.depends('border-right-width', this.autoWidth, t4) ||
              this.depends('padding-right', this.autoWidth, t4)),
            this.isAutoHeight &&
              (this.isTopDependentOnAutoHeight =
                this.depends('top', this.autoHeight, t4) ||
                this.depends('margin-top', this.autoHeight, t4) ||
                this.depends('border-top-width', this.autoHeight, t4) ||
                this.depends('padding-top', this.autoHeight, t4));
          for (var e4, n3 = D(this.children); !(e4 = n3()).done; )
            e4.value.resolveAutoSizing(t4);
        }),
        t3
      );
    })();
    var Qu = [
      'border-left-style',
      'border-right-style',
      'border-top-style',
      'border-bottom-style',
      'border-left-color',
      'border-right-color',
      'border-top-color',
      'border-bottom-color',
      'outline-style',
      'outline-color',
      'outline-width',
      'overflow',
      'visibility',
    ];
    var Zu = [
      'border-top-left-radius',
      'border-top-right-radius',
      'border-bottom-right-radius',
      'border-bottom-left-radius',
      'border-image-source',
      'border-image-slice',
      'border-image-width',
      'border-image-outset',
      'border-image-repeat',
      'background-attachment',
      'background-color',
      'background-image',
      'background-repeat',
      'background-position',
      'background-clip',
      'background-origin',
      'background-size',
      'opacity',
      'z-index',
      'background-blend-mode',
      'isolation',
      'mix-blend-mode',
      'filter',
    ];
    var $u = [
      'color',
      'font-family',
      'font-size',
      'font-style',
      'font-weight',
      'font-variant',
      'line-height',
      'letter-spacing',
      'text-align',
      'text-decoration',
      'text-indent',
      'text-transform',
      'white-space',
      'word-spacing',
      'font-feature-settings',
      'font-kerning',
      'font-size-adjust',
      'font-variant-east-asian',
      'font-stretch',
      'text-decoration-color',
      'text-decoration-line',
      'text-decoration-skip',
      'text-decoration-style',
      'text-emphasis',
      'text-emphasis-color',
      'text-emphasis-position',
      'text-emphasis-style',
      'text-shadow',
      'text-underline-position',
    ];
    var Ju = [
      'width',
      'height',
      'image-resolution',
      'object-fit',
      'object-position',
    ];
    var th = ['transform', 'transform-origin'];
    var eh = 'background-host';
    var nh = (function (t3) {
      function e3(e4) {
        return t3.call(this, null, e4) || this;
      }
      return (
        I2(e3, t3),
        (e3.prototype.applyCascadeAndInit = function (e4, n3) {
          t3.prototype.applyCascadeAndInit.call(this, e4, n3),
            this.children.sort(function (t4, e5) {
              return (
                e5.pageBox.specificity - t4.pageBox.specificity ||
                t4.pageBox.index - e5.pageBox.index
              );
            });
        }),
        e3
      );
    })(qu);
    var ih = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return (
          ((i3 = t3.call(this, e4, n4) || this).pageMasterInstance = k2(i3)), i3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.boxSpecificEnabled = function (t4) {
          var e4 = this.pageBox.pageMaster;
          return e4.condition && (t4 = Ne(e4.scope, t4, e4.condition)), t4;
        }),
        (n3.adjustPageLayout = function (t4, e4, n4) {}),
        e3
      );
    })(qu);
    var rh = (function (t3) {
      function e3(e4, n3) {
        var i3;
        return (
          ((i3 = t3.call(this, e4, n3) || this).pageMasterInstance =
            e4.pageMasterInstance),
          i3
        );
      }
      return I2(e3, t3), e3;
    })(qu);
    var oh = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return (
          ((i3 = t3.call(this, e4, n4) || this).pageMasterInstance =
            e4.pageMasterInstance),
          i3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.processPartitionList = function (t4, e4, n4) {
          var i3 = null;
          if (
            (e4 instanceof ke && (i3 = [e4]),
            e4 instanceof ze && (i3 = e4.values),
            i3)
          ) {
            for (var r3 = this.pageBox.scope, o3 = 0; o3 < i3.length; o3++)
              if (i3[o3] instanceof ke) {
                var a3 = Dt(i3[o3].name, 'enabled'),
                  s3 = new de(r3, a3);
                n4 && (s3 = new qt(r3, s3)), (t4 = Ne(r3, t4, s3));
              }
          }
          return t4;
        }),
        (n3.boxSpecificEnabled = function (t4) {
          var e4 = this.pageBox.scope,
            n4 = this.style,
            i3 = Ku(e4, n4.required, e4._false) !== e4._false;
          if (i3 || this.isAutoHeight) {
            var r3 = (function (t5, e5, n5) {
              return e5 ? e5.toExpr(t5, t5.zero) : new Ee(t5, 'body');
            })(e4, n4['flow-from']);
            t4 = Ne(e4, t4, new me(e4, 'has-content', [r3]));
          }
          if (
            ((t4 = this.processPartitionList(
              t4,
              n4['required-partitions'],
              false,
            )),
            (t4 = this.processPartitionList(
              t4,
              n4['conflicting-partitions'],
              true,
            )),
            i3)
          ) {
            var o3 = this.pageMasterInstance.style.enabled,
              a3 = o3 ? o3.toExpr(e4, null) : e4._true;
            (a3 = Ne(e4, a3, t4)),
              (this.pageMasterInstance.style.enabled = new We(a3));
          }
          return t4;
        }),
        (n3.prepareContainer = function (e4, n4, i3, r3, o3) {
          $2(n4.element, 'overflow', 'hidden'),
            t3.prototype.prepareContainer.call(this, e4, n4, i3, r3, o3);
        }),
        e3
      );
    })(qu);
    var ah = (function (t3) {
      function e3(e4, n4, i3, r3) {
        var o3;
        return (
          ((o3 = t3.call(this, e4, n4, false) || this).target = i3),
          (o3.validatorSet = r3),
          o3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.property = function (t4, e4, n4) {
          this.validatorSet.validatePropertyAndHandleShorthand(
            t4,
            e4,
            n4,
            this,
          );
        }),
        (n3.unknownProperty = function (t4, e4) {
          this.report('E_INVALID_PROPERTY ' + t4 + ': ' + e4.toString());
        }),
        (n3.invalidPropertyValue = function (t4, e4) {
          this.report('E_INVALID_PROPERTY_VALUE ' + t4 + ': ' + e4.toString());
        }),
        (n3.simpleProperty = function (t4, e4, n4) {
          this.target.specified[t4] = new kr(e4, n4 ? 50331648 : 67108864);
        }),
        e3
      );
    })(Yi);
    var sh = (function (t3) {
      function e3(e4, n3, i3, r3) {
        return t3.call(this, e4, n3, i3, r3) || this;
      }
      return I2(e3, t3), e3;
    })(ah);
    var lh = (function (t3) {
      function e3(e4, n4, i3, r3) {
        var o3;
        return (
          (o3 = t3.call(this, e4, n4, i3, r3) || this),
          (i3.specified.width = new kr(Ke, 0)),
          (i3.specified.height = new kr(Ke, 0)),
          o3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.startPartitionRule = function (t4, e4, n4) {
          var i3 = new Gu(this.scope, t4, e4, n4, this.target),
            r3 = new sh(this.scope, this.owner, i3, this.validatorSet);
          this.owner.pushHandler(r3);
        }),
        (n3.startPartitionGroupRule = function (t4, n4, i3) {
          var r3 = new zu(this.scope, t4, n4, i3, this.target),
            o3 = new e3(this.scope, this.owner, r3, this.validatorSet);
          this.owner.pushHandler(o3);
        }),
        e3
      );
    })(ah);
    var uh = (function (t3) {
      function e3(e4, n4, i3, r3) {
        return t3.call(this, e4, n4, i3, r3) || this;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.startPartitionRule = function (t4, e4, n4) {
          var i3 = new Gu(this.scope, t4, e4, n4, this.target),
            r3 = new sh(this.scope, this.owner, i3, this.validatorSet);
          this.owner.pushHandler(r3);
        }),
        (n3.startPartitionGroupRule = function (t4, e4, n4) {
          var i3 = new zu(this.scope, t4, e4, n4, this.target),
            r3 = new lh(this.scope, this.owner, i3, this.validatorSet);
          this.owner.pushHandler(r3);
        }),
        e3
      );
    })(ah);
    function hh(t3) {
      var e3 = t3['writing-mode'],
        n3 = t3.direction;
      return (
        (n3 = n3 && n3.value),
        (e3 = e3 && e3.value) === Ye.vertical_lr ||
        (e3 !== Ye.vertical_rl && n3 !== Ye.rtl)
          ? exports.PageProgression.LTR
          : exports.PageProgression.RTL
      );
    }
    var ch;
    var fh;
    var dh = {
      a5: { width: new De(148, 'mm'), height: new De(210, 'mm') },
      a4: { width: new De(210, 'mm'), height: new De(297, 'mm') },
      a3: { width: new De(297, 'mm'), height: new De(420, 'mm') },
      b5: { width: new De(176, 'mm'), height: new De(250, 'mm') },
      b4: { width: new De(250, 'mm'), height: new De(353, 'mm') },
      'jis-b5': { width: new De(182, 'mm'), height: new De(257, 'mm') },
      'jis-b4': { width: new De(257, 'mm'), height: new De(364, 'mm') },
      letter: { width: new De(8.5, 'in'), height: new De(11, 'in') },
      legal: { width: new De(8.5, 'in'), height: new De(14, 'in') },
      ledger: { width: new De(11, 'in'), height: new De(17, 'in') },
    };
    var ph = new De(0.24, 'pt');
    var gh = new De(3, 'mm');
    var mh = new De(10, 'mm');
    var vh = new De(13, 'mm');
    function Eh(t3) {
      var e3 = { width: qe, height: Qe, bleed: Ze, bleedOffset: Ze },
        n3 = t3.size;
      if (n3 && n3.value !== Ye.auto) {
        var i3,
          r3,
          o3 = n3.value;
        if (
          (o3.isSpaceList()
            ? ((i3 = o3.values[0]), (r3 = o3.values[1]))
            : ((i3 = o3), (r3 = null)),
          i3.isNumeric())
        )
          (e3.width = i3), (e3.height = r3 || i3);
        else {
          var a3 = i3.name && dh[i3.name.toLowerCase()];
          a3 &&
            (r3 && r3 === Ye.landscape
              ? ((e3.width = a3.height), (e3.height = a3.width))
              : ((e3.width = a3.width), (e3.height = a3.height)));
        }
      }
      var s3 = t3.marks;
      s3 && s3.value !== Ye.none && (e3.bleedOffset = vh);
      var l3 = t3.bleed;
      return (
        l3 && l3.value !== Ye.auto
          ? l3.value && l3.value.isNumeric() && (e3.bleed = l3.value)
          : s3 &&
            (s3.value.isSpaceList()
              ? s3.value.values.some(function (t4) {
                  return t4 === Ye.crop;
                })
              : s3.value === Ye.crop) &&
            (e3.bleed = new De(6, 'pt')),
        e3
      );
    }
    function yh(t3, e3) {
      var n3 = {},
        i3 = t3.bleed.num * e3.queryUnitSize(t3.bleed.unit, false),
        r3 = t3.bleedOffset.num * e3.queryUnitSize(t3.bleedOffset.unit, false),
        o3 = i3 + r3,
        a3 = t3.width;
      n3.pageWidth =
        a3 === qe
          ? e3.pref.defaultPaperSize
            ? e3.pref.defaultPaperSize.width * e3.queryUnitSize('px', false)
            : (e3.pref.spreadView
                ? Math.floor(e3.viewportWidth / 2) - e3.pref.pageBorder
                : e3.viewportWidth) -
              2 * o3
          : a3.num * e3.queryUnitSize(a3.unit, false);
      var s3 = t3.height;
      return (
        (n3.pageHeight =
          s3 === Qe
            ? e3.pref.defaultPaperSize
              ? e3.pref.defaultPaperSize.height * e3.queryUnitSize('px', false)
              : e3.viewportHeight - 2 * o3
            : s3.num * e3.queryUnitSize(s3.unit, false)),
        (n3.bleed = i3),
        (n3.bleedOffset = r3),
        (n3.cropOffset = o3),
        n3
      );
    }
    function wh(t3, e3, n3) {
      var i3 = t3.createElementNS(H2.SVG, 'svg');
      return (
        i3.setAttribute('width', e3),
        i3.setAttribute('height', n3),
        (i3.style.position = 'absolute'),
        i3
      );
    }
    function Nh(t3, e3, n3) {
      var i3 = t3.createElementNS(H2.SVG, (n3 = n3 || 'polyline'));
      return (
        i3.setAttribute('stroke', 'black'),
        i3.setAttribute('stroke-width', e3),
        i3.setAttribute('fill', 'none'),
        i3
      );
    }
    !(function (t3) {
      (t3.TOP_LEFT = 'top left'),
        (t3.TOP_RIGHT = 'top right'),
        (t3.BOTTOM_LEFT = 'bottom left'),
        (t3.BOTTOM_RIGHT = 'bottom right');
    })(ch || (ch = {})),
      (function (t3) {
        (t3.TOP = 'top'),
          (t3.BOTTOM = 'bottom'),
          (t3.LEFT = 'left'),
          (t3.RIGHT = 'right');
      })(fh || (fh = {}));
    var bh;
    var Sh;
    var Ch =
      ((bh = {
        width: true,
        height: true,
        'block-size': true,
        'inline-size': true,
        margin: true,
        padding: true,
        border: true,
        outline: true,
        'outline-width': true,
        'outline-style': true,
        'outline-color': true,
      }),
      [
        'left',
        'right',
        'top',
        'bottom',
        'before',
        'after',
        'start',
        'end',
        'block-start',
        'block-end',
        'inline-start',
        'inline-end',
      ].forEach(function (t3) {
        (bh['margin-' + t3] = true),
          (bh['padding-' + t3] = true),
          (bh['border-' + t3 + '-width'] = true),
          (bh['border-' + t3 + '-style'] = true),
          (bh['border-' + t3 + '-color'] = true);
      }),
      bh);
    !(function (t3) {
      (t3.START = 'start'), (t3.CENTER = 'center'), (t3.END = 'end');
    })(Sh || (Sh = {}));
    var Th;
    var xh = {
      'top-left-corner': {
        order: 1,
        isInTopRow: true,
        isInBottomRow: false,
        isInLeftColumn: true,
        isInRightColumn: true,
        positionAlongVariableDimension: null,
      },
      'top-left': {
        order: 2,
        isInTopRow: true,
        isInBottomRow: false,
        isInLeftColumn: false,
        isInRightColumn: false,
        positionAlongVariableDimension: Sh.START,
      },
      'top-center': {
        order: 3,
        isInTopRow: true,
        isInBottomRow: false,
        isInLeftColumn: false,
        isInRightColumn: false,
        positionAlongVariableDimension: Sh.CENTER,
      },
      'top-right': {
        order: 4,
        isInTopRow: true,
        isInBottomRow: false,
        isInLeftColumn: false,
        isInRightColumn: false,
        positionAlongVariableDimension: Sh.END,
      },
      'top-right-corner': {
        order: 5,
        isInTopRow: true,
        isInBottomRow: false,
        isInLeftColumn: false,
        isInRightColumn: true,
        positionAlongVariableDimension: null,
      },
      'right-top': {
        order: 6,
        isInTopRow: false,
        isInBottomRow: false,
        isInLeftColumn: false,
        isInRightColumn: true,
        positionAlongVariableDimension: Sh.START,
      },
      'right-middle': {
        order: 7,
        isInTopRow: false,
        isInBottomRow: false,
        isInLeftColumn: false,
        isInRightColumn: true,
        positionAlongVariableDimension: Sh.CENTER,
      },
      'right-bottom': {
        order: 8,
        isInTopRow: false,
        isInBottomRow: false,
        isInLeftColumn: false,
        isInRightColumn: true,
        positionAlongVariableDimension: Sh.END,
      },
      'bottom-right-corner': {
        order: 9,
        isInTopRow: false,
        isInBottomRow: true,
        isInLeftColumn: false,
        isInRightColumn: true,
        positionAlongVariableDimension: null,
      },
      'bottom-right': {
        order: 10,
        isInTopRow: false,
        isInBottomRow: true,
        isInLeftColumn: false,
        isInRightColumn: false,
        positionAlongVariableDimension: Sh.END,
      },
      'bottom-center': {
        order: 11,
        isInTopRow: false,
        isInBottomRow: true,
        isInLeftColumn: false,
        isInRightColumn: false,
        positionAlongVariableDimension: Sh.CENTER,
      },
      'bottom-left': {
        order: 12,
        isInTopRow: false,
        isInBottomRow: true,
        isInLeftColumn: false,
        isInRightColumn: false,
        positionAlongVariableDimension: Sh.START,
      },
      'bottom-left-corner': {
        order: 13,
        isInTopRow: false,
        isInBottomRow: true,
        isInLeftColumn: true,
        isInRightColumn: false,
        positionAlongVariableDimension: null,
      },
      'left-bottom': {
        order: 14,
        isInTopRow: false,
        isInBottomRow: false,
        isInLeftColumn: true,
        isInRightColumn: false,
        positionAlongVariableDimension: Sh.END,
      },
      'left-middle': {
        order: 15,
        isInTopRow: false,
        isInBottomRow: false,
        isInLeftColumn: true,
        isInRightColumn: false,
        positionAlongVariableDimension: Sh.CENTER,
      },
      'left-top': {
        order: 16,
        isInTopRow: false,
        isInBottomRow: false,
        isInLeftColumn: true,
        isInRightColumn: false,
        positionAlongVariableDimension: Sh.START,
      },
    };
    var Ih =
      ((Th = xh),
      Object.keys(Th).sort(function (t3, e3) {
        return Th[t3].order - Th[e3].order;
      }));
    var Ph = (function (t3) {
      function e3(e4, n4, i3) {
        var r3;
        (r3 =
          t3.call(
            this,
            e4,
            null,
            'vivliostyle-page-rule-master',
            [],
            n4,
            null,
            0,
          ) || this).pageMarginBoxes = {};
        var o3 = Eh(i3),
          a3 = new Rh(r3.scope, k2(r3), i3, o3);
        return (
          (r3.bodyPartitionKey = a3.key),
          r3.createPageMarginBoxes(i3),
          r3.applySpecified(i3, o3),
          r3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.createPageMarginBoxes = function (t4) {
          var e4 = t4._marginBoxes;
          if (e4) {
            var n4 = this;
            Ih.forEach(function (i3) {
              e4[i3] && (n4.pageMarginBoxes[i3] = new Ah(n4.scope, n4, i3, t4));
            });
          }
        }),
        (n3.applySpecified = function (t4, e4) {
          for (var n4 in ((this.specified.position = new kr(Ye.relative, 0)),
          (this.specified.width = new kr(e4.width, 0)),
          (this.specified.height = new kr(e4.height, 0)),
          t4))
            Ch[n4] || 'background-clip' === n4 || (this.specified[n4] = t4[n4]);
        }),
        (n3.createInstance = function (t4) {
          return new Lh(t4, this);
        }),
        e3
      );
    })(Hu);
    var Rh = (function (t3) {
      function e3(e4, n4, i3, r3) {
        var o3;
        return (
          ((o3 = t3.call(this, e4, null, null, [], n4) || this).pageSize = r3),
          (o3.specified['z-index'] = new kr(new Be(0), 0)),
          o3.applySpecified(i3),
          o3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.applySpecified = function (t4) {
          for (var e4 in ((this.specified['flow-from'] = new kr(Fe('body'), 0)),
          (this.specified.position = new kr(Ye.absolute, 0)),
          (this.specified.overflow = new kr(Ye.visible, 0)),
          Ch))
            Ch.hasOwnProperty(e4) && (this.specified[e4] = t4[e4]);
        }),
        (n3.createInstance = function (t4) {
          return new Dh(t4, this);
        }),
        e3
      );
    })(Gu);
    var Ah = (function (t3) {
      function e3(e4, n4, i3, r3) {
        var o3;
        return (
          ((o3 =
            t3.call(this, e4, null, null, [], n4) || this).marginBoxName = i3),
          o3.applySpecified(r3),
          o3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.applySpecified = function (t4) {
          var e4 = t4._marginBoxes[this.marginBoxName];
          for (var n4 in t4) {
            var i3 = e4[n4];
            (Nr[n4] || (i3 && i3.value === Ye.inherit)) &&
              (this.specified[n4] = t4[n4]);
          }
          for (var r3 in e4)
            if (Object.prototype.hasOwnProperty.call(e4, r3)) {
              var o3 = e4[r3];
              o3 && o3.value !== Ye.inherit && (this.specified[r3] = o3);
            }
        }),
        (n3.createInstance = function (t4) {
          return new _h(t4, this);
        }),
        e3
      );
    })(Gu);
    var Lh = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return (
          ((i3 = t3.call(this, e4, n4) || this).pageAreaDimension = null),
          (i3.pageMarginBoxInstances = {}),
          i3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.applyCascadeAndInit = function (e4, n4) {
          var i3 = this.cascaded;
          for (var r3 in n4)
            if (Object.prototype.hasOwnProperty.call(n4, r3))
              switch (r3) {
                case 'writing-mode':
                case 'direction':
                  i3[r3] = n4[r3];
              }
          t3.prototype.applyCascadeAndInit.call(this, e4, n4);
        }),
        (n3.initHorizontal = function () {
          var t4 = this.style;
          (t4.left = Ze),
            (t4['margin-left'] = Ze),
            (t4['border-left-width'] = Ze),
            (t4['padding-left'] = Ze),
            (t4['padding-right'] = Ze),
            (t4['border-right-width'] = Ze),
            (t4['margin-right'] = Ze),
            (t4.right = Ze);
        }),
        (n3.initVertical = function () {
          var t4 = this.style;
          (t4.top = Ze),
            (t4['margin-top'] = Ze),
            (t4['border-top-width'] = Ze),
            (t4['padding-top'] = Ze),
            (t4['padding-bottom'] = Ze),
            (t4['border-bottom-width'] = Ze),
            (t4['margin-bottom'] = Ze),
            (t4.bottom = Ze);
        }),
        (n3.setPageAreaDimension = function (t4) {
          this.pageAreaDimension = t4;
          var e4 = this.style;
          (e4.width = new We(t4.borderBoxWidth)),
            (e4.height = new We(t4.borderBoxHeight)),
            (e4['padding-left'] = new We(t4.marginLeft)),
            (e4['padding-right'] = new We(t4.marginRight)),
            (e4['padding-top'] = new We(t4.marginTop)),
            (e4['padding-bottom'] = new We(t4.marginBottom));
        }),
        (n3.adjustPageLayout = function (t4, e4, n4) {
          var i3 = e4.marginBoxes,
            r3 = {
              start: this.pageAreaDimension.marginLeft,
              end: this.pageAreaDimension.marginRight,
              extent: this.pageAreaDimension.borderBoxWidth,
            },
            o3 = {
              start: this.pageAreaDimension.marginTop,
              end: this.pageAreaDimension.marginBottom,
              extent: this.pageAreaDimension.borderBoxHeight,
            };
          this.sizeMarginBoxesAlongVariableDimension(i3.top, true, r3, t4, n4),
            this.sizeMarginBoxesAlongVariableDimension(
              i3.bottom,
              true,
              r3,
              t4,
              n4,
            ),
            this.sizeMarginBoxesAlongVariableDimension(
              i3.left,
              false,
              o3,
              t4,
              n4,
            ),
            this.sizeMarginBoxesAlongVariableDimension(
              i3.right,
              false,
              o3,
              t4,
              n4,
            );
        }),
        (n3.sizeMarginBoxesAlongVariableDimension = function (
          t4,
          e4,
          n4,
          i3,
          r3,
        ) {
          var o3 = Sh.START,
            a3 = Sh.CENTER,
            s3 = Sh.END,
            l3 = this.pageBox.scope,
            u3 = {},
            h3 = {},
            c3 = {};
          for (var f3 in t4) {
            var d3 = xh[f3];
            if (d3) {
              var p3 = t4[f3],
                g3 = this.pageMarginBoxInstances[f3],
                m3 = new Oh(p3, g3.style, e4, l3, r3);
              (u3[d3.positionAlongVariableDimension] = p3),
                (h3[d3.positionAlongVariableDimension] = g3),
                (c3[d3.positionAlongVariableDimension] = m3);
            }
          }
          var v3 = {
              start: n4.start.evaluate(i3),
              end: n4.end.evaluate(i3),
              extent: n4.extent.evaluate(i3),
            },
            E2 = this.getSizesOfMarginBoxesAlongVariableDimension(
              c3,
              v3.extent,
            ),
            y3 = false,
            w3 = {};
          Object.keys(u3).forEach(function (t5) {
            var o4 = t5,
              a4 = Wu(
                l3,
                h3[o4].style[e4 ? 'max-width' : 'max-height'],
                n4.extent,
              );
            if (a4) {
              var s4 = a4.evaluate(i3);
              if (E2[o4] > s4) {
                var f4 = (c3[o4] = new Fh(
                  u3[o4],
                  h3[o4].style,
                  e4,
                  l3,
                  r3,
                  s4,
                ));
                (w3[o4] = f4.getOuterSize()), (y3 = true);
              }
            }
          }),
            y3 &&
              ((E2 = this.getSizesOfMarginBoxesAlongVariableDimension(
                c3,
                v3.extent,
              )),
              (y3 = false),
              [o3, a3, s3].forEach(function (t5) {
                E2[t5] = w3[t5] || E2[t5];
              }));
          var N3 = {};
          Object.keys(u3).forEach(function (t5) {
            var o4 = t5,
              a4 = Wu(
                l3,
                h3[o4].style[e4 ? 'min-width' : 'min-height'],
                n4.extent,
              );
            if (a4) {
              var s4 = a4.evaluate(i3);
              if (E2[o4] < s4) {
                var f4 = (c3[o4] = new Fh(
                  u3[o4],
                  h3[o4].style,
                  e4,
                  l3,
                  r3,
                  s4,
                ));
                (N3[o4] = f4.getOuterSize()), (y3 = true);
              }
            }
          }),
            y3 &&
              ((E2 = this.getSizesOfMarginBoxesAlongVariableDimension(
                c3,
                v3.extent,
              )),
              [o3, a3, s3].forEach(function (t5) {
                E2[t5] = N3[t5] || E2[t5];
              }));
          var b3 = v3.start + v3.extent,
            S3 = v3.start + (v3.start + v3.extent);
          [o3, a3, s3].forEach(function (t5) {
            var n5 = E2[t5];
            if (n5) {
              var i4 = u3[t5],
                r4 = 0;
              switch (t5) {
                case o3:
                  r4 = e4 ? i4.left : i4.top;
                  break;
                case a3:
                  r4 = (S3 - n5) / 2;
                  break;
                case s3:
                  r4 = b3 - n5;
              }
              e4
                ? i4.setHorizontalPosition(
                    r4,
                    n5 - i4.getInsetLeft() - i4.getInsetRight(),
                  )
                : i4.setVerticalPosition(
                    r4,
                    n5 - i4.getInsetTop() - i4.getInsetBottom(),
                  );
            }
          });
        }),
        (n3.getSizesOfMarginBoxesAlongVariableDimension = function (t4, e4) {
          var n4 = t4[Sh.START],
            i3 = t4[Sh.CENTER],
            r3 = t4[Sh.END],
            o3 = {};
          if (i3) {
            var a3 = [n4, r3].filter(function (t5) {
                return t5;
              }),
              s3 = a3.length ? new kh(a3) : null,
              l3 = this.distributeAutoMarginBoxSizes(i3, s3, e4);
            l3.xSize && (o3[Sh.CENTER] = l3.xSize);
            var u3 = (e4 - (l3.xSize || i3.getOuterSize())) / 2;
            n4 && n4.hasAutoSize() && (o3[Sh.START] = u3),
              r3 && r3.hasAutoSize() && (o3[Sh.END] = u3);
          } else {
            var h3 = this.distributeAutoMarginBoxSizes(n4, r3, e4);
            h3.xSize && (o3[Sh.START] = h3.xSize),
              h3.ySize && (o3[Sh.END] = h3.ySize);
          }
          return o3;
        }),
        (n3.distributeAutoMarginBoxSizes = function (t4, e4, n4) {
          var i3 = { xSize: null, ySize: null };
          if (t4 && e4)
            if (t4.hasAutoSize() && e4.hasAutoSize()) {
              var r3 = t4.getOuterMaxContentSize(),
                o3 = e4.getOuterMaxContentSize();
              if (r3 > 0 && o3 > 0) {
                var a3 = r3 + o3;
                if (a3 < n4) i3.xSize = (n4 * r3) / a3;
                else {
                  var s3 = t4.getOuterMinContentSize(),
                    l3 = s3 + e4.getOuterMinContentSize();
                  l3 < n4
                    ? (i3.xSize = s3 + ((n4 - l3) * (r3 - s3)) / (a3 - l3))
                    : l3 > 0 && (i3.xSize = (n4 * s3) / l3);
                }
                i3.xSize > 0 && (i3.ySize = n4 - i3.xSize);
              } else r3 > 0 ? (i3.xSize = n4) : o3 > 0 && (i3.ySize = n4);
            } else
              t4.hasAutoSize()
                ? (i3.xSize = Math.max(n4 - e4.getOuterSize(), 0))
                : e4.hasAutoSize() &&
                  (i3.ySize = Math.max(n4 - t4.getOuterSize(), 0));
          else
            t4
              ? t4.hasAutoSize() && (i3.xSize = n4)
              : e4 && e4.hasAutoSize() && (i3.ySize = n4);
          return i3;
        }),
        (n3.prepareContainer = function (e4, n4, i3, r3, o3) {
          t3.prototype.prepareContainer.call(this, e4, n4, i3, r3, o3),
            n4.element.setAttribute('data-vivliostyle-page-box', true);
        }),
        e3
      );
    })(ih);
    var Oh = (function () {
      function t3(t4, e4, n3, i3, r3) {
        (this.container = t4),
          (this.isHorizontal = n3),
          (this.clientLayout = r3),
          (this.size = null),
          (this.hasAutoSize_ = !Wu(
            i3,
            e4[n3 ? 'width' : 'height'],
            new fe(i3, 0, 'px'),
          ));
      }
      var e3 = t3.prototype;
      return (
        (e3.hasAutoSize = function () {
          return this.hasAutoSize_;
        }),
        (e3.getSize = function () {
          return (
            this.size ||
              (this.size = ba(
                this.clientLayout,
                this.container.element,
                this.isHorizontal
                  ? [fa.MAX_CONTENT_WIDTH, fa.MIN_CONTENT_WIDTH]
                  : [fa.MAX_CONTENT_HEIGHT, fa.MIN_CONTENT_HEIGHT],
              )),
            this.size
          );
        }),
        (e3.getOuterMaxContentSize = function () {
          var t4 = this.getSize();
          return this.isHorizontal
            ? this.container.getInsetLeft() +
                t4[fa.MAX_CONTENT_WIDTH] +
                this.container.getInsetRight()
            : this.container.getInsetTop() +
                t4[fa.MAX_CONTENT_HEIGHT] +
                this.container.getInsetBottom();
        }),
        (e3.getOuterMinContentSize = function () {
          var t4 = this.getSize();
          return this.isHorizontal
            ? this.container.getInsetLeft() +
                t4[fa.MIN_CONTENT_WIDTH] +
                this.container.getInsetRight()
            : this.container.getInsetTop() +
                t4[fa.MIN_CONTENT_HEIGHT] +
                this.container.getInsetBottom();
        }),
        (e3.getOuterSize = function () {
          return this.isHorizontal
            ? this.container.getInsetLeft() +
                this.container.width +
                this.container.getInsetRight()
            : this.container.getInsetTop() +
                this.container.height +
                this.container.getInsetBottom();
        }),
        t3
      );
    })();
    var kh = (function () {
      function t3(t4) {
        this.params = t4;
      }
      var e3 = t3.prototype;
      return (
        (e3.hasAutoSize = function () {
          return this.params.some(function (t4) {
            return t4.hasAutoSize();
          });
        }),
        (e3.getOuterMaxContentSize = function () {
          var t4 = this.params.map(function (t5) {
            return t5.getOuterMaxContentSize();
          });
          return Math.max.apply(null, t4) * t4.length;
        }),
        (e3.getOuterMinContentSize = function () {
          var t4 = this.params.map(function (t5) {
            return t5.getOuterMinContentSize();
          });
          return Math.max.apply(null, t4) * t4.length;
        }),
        (e3.getOuterSize = function () {
          var t4 = this.params.map(function (t5) {
            return t5.getOuterSize();
          });
          return Math.max.apply(null, t4) * t4.length;
        }),
        t3
      );
    })();
    var Fh = (function (t3) {
      function e3(e4, n4, i3, r3, o3, a3) {
        var s3;
        return (
          ((s3 = t3.call(this, e4, n4, i3, r3, o3) || this).fixedSize = a3), s3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.hasAutoSize = function () {
          return false;
        }),
        (n3.getOuterMaxContentSize = function () {
          return this.getOuterSize();
        }),
        (n3.getOuterMinContentSize = function () {
          return this.getOuterSize();
        }),
        (n3.getOuterSize = function () {
          return this.isHorizontal
            ? this.container.getInsetLeft() +
                this.fixedSize +
                this.container.getInsetRight()
            : this.container.getInsetTop() +
                this.fixedSize +
                this.container.getInsetBottom();
        }),
        e3
      );
    })(Oh);
    var Dh = (function (t3) {
      function e3(e4, n4) {
        var i3;
        return (
          ((i3 = t3.call(this, e4, n4) || this).borderBoxWidth = null),
          (i3.borderBoxHeight = null),
          (i3.marginTop = null),
          (i3.marginRight = null),
          (i3.marginBottom = null),
          (i3.marginLeft = null),
          i3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.applyCascadeAndInit = function (e4, n4) {
          var i3 = this.cascaded;
          for (var r3 in n4)
            Object.prototype.hasOwnProperty.call(n4, r3) &&
              (r3.match(/^column.*$/) || r3.match(/^background-/)) &&
              (i3[r3] = n4[r3]);
          t3.prototype.applyCascadeAndInit.call(this, e4, n4),
            this.parentInstance.setPageAreaDimension({
              borderBoxWidth: this.borderBoxWidth,
              borderBoxHeight: this.borderBoxHeight,
              marginTop: this.marginTop,
              marginRight: this.marginRight,
              marginBottom: this.marginBottom,
              marginLeft: this.marginLeft,
            });
        }),
        (n3.initHorizontal = function () {
          var t4 = this.resolvePageBoxDimensions({
            start: 'left',
            end: 'right',
            extent: 'width',
          });
          (this.borderBoxWidth = t4.borderBoxExtent),
            (this.marginLeft = t4.marginStart),
            (this.marginRight = t4.marginEnd);
        }),
        (n3.initVertical = function () {
          var t4 = this.resolvePageBoxDimensions({
            start: 'top',
            end: 'bottom',
            extent: 'height',
          });
          (this.borderBoxHeight = t4.borderBoxExtent),
            (this.marginTop = t4.marginStart),
            (this.marginBottom = t4.marginEnd);
        }),
        (n3.resolvePageBoxDimensions = function (t4) {
          var e4 = this.style,
            n4 = this.pageBox.scope,
            i3 = t4.start,
            r3 = t4.end,
            o3 = t4.extent,
            a3 = this.pageBox.pageSize[o3].toExpr(n4, null),
            s3 = Wu(n4, e4[o3], a3),
            l3 = Wu(n4, e4['margin-' + i3], a3),
            u3 = Wu(n4, e4['margin-' + r3], a3),
            h3 = Xu(n4, e4['padding-' + i3], a3),
            c3 = Xu(n4, e4['padding-' + r3], a3),
            f3 = Yu(
              n4,
              e4['border-' + i3 + '-width'],
              e4['border-' + i3 + '-style'],
              a3,
            ),
            d3 = Yu(
              n4,
              e4['border-' + r3 + '-width'],
              e4['border-' + r3 + '-style'],
              a3,
            ),
            p3 = Se(n4, a3, be(n4, be(n4, f3, h3), be(n4, d3, c3)));
          return (
            s3
              ? ((p3 = Se(n4, p3, s3)),
                l3 || u3
                  ? l3
                    ? (u3 = Se(n4, p3, l3))
                    : (l3 = Se(n4, p3, u3))
                  : (u3 = l3 = Ce(n4, p3, new Ee(n4, 0.5))))
              : (l3 || (l3 = n4.zero),
                u3 || (u3 = n4.zero),
                (s3 = Se(n4, p3, be(n4, l3, u3)))),
            (e4[i3] = new We(l3)),
            (e4[r3] = new We(u3)),
            (e4['margin-' + i3] = Ze),
            (e4['margin-' + r3] = Ze),
            (e4['padding-' + i3] = new We(h3)),
            (e4['padding-' + r3] = new We(c3)),
            (e4['border-' + i3 + '-width'] = new We(f3)),
            (e4['border-' + r3 + '-width'] = new We(d3)),
            (e4[o3] = new We(s3)),
            (e4['max-' + o3] = new We(s3)),
            {
              borderBoxExtent: Se(n4, a3, be(n4, l3, u3)),
              marginStart: l3,
              marginEnd: u3,
            }
          );
        }),
        (n3.prepareContainer = function (e4, n4, i3, r3, o3) {
          t3.prototype.prepareContainer.call(this, e4, n4, i3, r3, o3),
            (i3.pageAreaElement = n4.element),
            (e4.pageAreaWidth = parseFloat(i3.pageAreaElement.style.width)),
            (e4.pageAreaHeight = parseFloat(i3.pageAreaElement.style.height));
        }),
        e3
      );
    })(oh);
    var _h = (function (t3) {
      function e3(e4, n4) {
        var i3;
        (i3 = t3.call(this, e4, n4) || this).suppressEmptyBoxGeneration = true;
        var r3 = n4.marginBoxName;
        return (
          (i3.boxInfo = xh[r3]), (e4.pageMarginBoxInstances[r3] = k2(i3)), i3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.prepareContainer = function (e4, n4, i3, r3, o3) {
          this.applyVerticalAlign(e4, n4.element),
            t3.prototype.prepareContainer.call(this, e4, n4, i3, r3, o3);
        }),
        (n3.applyVerticalAlign = function (t4, e4) {
          $2(e4, 'display', 'flex');
          var n4 = this.getProp(t4, 'vertical-align'),
            i3 = null;
          n4 === Fe('middle')
            ? (i3 = 'center')
            : n4 === Fe('top')
            ? (i3 = 'flex-start')
            : n4 === Fe('bottom') && (i3 = 'flex-end'),
            i3 &&
              ($2(e4, 'flex-flow', this.vertical ? 'row' : 'column'),
              $2(e4, 'justify-content', i3));
        }),
        (n3.positionAlongVariableDimension = function (t4, e4) {
          var n4 = this.style,
            i3 = this.pageBox.scope,
            r3 = t4.start,
            o3 = t4.end,
            a3 = 'left' === r3,
            s3 = a3 ? e4.borderBoxWidth : e4.borderBoxHeight,
            l3 = Wu(i3, n4[t4.extent], s3),
            u3 = a3 ? e4.marginLeft : e4.marginTop;
          if (this.boxInfo.positionAlongVariableDimension === Sh.START)
            n4[r3] = new We(u3);
          else if (l3) {
            var h3 = Xu(i3, n4['margin-' + r3], s3),
              c3 = Xu(i3, n4['margin-' + o3], s3),
              f3 = Xu(i3, n4['padding-' + r3], s3),
              d3 = Xu(i3, n4['padding-' + o3], s3),
              p3 = Yu(
                i3,
                n4['border-' + r3 + '-width'],
                n4['border-' + r3 + '-style'],
                s3,
              ),
              g3 = Yu(
                i3,
                n4['border-' + o3 + '-width'],
                n4['border-' + o3 + '-style'],
                s3,
              ),
              m3 = be(
                i3,
                l3,
                be(i3, be(i3, f3, d3), be(i3, be(i3, p3, g3), be(i3, h3, c3))),
              );
            switch (this.boxInfo.positionAlongVariableDimension) {
              case Sh.CENTER:
                n4[r3] = new We(
                  be(i3, u3, Te(i3, Se(i3, s3, m3), new Ee(i3, 2))),
                );
                break;
              case Sh.END:
                n4[r3] = new We(Se(i3, be(i3, u3, s3), m3));
            }
          }
        }),
        (n3.positionAndSizeAlongFixedDimension = function (t4, e4) {
          var n4 = this.style,
            i3 = this.pageBox.scope,
            r3 = t4.inside,
            o3 = t4.outside,
            a3 = t4.extent,
            s3 = e4['margin' + o3.charAt(0).toUpperCase() + o3.substring(1)],
            l3 = ju(i3, n4['margin-' + r3], s3),
            u3 = ju(i3, n4['margin-' + o3], s3),
            h3 = Xu(i3, n4['padding-' + r3], s3),
            c3 = Xu(i3, n4['padding-' + o3], s3),
            f3 = Yu(
              i3,
              n4['border-' + r3 + '-width'],
              n4['border-' + r3 + '-style'],
              s3,
            ),
            d3 = Yu(
              i3,
              n4['border-' + o3 + '-width'],
              n4['border-' + o3 + '-style'],
              s3,
            ),
            p3 = Wu(i3, n4[a3], s3),
            g3 = null;
          function m3(t5) {
            if (g3) return g3;
            g3 = {
              extent: p3 ? p3.evaluate(t5) : null,
              marginInside: l3 ? l3.evaluate(t5) : null,
              marginOutside: u3 ? u3.evaluate(t5) : null,
            };
            var e5 = s3.evaluate(t5),
              n5 = 0;
            return (
              [f3, h3, c3, d3].forEach(function (e6) {
                e6 && (n5 += e6.evaluate(t5));
              }),
              (null === g3.marginInside || null === g3.marginOutside) &&
                n5 + g3.extent + g3.marginInside + g3.marginOutside > e5 &&
                (null === g3.marginInside && (g3.marginInside = 0),
                null === g3.marginOutside && (g3.marginOutside = 0)),
              null !== g3.extent &&
                null !== g3.marginInside &&
                null !== g3.marginOutside &&
                (g3.marginOutside = null),
              null === g3.extent &&
              null !== g3.marginInside &&
              null !== g3.marginOutside
                ? (g3.extent = e5 - n5 - g3.marginInside - g3.marginOutside)
                : null !== g3.extent &&
                  null === g3.marginInside &&
                  null !== g3.marginOutside
                ? (g3.marginInside = e5 - n5 - g3.extent - g3.marginOutside)
                : null !== g3.extent &&
                  null !== g3.marginInside &&
                  null === g3.marginOutside
                ? (g3.marginOutside = e5 - n5 - g3.extent - g3.marginInside)
                : null === g3.extent
                ? ((g3.marginInside = g3.marginOutside = 0),
                  (g3.extent = e5 - n5))
                : (g3.marginInside = g3.marginOutside =
                    (e5 - n5 - g3.extent) / 2),
              g3
            );
          }
          (n4[a3] = new We(
            new ge(
              i3,
              function () {
                var t5 = m3(this).extent;
                return null === t5 ? 0 : t5;
              },
              a3,
            ),
          )),
            (n4['margin-' + r3] = new We(
              new ge(
                i3,
                function () {
                  var t5 = m3(this).marginInside;
                  return null === t5 ? 0 : t5;
                },
                'margin-' + r3,
              ),
            )),
            (n4['margin-' + o3] = new We(
              new ge(
                i3,
                function () {
                  var t5 = m3(this).marginOutside;
                  return null === t5 ? 0 : t5;
                },
                'margin-' + o3,
              ),
            )),
            'left' === r3
              ? (n4.left = new We(be(i3, e4.marginLeft, e4.borderBoxWidth)))
              : 'top' === r3 &&
                (n4.top = new We(be(i3, e4.marginTop, e4.borderBoxHeight)));
        }),
        (n3.initHorizontal = function () {
          var t4 = this.parentInstance.pageAreaDimension;
          this.boxInfo.isInLeftColumn
            ? this.positionAndSizeAlongFixedDimension(
                { inside: 'right', outside: 'left', extent: 'width' },
                t4,
              )
            : this.boxInfo.isInRightColumn
            ? this.positionAndSizeAlongFixedDimension(
                { inside: 'left', outside: 'right', extent: 'width' },
                t4,
              )
            : this.positionAlongVariableDimension(
                { start: 'left', end: 'right', extent: 'width' },
                t4,
              );
        }),
        (n3.initVertical = function () {
          var t4 = this.parentInstance.pageAreaDimension;
          this.boxInfo.isInTopRow
            ? this.positionAndSizeAlongFixedDimension(
                { inside: 'bottom', outside: 'top', extent: 'height' },
                t4,
              )
            : this.boxInfo.isInBottomRow
            ? this.positionAndSizeAlongFixedDimension(
                { inside: 'top', outside: 'bottom', extent: 'height' },
                t4,
              )
            : this.positionAlongVariableDimension(
                { start: 'top', end: 'bottom', extent: 'height' },
                t4,
              );
        }),
        (n3.finishContainer = function (e4, n4, i3, r3, o3, a3, s3) {
          t3.prototype.finishContainer.call(this, e4, n4, i3, r3, o3, a3, s3);
          var l3 = i3.marginBoxes,
            u3 = this.pageBox.marginBoxName,
            h3 = this.boxInfo;
          h3.isInLeftColumn || h3.isInRightColumn
            ? h3.isInTopRow ||
              h3.isInBottomRow ||
              (h3.isInLeftColumn
                ? (l3.left[u3] = n4)
                : h3.isInRightColumn && (l3.right[u3] = n4))
            : h3.isInTopRow
            ? (l3.top[u3] = n4)
            : h3.isInBottomRow && (l3.bottom[u3] = n4);
        }),
        e3
      );
    })(oh);
    var Bh = (function () {
      function t3(t4, e4, n3, i3, r3) {
        (this.cascadeInstance = t4),
          (this.pageScope = e4),
          (this.rootPageBoxInstance = n3),
          (this.context = i3),
          (this.docElementStyle = r3),
          (this.pageMasterCache = {}),
          this.definePageProgression();
      }
      var e3 = t3.prototype;
      return (
        (e3.definePageProgression = function () {
          var t4 = this.pageScope,
            e4 = new de(t4, 'page-number'),
            n3 = new oe(t4, new ce(t4, e4, new Ee(t4, 2)), t4.zero);
          t4.defineName('recto-page', new qt(t4, n3)),
            t4.defineName('verso-page', n3),
            (this.context.pageProgression || hh(this.docElementStyle)) ===
            exports.PageProgression.LTR
              ? (t4.defineName('left-page', n3),
                t4.defineName('right-page', new qt(t4, n3)))
              : (t4.defineName('left-page', new qt(t4, n3)),
                t4.defineName('right-page', n3));
        }),
        (e3.getCascadedPageStyle = function () {
          var t4 = {};
          return (
            this.cascadeInstance.pushRule([], '', t4),
            this.cascadeInstance.popRule(),
            t4
          );
        }),
        (e3.getPageRulePageMaster = function (t4, e4) {
          var n3 = t4.pageBox;
          if (0 === Object.keys(e4).length) return n3.resetScope(), t4;
          var i3 = this.makeCacheKey(e4, n3),
            r3 = this.pageMasterCache[i3];
          return (
            r3 ||
              ((r3 =
                n3.pseudoName === eh
                  ? this.generatePageRuleMaster(e4)
                  : this.generateCascadedPageMaster(e4, n3)),
              (this.pageMasterCache[i3] = r3)),
            r3.pageBox.resetScope(),
            r3
          );
        }),
        (e3.makeCacheKey = function (t4, e4) {
          var n3 = this.makeCascadeValueObjectKey(t4);
          return e4.key + '^' + n3;
        }),
        (e3.makeCascadeValueObjectKey = function (t4) {
          var e4 = [];
          for (var n3 in t4)
            if (Object.prototype.hasOwnProperty.call(t4, n3)) {
              var i3,
                r3 = t4[n3];
              (i3 =
                r3 instanceof kr
                  ? '' + r3.value
                  : this.makeCascadeValueObjectKey(r3)),
                e4.push(n3 + i3 + (r3.priority || ''));
            }
          return e4.sort().join('^');
        }),
        (e3.generatePageRuleMaster = function (t4) {
          var e4 = new Ph(
            this.pageScope,
            this.rootPageBoxInstance.pageBox,
            t4,
          ).createInstance(this.rootPageBoxInstance);
          return (
            e4.applyCascadeAndInit(this.cascadeInstance, this.docElementStyle),
            e4.resolveAutoSizing(this.context),
            e4
          );
        }),
        (e3.generateCascadedPageMaster = function (t4, e4) {
          var n3 = e4.clone({ pseudoName: 'vivliostyle-page-rule-master' }),
            i3 = n3.specified,
            r3 = t4.size;
          if (r3) {
            var o3 = Eh(t4),
              a3 = r3.priority;
            (i3.width = Dr(this.context, i3.width, new kr(o3.width, a3))),
              (i3.height = Dr(this.context, i3.height, new kr(o3.height, a3)));
          }
          ['counter-reset', 'counter-increment'].forEach(function (e5) {
            i3[e5] && (t4[e5] = i3[e5]);
          });
          var s3 = n3.createInstance(this.rootPageBoxInstance);
          return (
            s3.applyCascadeAndInit(this.cascadeInstance, this.docElementStyle),
            s3.resolveAutoSizing(this.context),
            s3
          );
        }),
        t3
      );
    })();
    var Mh = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).pageType = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          t4.currentPageType === this.pageType && this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 3;
        }),
        (n3.makePrimary = function (t4) {
          return (
            this.chained &&
              t4.insertInTable(t4.pagetypes, this.pageType, this.chained),
            true
          );
        }),
        e3
      );
    })(eo);
    var Uh = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).scope = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          1 === new de(this.scope, 'page-number').evaluate(t4.context) &&
            this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 2;
        }),
        e3
      );
    })(eo);
    var Vh = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).scope = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          new de(this.scope, 'left-page').evaluate(t4.context) &&
            this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 1;
        }),
        e3
      );
    })(eo);
    var Hh = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).scope = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          new de(this.scope, 'right-page').evaluate(t4.context) &&
            this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 1;
        }),
        e3
      );
    })(eo);
    var zh = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).scope = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          new de(this.scope, 'recto-page').evaluate(t4.context) &&
            this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 1;
        }),
        e3
      );
    })(eo);
    var Gh = (function (t3) {
      function e3(e4) {
        var n4;
        return ((n4 = t3.call(this) || this).scope = e4), n4;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.apply = function (t4) {
          new de(this.scope, 'verso-page').evaluate(t4.context) &&
            this.chained.apply(t4);
        }),
        (n3.getPriority = function () {
          return 1;
        }),
        e3
      );
    })(eo);
    var Wh = (function (t3) {
      function e3(e4, n3) {
        return t3.call(this, e4, n3, null, null, null) || this;
      }
      return (
        I2(e3, t3),
        (e3.prototype.apply = function (t4) {
          !(function (t5, e4, n3, i3, r3) {
            Yr(t5, e4, n3, i3, null, null, null);
            var o3 = n3._marginBoxes;
            if (o3) {
              var a3 = Gr(e4, '_marginBoxes');
              for (var s3 in o3)
                if (o3.hasOwnProperty(s3)) {
                  var l3 = a3[s3];
                  l3 || (a3[s3] = l3 = {}),
                    Yr(t5, l3, o3[s3], i3, null, null, null);
                }
            }
          })(t4.context, t4.currentStyle, this.style, this.specificity);
        }),
        e3
      );
    })(to);
    var Xh = (function (t3) {
      function e3(e4, n4, i3, r3, o3) {
        var a3;
        return (
          ((a3 =
            t3.call(this, e4, n4, null, i3, null, r3, false) ||
            this).pageProps = o3),
          (a3.currentPageSelectors = []),
          (a3.currentNamedPageSelector = ''),
          (a3.currentPseudoPageClassSelectors = []),
          a3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.startPageRule = function () {
          this.startSelectorRule();
        }),
        (n3.tagSelector = function (t4, e4) {
          (this.currentNamedPageSelector = e4),
            e4 && (this.chain.push(new Mh(e4)), (this.specificity += 65536));
        }),
        (n3.pseudoclassSelector = function (t4, e4) {
          switch (
            (e4 &&
              this.reportAndSkip(
                'E_INVALID_PAGE_SELECTOR :' + t4 + '(' + e4.join('') + ')',
              ),
            this.currentPseudoPageClassSelectors.push(':' + t4),
            t4.toLowerCase())
          ) {
            case 'first':
              this.chain.push(new Uh(this.scope)), (this.specificity += 256);
              break;
            case 'left':
              this.chain.push(new Vh(this.scope)), (this.specificity += 1);
              break;
            case 'right':
              this.chain.push(new Hh(this.scope)), (this.specificity += 1);
              break;
            case 'recto':
              this.chain.push(new zh(this.scope)), (this.specificity += 1);
              break;
            case 'verso':
              this.chain.push(new Gh(this.scope)), (this.specificity += 1);
              break;
            default:
              this.reportAndSkip('E_INVALID_PAGE_SELECTOR :' + t4);
          }
        }),
        (n3.finishSelector = function () {
          var t4;
          (t4 =
            this.currentNamedPageSelector ||
            this.currentPseudoPageClassSelectors.length
              ? [this.currentNamedPageSelector].concat(
                  this.currentPseudoPageClassSelectors.sort(),
                )
              : null),
            this.currentPageSelectors.push({
              selectors: t4,
              specificity: this.specificity,
            }),
            (this.currentNamedPageSelector = ''),
            (this.currentPseudoPageClassSelectors = []);
        }),
        (n3.nextSelector = function () {
          this.finishSelector(), t3.prototype.nextSelector.call(this);
        }),
        (n3.startRuleBody = function () {
          this.finishSelector(), t3.prototype.startRuleBody.call(this);
        }),
        (n3.simpleProperty = function (e4, n4, i3) {
          var r3 = this;
          if (
            ('bleed' !== e4 && 'marks' !== e4) ||
            this.currentPageSelectors.some(function (t4) {
              return null === t4.selectors;
            })
          ) {
            t3.prototype.simpleProperty.call(this, e4, n4, i3);
            var o3 = Vr(this.elementStyle, e4),
              a3 = this.pageProps;
            if ('bleed' === e4 || 'marks' === e4)
              a3[''] || (a3[''] = {}),
                Object.keys(a3).forEach(function (t4) {
                  Hr(a3[t4], e4, o3);
                });
            else if ('size' === e4) {
              var s3 = a3[''];
              this.currentPageSelectors.forEach(function (t4) {
                var n5 = new kr(o3.value, o3.priority + t4.specificity),
                  i4 = t4.selectors ? t4.selectors.join('') : '',
                  l3 = a3[i4];
                if (l3) {
                  var u3 = Vr(l3, e4);
                  (n5 = u3 ? Dr(null, n5, u3) : n5), Hr(l3, e4, n5);
                } else
                  Hr((l3 = a3[i4] = {}), e4, n5),
                    s3 &&
                      ['bleed', 'marks'].forEach(function (t5) {
                        s3[t5] && Hr(l3, t5, s3[t5]);
                      }, r3);
              });
            }
          }
        }),
        (n3.insertNonPrimary = function (t4) {
          this.cascade.insertInTable(this.cascade.pagetypes, '*', t4);
        }),
        (n3.makeApplyRuleAction = function (t4) {
          return new Wh(this.elementStyle, t4);
        }),
        (n3.startPageMarginBoxRule = function (t4) {
          var e4 = Gr(this.elementStyle, '_marginBoxes'),
            n4 = e4[t4];
          n4 || (e4[t4] = n4 = {});
          var i3 = new jh(this.scope, this.owner, this.validatorSet, n4);
          this.owner.pushHandler(i3);
        }),
        e3
      );
    })(qo);
    var jh = (function (t3) {
      function e3(e4, n4, i3, r3) {
        var o3;
        return (
          ((o3 = t3.call(this, e4, n4, false) || this).validatorSet = i3),
          (o3.boxStyle = r3),
          o3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.property = function (t4, e4, n4) {
          this.validatorSet.validatePropertyAndHandleShorthand(
            t4,
            e4,
            n4,
            this,
          );
        }),
        (n3.invalidPropertyValue = function (t4, e4) {
          this.report('E_INVALID_PROPERTY_VALUE ' + t4 + ': ' + e4.toString());
        }),
        (n3.unknownProperty = function (t4, e4) {
          this.report('E_INVALID_PROPERTY ' + t4 + ': ' + e4.toString());
        }),
        (n3.simpleProperty = function (t4, e4, n4) {
          var i3 = n4
              ? this.getImportantSpecificity()
              : this.getBaseSpecificity(),
            r3 = new kr(e4, i3);
          Hr(this.boxStyle, t4, r3);
        }),
        e3
      );
    })(Yi);
    var Yh = function (t3, e3, n3) {
      return t3
        .replace(
          /[uU][rR][lL]\(\s*"((\\([^0-9a-fA-F]+|[0-9a-fA-F]+\s*)|[^"\r\n])+)"/gm,
          function (t4, i3) {
            return 'url("' + n3.transformURL(i3, e3) + '"';
          },
        )
        .replace(
          /[uU][rR][lL]\(\s*'((\\([^0-9a-fA-F]+|[0-9a-fA-F]+\s*)|[^'\r\n])+)'/gm,
          function (t4, i3) {
            return "url('" + n3.transformURL(i3, e3) + "'";
          },
        )
        .replace(
          /[uU][rR][lL]\(\s*((\\([^0-9a-fA-F]+|[0-9a-fA-F]+\s*)|[^"'\r\n\)\s])+)/gm,
          function (t4, i3) {
            return 'url(' + n3.transformURL(i3, e3);
          },
        );
    };
    var Kh = {};
    var qh = {
      'text-indent': '0px',
      'margin-top': '0px',
      'padding-top': '0px',
      'border-top-width': '0px',
      'border-top-style': 'none',
      'border-top-color': 'transparent',
      'border-top-left-radius': '0px',
      'border-top-right-radius': '0px',
    };
    var Qh = {
      'text-indent': '0px',
      'margin-right': '0px',
      'padding-right': '0px',
      'border-right-width': '0px',
      'border-right-style': 'none',
      'border-right-color': 'transparent',
      'border-top-right-radius': '0px',
      'border-bottom-right-radius': '0px',
    };
    var Zh = { 'margin-top': '0px' };
    var $h = { 'margin-right': '0px' };
    var Jh = (function (t3) {
      function e3(e4, n4, i3, r3, o3, a3, s3, l3, u3, h3, c3, f3, d3) {
        var p3;
        return (
          ((p3 = t3.call(this) || this).flowName = e4),
          (p3.context = n4),
          (p3.viewport = i3),
          (p3.styler = r3),
          (p3.regionIds = o3),
          (p3.xmldoc = a3),
          (p3.docFaces = s3),
          (p3.footnoteStyle = l3),
          (p3.stylerProducer = u3),
          (p3.page = h3),
          (p3.customRenderer = c3),
          (p3.fallbackMap = f3),
          (p3.documentURLTransformer = d3),
          (p3.nodeContext = null),
          (p3.viewRoot = null),
          (p3.isFootnote = false),
          (p3.sourceNode = null),
          (p3.offsetInNode = 0),
          (p3.viewNode = null),
          (p3.document = i3.document),
          (p3.exprContentListener = r3.counterListener.getExprContentListener()),
          p3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.clone = function () {
          return new e3(
            this.flowName,
            this.context,
            this.viewport,
            this.styler,
            this.regionIds,
            this.xmldoc,
            this.docFaces,
            this.footnoteStyle,
            this.stylerProducer,
            this.page,
            this.customRenderer,
            this.fallbackMap,
            this.documentURLTransformer,
          );
        }),
        (n3.createPseudoelementShadow = function (
          t4,
          e4,
          n4,
          i3,
          r3,
          o3,
          a3,
          s3,
        ) {
          var l3 = this.getPseudoMap(
            n4,
            this.regionIds,
            this.isFootnote,
            this.nodeContext,
            o3,
          );
          if (!l3) return s3;
          for (
            var u3,
              h3 = [],
              c3 = Ws.createElementNS(H2.SHADOW, 'root'),
              f3 = c3,
              d3 = D(Xs);
            !(u3 = d3()).done;

          ) {
            var p3 = u3.value,
              g3 = void 0;
            if (p3) {
              if (!l3[p3]) continue;
              if (!('footnote-marker' != p3 || (e4 && this.isFootnote)))
                continue;
              if (p3.match(/^first-/)) {
                var m3 = i3.display;
                if (!m3 || m3 === Ye.inline) continue;
              }
              if ('before' === p3 || 'after' === p3) {
                var v3 = l3[p3].content;
                if (!v3 || v3 === Ye.normal || v3 === Ye.none) continue;
              }
              h3.push(p3), Ys((g3 = Ws.createElementNS(H2.XHTML, 'span')), p3);
            } else g3 = Ws.createElementNS(H2.SHADOW, 'content');
            f3.appendChild(g3), p3.match(/^first-/) && (f3 = g3);
          }
          if (!h3.length) return s3;
          var E2 = new Ks(t4, n4, r3, o3, this.exprContentListener);
          return new Ga(t4, c3, null, a3, s3, za.ROOTLESS, E2);
        }),
        (n3.getPseudoMap = function (t4, e4, n4, i3, r3) {
          var o3 = zr(t4, '_pseudos');
          if (!o3) return null;
          var a3 = {},
            s3 = function (t5) {
              var i4 = (a3[t5] = {});
              la(i4, o3[t5], r3),
                ia(i4, r3, o3[t5]),
                sa(o3[t5], e4, n4, function (t6, e5) {
                  la(i4, e5, r3),
                    na(e5, function (t7) {
                      la(i4, t7, r3);
                    });
                });
            };
          for (var l3 in o3) s3(l3);
          return a3;
        }),
        (n3.createRefShadow = function (t4, e4, n4, i3, r3) {
          var o3 = this,
            a3 = bi('createRefShadow');
          return (
            o3.xmldoc.store.load(t4).then(function (s3) {
              var l3 = s3;
              if (l3) {
                var u3 = l3.getElement(t4);
                if (u3) {
                  var h3 = o3.stylerProducer.getStylerForDoc(l3);
                  r3 = new Ga(n4, u3, l3, i3, r3, e4, h3);
                }
              }
              a3.finish(r3);
            }),
            a3.result()
          );
        }),
        (n3.createShadows = function (t4, e4, n4, i3, r3, o3, a3) {
          var s3 = this,
            l3 = bi('createShadows'),
            u3 = i3.template;
          return (
            (u3 instanceof Ue
              ? s3.createRefShadow(u3.url, za.ROOTLESS, t4, a3, null)
              : Si(null)
            ).then(function (u4) {
              var h3 = null;
              if (t4.namespaceURI == H2.SHADOW && 'include' == t4.localName) {
                var c3 = t4.getAttribute('href'),
                  f3 = null;
                c3
                  ? (f3 = a3 ? a3.xmldoc : s3.xmldoc)
                  : a3 &&
                    ((c3 =
                      a3.owner.namespaceURI == H2.XHTML
                        ? a3.owner.getAttribute('href')
                        : a3.owner.getAttributeNS(H2.XLINK, 'href')),
                    (f3 = a3.parentShadow
                      ? a3.parentShadow.xmldoc
                      : s3.xmldoc)),
                  c3 &&
                    ((c3 = W(c3, f3.url)),
                    (h3 = s3.createRefShadow(c3, za.ROOTED, t4, a3, u4)));
              }
              null == h3 && (h3 = Si(u4));
              var d3 = null;
              h3.then(function (e5) {
                if (i3.display === Ye.table_cell) {
                  var n5 = W('user-agent.xml#table-cell', z2);
                  d3 = s3.createRefShadow(n5, za.ROOTLESS, t4, a3, e5);
                } else d3 = Si(e5);
              }),
                d3.then(function (u5) {
                  (u5 = s3.createPseudoelementShadow(
                    t4,
                    e4,
                    n4,
                    i3,
                    r3,
                    o3,
                    a3,
                    u5,
                  )),
                    l3.finish(u5);
                });
            }),
            l3.result()
          );
        }),
        (n3.setViewRoot = function (t4, e4) {
          (this.viewRoot = t4), (this.isFootnote = e4);
        }),
        (n3.computeStyle = function (t4, e4, n4, i3) {
          var r3 = this.context,
            o3 = aa(n4, r3, this.regionIds, this.isFootnote);
          (t4 = ra(o3, r3, t4)), (e4 = oa(o3, r3, e4));
          var a3 = this;
          ua(o3, i3, t4, e4, function (t5, e5) {
            var n5 = e5.evaluate(r3, t5);
            return (
              'font-family' == t5 && (n5 = a3.docFaces.filterFontFamily(n5)), n5
            );
          });
          var s3 = Ls(
            i3.display || Ye.inline,
            i3.position,
            i3.float,
            this.sourceNode === this.xmldoc.root,
          );
          return (
            ['display', 'position', 'float'].forEach(function (t5) {
              s3[t5] && (i3[t5] = s3[t5]);
            }),
            t4
          );
        }),
        (n3.inheritFromSourceParent = function (t4) {
          for (
            var e4 = this.nodeContext.sourceNode,
              n4 = [],
              i3 = null,
              r3 = this.nodeContext.shadowContext,
              o3 = -1;
            e4 && 1 == e4.nodeType;

          ) {
            var a3 = r3 && r3.root == e4;
            if (!a3 || r3.type == za.ROOTLESS) {
              var s3 = (r3 ? r3.styler : this.styler).getStyle(e4, false);
              n4.push(s3), (i3 = i3 || tt(e4));
            }
            a3
              ? ((e4 = r3.owner), (r3 = r3.parentShadow))
              : ((e4 = e4.parentNode), o3++);
          }
          for (
            var l3 = this.context.queryUnitSize('em', 0 === o3),
              u3 = { 'font-size': new kr(new De(l3, 'px'), 0) },
              h3 = new qr(u3, this.context),
              c3 = n4.length - 1;
            c3 >= 0;
            --c3
          ) {
            var f3 = n4[c3],
              d3 = [];
            for (var p3 in f3) Ur(p3) && d3.push(p3);
            d3.sort(Je);
            for (var g3 = 0, m3 = d3; g3 < m3.length; g3++) {
              var v3 = m3[g3];
              h3.setPropName(v3);
              var E2 = Vr(f3, v3);
              E2.value !== Ye.inherit && (u3[v3] = E2.filterValue(h3));
            }
          }
          for (var y3 in t4) Ur(y3) || (u3[y3] = t4[y3]);
          return { lang: i3, elementStyle: u3 };
        }),
        (n3.resolveURL = function (t4) {
          return (t4 = W(t4, this.xmldoc.url)), this.fallbackMap[t4] || t4;
        }),
        (n3.inheritLangAttribute = function () {
          this.nodeContext.lang =
            tt(this.nodeContext.sourceNode) ||
            (this.nodeContext.parent && this.nodeContext.parent.lang) ||
            this.nodeContext.lang;
        }),
        (n3.transferPolyfilledInheritedProps = function (t4) {
          var e4 = Sr().filter(function (e5) {
            return t4[e5];
          });
          if (e4.length) {
            var n4 = this.nodeContext.inheritedProps;
            if (this.nodeContext.parent)
              for (var i3 in ((n4 = this.nodeContext.inheritedProps = {}),
              this.nodeContext.parent.inheritedProps))
                n4[i3] = this.nodeContext.parent.inheritedProps[i3];
            e4.forEach(function (e5) {
              var i4 = t4[e5];
              if (i4) {
                if (i4 instanceof Be) n4[e5] = i4.num;
                else if (i4 instanceof ke) n4[e5] = i4.name;
                else if (i4 instanceof De) {
                  var r3 = i4;
                  switch (r3.unit) {
                    case 'dpi':
                    case 'dpcm':
                    case 'dppx':
                      n4[e5] = r3.num * Ut[r3.unit];
                  }
                } else n4[e5] = i4;
                delete t4[e5];
              }
            });
          }
        }),
        (n3.resolveFormattingContext = function (t4, e4, n4, i3, r3, o3) {
          for (
            var a3 = g2(exports.HOOKS.RESOLVE_FORMATTING_CONTEXT), s3 = 0;
            s3 < a3.length;
            s3++
          ) {
            var l3 = a3[s3](t4, e4, n4, i3, r3, o3);
            if (l3) return void (t4.formattingContext = l3);
          }
        }),
        (n3.createElementView = function (t4, e4) {
          var n4 = this,
            i3 = true,
            r3 = bi('createElementView'),
            o3 = n4.sourceNode,
            a3 = n4.nodeContext.shadowContext
              ? n4.nodeContext.shadowContext.styler
              : n4.styler,
            s3 = a3.getStyle(o3, false);
          if (!n4.nodeContext.shadowContext) {
            var l3 = this.xmldoc.getElementOffset(o3);
            yr.registerFragmentIndex(l3, n4.nodeContext.fragmentIndex, 0);
          }
          var u3 = {};
          if (!n4.nodeContext.parent) {
            var h3 = n4.inheritFromSourceParent(s3);
            (s3 = h3.elementStyle), (n4.nodeContext.lang = h3.lang);
          }
          var c3 =
            s3['float-reference'] &&
            (function (t5) {
              switch (t5) {
                case 'inline':
                  return ts.INLINE;
                case 'column':
                  return ts.COLUMN;
                case 'region':
                  return ts.REGION;
                case 'page':
                  return ts.PAGE;
                default:
                  throw new Error('Unknown float-reference: ' + t5);
              }
            })(s3['float-reference'].value.toString());
          if (n4.nodeContext.parent && c3 && es(c3)) {
            var f3 = n4.inheritFromSourceParent(s3);
            (s3 = f3.elementStyle), (n4.nodeContext.lang = f3.lang);
          }
          (n4.nodeContext.vertical = n4.computeStyle(
            n4.nodeContext.vertical,
            'rtl' === n4.nodeContext.direction,
            s3,
            u3,
          )),
            a3.processContent(o3, u3),
            this.transferPolyfilledInheritedProps(u3),
            this.inheritLangAttribute(),
            u3.direction &&
              (n4.nodeContext.direction = u3.direction.toString());
          var d3 = u3['flow-into'];
          if (d3 && d3.toString() != n4.flowName)
            return r3.finish(false), r3.result();
          var p3 = u3.display;
          if (p3 === Ye.none) return r3.finish(false), r3.result();
          var g3 = null == n4.nodeContext.parent;
          return (
            (n4.nodeContext.flexContainer = p3 === Ye.flex),
            n4
              .createShadows(
                o3,
                g3,
                s3,
                u3,
                a3,
                n4.context,
                n4.nodeContext.shadowContext,
              )
              .then(function (l4) {
                n4.nodeContext.nodeShadow = l4;
                var h4 = u3.position,
                  f4 = u3.float,
                  d4 = u3.clear,
                  m3 = n4.nodeContext.vertical
                    ? Ye.vertical_rl
                    : Ye.horizontal_tb,
                  v3 = n4.nodeContext.parent
                    ? n4.nodeContext.parent.vertical
                      ? Ye.vertical_rl
                      : Ye.horizontal_tb
                    : m3,
                  E2 = (function (t5) {
                    return (
                      'true' === t5.getAttribute('data-vivliostyle-flow-root')
                    );
                  })(o3);
                (n4.nodeContext.establishesBFC = (function (
                  t5,
                  e5,
                  n5,
                  i4,
                  r4,
                  o4,
                  a4,
                ) {
                  return (
                    (r4 = r4 || o4 || Ye.horizontal_tb),
                    !!a4 ||
                      (!!n5 && n5 !== Ye.none) ||
                      As(e5) ||
                      t5 === Ye.inline_block ||
                      t5 === Ye.table_cell ||
                      t5 === Ye.table_caption ||
                      t5 == Ye.flex ||
                      ((t5 === Ye.block || t5 === Ye.list_item) &&
                        !!i4 &&
                        i4 !== Ye.visible) ||
                      (!!o4 && r4 !== o4)
                  );
                })(p3, h4, f4, u3.overflow, m3, v3, E2)),
                  (n4.nodeContext.containingBlockForAbsolute = (function (t5) {
                    return (
                      t5 === Ye.relative ||
                      t5 === Ye.absolute ||
                      t5 === Ye.fixed
                    );
                  })(h4)),
                  !n4.nodeContext.isInsideBFC() ||
                    f4 === Ye.footnote ||
                    (c3 && es(c3)) ||
                    ((f4 = null), (d4 = null));
                var y3 =
                  f4 === Ye.left ||
                  f4 === Ye.right ||
                  f4 === Ye.top ||
                  f4 === Ye.bottom ||
                  f4 === Ye.inline_start ||
                  f4 === Ye.inline_end ||
                  f4 === Ye.block_start ||
                  f4 === Ye.block_end ||
                  f4 === Ye.snap_block ||
                  f4 === Ye.footnote;
                f4 &&
                  (delete u3.float,
                  f4 === Ye.footnote &&
                    (n4.isFootnote
                      ? ((y3 = false), (u3.display = Ye.block))
                      : (u3.display = Ye.inline))),
                  d4 &&
                    (d4 === Ye.inherit &&
                      n4.nodeContext.parent &&
                      n4.nodeContext.parent.clearSide &&
                      (d4 = Fe(n4.nodeContext.parent.clearSide)),
                    (d4 !== Ye.left &&
                      d4 !== Ye.right &&
                      d4 !== Ye.top &&
                      d4 !== Ye.bottom &&
                      d4 !== Ye.both &&
                      d4 !== Ye.all &&
                      d4 !== Ye.same) ||
                      (delete u3.clear,
                      u3.display &&
                        u3.display != Ye.inline &&
                        (n4.nodeContext.clearSide = d4.toString())));
                var w3 = p3 === Ye.list_item && u3['ua-list-item-count'];
                if (
                  ((y3 ||
                    (u3['break-inside'] && u3['break-inside'] !== Ye.auto)) &&
                    n4.nodeContext.breakPenalty++,
                  p3 &&
                    p3 !== Ye.inline &&
                    ks(p3) &&
                    n4.nodeContext.breakPenalty++,
                  (n4.nodeContext.inline =
                    (!y3 && !p3) ||
                    ks(p3) ||
                    (function (t5) {
                      switch (t5.toString()) {
                        case 'ruby-base':
                        case 'ruby-text':
                        case 'ruby-base-container':
                        case 'ruby-text-container':
                          return true;
                        default:
                          return false;
                      }
                    })(p3)),
                  (n4.nodeContext.display = p3 ? p3.toString() : 'inline'),
                  (n4.nodeContext.floatSide = y3 ? f4.toString() : null),
                  (n4.nodeContext.floatReference = c3 || ts.INLINE),
                  (n4.nodeContext.floatMinWrapBlock =
                    u3['float-min-wrap-block'] || null),
                  (n4.nodeContext.columnSpan = u3['column-span']),
                  !n4.nodeContext.inline)
                ) {
                  var N3 = u3['break-after'];
                  N3 && (n4.nodeContext.breakAfter = N3.toString());
                  var b3 = u3['break-before'];
                  b3 && (n4.nodeContext.breakBefore = b3.toString());
                }
                (n4.nodeContext.verticalAlign =
                  (u3['vertical-align'] && u3['vertical-align'].toString()) ||
                  'baseline'),
                  (n4.nodeContext.captionSide =
                    (u3['caption-side'] && u3['caption-side'].toString()) ||
                    'top');
                var S3 = u3['border-collapse'];
                if (!S3 || S3 === Fe('separate')) {
                  var C3,
                    T3,
                    x3 = u3['border-spacing'];
                  x3 &&
                    (x3.isSpaceList()
                      ? ((C3 = x3.values[0]), (T3 = x3.values[1]))
                      : (C3 = T3 = x3),
                    C3.isNumeric() &&
                      (n4.nodeContext.inlineBorderSpacing = Xe(C3, n4.context)),
                    T3.isNumeric() &&
                      (n4.nodeContext.blockBorderSpacing = Xe(T3, n4.context)));
                }
                n4.nodeContext.footnotePolicy = u3['footnote-policy'];
                var I3 = u3['x-first-pseudo'];
                I3 &&
                  (n4.nodeContext.firstPseudo = new Xa(
                    n4.nodeContext.parent
                      ? n4.nodeContext.parent.firstPseudo
                      : null,
                    I3.num,
                  )),
                  n4.nodeContext.inline ||
                    n4.processAfterIfcontinues(o3, s3, a3, n4.context);
                var P3 = u3['white-space'];
                if (P3) {
                  var R2 = Oa(P3.toString());
                  null !== R2 && (n4.nodeContext.whitespace = R2);
                }
                var A3 = u3['hyphenate-character'];
                A3 &&
                  A3 !== Ye.auto &&
                  (n4.nodeContext.hyphenateCharacter = A3.str),
                  (n4.nodeContext.breakWord =
                    u3['word-break'] === Ye.break_all ||
                    (u3['overflow-wrap'] || ['word-wrap']) === Ye.break_word),
                  n4.resolveFormattingContext(
                    n4.nodeContext,
                    t4,
                    p3,
                    h4,
                    f4,
                    g3,
                  ),
                  n4.nodeContext.parent &&
                    n4.nodeContext.parent.formattingContext &&
                    (t4 = n4.nodeContext.parent.formattingContext.isFirstTime(
                      n4.nodeContext,
                      t4,
                    )),
                  n4.nodeContext.inline ||
                    ((n4.nodeContext.repeatOnBreak = n4.processRepeatOnBreak(
                      u3,
                    )),
                    n4.findAndProcessRepeatingElements(o3, a3));
                var L3 = false,
                  O3 = null,
                  k3 = [],
                  F2 = o3.namespaceURI,
                  D2 = o3.localName;
                if (F2 == H2.XHTML)
                  'html' == D2 ||
                  'body' == D2 ||
                  'script' == D2 ||
                  'link' == D2 ||
                  'meta' == D2
                    ? (D2 = 'div')
                    : 'vide_' == D2
                    ? (D2 = 'video')
                    : 'audi_' == D2
                    ? (D2 = 'audio')
                    : 'object' == D2 && (L3 = !!n4.customRenderer),
                    o3.getAttribute('data-adapt-pseudo') &&
                      s3.content &&
                      s3.content.value &&
                      s3.content.value.url &&
                      (D2 = 'img');
                else if (F2 == H2.epub) (D2 = 'span'), (F2 = H2.XHTML);
                else if (F2 == H2.FB2) {
                  if (((F2 = H2.XHTML), 'image' == D2)) {
                    D2 = 'div';
                    var _3 = o3.getAttributeNS(H2.XLINK, 'href');
                    if (_3 && '#' == _3.charAt(0)) {
                      var B2 = n4.xmldoc.getElement(_3);
                      if (B2) {
                        O3 = n4.createElement(F2, 'img');
                        var M3 =
                          'data:' +
                          (B2.getAttribute('content-type') || 'image/jpeg') +
                          ';base64,' +
                          B2.textContent.replace(/[ \t\n\t]/g, '');
                        k3.push(_i(O3, M3));
                      }
                    }
                  } else D2 = ec[D2];
                  D2 || (D2 = n4.nodeContext.inline ? 'span' : 'div');
                } else if (F2 == H2.NCX)
                  if (((F2 = H2.XHTML), 'ncx' == D2 || 'navPoint' == D2))
                    D2 = 'div';
                  else if ('navLabel' == D2) {
                    D2 = 'span';
                    var U2 = o3.parentNode;
                    if (U2) {
                      for (
                        var V2 = null, z3 = U2.firstChild;
                        z3;
                        z3 = z3.nextSibling
                      )
                        if (
                          1 == z3.nodeType &&
                          z3.namespaceURI == H2.NCX &&
                          'content' == z3.localName
                        ) {
                          V2 = z3.getAttribute('src');
                          break;
                        }
                      V2 &&
                        ((D2 = 'a'),
                        (o3 = o3.ownerDocument.createElementNS(
                          F2,
                          'a',
                        )).setAttribute('href', V2));
                    }
                  } else D2 = 'span';
                else
                  F2 == H2.SHADOW
                    ? ((F2 = H2.XHTML),
                      (D2 = n4.nodeContext.inline ? 'span' : 'div'))
                    : (L3 = !!n4.customRenderer);
                if (w3)
                  t4
                    ? (D2 = 'li')
                    : ((D2 = 'div'), (u3.display = p3 = Ye.block));
                else if ('body' == D2 || 'li' == D2) D2 = 'div';
                else if ('q' == D2) D2 = 'span';
                else if ('a' == D2) {
                  var G2 = u3['hyperlink-processing'];
                  G2 && 'normal' != G2.toString() && (D2 = 'span');
                }
                u3.behavior &&
                  'none' != u3.behavior.toString() &&
                  n4.customRenderer &&
                  (L3 = true),
                  o3.dataset &&
                    'true' === o3.getAttribute('data-math-typeset') &&
                    (L3 = true),
                  (L3
                    ? n4.customRenderer(
                        o3,
                        n4.nodeContext.parent
                          ? n4.nodeContext.parent.viewNode
                          : null,
                        u3,
                      )
                    : Si(null)
                  ).then(function (a4) {
                    var s4;
                    a4
                      ? L3 &&
                        (i3 =
                          'true' ==
                          a4.getAttribute('data-adapt-process-children'))
                      : (a4 = n4.createElement(F2, D2)),
                      'a' == D2 &&
                        a4.addEventListener(
                          'click',
                          n4.page.hrefHandler,
                          false,
                        ),
                      O3 &&
                        (n4.applyPseudoelementStyle(
                          n4.nodeContext,
                          'inner',
                          O3,
                        ),
                        a4.appendChild(O3)),
                      'iframe' == a4.localName &&
                        a4.namespaceURI == H2.XHTML &&
                        (s4 = a4).addEventListener(
                          'load',
                          function () {
                            s4.contentWindow.navigator.epubReadingSystem = {
                              name: 'adapt',
                              version: '0.1',
                              layoutStyle: 'paginated',
                              hasFeature: function (t5, e5) {
                                switch (t5) {
                                  case 'mouse-events':
                                    return true;
                                }
                                return false;
                              },
                            };
                          },
                          false,
                        );
                    var l5 = n4.nodeContext.inheritedProps['image-resolution'],
                      h5 = [],
                      c4 = u3.width,
                      f5 = u3.height,
                      d5 = o3.getAttribute('width'),
                      p4 = o3.getAttribute('height'),
                      g4 = c4 === Ye.auto || (!c4 && !d5),
                      m4 = f5 === Ye.auto || (!f5 && !p4);
                    if (o3.namespaceURI != H2.FB2 || 'td' == D2) {
                      for (
                        var v4 = o3.attributes,
                          E3 = v4.length,
                          y4 = null,
                          N4 = 0;
                        N4 < E3;
                        N4++
                      ) {
                        var b4 = v4[N4],
                          S4 = b4.namespaceURI,
                          C4 = b4.localName,
                          T4 = b4.nodeValue;
                        if (S4) {
                          if ('http://www.w3.org/2000/xmlns/' == S4) continue;
                          S4 == H2.XLINK &&
                            'href' == C4 &&
                            (T4 = n4.resolveURL(T4));
                        } else {
                          if (C4.match(/^on/)) continue;
                          if ('style' == C4) continue;
                          if (('id' == C4 || 'name' == C4) && t4) {
                            (T4 = n4.documentURLTransformer.transformFragment(
                              T4,
                              n4.xmldoc.url,
                            )),
                              a4.setAttribute(C4, T4),
                              n4.page.registerElementWithId(a4, T4);
                            continue;
                          }
                          if (
                            ('src' == C4 || 'href' == C4 || 'poster' == C4
                              ? ((T4 = n4.resolveURL(T4)),
                                'href' === C4 &&
                                  (T4 = n4.documentURLTransformer.transformURL(
                                    T4,
                                    n4.xmldoc.url,
                                  )))
                              : 'srcset' == C4 &&
                                (T4 = T4.split(',')
                                  .map(function (t5) {
                                    return n4.resolveURL(t5.trim());
                                  })
                                  .join(',')),
                            'poster' === C4 &&
                              'video' === D2 &&
                              F2 === H2.XHTML &&
                              g4 &&
                              m4)
                          ) {
                            var x4 = new Image(),
                              I4 = _i(x4, T4);
                            k3.push(I4),
                              h5.push({ image: x4, element: a4, fetcher: I4 });
                          }
                        }
                        if (
                          (F2 == H2.SVG &&
                            /^[A-Z\-]+$/.test(C4) &&
                            (C4 = C4.toLowerCase()),
                          n4.isSVGUrlAttribute(C4) &&
                            (T4 = Yh(
                              T4,
                              n4.xmldoc.url,
                              n4.documentURLTransformer,
                            )),
                          S4)
                        ) {
                          var P4 = Kh[S4];
                          P4 && (C4 = P4 + ':' + C4);
                        }
                        'src' != C4 ||
                        S4 ||
                        ('img' != D2 && 'input' != D2) ||
                        F2 != H2.XHTML
                          ? 'href' == C4 &&
                            'image' == D2 &&
                            F2 == H2.SVG &&
                            S4 == H2.XLINK
                            ? n4.page.fetchers.push(_i(a4, T4))
                            : S4
                            ? a4.setAttributeNS(S4, C4, T4)
                            : a4.setAttribute(C4, T4)
                          : (y4 = T4);
                      }
                      if (y4) {
                        var R3 = 'input' === D2 ? new Image() : a4,
                          A4 = _i(R3, y4);
                        R3 !== a4 && (a4.src = y4),
                          g4 || m4
                            ? (g4 &&
                                m4 &&
                                l5 &&
                                1 !== l5 &&
                                h5.push({
                                  image: R3,
                                  element: a4,
                                  fetcher: A4,
                                }),
                              k3.push(A4))
                            : n4.page.fetchers.push(A4);
                      }
                    }
                    delete u3.content;
                    var _4 = u3['list-style-image'];
                    if (_4 && _4 instanceof Ue) {
                      var B3 = _4.url;
                      k3.push(_i(new Image(), B3));
                    }
                    if (
                      (n4.preprocessElementStyle(u3),
                      n4.applyComputedStyles(a4, u3),
                      !n4.nodeContext.inline)
                    ) {
                      var M4 = null;
                      if (
                        (t4
                          ? e4 && (M4 = n4.nodeContext.vertical ? $h : Zh)
                          : (M4 =
                              'clone' !==
                              n4.nodeContext.inheritedProps[
                                'box-decoration-break'
                              ]
                                ? n4.nodeContext.vertical
                                  ? Qh
                                  : qh
                                : n4.nodeContext.vertical
                                ? $h
                                : Zh),
                        M4)
                      )
                        for (var U3 in M4) $2(a4, U3, M4[U3]);
                    }
                    w3 &&
                      a4.setAttribute(
                        'value',
                        u3['ua-list-item-count'].stringValue(),
                      ),
                      (n4.viewNode = a4),
                      k3.length
                        ? Di(k3).then(function () {
                            l5 > 0 &&
                              n4.modifyElemDimensionWithImageResolution(
                                h5,
                                l5,
                                u3,
                                n4.nodeContext.vertical,
                              ),
                              r3.finish(i3);
                          })
                        : r3.timeSlice().then(function () {
                            r3.finish(i3);
                          });
                  });
              }),
            r3.result()
          );
        }),
        (n3.processAfterIfcontinues = function (t4, e4, n4, i3) {
          var r3 = this.getPseudoMap(
            e4,
            this.regionIds,
            this.isFootnote,
            this.nodeContext,
            i3,
          );
          if (
            r3 &&
            r3['after-if-continues'] &&
            r3['after-if-continues'].content
          ) {
            var o3 = new Ks(t4, e4, n4, i3, this.exprContentListener);
            this.nodeContext.afterIfContinues = new Qs(t4, o3);
          }
        }),
        (n3.isSVGUrlAttribute = function (t4) {
          return e3.SVG_URL_ATTRIBUTES.includes(t4.toLowerCase());
        }),
        (n3.modifyElemDimensionWithImageResolution = function (t4, e4, n4, i3) {
          var r3 = this;
          t4.forEach(function (t5) {
            if ('load' === t5.fetcher.get().get()) {
              var o3 = t5.image,
                a3 = o3.width / e4,
                s3 = o3.height / e4,
                l3 = t5.element;
              if (a3 > 0 && s3 > 0) {
                if (
                  (n4['box-sizing'] === Ye.border_box &&
                    (n4['border-left-style'] !== Ye.none &&
                      (a3 += Xe(n4['border-left-width'], r3.context)),
                    n4['border-right-style'] !== Ye.none &&
                      (a3 += Xe(n4['border-right-width'], r3.context)),
                    n4['border-top-style'] !== Ye.none &&
                      (s3 += Xe(n4['border-top-width'], r3.context)),
                    n4['border-bottom-style'] !== Ye.none &&
                      (s3 += Xe(n4['border-bottom-width'], r3.context))),
                  e4 > 1)
                ) {
                  var u3 = n4['max-width'] || Ye.none,
                    h3 = n4['max-height'] || Ye.none;
                  if (u3 === Ye.none && h3 === Ye.none)
                    $2(l3, 'max-width', a3 + 'px');
                  else if (u3 !== Ye.none && h3 === Ye.none)
                    $2(l3, 'width', a3 + 'px');
                  else if (u3 === Ye.none && h3 !== Ye.none)
                    $2(l3, 'height', s3 + 'px');
                  else {
                    u3.isNumeric(), h3.isNumeric();
                    var c3 = h3;
                    '%' !== u3.unit
                      ? $2(
                          l3,
                          'max-width',
                          Math.min(a3, Xe(u3, r3.context)) + 'px',
                        )
                      : '%' !== c3.unit
                      ? $2(
                          l3,
                          'max-height',
                          Math.min(s3, Xe(c3, r3.context)) + 'px',
                        )
                      : i3
                      ? $2(l3, 'height', s3 + 'px')
                      : $2(l3, 'width', a3 + 'px');
                  }
                } else if (e4 < 1) {
                  var f3 = n4['min-width'] || Ze,
                    d3 = n4['min-height'] || Ze;
                  f3.isNumeric(), f3.isNumeric();
                  var p3 = f3,
                    g3 = d3;
                  0 === p3.num && 0 === g3.num
                    ? $2(l3, 'min-width', a3 + 'px')
                    : 0 !== p3.num && 0 === g3.num
                    ? $2(l3, 'width', a3 + 'px')
                    : 0 === p3.num && 0 !== g3.num
                    ? $2(l3, 'height', s3 + 'px')
                    : '%' !== p3.unit
                    ? $2(
                        l3,
                        'min-width',
                        Math.max(a3, Xe(p3, r3.context)) + 'px',
                      )
                    : '%' !== g3.unit
                    ? $2(
                        l3,
                        'min-height',
                        Math.max(s3, Xe(g3, r3.context)) + 'px',
                      )
                    : i3
                    ? $2(l3, 'height', s3 + 'px')
                    : $2(l3, 'width', a3 + 'px');
                }
              }
            }
          });
        }),
        (n3.preprocessElementStyle = function (t4) {
          var e4 = this;
          g2(exports.HOOKS.PREPROCESS_ELEMENT_STYLE).forEach(function (n4) {
            n4(e4.nodeContext, t4);
          });
        }),
        (n3.findAndProcessRepeatingElements = function (t4, e4) {
          for (var n4 = t4.firstChild; n4; n4 = n4.nextSibling)
            if (1 === n4.nodeType) {
              var i3 = {},
                r3 = e4.getStyle(n4, false);
              if (
                (this.computeStyle(
                  this.nodeContext.vertical,
                  'rtl' === this.nodeContext.direction,
                  r3,
                  i3,
                ),
                this.processRepeatOnBreak(i3))
              ) {
                if (
                  this.nodeContext.formattingContext instanceof dl &&
                  !this.nodeContext.belongsTo(
                    this.nodeContext.formattingContext,
                  )
                )
                  return;
                var o3 = this.nodeContext.parent;
                return (
                  (this.nodeContext.formattingContext = new dl(
                    o3 && o3.formattingContext,
                    this.nodeContext.sourceNode,
                  )),
                  void this.nodeContext.formattingContext.initializeRepetitiveElements(
                    this.nodeContext.vertical,
                  )
                );
              }
            }
        }),
        (n3.processRepeatOnBreak = function (t4) {
          var e4 = t4['repeat-on-break'];
          return e4 !== Ye.none &&
            (e4 === Ye.auto &&
              (e4 =
                t4.display === Ye.table_header_group
                  ? Ye.header
                  : t4.display === Ye.table_footer_group
                  ? Ye.footer
                  : Ye.none),
            e4 && e4 !== Ye.none)
            ? e4.toString()
            : null;
        }),
        (n3.createTextNodeView = function () {
          var t4 = this,
            e4 = bi('createTextNodeView');
          return (
            this.preprocessTextContent().then(function () {
              var n4 = t4.offsetInNode || 0,
                i3 = Sa(t4.nodeContext.preprocessedTextContent).substr(n4);
              (t4.viewNode = document.createTextNode(i3)), e4.finish(true);
            }),
            e4.result()
          );
        }),
        (n3.preprocessTextContent = function () {
          if (null != this.nodeContext.preprocessedTextContent) return Si(true);
          var t4,
            e4 = this,
            n4 = (t4 = e4.sourceNode.textContent),
            r3 = bi('preprocessTextContent'),
            o3 = g2(exports.HOOKS.PREPROCESS_TEXT_CONTENT),
            a3 = 0;
          return (
            r3
              .loop(function () {
                return a3 >= o3.length
                  ? Si(false)
                  : o3[a3++](e4.nodeContext, n4).thenAsync(function (t5) {
                      return (n4 = t5), Si(true);
                    });
              })
              .then(function () {
                (e4.nodeContext.preprocessedTextContent = i2(t4, n4, 0)),
                  r3.finish(true);
              }),
            r3.result()
          );
        }),
        (n3.createNodeView = function (t4, e4) {
          var n4,
            i3 = this,
            r3 = bi('createNodeView'),
            o3 = true;
          return (
            1 == i3.sourceNode.nodeType
              ? (n4 = i3.createElementView(t4, e4))
              : 8 == i3.sourceNode.nodeType
              ? ((i3.viewNode = null), (n4 = Si(true)))
              : (n4 = i3.createTextNodeView()),
            n4.then(function (t5) {
              if (
                ((o3 = t5),
                (i3.nodeContext.viewNode = i3.viewNode),
                i3.viewNode)
              ) {
                var e5 = i3.nodeContext.parent
                  ? i3.nodeContext.parent.viewNode
                  : i3.viewRoot;
                e5 && e5.appendChild(i3.viewNode);
              }
              r3.finish(o3);
            }),
            r3.result()
          );
        }),
        (n3.setCurrent = function (t4, e4, n4) {
          return (
            (this.nodeContext = t4),
            t4
              ? ((this.sourceNode = t4.sourceNode),
                (this.offsetInNode = t4.offsetInNode))
              : ((this.sourceNode = null), (this.offsetInNode = -1)),
            (this.viewNode = null),
            this.nodeContext ? this.createNodeView(e4, !!n4) : Si(true)
          );
        }),
        (n3.processShadowContent = function (t4) {
          if (
            null == t4.shadowContext ||
            'content' != t4.sourceNode.localName ||
            t4.sourceNode.namespaceURI != H2.SHADOW
          )
            return t4;
          var e4,
            n4,
            i3,
            r3 = t4.boxOffset,
            o3 = t4.shadowContext,
            a3 = t4.parent;
          o3.subShadow
            ? ((i3 = o3.subShadow),
              (e4 = o3.root),
              (n4 = o3.type) == za.ROOTLESS && (e4 = e4.firstChild))
            : ((i3 = o3.parentShadow),
              (e4 = o3.owner.firstChild),
              (n4 = za.ROOTLESS));
          var s3 = t4.sourceNode.nextSibling;
          if (
            (s3
              ? ((t4.sourceNode = s3), t4.resetView())
              : t4.shadowSibling
              ? (t4 = t4.shadowSibling)
              : e4
              ? (t4 = null)
              : ((t4 = t4.parent.modify()).after = true),
            e4)
          ) {
            var l3 = new ja(e4, a3, r3);
            return (
              (l3.shadowContext = i3),
              (l3.shadowType = n4),
              (l3.shadowSibling = t4),
              l3
            );
          }
          return (t4.boxOffset = r3), t4;
        }),
        (n3.nextPositionInTree = function (t4) {
          var e4 = t4.boxOffset + 1;
          if (t4.after) {
            if (!t4.parent) return null;
            if (t4.shadowType != za.ROOTED) {
              var n4 = t4.sourceNode.nextSibling;
              if (n4)
                return (
                  ((t4 = t4.modify()).boxOffset = e4),
                  (t4.sourceNode = n4),
                  t4.resetView(),
                  this.processShadowContent(t4)
                );
            }
            return t4.shadowSibling
              ? (((t4 = t4.shadowSibling.modify()).boxOffset = e4), t4)
              : (((t4 = t4.parent.modify()).boxOffset = e4),
                (t4.after = true),
                t4);
          }
          if (t4.nodeShadow) {
            var i3 = t4.nodeShadow.root;
            if (
              (t4.nodeShadow.type == za.ROOTLESS && (i3 = i3.firstChild), i3)
            ) {
              var r3 = new ja(i3, t4, e4);
              return (
                (r3.shadowContext = t4.nodeShadow),
                (r3.shadowType = t4.nodeShadow.type),
                this.processShadowContent(r3)
              );
            }
          }
          var o3 = t4.sourceNode.firstChild;
          return o3
            ? this.processShadowContent(new ja(o3, t4, e4))
            : (1 != t4.sourceNode.nodeType &&
                (e4 +=
                  Sa(t4.preprocessedTextContent).length - 1 - t4.offsetInNode),
              ((t4 = t4.modify()).boxOffset = e4),
              (t4.after = true),
              t4);
        }),
        (n3.isTransclusion = function (t4, e4, n4) {
          var i3 = Vr(e4, 'hyperlink-processing');
          if (!i3) return false;
          var r3 = i3.evaluate(this.context, 'hyperlink-processing');
          return !!r3 && r3.toString() == n4;
        }),
        (n3.nextInTree = function (t4, e4) {
          var n4 = this,
            i3 = this.nextPositionInTree(t4);
          if (!i3 || i3.after) return Si(i3);
          var r3 = bi('nextInTree');
          return (
            this.setCurrent(i3, true, e4).then(function (t5) {
              (i3.viewNode && t5) ||
                (((i3 = i3.modify()).after = true),
                i3.viewNode || (i3.inline = true)),
                n4.dispatchEvent({ type: 'nextInTree', nodeContext: i3 }),
                r3.finish(i3);
            }),
            r3.result()
          );
        }),
        (n3.addImageFetchers = function (t4) {
          if (t4 instanceof ze)
            for (var e4 = t4.values, n4 = 0; n4 < e4.length; n4++)
              this.addImageFetchers(e4[n4]);
          else if (t4 instanceof Ue) {
            var i3 = t4.url;
            this.page.fetchers.push(_i(new Image(), i3));
          }
        }),
        (n3.applyComputedStyles = function (t4, e4) {
          var n4 = e4['background-image'];
          n4 && this.addImageFetchers(n4);
          var i3 = e4.position === Ye.relative;
          for (var r3 in e4)
            if (!nc[r3]) {
              var o3 = e4[r3];
              (o3 = o3.visit(
                new Rn(this.xmldoc.url, this.documentURLTransformer),
              )).isNumeric() &&
                Vt(o3.unit) &&
                (o3 = je(o3, this.context)),
                Ta[r3] || (i3 && xa[r3])
                  ? this.page.delayedItems.push(new Ia(t4, r3, o3))
                  : $2(t4, r3, o3.toString());
            }
        }),
        (n3.applyPseudoelementStyle = function (t4, e4, n4) {
          if (!t4.after) {
            var i3 = (t4.shadowContext
                ? t4.shadowContext.styler
                : this.styler
              ).getStyle(this.sourceNode, false),
              r3 = zr(i3, '_pseudos');
            if (r3 && (i3 = r3[e4])) {
              var o3 = {};
              t4.vertical = this.computeStyle(
                t4.vertical,
                'rtl' === t4.direction,
                i3,
                o3,
              );
              var a3 = o3.content;
              Ja(a3) &&
                (a3.visit(
                  new $a(n4, this.context, a3, this.exprContentListener),
                ),
                delete o3.content),
                this.applyComputedStyles(n4, o3);
            }
          }
        }),
        (n3.peelOff = function (t4, e4) {
          var n4 = bi('peelOff'),
            i3 = t4.firstPseudo,
            r3 = t4.offsetInNode,
            o3 = t4.after;
          if (e4 > 0)
            (t4.viewNode.textContent = t4.viewNode.textContent.substr(0, e4)),
              (r3 += e4);
          else if (!o3 && t4.viewNode && 0 == r3) {
            var a3 = t4.viewNode.parentNode;
            a3 && a3.removeChild(t4.viewNode);
          }
          for (var s3 = t4.boxOffset + e4, l3 = []; t4.firstPseudo === i3; )
            l3.push(t4), (t4 = t4.parent);
          var u3 = l3.pop(),
            h3 = u3.shadowSibling,
            c3 = this;
          return (
            n4
              .loop(function () {
                for (; l3.length > 0; ) {
                  (u3 = l3.pop()),
                    (t4 = new ja(u3.sourceNode, t4, s3)),
                    0 == l3.length && ((t4.offsetInNode = r3), (t4.after = o3)),
                    (t4.shadowType = u3.shadowType),
                    (t4.shadowContext = u3.shadowContext),
                    (t4.nodeShadow = u3.nodeShadow),
                    (t4.shadowSibling = u3.shadowSibling
                      ? u3.shadowSibling
                      : h3),
                    (h3 = null);
                  var e5 = c3.setCurrent(t4, false);
                  if (e5.isPending()) return e5;
                }
                return Si(false);
              })
              .then(function () {
                n4.finish(t4);
              }),
            n4.result()
          );
        }),
        (n3.createElement = function (t4, e4) {
          return t4 == H2.XHTML
            ? this.document.createElement(e4)
            : this.document.createElementNS(t4, e4);
        }),
        (n3.applyFootnoteStyle = function (t4, e4, n4) {
          var i3 = {},
            r3 = zr(this.footnoteStyle, '_pseudos');
          if (
            ((t4 = this.computeStyle(t4, e4, this.footnoteStyle, i3)),
            r3 && r3.before)
          ) {
            var o3 = {},
              a3 = this.createElement(H2.XHTML, 'span');
            Ys(a3, 'before'),
              n4.appendChild(a3),
              this.computeStyle(t4, e4, r3.before, o3),
              delete o3.content,
              this.applyComputedStyles(a3, o3);
          }
          return delete i3.content, this.applyComputedStyles(n4, i3), t4;
        }),
        (n3.processFragmentedBlockEdge = function (t4) {
          t4 &&
            t4.walkUpBlocks(function (t5) {
              var e4 = t5.inheritedProps['box-decoration-break'];
              if (!e4 || 'slice' === e4) {
                var n4 = t5.viewNode;
                t5.vertical
                  ? ($2(n4, 'padding-left', '0'),
                    $2(n4, 'border-left', 'none'),
                    $2(n4, 'border-top-left-radius', '0'),
                    $2(n4, 'border-bottom-left-radius', '0'))
                  : ($2(n4, 'padding-bottom', '0'),
                    $2(n4, 'border-bottom', 'none'),
                    $2(n4, 'border-bottom-left-radius', '0'),
                    $2(n4, 'border-bottom-right-radius', '0'));
              }
            });
        }),
        (n3.convertLengthToPx = function (t4, e4, n4) {
          var i3 = t4.num,
            r3 = t4.unit;
          if (
            (function (t5) {
              switch (t5.toLowerCase()) {
                case 'em':
                case 'ex':
                case 'rem':
                  return true;
                default:
                  return false;
              }
            })(r3)
          ) {
            for (var o3 = e4; o3 && 1 !== o3.nodeType; ) o3 = o3.parentNode;
            return Qr(
              t4,
              parseFloat(n4.getElementComputedStyle(o3)['font-size']),
              this.context,
            ).num;
          }
          var a3 = this.context.queryUnitSize(r3, false);
          return a3 ? i3 * a3 : t4;
        }),
        (n3.isSameNodePositionStep = function (t4, e4) {
          if (t4.shadowContext) {
            if (!e4.shadowContext) return false;
            var n4 = 1 === e4.node.nodeType ? e4.node : e4.node.parentElement;
            return (
              t4.shadowContext.owner === e4.shadowContext.owner &&
              js(1 === t4.node.nodeType ? t4.node : t4.node.parentElement) ===
                js(n4)
            );
          }
          return t4.node === e4.node;
        }),
        (n3.isSameNodePosition = function (t4, e4) {
          var n4 = this;
          return (
            t4.offsetInNode === e4.offsetInNode &&
            t4.after == e4.after &&
            t4.steps.length === e4.steps.length &&
            t4.steps.every(function (t5, i3) {
              return n4.isSameNodePositionStep(t5, e4.steps[i3]);
            })
          );
        }),
        (n3.isPseudoelement = function (t4) {
          return !!js(t4);
        }),
        e3
      );
    })(dt);
    Jh.SVG_URL_ATTRIBUTES = [
      'color-profile',
      'clip-path',
      'cursor',
      'filter',
      'marker',
      'marker-start',
      'marker-end',
      'marker-mid',
      'fill',
      'stroke',
      'mask',
    ];
    var tc;
    var ec = {
      a: 'a',
      sub: 'sub',
      sup: 'sup',
      table: 'table',
      tr: 'tr',
      td: 'td',
      th: 'th',
      code: 'code',
      body: 'div',
      p: 'p',
      v: 'p',
      date: 'p',
      emphasis: 'em',
      strong: 'strong',
      style: 'span',
      strikethrough: 'del',
    };
    var nc = {
      'box-decoration-break': true,
      'float-min-wrap-block': true,
      'float-reference': true,
      'flow-into': true,
      'flow-linger': true,
      'flow-options': true,
      'flow-priority': true,
      'footnote-policy': true,
      page: true,
    };
    var ic = (function () {
      function t3(t4) {
        (this.layoutBox = t4.layoutBox), (this.window = t4.window);
      }
      var e3 = t3.prototype;
      return (
        (e3.subtractOffsets = function (t4, e4) {
          var n3 = e4.left,
            i3 = e4.top;
          return {
            left: t4.left - n3,
            top: t4.top - i3,
            right: t4.right - n3,
            bottom: t4.bottom - i3,
            width: t4.width,
            height: t4.height,
          };
        }),
        (e3.getRangeClientRects = function (t4) {
          var e4 = this,
            n3 = t4.getClientRects(),
            i3 = this.layoutBox.getBoundingClientRect();
          return Array.from(n3).map(function (t5) {
            return e4.subtractOffsets(t5, i3);
          });
        }),
        (e3.getElementClientRect = function (t4) {
          var e4 = t4.getBoundingClientRect(),
            n3 = this.layoutBox.getBoundingClientRect();
          return this.subtractOffsets(e4, n3);
        }),
        (e3.getElementComputedStyle = function (t4) {
          return this.window.getComputedStyle(t4, null);
        }),
        t3
      );
    })();
    var rc = (function () {
      function t3(t4, e4, n3, i3, r3) {
        (this.window = t4),
          (this.fontSize = e4),
          (this.document = t4.document),
          (this.root = n3 || this.document.body);
        var o3 = this.root.firstElementChild;
        o3 ||
          ((o3 = this.document.createElement('div')).setAttribute(
            'data-vivliostyle-outer-zoom-box',
            'true',
          ),
          this.root.appendChild(o3));
        var a3 = o3.firstElementChild;
        a3 ||
          ((a3 = this.document.createElement('div')).setAttribute(
            'data-vivliostyle-spread-container',
            'true',
          ),
          o3.appendChild(a3));
        var s3 = o3.nextElementSibling;
        s3 ||
          ((s3 = this.document.createElement('div')).setAttribute(
            'data-vivliostyle-layout-box',
            'true',
          ),
          this.root.appendChild(s3)),
          (this.outerZoomBox = o3),
          (this.contentContainer = a3),
          (this.layoutBox = s3);
        var l3 = new ic(this).getElementComputedStyle(this.root);
        (this.width = i3 || parseFloat(l3.width) || t4.innerWidth),
          (this.height = r3 || parseFloat(l3.height) || t4.innerHeight);
      }
      var e3 = t3.prototype;
      return (
        (e3.resetZoom = function () {
          $2(this.outerZoomBox, 'width', ''),
            $2(this.outerZoomBox, 'height', ''),
            $2(this.contentContainer, 'width', ''),
            $2(this.contentContainer, 'height', ''),
            $2(this.contentContainer, 'transform', '');
        }),
        (e3.zoom = function (t4, e4, n3) {
          $2(this.outerZoomBox, 'width', t4 * n3 + 'px'),
            $2(this.outerZoomBox, 'height', e4 * n3 + 'px'),
            $2(this.contentContainer, 'width', t4 + 'px'),
            $2(this.contentContainer, 'height', e4 + 'px'),
            $2(this.contentContainer, 'transform', 'scale(' + n3 + ')');
        }),
        (e3.clear = function () {
          for (var t4 = this.root; t4.lastChild; ) t4.removeChild(t4.lastChild);
        }),
        t3
      );
    })();
    var oc = (function () {
      function t3(t4, e4, n3) {
        (this.store = t4),
          (this.url = e4),
          (this.document = n3),
          (this.lang = null),
          (this.totalOffset = -1),
          (this.lastOffset = 1),
          (this.root = n3.documentElement);
        var i3 = null,
          r3 = null;
        if (this.root.namespaceURI == H2.XHTML) {
          for (var o3 = this.root.firstChild; o3; o3 = o3.nextSibling)
            if (1 == o3.nodeType) {
              var a3 = o3;
              if (a3.namespaceURI == H2.XHTML)
                switch (a3.localName) {
                  case 'head':
                    r3 = a3;
                    break;
                  case 'body':
                    i3 = a3;
                }
            }
          this.lang = this.root.getAttribute('lang');
        } else if (this.root.namespaceURI == H2.FB2) {
          r3 = this.root;
          for (var s3 = this.root.firstChild; s3; s3 = s3.nextSibling)
            1 == s3.nodeType &&
              s3.namespaceURI == H2.FB2 &&
              'body' == s3.localName &&
              (i3 = s3);
          var l3 = this.doc()
            .child('FictionBook')
            .child('description')
            .child('title-info')
            .child('lang')
            .textContent();
          l3.length > 0 && (this.lang = l3[0]);
        } else if (this.root.namespaceURI == H2.SSE)
          for (
            var u3 = this.root.firstElementChild;
            u3;
            u3 = u3.nextElementSibling
          ) {
            var h3 = u3.localName;
            'meta' === h3 ? (r3 = u3) : 'body' === h3 && (i3 = u3);
          }
        (this.body = i3),
          (this.head = r3),
          (this.last = this.root),
          this.last.setAttribute('data-adapt-eloff', '0');
      }
      var e3 = t3.prototype;
      return (
        (e3.doc = function () {
          return new uc([this.document]);
        }),
        (e3.getElementOffset = function (t4) {
          var e4 = t4.getAttribute('data-adapt-eloff');
          if (e4) return parseInt(e4, 10);
          for (var n3 = this.lastOffset, i3 = this.last; i3 != t4; ) {
            var r3 = i3.firstChild;
            if (!r3) {
              for (; !(r3 = i3.nextSibling); )
                if (null == (i3 = i3.parentNode))
                  throw new Error('Internal error');
            }
            (i3 = r3),
              1 == r3.nodeType
                ? (r3.setAttribute('data-adapt-eloff', n3.toString()), ++n3)
                : (n3 += r3.textContent.length);
          }
          return (this.lastOffset = n3), (this.last = t4), n3 - 1;
        }),
        (e3.getNodeOffset = function (t4, e4, n3) {
          var i3 = 0,
            r3 = t4,
            o3 = null;
          if (1 == r3.nodeType) {
            if (!n3) return this.getElementOffset(r3);
          } else {
            if (((i3 = e4), !(o3 = r3.previousSibling)))
              return (
                (i3 += 1), this.getElementOffset((r3 = r3.parentNode)) + i3
              );
            r3 = o3;
          }
          for (;;) {
            for (; r3.lastChild; ) r3 = r3.lastChild;
            if (1 == r3.nodeType) break;
            if (((i3 += r3.textContent.length), !(o3 = r3.previousSibling))) {
              r3 = r3.parentNode;
              break;
            }
            r3 = o3;
          }
          return (i3 += 1), this.getElementOffset(r3) + i3;
        }),
        (e3.getTotalOffset = function () {
          return (
            this.totalOffset < 0 &&
              (this.totalOffset = this.getNodeOffset(this.root, 0, true)),
            this.totalOffset
          );
        }),
        (e3.getNodeByOffset = function (t4) {
          var e4,
            n3 = this,
            i3 = this,
            r3 = this.root,
            o3 = function () {
              if ((e4 = n3.getElementOffset(r3)) >= t4) return { v: r3 };
              var o4 = r3.children;
              if (!o4) return 'break';
              var a4 = ut(o4.length, function (e5) {
                return i3.getElementOffset(o4[e5]) > t4;
              });
              if (0 == a4) return 'break';
              r3 = o4[a4 - 1];
            };
          t: for (;;) {
            var a3 = o3();
            switch (a3) {
              case 'break':
                break t;
              default:
                if ('object' == typeof a3) return a3.v;
            }
          }
          for (
            var s3 = e4 + 1,
              l3 = r3,
              u3 = l3.firstChild || l3.nextSibling,
              h3 = null;
            ;

          ) {
            if (u3) {
              if (1 == u3.nodeType) break;
              if (((h3 = l3 = u3), (s3 += u3.textContent.length) > t4)) break;
            } else if (!(l3 = l3.parentNode)) break;
            u3 = l3.nextSibling;
          }
          return h3 || r3;
        }),
        (e3.buildIdMap = function (t4) {
          var e4 = t4.getAttribute('id');
          e4 && !this.idMap[e4] && (this.idMap[e4] = t4);
          var n3 = t4.getAttributeNS(H2.XML, 'id');
          n3 && !this.idMap[n3] && (this.idMap[n3] = t4);
          for (var i3 = t4.firstElementChild; i3; i3 = i3.nextElementSibling)
            this.buildIdMap(i3);
        }),
        (e3.getElement = function (t4) {
          var e4 = t4.match(/([^#]*)#(.+)$/);
          if (!e4 || (e4[1] && e4[1] != this.url)) return null;
          var n3 = e4[2],
            i3 = this.document.getElementById(n3);
          return (
            !i3 &&
              this.document.getElementsByName &&
              (i3 = this.document.getElementsByName(n3)[0]),
            i3 ||
              (this.idMap ||
                ((this.idMap = {}),
                this.buildIdMap(this.document.documentElement)),
              (i3 = this.idMap[n3])),
            i3
          );
        }),
        t3
      );
    })();
    function ac(t3, e3, n3) {
      var i3,
        r3 = n3 || new DOMParser();
      try {
        i3 = r3.parseFromString(t3, e3);
      } catch (t4) {}
      if (!i3) return null;
      var o3 = i3.documentElement;
      if ('parsererror' === o3.localName) return null;
      for (var a3 = o3.firstElementChild; a3; a3 = a3.nextElementSibling)
        if ('parsererror' === a3.localName) return null;
      return i3;
    }
    function sc(t3, e3) {
      var n3 = t3.responseXML;
      if (!n3) {
        var i3 = new DOMParser(),
          r3 = t3.responseText;
        if (r3) {
          var o3 = (function (t4) {
            var e4 = t4.contentType;
            if (e4) {
              for (var n4 = Object.keys(tc), i4 = 0; i4 < n4.length; i4++)
                if (tc[n4[i4]] === e4) return e4;
              if (e4.match(/\+xml$/)) return tc.APPLICATION_XML;
            }
            var r4 = t4.url.match(/\.([^./]+)$/);
            if (r4)
              switch (r4[1]) {
                case 'html':
                case 'htm':
                  return tc.TEXT_HTML;
                case 'xhtml':
                case 'xht':
                  return tc.APPLICATION_XHTML_XML;
                case 'svg':
                case 'svgz':
                  return tc.IMAGE_SVG_XML;
                case 'opf':
                case 'xml':
                  return tc.APPLICATION_XML;
              }
            return null;
          })(t3);
          if ((n3 = ac(r3, o3 || tc.APPLICATION_XML, i3)) && !o3) {
            var a3 = n3.documentElement;
            'html' !== a3.localName.toLowerCase() || a3.namespaceURI
              ? 'svg' === a3.localName.toLowerCase() &&
                n3.contentType !== tc.IMAGE_SVG_XML &&
                (n3 = ac(r3, tc.IMAGE_SVG_XML, i3))
              : (n3 = ac(r3, tc.TEXT_HTML, i3));
          }
          n3 || (n3 = ac(r3, tc.TEXT_HTML, i3));
        }
      }
      return Si(n3 ? new oc(e3, t3.url, n3) : null);
    }
    !(function (t3) {
      (t3.TEXT_HTML = 'text/html'),
        (t3.TEXT_XML = 'text/xml'),
        (t3.APPLICATION_XML = 'application/xml'),
        (t3.APPLICATION_XHTML_XML = 'application/xhtml_xml'),
        (t3.IMAGE_SVG_XML = 'image/svg+xml');
    })(tc || (tc = {}));
    var lc = new ((function () {
      function t3(t4) {
        this.fn = t4;
      }
      var e3 = t3.prototype;
      return (
        (e3.check = function (t4) {
          return this.fn(t4);
        }),
        (e3.withAttribute = function (e4, n3) {
          var i3 = this;
          return new t3(function (t4) {
            return (
              i3.check(t4) && 1 == t4.nodeType && t4.getAttribute(e4) == n3
            );
          });
        }),
        (e3.withChild = function (e4, n3) {
          var i3 = this;
          return new t3(function (t4) {
            if (!i3.check(t4)) return false;
            var r3 = new uc([t4]);
            return (
              (r3 = r3.child(e4)), n3 && (r3 = r3.predicate(n3)), r3.size() > 0
            );
          });
        }),
        t3
      );
    })())(function (t3) {
      return true;
    });
    var uc = (function () {
      function t3(t4) {
        this.nodes = t4;
      }
      var e3 = t3.prototype;
      return (
        (e3.asArray = function () {
          return this.nodes;
        }),
        (e3.size = function () {
          return this.nodes.length;
        }),
        (e3.predicate = function (e4) {
          for (var n3, i3 = [], r3 = D(this.nodes); !(n3 = r3()).done; ) {
            var o3 = n3.value;
            e4.check(o3) && i3.push(o3);
          }
          return new t3(i3);
        }),
        (e3.forEachNode = function (e4) {
          for (
            var n3 = [],
              i3 = function (t4) {
                n3.push(t4);
              },
              r3 = 0;
            r3 < this.nodes.length;
            r3++
          )
            e4(this.nodes[r3], i3);
          return new t3(n3);
        }),
        (e3.forEach = function (t4) {
          for (var e4 = [], n3 = 0; n3 < this.nodes.length; n3++)
            e4.push(t4(this.nodes[n3]));
          return e4;
        }),
        (e3.forEachNonNull = function (t4) {
          for (var e4 = [], n3 = 0; n3 < this.nodes.length; n3++) {
            var i3 = t4(this.nodes[n3]);
            null != i3 && e4.push(i3);
          }
          return e4;
        }),
        (e3.child = function (t4) {
          return this.forEachNode(function (e4, n3) {
            for (var i3 = e4.firstChild; i3; i3 = i3.nextSibling)
              1 == i3.nodeType && i3.localName == t4 && n3(i3);
          });
        }),
        (e3.childElements = function () {
          return this.forEachNode(function (t4, e4) {
            for (var n3 = t4.firstChild; n3; n3 = n3.nextSibling)
              1 == n3.nodeType && e4(n3);
          });
        }),
        (e3.attribute = function (t4) {
          return this.forEachNonNull(function (e4) {
            return 1 == e4.nodeType ? e4.getAttribute(t4) : null;
          });
        }),
        (e3.textContent = function () {
          return this.forEach(function (t4) {
            return t4.textContent;
          });
        }),
        t3
      );
    })();
    var hc = new Fi(function () {
      var t3 = bi('uaStylesheetBase'),
        e3 = Ru(),
        n3 = W('user-agent-base.css', z2),
        i3 = new qo(null, null, null, null, null, e3, true);
      return (
        i3.startStylesheet(Ui.USER_AGENT),
        (Ko = i3.cascade),
        cr(
          '\n@namespace html "http://www.w3.org/1999/xhtml";\n\nhtml|html,\nhtml|address,\nhtml|blockquote,\nhtml|body,\nhtml|dd,\nhtml|div,\nhtml|dl,\nhtml|dt,\nhtml|fieldset,\nhtml|form,\nhtml|frame,\nhtml|frameset,\nhtml|h1,\nhtml|h2,\nhtml|h3,\nhtml|h4,\nhtml|h5,\nhtml|h6,\nhtml|noframes,\nhtml|ol,\nhtml|p,\nhtml|ul,\nhtml|center,\nhtml|dir,\nhtml|hr,\nhtml|menu,\nhtml|pre,\nhtml|article,\nhtml|section,\nhtml|nav,\nhtml|aside,\nhtml|hgroup,\nhtml|footer,\nhtml|header,\nhtml|figure,\nhtml|figcaption,\nhtml|main {\n  display: block;\n  unicode-bidi: normal;\n}\nhtml|li {\n  display: list-item;\n}\nhtml|head {\n  display: none !important;\n}\nhtml|table {\n  display: table;\n}\nhtml|tr {\n  display: table-row;\n}\nhtml|thead {\n  display: table-header-group;\n  break-after: avoid;\n}\nhtml|tbody {\n  display: table-row-group;\n}\nhtml|tfoot {\n  display: table-footer-group;\n  break-before: avoid;\n}\nhtml|col {\n  display: table-column;\n}\nhtml|colgroup {\n  display: table-column-group;\n}\nhtml|td,\nhtml|th {\n  display: table-cell;\n}\nhtml|caption {\n  display: table-caption;\n  text-align: center;\n}\nhtml|th {\n  font-weight: bolder;\n  text-align: center;\n}\nhtml|script {\n  display: none;\n}\nhtml|body {\n  margin: 8px;\n}\nhtml|h1 {\n  font-size: 2em;\n  margin-block-start: 0.67em;\n  margin-block-end: 0.67em;\n  margin-inline-start: 0em;\n  margin-inline-end: 0em;\n}\nhtml|h2 {\n  font-size: 1.5em;\n  margin-block-start: 0.75em;\n  margin-block-end: 0.75em;\n  margin-inline-start: 0em;\n  margin-inline-end: 0em;\n}\nhtml|h3 {\n  font-size: 1.17em;\n  margin-block-start: 0.83em;\n  margin-block-end: 0.83em;\n  margin-inline-start: 0em;\n  margin-inline-end: 0em;\n}\nhtml|h4,\nhtml|p,\nhtml|blockquote,\nhtml|ul,\nhtml|fieldset,\nhtml|form,\nhtml|ol,\nhtml|dl,\nhtml|dir,\nhtml|menu,\nhtml|h5,\nhtml|h6 {\n  margin-block-start: 1em;\n  margin-block-end: 1em;\n  margin-inline-start: 0em;\n  margin-inline-end: 0em;\n}\nhtml|h5 {\n  font-size: 0.83em;\n}\nhtml|h6 {\n  font-size: 0.75em;\n}\nhtml|h1,\nhtml|h2,\nhtml|h3,\nhtml|h4,\nhtml|h5,\nhtml|h6,\nhtml|b,\nhtml|strong {\n  font-weight: bolder;\n}\nhtml|h1,\nhtml|h2,\nhtml|h3,\nhtml|h4,\nhtml|h5,\nhtml|h6 {\n  break-after: avoid;\n}\nhtml|blockquote {\n  margin-block-start: 0px;\n  margin-block-end: 0px;\n  margin-inline-start: 40px;\n  margin-inline-end: 40px;\n}\nhtml|i,\nhtml|cite,\nhtml|em,\nhtml|var,\nhtml|address {\n  font-style: italic;\n}\nhtml|pre,\nhtml|tt,\nhtml|code,\nhtml|kbd,\nhtml|samp {\n  font-family: monospace;\n}\nhtml|pre {\n  white-space: pre;\n}\nhtml|button,\nhtml|textarea,\nhtml|input,\nhtml|select {\n  display: inline-block;\n}\nhtml|big {\n  font-size: 1.17em;\n}\nhtml|small,\nhtml|sub,\nhtml|sup {\n  font-size: 0.83em;\n}\nhtml|sub {\n  vertical-align: sub;\n}\nhtml|sup {\n  vertical-align: super;\n}\nhtml|table {\n  border-spacing: 2px;\n}\nhtml|thead,\nhtml|tbody,\nhtml|tfoot {\n  vertical-align: middle;\n}\n/* for XHTML tables without tbody */\nhtml|table > html|tr {\n  vertical-align: middle;\n}\nhtml|td,\nhtml|th {\n  vertical-align: inherit;\n}\nhtml|s,\nhtml|strike,\nhtml|del {\n  text-decoration: line-through;\n}\nhtml|hr {\n  border: 1px inset;\n}\nhtml|ol,\nhtml|ul,\nhtml|dir,\nhtml|menu,\nhtml|dd {\n  margin: 0px;\n  margin-inline-start: 40px;\n}\nhtml|ol {\n  list-style-type: decimal;\n}\nhtml|ol html|ul,\nhtml|ul html|ol,\nhtml|ul html|ul,\nhtml|ol html|ol {\n  margin-top: 0;\n  margin-bottom: 0;\n}\nhtml|u,\nhtml|ins {\n  text-decoration: underline;\n}\nhtml|center {\n  text-align: center;\n}\nhtml|q:before {\n  content: open-quote;\n}\nhtml|q:after {\n  content: close-quote;\n}\n\nhtml|audio,\nhtml|video {\n  break-inside: avoid;\n}\n\nhtml|ruby {\n  display: ruby;\n}\nhtml|rp {\n  display: none;\n}\nhtml|rbc {\n  display: ruby-base-container;\n}\nhtml|rtc {\n  display: ruby-text-container;\n}\nhtml|rb {\n  display: ruby-base;\n  white-space: nowrap;\n}\nhtml|rt {\n  display: ruby-text;\n}\nhtml|ruby,\nhtml|rb,\nhtml|rt,\nhtml|rbc,\nhtml|rtc {\n  unicode-bidi: isolate;\n}\n\nhtml|rtc,\nhtml|rt {\n  font-variant-east-asian: ruby;\n  text-emphasis: none;\n  white-space: nowrap;\n  line-height: 1;\n}\n\nhtml|rtc:lang(zh),\nhtml|rt:lang(zh) {\n  ruby-align: center;\n}\n\nhtml|rtc,\nhtml|rt {\n  font-size: 50%;\n}\n\nhtml|rtc:lang(zh-TW),\nhtml|rt:lang(zh-TW) {\n  font-size: 30%;\n}\n\nhtml|rtc > html|rt,\nhtml|rtc > html|rt:lang(zh-TW) {\n  font-size: 100%;\n}\n\n/* Bidi settings */\nhtml|bdo[dir="ltr"] {\n  direction: ltr;\n  unicode-bidi: bidi-override;\n}\nhtml|bdo[dir="rtl"] {\n  direction: rtl;\n  unicode-bidi: bidi-override;\n}\nhtml|*[dir="ltr"] {\n  direction: ltr;\n  unicode-bidi: embed;\n}\nhtml|*[dir="rtl"] {\n  direction: rtl;\n  unicode-bidi: embed;\n}\n\n/*------------------ epub-specific ---------------------*/\n\n@namespace epub "http://www.idpf.org/2007/ops";\n\nhtml|a[epub|type="noteref"] {\n  font-size: 0.75em;\n  vertical-align: super;\n  line-height: 0.01;\n}\n\nhtml|a[epub|type="noteref"]:href-epub-type(footnote) {\n  -adapt-template: url(user-agent.xml#footnote);\n  text-decoration: none;\n}\n\nhtml|aside[epub|type="footnote"] {\n  display: none;\n}\n\nhtml|aside[epub|type="footnote"]:footnote-content {\n  display: block;\n  margin: 0.25em;\n  font-size: 1.2em;\n  line-height: 1.2;\n}\n\nepub|trigger {\n  display: none;\n}\n\nepub|switch {\n  display: inline;\n}\n\nepub|default {\n  display: inline;\n}\n\nepub|case {\n  display: none;\n}\n\nepub|case[required-namespace::supported] {\n  display: inline;\n}\n\nepub|case[required-namespace::supported] ~ epub|case {\n  display: none;\n}\n\nepub|case[required-namespace::supported] ~ epub|default {\n  display: none;\n}\n\n/*--------------- ncx and toc ----------------------*/\n\n@namespace ncx "http://www.daisy.org/z3986/2005/ncx/";\n\nncx|ncx {\n  display: block;\n  padding-top: 10px;\n  padding-bottom: 10px;\n}\n\nncx|content {\n  display: none;\n}\n\nbody > * {\n  -adapt-behavior: body-child;\n}\n\n[role="doc-toc"],\n[role="directory"],\nnav,\n.toc,\n#toc,\n#table-of-contents,\n#contents {\n  -adapt-behavior: toc-root;\n}\n\n[role="doc-toc"] a,\n[role="directory"] a,\nnav a,\n.toc a,\n#toc a,\nncx|navLabel {\n  -adapt-behavior: toc-node-anchor;\n}\n\n[role="doc-toc"] li,\n[role="directory"] li,\nnav li,\n.toc li,\n#toc li,\nncx|navPoint {\n  -adapt-behavior: toc-node;\n}\n\n[role="doc-toc"] li > *:first-child,\n[role="directory"] li > *:first-child,\nnav li > *:first-child,\n.toc li > *:first-child,\n#toc li > *:first-child {\n  -adapt-behavior: toc-node-first-child;\n}\n\n[role="doc-toc"] ol,\n[role="directory"] ol,\nnav ol,\n.toc ol,\n#toc ol,\n[role="doc-toc"] ul,\n[role="directory"] ul,\nnav ul,\n.toc ul,\n#toc ul,\nol[role="doc-toc"],\nol[role="directory"],\nol.toc,\nol#toc,\nul[role="doc-toc"],\nul[role="directory"],\nul.toc,\nul#toc {\n  -adapt-behavior: toc-container;\n}\n\n/*---------------- fb2 ---------------------*/\n\n@namespace fb2 "http://www.gribuser.ru/xml/fictionbook/2.0";\n\nfb2|FictionBook {\n  display: block;\n}\n\nfb2|body {\n  font-family: serif;\n  margin: 8px;\n  column-width: 25em;\n}\n\nfb2|a {\n  line-height: 0.1;\n  vertical-align: super;\n  font-size: 0.7em;\n}\n\nfb2|sub {\n  line-height: 0.1;\n  font-size: 0.7em;\n}\n\nfb2|sup {\n  line-height: 0.1;\n  font-size: 0.7em;\n}\n\nfb2|table {\n  display: table;\n  font-size: 0.8em;\n  font-family: sans-serif;\n  margin: 0.5em;\n  border-collapse: collapse;\n  border: 1px solid black;\n}\n\nfb2|td {\n  border: 1px solid black;\n  padding: 0.3em;\n}\n\nfb2|th {\n  font-weight: bold;\n  text-align: center;\n  border: 1px solid black;\n  background-color: #cee;\n  padding: 0.3em;\n}\n\nfb2|code {\n  font-family: monospace;\n}\n\nfb2|p {\n  display: block;\n  margin: 0px;\n  text-indent: 1.5em;\n  text-align: justify;\n}\n\nfb2|title fb2|p {\n  margin: 0px 0px 0.5em 0px;\n  text-indent: 0px;\n  text-align: inherit;\n}\n\nfb2|title {\n  font-size: 2.2em;\n  font-weight: bold;\n  break-inside: avoid;\n  break-after: avoid;\n  text-align: center;\n  margin: 1em 0px 0.5em 0px;\n  display: block;\n}\n\nfb2|section {\n  display: block;\n}\n\nfb2|section fb2|title {\n  font-size: 1.8em;\n  text-align: center;\n  margin: 1em 0px 0.5em 0px;\n}\n\nfb2|section fb2|section fb2|title {\n  font-size: 1.5em;\n  text-align: left;\n  margin: 1em 0px 0.5em 1.5625em;\n}\n\nfb2|section fb2|section fb2|section fb2|title {\n  font-size: 1.3em;\n  text-align: left;\n  margin: 1em 0px 0.5em 1.923em;\n}\n\nfb2|section fb2|section fb2|section fb2|section fb2|title {\n  font-size: 1.2em;\n  text-align: left;\n  margin: 1em 0px 0.5em 2.083em;\n}\n\nfb2|section fb2|section fb2|section fb2|section fb2|section fb2|title {\n  font-size: 1.1em;\n  text-align: left;\n  margin: 1em 0px 0.5em 2.272em;\n}\n\nfb2|section\n  fb2|section\n  fb2|section\n  fb2|section\n  fb2|section\n  fb2|section\n  fb2|title {\n  text-align: left;\n  margin: 1em 0px 0.5em 2.5em;\n}\n\nfb2|epigraph {\n  text-align: left;\n  font-style: italic;\n  margin: 1em 1em 2em 30%;\n  display: block;\n}\n\nfb2|image {\n  text-align: center;\n  padding: 3px;\n}\n\nfb2|image::inner {\n  max-width: 95%;\n}\n\nfb2|image::after {\n  display: block;\n  content: attr(title);\n}\n\nfb2|v {\n  text-indent: -1em;\n  padding-left: 1em;\n  margin: 0px;\n  display: block;\n}\nfb2|poem {\n  margin: 0.5em 0px 0.5em 2em;\n  display: block;\n}\nfb2|date {\n  margin: 0.5em 0px 0.5em 50%;\n  font-style: italic;\n  display: block;\n}\nfb2|stanza {\n  margin: 0.5em 0px;\n  break-inside: avoid;\n  display: block;\n}\nfb2|empty-line {\n  height: 1em;\n  margin: 0px;\n  display: block;\n}\nfb2|cite {\n  margin: 0.5em 0px 0.5em 1em;\n  font-size: 0.95em;\n  display: block;\n}\nfb2|subtitle {\n  text-indent: 0px;\n  text-align: center;\n  font-style: italic;\n  font-weight: bold;\n  margin: 0.5em 2em;\n  break-inside: avoid;\n  break-after: avoid;\n  display: block;\n}\nfb2|annotation {\n  margin: 1em 0px 1em 2em;\n  text-indent: 0px;\n  font-style: italic;\n  display: block;\n}\nfb2|text-author {\n  text-indent: 0px;\n  margin: 0.2em 0px 0px 3em;\n  display: block;\n}\nfb2|emphasis {\n  font-style: italic;\n}\nfb2|strong {\n  font-weight: bold;\n}\nfb2|strikethrough {\n  text-decoration: line-through;\n}\nfb2|*.italic {\n  font-style: italic;\n}\nfb2|*.bold {\n  font-weight: bold;\n}\n\nfb2|binary,\nfb2|description,\nfb2|stylesheet {\n  display: none;\n}\n\nfb2|a[type="note"] {\n  font-size: 0.75em;\n  vertical-align: super;\n  line-height: 0.01;\n  text-decoration: none;\n  -adapt-template: url(user-agent.xml#footnote);\n}\n\nfb2|body[name="notes"] {\n  display: none;\n}\n\nfb2|body[name="notes"] fb2|title {\n  display: inline;\n  vertical-align: super;\n  line-height: 0.01;\n  text-align: left;\n  font-size: 0.75em;\n  font-weight: bold;\n  margin: 0px;\n}\n\nfb2|body[name="notes"] fb2|p {\n  text-indent: 0px;\n  display: inline; /* for now */\n}\n\nfb2|body[name="notes"] fb2|p + fb2|p {\n  display: block;\n}\n\nfb2|body[name="notes"] fb2|section {\n  text-indent: 0px;\n  line-height: 1.2;\n  font-size: 1.2em;\n}\n',
          i3,
          n3,
          null,
          null,
        ).thenFinish(t3),
        t3.result()
      );
    }, 'uaStylesheetBaseFetcher');
    var cc = (function () {
      function t3(t4, e3, n3, i3, r3, o3, a3, s3, l3, u3) {
        (this.store = t4),
          (this.rootScope = e3),
          (this.pageScope = n3),
          (this.cascade = i3),
          (this.rootBox = r3),
          (this.fontFaces = o3),
          (this.footnoteProps = a3),
          (this.flowProps = s3),
          (this.viewportProps = l3),
          (this.pageProps = u3),
          (this.fontDeobfuscator = t4.fontDeobfuscator),
          (this.validatorSet = t4.validatorSet),
          this.pageScope.defineBuiltIn('has-content', function (t5) {
            var e4 = this.currentLayoutPosition,
              n4 = e4.firstFlowChunkOfFlow((t5 = t5));
            return (
              this.matchPageSide(e4.startSideOfFlow(t5)) &&
              e4.hasContent(t5, this.lookupOffset) &&
              !!n4 &&
              !this.flowChunkIsAfterParentFlowForcedBreak(n4)
            );
          }),
          this.pageScope.defineName(
            'page-number',
            new ge(
              this.pageScope,
              function () {
                return this.pageNumberOffset + this.currentLayoutPosition.page;
              },
              'page-number',
            ),
          );
      }
      return (
        (t3.prototype.sizeViewport = function (t4, e3, n3, i3) {
          if (this.viewportProps.length) {
            var r3 = new Ht(this.rootScope, t4, e3, n3),
              o3 = (function (t5, e4) {
                for (var n4 = {}, i4 = 0; i4 < e4.length; i4++)
                  Yr(t5, n4, e4[i4], 0, null, null, null);
                return n4;
              })(r3, this.viewportProps),
              a3 = o3.width,
              s3 = o3.height,
              l3 = o3['text-zoom'],
              u3 = 1;
            if ((a3 && s3) || l3) {
              var h3 = Ut.em;
              if (
                ((l3 ? l3.evaluate(r3, 'text-zoom') : null) === Ye.scale &&
                  ((u3 = h3 / n3), (n3 = h3), (t4 *= u3), (e3 *= u3)),
                a3 && s3)
              ) {
                var c3 = Xe(a3.evaluate(r3, 'width'), r3),
                  f3 = Xe(s3.evaluate(r3, 'height'), r3);
                if (c3 > 0 && f3 > 0)
                  return {
                    width: i3 && i3.spreadView ? 2 * (c3 + i3.pageBorder) : c3,
                    height: f3,
                    fontSize: n3,
                  };
              }
            }
          }
          return { width: t4, height: e3, fontSize: n3 };
        }),
        t3
      );
    })();
    var fc = (function (t3) {
      function e3(e4, n4, i3, r3, o3, a3, s3, l3, u3, h3, c3, f3) {
        var d3;
        for (var p3 in (((d3 =
          t3.call(this, e4.rootScope, r3.width, r3.height, r3.fontSize) ||
          this).style = e4),
        (d3.xmldoc = n4),
        (d3.viewport = r3),
        (d3.clientLayout = o3),
        (d3.fontMapper = a3),
        (d3.customRenderer = s3),
        (d3.fallbackMap = l3),
        (d3.pageNumberOffset = u3),
        (d3.documentURLTransformer = h3),
        (d3.counterStore = c3),
        (d3.primaryFlows = { body: true }),
        (d3.rootPageBoxInstance = null),
        (d3.styler = null),
        (d3.stylerMap = null),
        (d3.currentLayoutPosition = null),
        (d3.layoutPositionAtPageStart = null),
        (d3.lookupOffset = 0),
        (d3.pageBoxInstances = {}),
        (d3.pageManager = null),
        (d3.pageBreaks = {}),
        (d3.pageProgression = null),
        (d3.pageSheetSize = {}),
        (d3.pageSheetHeight = 0),
        (d3.pageSheetWidth = 0),
        (d3.lang = n4.lang || i3),
        (d3.faces = new Du(d3.style.fontDeobfuscator)),
        (d3.rootPageFloatLayoutContext = new as(
          null,
          null,
          null,
          null,
          null,
          null,
          null,
        )),
        (d3.pageProgression = f3 || null),
        e4.flowProps)) {
          var g3 = Vr(e4.flowProps[p3], 'flow-consume');
          g3 &&
            (g3.evaluate(k2(d3), 'flow-consume') == Ye.all
              ? (d3.primaryFlows[p3] = true)
              : delete d3.primaryFlows[p3]);
        }
        return d3;
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.init = function () {
          var t4 = this,
            e4 = bi('StyleInstance.init'),
            n4 = this.counterStore.createCounterListener(this.xmldoc.url),
            i3 = this.counterStore.createCounterResolver(
              this.xmldoc.url,
              this.style.rootScope,
              this.style.pageScope,
            );
          (this.styler = new su(
            this.xmldoc,
            this.style.cascade,
            this.style.rootScope,
            this,
            this.primaryFlows,
            this.style.validatorSet,
            n4,
            i3,
          )),
            i3.setStyler(this.styler),
            this.styler.resetFlowChunkStream(this),
            (this.stylerMap = {}),
            (this.stylerMap[this.xmldoc.url] = this.styler);
          var r3 = this.styler.getTopContainerStyle();
          this.pageProgression || (this.pageProgression = hh(r3)),
            (this.rootPageBoxInstance = new nh(this.style.rootBox));
          var o3 = this.style.cascade.createInstance(this, n4, i3, this.lang);
          this.rootPageBoxInstance.applyCascadeAndInit(o3, r3),
            this.rootPageBoxInstance.resolveAutoSizing(this),
            (this.pageManager = new Bh(
              o3,
              this.style.pageScope,
              this.rootPageBoxInstance,
              this,
              r3,
            ));
          for (
            var a3, s3 = [], l3 = D(this.style.fontFaces);
            !(a3 = l3()).done;

          ) {
            var u3 = a3.value;
            if (!u3.condition || u3.condition.evaluate(this)) {
              var h3 = ku(u3.properties, this),
                c3 = new Fu(h3);
              s3.push(c3);
            }
          }
          this.fontMapper.findOrLoadFonts(s3, this.faces).thenFinish(e4);
          var f3 = this.style.pageProps;
          return (
            Object.keys(f3).forEach(function (e5) {
              var n5 = yh(Eh(f3[e5]), t4);
              t4.pageSheetSize[e5] = {
                width: n5.pageWidth + 2 * n5.cropOffset,
                height: n5.pageHeight + 2 * n5.cropOffset,
              };
            }),
            e4.result()
          );
        }),
        (n3.getStylerForDoc = function (t4) {
          var e4 = this.stylerMap[t4.url];
          if (!e4) {
            var n4 = this.style.store.getStyleForDoc(t4),
              i3 = new Ht(
                n4.rootScope,
                this.pageWidth(),
                this.pageHeight(),
                this.initialFontSize,
              ),
              r3 = this.counterStore.createCounterListener(t4.url),
              o3 = this.counterStore.createCounterResolver(
                t4.url,
                n4.rootScope,
                n4.pageScope,
              );
            (e4 = new su(
              t4,
              n4.cascade,
              n4.rootScope,
              i3,
              this.primaryFlows,
              n4.validatorSet,
              r3,
              o3,
            )),
              (this.stylerMap[t4.url] = e4);
          }
          return e4;
        }),
        (n3.registerInstance = function (t4, e4) {
          this.pageBoxInstances[t4] = e4;
        }),
        (n3.lookupInstance = function (t4) {
          return this.pageBoxInstances[t4];
        }),
        (n3.encounteredFlowChunk = function (t4, e4) {
          var n4 = this.currentLayoutPosition;
          if (n4) {
            n4.flows[t4.flowName]
              ? (e4 = n4.flows[t4.flowName])
              : (n4.flows[t4.flowName] = e4);
            var i3 = n4.flowPositions[t4.flowName];
            i3 || ((i3 = new qa()), (n4.flowPositions[t4.flowName] = i3));
            var r3 = new Ya({
                steps: [
                  {
                    node: t4.element,
                    shadowType: za.NONE,
                    shadowContext: null,
                    nodeShadow: null,
                    shadowSibling: null,
                    formattingContext: null,
                    fragmentIndex: 0,
                  },
                ],
                offsetInNode: 0,
                after: false,
                preprocessedTextContent: null,
              }),
              o3 = new Ka(r3, t4);
            i3.positions.push(o3);
          }
        }),
        (n3.getConsumedOffset = function (t4) {
          for (
            var e4 = Number.POSITIVE_INFINITY, n4 = 0;
            n4 < t4.positions.length;
            n4++
          ) {
            for (
              var i3 = t4.positions[n4].chunkPosition.primary,
                r3 = i3.steps[0].node,
                o3 = i3.offsetInNode,
                a3 = i3.after,
                s3 = 0;
              r3.ownerDocument != this.xmldoc.document;

            )
              s3++, (r3 = i3.steps[s3].node), (a3 = false), (o3 = 0);
            var l3 = this.xmldoc.getNodeOffset(r3, o3, a3);
            l3 < e4 && (e4 = l3);
          }
          return e4;
        }),
        (n3.getPosition = function (t4, e4) {
          if (!t4) return 0;
          var n4 = Number.POSITIVE_INFINITY;
          for (var i3 in this.primaryFlows) {
            var r3 = t4.flowPositions[i3];
            if (
              (e4 ||
                (r3 && 0 != r3.positions.length) ||
                !this.currentLayoutPosition ||
                (this.styler.styleUntilFlowIsReached(i3),
                (r3 = this.currentLayoutPosition.flowPositions[i3]),
                t4 != this.currentLayoutPosition &&
                  r3 &&
                  ((r3 = r3.clone()), (t4.flowPositions[i3] = r3))),
              r3)
            ) {
              var o3 = this.getConsumedOffset(r3);
              o3 < n4 && (n4 = o3);
            }
          }
          return n4;
        }),
        (n3.dumpLocation = function (t4) {
          for (var e4 in (c2.debug(
            'Location - page',
            this.currentLayoutPosition.page,
          ),
          c2.debug('  current:', t4),
          c2.debug('  lookup:', this.lookupOffset),
          this.currentLayoutPosition.flowPositions))
            for (
              var n4,
                i3 = D(this.currentLayoutPosition.flowPositions[e4].positions);
              !(n4 = i3()).done;

            )
              c2.debug('  Chunk', e4 + ':', n4.value.flowChunk.startOffset);
        }),
        (n3.matchPageSide = function (t4) {
          switch (t4) {
            case 'left':
            case 'right':
            case 'recto':
            case 'verso':
              return new de(this.style.pageScope, t4 + '-page').evaluate(this);
            default:
              return true;
          }
        }),
        (n3.updateStartSide = function (t4) {
          for (var e4 in t4.flowPositions) {
            var n4 = t4.flowPositions[e4];
            if (n4 && n4.positions.length > 0) {
              var i3 = n4.positions[0].flowChunk;
              if (this.getConsumedOffset(n4) === i3.startOffset) {
                var r3 = n4.positions[0].flowChunk.breakBefore,
                  o3 = ys(n4.startSide);
                n4.startSide = Es(vs(o3, r3));
              }
            }
          }
        }),
        (n3.selectPageMaster = function (t4) {
          var e4 = this.currentLayoutPosition,
            n4 = this.getPosition(e4);
          if (n4 == Number.POSITIVE_INFINITY) return null;
          for (
            var i3, r3 = this.rootPageBoxInstance.children, o3 = 0;
            o3 < r3.length;
            o3++
          )
            if (
              'vivliostyle-page-rule-master' !==
              (i3 = r3[o3]).pageBox.pseudoName
            ) {
              var a3 = 1,
                s3 = i3.getProp(this, 'utilization');
              s3 && s3.isNum() && (a3 = s3.num);
              var l3 = this.queryUnitSize('em', false),
                u3 = this.pageWidth() * this.pageHeight(),
                h3 = Math.ceil((a3 * u3) / (l3 * l3));
              (this.lookupOffset = this.styler.styleUntil(n4, h3)),
                this.updateStartSide(e4),
                (this.layoutPositionAtPageStart = e4.clone()),
                this.initLingering(),
                this.clearScope(this.style.pageScope);
              var c3 = i3.getProp(this, 'enabled');
              if (!c3 || c3 === Ye._true)
                return this.pageManager.getPageRulePageMaster(i3, t4);
            }
          throw new Error('No enabled page masters');
        }),
        (n3.flowChunkIsAfterParentFlowForcedBreak = function (t4) {
          var e4 = this.layoutPositionAtPageStart.flows,
            n4 = e4[t4.flowName].parentFlowName;
          if (n4) {
            var i3 = t4.startOffset,
              r3 = e4[n4].forcedBreakOffsets;
            if (!r3.length || i3 < r3[0]) return false;
            var o3 =
                ut(r3.length, function (t5) {
                  return r3[t5] > i3;
                }) - 1,
              a3 = r3[o3],
              s3 = this.layoutPositionAtPageStart.flowPositions[n4],
              l3 = this.getConsumedOffset(s3);
            return !(a3 < l3) && (l3 < a3 || !this.matchPageSide(s3.startSide));
          }
          return false;
        }),
        (n3.setFormattingContextToColumn = function (t4, e4) {
          var n4 = this.currentLayoutPosition.flows[e4];
          n4.formattingContext || (n4.formattingContext = new _s(null)),
            (t4.flowRootFormattingContext = n4.formattingContext);
        }),
        (n3.layoutDeferredPageFloats = function (t4) {
          var e4 = t4.pageFloatLayoutContext,
            n4 = e4.getDeferredPageFloatContinuations(),
            i3 = bi('layoutDeferredPageFloats'),
            r3 = false,
            o3 = 0;
          return (
            i3
              .loopWithFrame(function (i4) {
                if (o3 !== n4.length) {
                  var a3 = n4[o3++],
                    s3 = a3.float,
                    l3 = new ls().findByFloat(s3),
                    u3 = l3.findPageFloatFragment(s3, e4);
                  if (!u3 || !u3.hasFloat(s3))
                    return e4.isForbidden(s3) ||
                      e4.hasPrecedingFloatsDeferredToNext(s3)
                      ? (e4.deferPageFloat(a3), void i4.breakLoop())
                      : void t4
                          .layoutPageFloatInner(a3, l3, null, u3)
                          .then(function (t5) {
                            if (t5) {
                              var n5 = e4.parent.isInvalidated();
                              n5
                                ? i4.breakLoop()
                                : (e4.isInvalidated() &&
                                    !n5 &&
                                    ((r3 = true), e4.validate()),
                                  i4.continueLoop());
                            } else i4.breakLoop();
                          });
                  i4.continueLoop();
                } else i4.breakLoop();
              })
              .then(function () {
                r3 && e4.invalidate(), i3.finish(true);
              }),
            i3.result()
          );
        }),
        (n3.getLastAfterPositionIfDeferredFloatsExists = function (t4, e4) {
          var n4;
          return t4.pageFloatLayoutContext.getPageFloatContinuationsDeferredToNext()
            .length > 0 && t4.lastAfterPosition
            ? (e4
                ? ((n4 = e4.clone()).primary = t4.lastAfterPosition)
                : (n4 = new Ya(t4.lastAfterPosition)),
              n4)
            : null;
        }),
        (n3.layoutColumn = function (t4, e4) {
          var n4 = this.currentLayoutPosition.flowPositions[e4];
          if (!n4 || !this.matchPageSide(n4.startSide)) return Si(true);
          (n4.startSide = 'any'),
            this.setFormattingContextToColumn(t4, e4),
            t4.init(),
            this.primaryFlows[e4] &&
              t4.bands.length > 0 &&
              (t4.forceNonfitting = false);
          var i3 = this,
            r3 = bi('layoutColumn');
          return (
            this.layoutDeferredPageFloats(t4).then(function () {
              if (t4.pageFloatLayoutContext.isInvalidated()) r3.finish(true);
              else {
                var o3 = [],
                  a3 = [],
                  s3 = true;
                r3.loopWithFrame(function (r4) {
                  if (
                    t4.pageFloatLayoutContext.hasContinuingFloatFragmentsInFlow(
                      e4,
                    )
                  )
                    r4.breakLoop();
                  else {
                    var l3 = function () {
                      for (var e5 = 0; a3.includes(e5); ) e5++;
                      var l4 = n4.positions[e5];
                      if (
                        l4.flowChunk.startOffset > i3.lookupOffset ||
                        i3.flowChunkIsAfterParentFlowForcedBreak(l4.flowChunk)
                      )
                        return 'break';
                      for (var u4 = e5 + 1; u4 < n4.positions.length; u4++)
                        if (!a3.includes(u4)) {
                          var h3 = n4.positions[u4];
                          if (
                            h3.flowChunk.startOffset > i3.lookupOffset ||
                            i3.flowChunkIsAfterParentFlowForcedBreak(
                              h3.flowChunk,
                            )
                          )
                            break;
                          h3.flowChunk.isBetter(l4.flowChunk) &&
                            ((l4 = h3), (e5 = u4));
                        }
                      var c3 = l4.flowChunk,
                        f3 = true;
                      return (
                        t4
                          .layout(l4.chunkPosition, s3, n4.breakAfter)
                          .then(function (u5) {
                            if (t4.pageFloatLayoutContext.isInvalidated())
                              r4.breakLoop();
                            else {
                              if (
                                ((s3 = false),
                                l4.flowChunk.repeated &&
                                  (null === u5 || c3.exclusive) &&
                                  o3.push(e5),
                                c3.exclusive)
                              )
                                return a3.push(e5), void r4.breakLoop();
                              var h4 = !!u5 || !!t4.pageBreakType,
                                d3 = i3.getLastAfterPositionIfDeferredFloatsExists(
                                  t4,
                                  u5,
                                );
                              t4.pageBreakType && d3
                                ? ((l4.chunkPosition = d3),
                                  (n4.breakAfter = t4.pageBreakType),
                                  (t4.pageBreakType = null))
                                : (a3.push(e5),
                                  (u5 || d3) &&
                                    ((l4.chunkPosition = u5 || d3),
                                    o3.push(e5)),
                                  t4.pageBreakType &&
                                    (n4.startSide = Es(t4.pageBreakType))),
                                h4
                                  ? r4.breakLoop()
                                  : ((t4.forceNonfitting = false),
                                    f3 ? (f3 = false) : r4.continueLoop());
                            }
                          }),
                        f3 ? ((f3 = false), { v: void 0 }) : void 0
                      );
                    };
                    t: for (; n4.positions.length - a3.length > 0; ) {
                      var u3 = l3();
                      switch (u3) {
                        case 'break':
                          break t;
                        default:
                          if ('object' == typeof u3) return u3.v;
                      }
                    }
                    r4.breakLoop();
                  }
                }).then(function () {
                  if (!t4.pageFloatLayoutContext.isInvalidated()) {
                    (n4.positions = n4.positions.filter(function (t5, e6) {
                      return o3.includes(e6) || !a3.includes(e6);
                    })),
                      'column' === n4.breakAfter && (n4.breakAfter = null),
                      t4.saveDistanceToBlockEndFloats();
                    var e5 = t4.pageFloatLayoutContext.getMaxReachedAfterEdge();
                    t4.updateMaxReachedAfterEdge(e5);
                  }
                  r3.finish(true);
                });
              }
            }),
            r3.result()
          );
        }),
        (n3.createLayoutConstraint = function (t4) {
          var e4 = this.counterStore.createLayoutConstraint(
            this.currentLayoutPosition.page - 1,
          );
          return new nl([e4].concat(t4.getLayoutConstraints()));
        }),
        (n3.createAndLayoutColumn = function (
          t4,
          e4,
          n4,
          i3,
          r3,
          o3,
          a3,
          s3,
          l3,
          u3,
          h3,
          c3,
          f3,
          d3,
        ) {
          var p3,
            g3 = this,
            m3 = t4.vertical
              ? t4.isAutoWidth && t4.isRightDependentOnAutoWidth
              : t4.isAutoHeight && t4.isTopDependentOnAutoHeight,
            v3 = r3.element,
            E2 = new as(s3, ts.COLUMN, null, a3, null, null, null),
            y3 = g3.currentLayoutPosition.clone(),
            w3 = bi('createAndLayoutColumn');
          return (
            w3
              .loopWithFrame(function (t5) {
                var w4 = g3.createLayoutConstraint(E2);
                if (l3 > 1) {
                  var N3 = g3.viewport.document.createElement('div');
                  if (
                    ($2(N3, 'position', 'absolute'),
                    v3.appendChild(N3),
                    ((p3 = new ol(
                      N3,
                      f3,
                      g3.clientLayout,
                      w4,
                      E2,
                    )).forceNonfitting = d3),
                    (p3.vertical = r3.vertical),
                    (p3.snapHeight = r3.snapHeight),
                    (p3.snapWidth = r3.snapWidth),
                    r3.vertical)
                  ) {
                    var b3 = o3 * (h3 + u3) + r3.paddingTop;
                    p3.setHorizontalPosition(r3.paddingLeft, r3.width),
                      p3.setVerticalPosition(b3, h3);
                  } else {
                    var S3 = o3 * (h3 + u3) + r3.paddingLeft;
                    p3.setVerticalPosition(r3.paddingTop, r3.height),
                      p3.setHorizontalPosition(S3, h3);
                  }
                  (p3.originX = e4), (p3.originY = n4);
                } else (p3 = new ol(v3, f3, g3.clientLayout, w4, E2)).copyFrom(r3);
                (p3.exclusions = m3 ? [] : i3.concat()),
                  (p3.innerShape = c3),
                  E2.setContainer(p3),
                  p3.width >= 0
                    ? g3.layoutColumn(p3, a3).then(function () {
                        E2.isInvalidated() || E2.finish(),
                          p3.pageFloatLayoutContext.isInvalidated() &&
                          !s3.isInvalidated()
                            ? (p3.pageFloatLayoutContext.validate(),
                              (g3.currentLayoutPosition = y3.clone()),
                              p3.element !== v3 && v3.removeChild(p3.element),
                              t5.continueLoop())
                            : t5.breakLoop();
                      })
                    : (E2.finish(), t5.breakLoop());
              })
              .then(function () {
                w3.finish(p3);
              }),
            w3.result()
          );
        }),
        (n3.setPagePageFloatLayoutContextContainer = function (t4, e4, n4) {
          (e4 instanceof Dh || (e4 instanceof ih && !(e4 instanceof Lh))) &&
            t4.setContainer(n4);
        }),
        (n3.getRegionPageFloatLayoutContext = function (t4, e4, n4, i3) {
          var r3 = e4.getProp(this, 'writing-mode') || null,
            o3 = e4.getProp(this, 'direction') || null;
          return new as(t4, ts.REGION, n4, i3, null, r3, o3);
        }),
        (n3.layoutFlowColumnsWithBalancing = function (
          t4,
          e4,
          n4,
          i3,
          r3,
          o3,
          a3,
          s3,
          l3,
        ) {
          var u3 = this,
            h3 = u3.currentLayoutPosition.clone(),
            c3 = u3.getRegionPageFloatLayoutContext(o3, e4, a3, s3),
            f3 = true;
          function d3() {
            return (
              (u3.currentLayoutPosition = h3.clone()),
              u3
                .layoutFlowColumns(t4, e4, n4, i3, r3, o3, c3, a3, s3, l3, f3)
                .thenAsync(function (t5) {
                  return Si(
                    t5
                      ? { columns: t5, position: u3.currentLayoutPosition }
                      : null,
                  );
                })
            );
          }
          return d3().thenAsync(function (t5) {
            if (!t5) return Si(null);
            if (l3 <= 1) return Si(t5.columns);
            var n5 = e4.getProp(u3, 'column-fill') || Ye.balance,
              i4 = (function (t6, e5, n6, i5, r4, o4, a4) {
                if (e5 === Ye.auto) return null;
                var s4 = o4[o4.length - 1];
                return 0 === a4.positions.length || (s4 && s4.pageBreakType)
                  ? new Jl(n6, i5, r4, t6)
                  : e5 === Ye.balance_all
                  ? new nu(n6, i5, r4)
                  : null;
              })(
                l3,
                n5,
                d3,
                c3,
                a3,
                t5.columns,
                u3.currentLayoutPosition.flowPositions[s3],
              );
            return i4
              ? ((f3 = false),
                o3.lock(),
                c3.lock(),
                i4.balanceColumns(t5).thenAsync(function (t6) {
                  return (
                    o3.unlock(),
                    o3.validate(),
                    c3.unlock(),
                    (u3.currentLayoutPosition = t6.position),
                    Si(t6.columns)
                  );
                }))
              : Si(t5.columns);
          });
        }),
        (n3.layoutFlowColumns = function (
          t4,
          e4,
          n4,
          i3,
          r3,
          o3,
          a3,
          s3,
          l3,
          u3,
          h3,
        ) {
          var c3 = this,
            f3 = bi('layoutFlowColumns'),
            d3 = c3.currentLayoutPosition.clone(),
            p3 = e4.getPropAsNumber(c3, 'column-gap'),
            g3 = u3 > 1 ? e4.getPropAsNumber(c3, 'column-width') : s3.width,
            m3 = e4.getActiveRegions(c3),
            v3 = xn(
              e4.getProp(c3, 'shape-inside'),
              0,
              0,
              s3.width,
              s3.height,
              c3,
            ),
            E2 = new Jh(
              l3,
              c3,
              c3.viewport,
              c3.styler,
              m3,
              c3.xmldoc,
              c3.faces,
              c3.style.footnoteProps,
              c3,
              t4,
              c3.customRenderer,
              c3.fallbackMap,
              this.documentURLTransformer,
            ),
            y3 = 0,
            w3 = null,
            N3 = [];
          return (
            f3
              .loopWithFrame(function (t5) {
                c3.createAndLayoutColumn(
                  e4,
                  n4,
                  i3,
                  r3,
                  s3,
                  y3++,
                  l3,
                  a3,
                  u3,
                  p3,
                  g3,
                  v3,
                  E2,
                  h3,
                ).then(function (e5) {
                  return o3.isInvalidated()
                    ? ((N3 = null), void t5.breakLoop())
                    : ((!(e5.pageBreakType && 'column' !== e5.pageBreakType) &&
                        y3 !== u3) ||
                        a3.isInvalidated() ||
                        a3.finish(),
                      a3.isInvalidated()
                        ? ((y3 = 0),
                          (c3.currentLayoutPosition = d3.clone()),
                          a3.validate(),
                          void (a3.isLocked()
                            ? ((N3 = null), t5.breakLoop())
                            : t5.continueLoop()))
                        : ((N3[y3 - 1] = w3 = e5),
                          w3.pageBreakType &&
                            'column' != w3.pageBreakType &&
                            ((y3 = u3),
                            'region' != w3.pageBreakType &&
                              (c3.pageBreaks[l3] = true)),
                          void (y3 < u3 ? t5.continueLoop() : t5.breakLoop())));
                });
              })
              .then(function () {
                f3.finish(N3);
              }),
            f3.result()
          );
        }),
        (n3.layoutContainer = function (t4, e4, n4, i3, r3, o3, a3) {
          var s3 = this;
          e4.reset();
          var l3 = e4.getProp(s3, 'enabled');
          if (l3 && l3 !== Ye._true) return Si(true);
          var u3 = bi('layoutContainer'),
            h3 = e4.getProp(s3, 'wrap-flow') === Ye.auto,
            c3 = e4.getProp(s3, 'flow-from'),
            f3 = s3.viewport.document.createElement('div'),
            d3 = e4.getProp(s3, 'position');
          $2(f3, 'position', d3 ? d3.name : 'absolute'),
            n4.insertBefore(f3, n4.firstChild);
          var p3,
            g3 = new Za(f3);
          (g3.vertical = e4.vertical),
            (g3.exclusions = o3),
            e4.prepareContainer(s3, g3, t4, s3.faces, s3.clientLayout),
            (g3.originX = i3),
            (g3.originY = r3),
            (i3 += g3.left + g3.marginLeft + g3.borderLeft),
            (r3 += g3.top + g3.marginTop + g3.borderTop),
            this.setPagePageFloatLayoutContextContainer(a3, e4, g3);
          var m3 = false;
          if (c3 && c3.isIdent())
            if (s3.pageBreaks[c3.toString()])
              a3.isInvalidated() ||
                e4.finishContainer(
                  s3,
                  g3,
                  t4,
                  null,
                  1,
                  s3.clientLayout,
                  s3.faces,
                ),
                (p3 = Si(true));
            else {
              var v3 = bi('layoutContainer.inner'),
                E2 = c3.toString(),
                y3 = e4.getPropAsNumber(s3, 'column-count');
              s3
                .layoutFlowColumnsWithBalancing(
                  t4,
                  e4,
                  i3,
                  r3,
                  o3,
                  a3,
                  g3,
                  E2,
                  y3,
                )
                .then(function (n5) {
                  if (!a3.isInvalidated()) {
                    var i4 = n5[0];
                    i4.element === f3 && (g3 = i4),
                      (g3.computedBlockSize = Math.max.apply(
                        null,
                        n5.map(function (t5) {
                          return t5.computedBlockSize;
                        }),
                      )),
                      e4.finishContainer(
                        s3,
                        g3,
                        t4,
                        i4,
                        y3,
                        s3.clientLayout,
                        s3.faces,
                      );
                    var r4 = s3.currentLayoutPosition.flowPositions[E2];
                    r4 && 'region' === r4.breakAfter && (r4.breakAfter = null);
                  }
                  v3.finish(true);
                }),
                (p3 = v3.result());
            }
          else {
            var w3 = e4.getProp(s3, 'content');
            if (w3 && Ja(w3)) {
              var N3 = 'span';
              w3.url && (N3 = 'img');
              var b3 = s3.viewport.document.createElement(N3);
              w3.visit(
                new $a(b3, s3, w3, s3.counterStore.getExprContentListener()),
              ),
                f3.appendChild(b3),
                'img' == N3 &&
                  e4.transferSinglUriContentProps(s3, b3, s3.faces),
                e4.transferContentProps(s3, g3, t4, s3.faces);
            } else
              e4.suppressEmptyBoxGeneration &&
                (n4.removeChild(f3), (m3 = true));
            m3 ||
              e4.finishContainer(
                s3,
                g3,
                t4,
                null,
                1,
                s3.clientLayout,
                s3.faces,
              ),
              (p3 = Si(true));
          }
          return (
            p3.then(function () {
              if (a3.isInvalidated()) u3.finish(true);
              else {
                if (!e4.isAutoHeight || Math.floor(g3.computedBlockSize) > 0) {
                  if (!m3 && !h3) {
                    var l4 = e4.getProp(s3, 'shape-outside'),
                      c4 = g3.getOuterShape(l4, s3);
                    o3.push(c4);
                  }
                } else if (0 == e4.children.length)
                  return n4.removeChild(f3), void u3.finish(true);
                var d4 = e4.children.length - 1;
                u3.loop(function () {
                  for (; d4 >= 0; ) {
                    var n5 = e4.children[d4--],
                      l5 = s3.layoutContainer(t4, n5, f3, i3, r3, o3, a3);
                    if (l5.isPending())
                      return l5.thenAsync(function () {
                        return Si(!a3.isInvalidated());
                      });
                    if (a3.isInvalidated()) break;
                  }
                  return Si(false);
                }).then(function () {
                  u3.finish(true);
                });
              }
            }),
            u3.result()
          );
        }),
        (n3.processLinger = function () {
          var t4 = this.currentLayoutPosition.page;
          for (var e4 in this.currentLayoutPosition.flowPositions)
            for (
              var n4 = this.currentLayoutPosition.flowPositions[e4],
                i3 = n4.positions.length - 1;
              i3 >= 0;
              i3--
            ) {
              var r3 = n4.positions[i3];
              r3.flowChunk.startPage >= 0 &&
                r3.flowChunk.startPage + r3.flowChunk.linger - 1 <= t4 &&
                n4.positions.splice(i3, 1);
            }
        }),
        (n3.initLingering = function () {
          var t4 = this.currentLayoutPosition.page;
          for (var e4 in this.currentLayoutPosition.flowPositions)
            for (
              var n4 = this.currentLayoutPosition.flowPositions[e4],
                i3 = n4.positions.length - 1;
              i3 >= 0;
              i3--
            ) {
              var r3 = n4.positions[i3];
              r3.flowChunk.startPage < 0 &&
                r3.flowChunk.startOffset < this.lookupOffset &&
                (r3.flowChunk.startPage = t4);
            }
        }),
        (n3.noMorePrimaryFlows = function (t4) {
          for (var e4 in this.primaryFlows) {
            var n4 = t4.flowPositions[e4];
            if (n4 && n4.positions.length > 0) return false;
          }
          return true;
        }),
        (n3.layoutNextPage = function (t4, e4) {
          var n4 = this,
            i3 = t4.container === t4.bleedBox;
          (n4.pageBreaks = {}),
            e4
              ? ((n4.currentLayoutPosition = e4.clone()),
                n4.styler.replayFlowElementsFromOffset(e4.highestSeenOffset))
              : ((n4.currentLayoutPosition = new Qa()),
                n4.styler.replayFlowElementsFromOffset(-1)),
            this.lang && t4.bleedBox.setAttribute('lang', this.lang),
            (e4 = n4.currentLayoutPosition).page++,
            n4.clearScope(n4.style.pageScope),
            (n4.layoutPositionAtPageStart = e4.clone());
          var r3 = i3 ? {} : n4.pageManager.getCascadedPageStyle(),
            o3 = n4.selectPageMaster(r3);
          if (!o3) return Si(null);
          var a3 = 0;
          if (!i3) {
            t4.setAutoPageWidth(o3.pageBox.specified.width.value === qe),
              t4.setAutoPageHeight(o3.pageBox.specified.height.value === Qe),
              n4.counterStore.setCurrentPage(t4),
              n4.counterStore.updatePageCounters(r3, n4);
            var s3 = yh(Eh(r3), this);
            n4.setPageSizeAndBleed(s3, t4),
              (function (t5, e5, n5, i4) {
                var r4 = false,
                  o4 = false,
                  a4 = t5.marks;
                if (a4) {
                  var s4 = a4.value;
                  s4.isSpaceList()
                    ? s4.values.forEach(function (t6) {
                        t6 === Ye.crop
                          ? (r4 = true)
                          : t6 === Ye.cross && (o4 = true);
                      })
                    : s4 === Ye.crop
                    ? (r4 = true)
                    : s4 === Ye.cross && (o4 = true);
                }
                if (r4 || o4) {
                  var l4 = n5.container,
                    u4 = l4.ownerDocument,
                    h4 = e5.bleed,
                    c4 = Xe(ph, i4),
                    f3 = Xe(gh, i4),
                    d3 = Xe(mh, i4);
                  if (h4) {
                    var p3 = t5['background-color'];
                    p3 &&
                      p3.value &&
                      (n5.bleedBox.style.backgroundColor = p3.value.stringValue());
                  }
                  r4 &&
                    Object.keys(ch).forEach(function (t6) {
                      var e6 = (function (t7, e7, n6, i5, r5, o5) {
                        var a5 = i5;
                        a5 <= r5 + 2 * Ut.mm && (a5 = r5 + i5 / 2);
                        var s5 = Math.max(i5, a5),
                          l5 = r5 + s5 + n6 / 2,
                          u5 = wh(t7, l5, l5),
                          h5 = [
                            [0, r5 + i5],
                            [i5, r5 + i5],
                            [i5, r5 + i5 - a5],
                          ],
                          c5 = h5.map(function (t8) {
                            return [t8[1], t8[0]];
                          });
                        (e7 !== ch.TOP_RIGHT && e7 !== ch.BOTTOM_RIGHT) ||
                          ((h5 = h5.map(function (t8) {
                            return [r5 + s5 - t8[0], t8[1]];
                          })),
                          (c5 = c5.map(function (t8) {
                            return [r5 + s5 - t8[0], t8[1]];
                          }))),
                          (e7 !== ch.BOTTOM_LEFT && e7 !== ch.BOTTOM_RIGHT) ||
                            ((h5 = h5.map(function (t8) {
                              return [t8[0], r5 + s5 - t8[1]];
                            })),
                            (c5 = c5.map(function (t8) {
                              return [t8[0], r5 + s5 - t8[1]];
                            })));
                        var f4 = Nh(t7, n6);
                        f4.setAttribute(
                          'points',
                          h5
                            .map(function (t8) {
                              return t8.join(',');
                            })
                            .join(' '),
                        ),
                          u5.appendChild(f4);
                        var d4 = Nh(t7, n6);
                        return (
                          d4.setAttribute(
                            'points',
                            c5
                              .map(function (t8) {
                                return t8.join(',');
                              })
                              .join(' '),
                          ),
                          u5.appendChild(d4),
                          e7.split(' ').forEach(function (t8) {
                            u5.style[t8] = o5 + 'px';
                          }),
                          u5
                        );
                      })(u4, ch[t6], c4, d3, h4, f3);
                      l4.appendChild(e6);
                    }),
                    o4 &&
                      Object.keys(fh).forEach(function (t6) {
                        var e6 = (function (t7, e7, n6, i5, r5) {
                          var o5,
                            a5,
                            s5 = 2 * i5;
                          e7 === fh.TOP || e7 === fh.BOTTOM
                            ? ((o5 = s5), (a5 = i5))
                            : ((o5 = i5), (a5 = s5));
                          var l5 = wh(t7, o5, a5),
                            u5 = Nh(t7, n6);
                          u5.setAttribute(
                            'points',
                            '0,' + a5 / 2 + ' ' + o5 + ',' + a5 / 2,
                          ),
                            l5.appendChild(u5);
                          var h5 = Nh(t7, n6);
                          h5.setAttribute(
                            'points',
                            o5 / 2 + ',0 ' + o5 / 2 + ',' + a5,
                          ),
                            l5.appendChild(h5);
                          var c5,
                            f4 = Nh(t7, n6, 'circle');
                          switch (
                            (f4.setAttribute('cx', o5 / 2),
                            f4.setAttribute('cy', a5 / 2),
                            f4.setAttribute('r', i5 / 4),
                            l5.appendChild(f4),
                            e7)
                          ) {
                            case fh.TOP:
                              c5 = fh.BOTTOM;
                              break;
                            case fh.BOTTOM:
                              c5 = fh.TOP;
                              break;
                            case fh.LEFT:
                              c5 = fh.RIGHT;
                              break;
                            case fh.RIGHT:
                              c5 = fh.LEFT;
                          }
                          return (
                            Object.keys(fh).forEach(function (t8) {
                              var n7 = fh[t8];
                              n7 === e7
                                ? (l5.style[n7] = r5 + 'px')
                                : n7 !== c5 &&
                                  ((l5.style[n7] = '0'),
                                  (l5.style['margin-' + n7] = 'auto'));
                            }),
                            l5
                          );
                        })(u4, fh[t6], c4, d3, f3);
                        l4.appendChild(e6);
                      });
                }
              })(r3, s3, t4, this),
              (a3 = s3.bleedOffset + s3.bleed);
          }
          var l3 = (!i3 && o3.getProp(n4, 'writing-mode')) || Ye.horizontal_tb;
          this.pageVertical = l3 != Ye.horizontal_tb;
          var u3 = o3.getProp(n4, 'direction') || Ye.ltr,
            h3 = new as(
              n4.rootPageFloatLayoutContext,
              ts.PAGE,
              null,
              null,
              null,
              l3,
              u3,
            ),
            c3 = bi('layoutNextPage');
          return (
            c3
              .loopWithFrame(function (e5) {
                n4.layoutContainer(t4, o3, t4.bleedBox, a3, a3, [], h3).then(
                  function () {
                    h3.isInvalidated() || h3.finish(),
                      h3.isInvalidated()
                        ? ((n4.currentLayoutPosition = n4.layoutPositionAtPageStart.clone()),
                          h3.validate(),
                          e5.continueLoop())
                        : e5.breakLoop();
                  },
                );
              })
              .then(function () {
                if ((o3.adjustPageLayout(n4, t4, n4.clientLayout), !i3)) {
                  var r4 = new de(o3.pageBox.scope, 'left-page');
                  (t4.side = r4.evaluate(n4)
                    ? exports.PageSide.LEFT
                    : exports.PageSide.RIGHT),
                    n4.processLinger(),
                    (e4 = n4.currentLayoutPosition),
                    Object.keys(e4.flowPositions).forEach(function (t5) {
                      var i4 = e4.flowPositions[t5],
                        r5 = i4.breakAfter;
                      !r5 ||
                        ('page' !== r5 && n4.matchPageSide(r5)) ||
                        (i4.breakAfter = null);
                    });
                }
                (n4.currentLayoutPosition = n4.layoutPositionAtPageStart = null),
                  (e4.highestSeenOffset = n4.styler.getReachedOffset());
                var a4 = n4.style.store.getTriggersForDoc(n4.xmldoc);
                t4.finish(a4, n4.clientLayout),
                  n4.noMorePrimaryFlows(e4) && (e4 = null),
                  c3.finish(e4);
              }),
            c3.result()
          );
        }),
        (n3.setPageSizeAndBleed = function (t4, e4) {
          (this.actualPageWidth = t4.pageWidth),
            (this.actualPageHeight = t4.pageHeight),
            (this.pageSheetWidth = t4.pageWidth + 2 * t4.cropOffset),
            (this.pageSheetHeight = t4.pageHeight + 2 * t4.cropOffset),
            (e4.container.style.width = this.pageSheetWidth + 'px'),
            (e4.container.style.height = this.pageSheetHeight + 'px'),
            (e4.bleedBox.style.left = t4.bleedOffset + 'px'),
            (e4.bleedBox.style.right = t4.bleedOffset + 'px'),
            (e4.bleedBox.style.top = t4.bleedOffset + 'px'),
            (e4.bleedBox.style.bottom = t4.bleedOffset + 'px'),
            (e4.bleedBox.style.padding = t4.bleed + 'px'),
            (e4.bleedBox.style.paddingTop = t4.bleed + 0.01 + 'px');
        }),
        e3
      );
    })(Ht);
    var dc = (function (t3) {
      function e3(e4, n4, i3, r3) {
        var o3;
        return (
          ((o3 =
            t3.call(this, e4.rootScope, e4, n4, i3, r3, e4.validatorSet, !i3) ||
            this).masterHandler = e4),
          (o3.insideRegion = false),
          o3
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.startPageTemplateRule = function () {}),
        (n3.startPageMasterRule = function (t4, e4, n4) {
          var i3 = new Hu(
            this.masterHandler.pageScope,
            t4,
            e4,
            n4,
            this.masterHandler.rootBox,
            this.condition,
            this.owner.getBaseSpecificity(),
          );
          this.masterHandler.pushHandler(
            new uh(i3.scope, this.masterHandler, i3, this.validatorSet),
          );
        }),
        (n3.startWhenRule = function (t4) {
          var n4 = t4.expr;
          null != this.condition && (n4 = Ne(this.scope, this.condition, n4)),
            this.masterHandler.pushHandler(
              new e3(this.masterHandler, n4, this, this.regionId),
            );
        }),
        (n3.startDefineRule = function () {
          this.masterHandler.pushHandler(new Jo(this.scope, this.owner));
        }),
        (n3.startFontFaceRule = function () {
          var t4 = {};
          this.masterHandler.fontFaces.push({
            properties: t4,
            condition: this.condition,
          }),
            this.masterHandler.pushHandler(
              new ta(
                this.scope,
                this.owner,
                null,
                t4,
                this.masterHandler.validatorSet,
              ),
            );
        }),
        (n3.startFlowRule = function (t4) {
          var e4 = this.masterHandler.flowProps[t4];
          e4 || (this.masterHandler.flowProps[t4] = e4 = {}),
            this.masterHandler.pushHandler(
              new ta(
                this.scope,
                this.owner,
                null,
                e4,
                this.masterHandler.validatorSet,
              ),
            );
        }),
        (n3.startViewportRule = function () {
          var t4 = {};
          this.masterHandler.viewportProps.push(t4),
            this.masterHandler.pushHandler(
              new ta(
                this.scope,
                this.owner,
                this.condition,
                t4,
                this.masterHandler.validatorSet,
              ),
            );
        }),
        (n3.startFootnoteRule = function (t4) {
          var e4 = this.masterHandler.footnoteProps;
          if (t4) {
            var n4 = Gr(e4, '_pseudos');
            (e4 = n4[t4]) || (n4[t4] = e4 = {});
          }
          this.masterHandler.pushHandler(
            new ta(
              this.scope,
              this.owner,
              null,
              e4,
              this.masterHandler.validatorSet,
            ),
          );
        }),
        (n3.startRegionRule = function () {
          (this.insideRegion = true), this.startSelectorRule();
        }),
        (n3.startPageRule = function () {
          var t4 = new Xh(
            this.masterHandler.pageScope,
            this.masterHandler,
            this,
            this.validatorSet,
            this.masterHandler.pageProps,
          );
          this.masterHandler.pushHandler(t4), t4.startPageRule();
        }),
        (n3.startRuleBody = function () {
          if ((qo.prototype.startRuleBody.call(this), this.insideRegion)) {
            this.insideRegion = false;
            var t4 = 'R' + this.masterHandler.regionCount++;
            this.special('region-id', Fe(t4)), this.endRule();
            var n4 = new e3(this.masterHandler, this.condition, this, t4);
            this.masterHandler.pushHandler(n4), n4.startRuleBody();
          }
        }),
        e3
      );
    })(qo);
    function pc(t3) {
      var e3 = t3.getAttribute('content');
      if (!e3) return '';
      for (
        var n3, i3 = {};
        null !=
        (n3 = e3.match(
          /^,?\s*([-A-Za-z_.][-A-Za-z_0-9.]*)\s*=\s*([-+A-Za-z_0-9.]*)\s*/,
        ));

      )
        (e3 = e3.substr(n3[0].length)), (i3[n3[1]] = n3[2]);
      var r3 = i3.width - 0,
        o3 = i3.height - 0;
      return r3 && o3
        ? '@-epubx-viewport{width:' + r3 + 'px;height:' + o3 + 'px;}'
        : '';
    }
    var gc = (function (t3) {
      function e3(e4) {
        var n3;
        return (
          ((n3 = t3.call(this) || this).validatorSet = e4),
          (n3.regionCount = 0),
          (n3.fontFaces = []),
          (n3.footnoteProps = {}),
          (n3.flowProps = {}),
          (n3.viewportProps = []),
          (n3.pageProps = {}),
          (n3.rootScope = new Bt(null)),
          (n3.pageScope = new Bt(n3.rootScope)),
          (n3.rootBox = new Uu(n3.rootScope)),
          (n3.cascadeParserHandler = new dc(k2(n3), null, null, null)),
          (n3.slave = n3.cascadeParserHandler),
          n3
        );
      }
      return (
        I2(e3, t3),
        (e3.prototype.error = function (t4, e4) {
          c2.warn('CSS parser:', t4);
        }),
        e3
      );
    })(Xi);
    function mc(t3, e3) {
      return e3.parseOPSResource(t3);
    }
    var vc = (function (t3) {
      function e3(e4) {
        var n4;
        return (
          ((n4 = t3.call(this, mc, Ti.DOCUMENT) || this).fontDeobfuscator = e4),
          (n4.styleByKey = {}),
          (n4.styleFetcherByKey = {}),
          (n4.styleByDocURL = {}),
          (n4.triggersByDocURL = {}),
          (n4.validatorSet = null),
          (n4.styleSheets = []),
          (n4.triggerSingleDocumentPreprocessing = false),
          n4
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.init = function (t4, e4) {
          var n4 = this;
          this.setStyleSheets(t4, e4);
          var i3 = W('user-agent.xml', z2),
            r3 = bi('OPSDocStore.init');
          return (
            (this.validatorSet = Ru()),
            hc.get().then(function () {
              n4.load(i3).then(function () {
                (n4.triggerSingleDocumentPreprocessing = true), r3.finish(true);
              });
            }),
            r3.result()
          );
        }),
        (n3.getStyleForDoc = function (t4) {
          return this.styleByDocURL[t4.url];
        }),
        (n3.getTriggersForDoc = function (t4) {
          return this.triggersByDocURL[t4.url];
        }),
        (n3.setStyleSheets = function (t4, e4) {
          this.clearStyleSheets(),
            t4 && t4.forEach(this.addAuthorStyleSheet, this),
            e4 && e4.forEach(this.addUserStyleSheet, this);
        }),
        (n3.clearStyleSheets = function () {
          this.styleSheets.splice(0);
        }),
        (n3.addAuthorStyleSheet = function (t4) {
          var e4 = t4.url;
          e4 && (e4 = W(X(e4), U)),
            this.styleSheets.push({
              url: e4,
              text: t4.text,
              flavor: Ui.AUTHOR,
              classes: null,
              media: null,
            });
        }),
        (n3.addUserStyleSheet = function (t4) {
          var e4 = t4.url;
          e4 && (e4 = W(X(e4), U)),
            this.styleSheets.push({
              url: e4,
              text: t4.text,
              flavor: Ui.USER,
              classes: null,
              media: null,
            });
        }),
        (n3.parseOPSResource = function (t4) {
          var e4 = bi('OPSDocStore.load'),
            n4 = this,
            i3 = t4.url,
            r3 = i3.endsWith('?viv-toc-box');
          return (
            sc(t4, n4).then(function (t5) {
              if (t5) {
                if (n4.triggerSingleDocumentPreprocessing)
                  for (
                    var o3 = g2(exports.HOOKS.PREPROCESS_SINGLE_DOCUMENT),
                      a3 = 0;
                    a3 < o3.length;
                    a3++
                  )
                    try {
                      o3[a3](t5.document);
                    } catch (t6) {
                      c2.warn(
                        'Error during single document preprocessing:',
                        t6,
                      );
                    }
                for (
                  var s3 = [],
                    l3 = t5.document.getElementsByTagNameNS(H2.epub, 'trigger'),
                    u3 = 0;
                  u3 < l3.length;
                  u3++
                ) {
                  var h3 = l3[u3],
                    f3 = h3.getAttributeNS(H2.EV, 'observer'),
                    d3 = h3.getAttributeNS(H2.EV, 'event'),
                    p3 = h3.getAttribute('action'),
                    m3 = h3.getAttribute('ref');
                  f3 &&
                    d3 &&
                    p3 &&
                    m3 &&
                    s3.push({ observer: f3, event: d3, action: p3, ref: m3 });
                }
                n4.triggersByDocURL[i3] = s3;
                var v3 = [],
                  E2 = W('user-agent-page.css', z2);
                v3.push({
                  url: E2,
                  text:
                    '\n@namespace html "http://www.w3.org/1999/xhtml";\n@namespace fb2 "http://www.gribuser.ru/xml/fictionbook/2.0";\n\nhtml|body,\nfb2|body {\n  hyphens: -epubx-expr(pref-hyphenate? "auto": "manual");\n}\n\n@-adapt-footnote-area {\n  display: block;\n  margin-block-start: 0.5em;\n  margin-block-end: 0.5em;\n}\n\n@-adapt-footnote-area ::before {\n  display: block;\n  border-block-start-width: 1px;\n  border-block-start-style: solid;\n  border-block-start-color: black;\n  margin-block-end: 0.4em;\n  margin-inline-start: 0;\n  margin-inline-end: 60%;\n}\n\n/* default page master */\n@-epubx-page-master :background-host {\n  @-epubx-partition :layout-host {\n    -epubx-flow-from: body;\n    top: -epubx-expr(header.margin-bottom-edge);\n    bottom: -epubx-expr(page-height - footer.margin-top-edge);\n    left: 0px;\n    right: 0px;\n    column-width: 25em;\n  }\n  @-epubx-partition footer :oeb-page-foot {\n    writing-mode: horizontal-tb;\n    -epubx-flow-from: oeb-page-foot;\n    bottom: 0px;\n    left: 0px;\n    right: 0px;\n  }\n  @-epubx-partition header :oeb-page-head {\n    writing-mode: horizontal-tb;\n    -epubx-flow-from: oeb-page-head;\n    top: 0px;\n    left: 0px;\n    right: 0px;\n  }\n}\n\n@page {\n  @top-left-corner {\n    text-align: right;\n    vertical-align: middle;\n  }\n  @top-left {\n    text-align: left;\n    vertical-align: middle;\n  }\n  @top-center {\n    text-align: center;\n    vertical-align: middle;\n  }\n  @top-right {\n    text-align: right;\n    vertical-align: middle;\n  }\n  @top-right-corner {\n    text-align: left;\n    vertical-align: middle;\n  }\n  @left-top {\n    text-align: center;\n    vertical-align: top;\n  }\n  @left-middle {\n    text-align: center;\n    vertical-align: middle;\n  }\n  @left-bottom {\n    text-align: center;\n    vertical-align: bottom;\n  }\n  @right-top {\n    text-align: center;\n    vertical-align: top;\n  }\n  @right-middle {\n    text-align: center;\n    vertical-align: middle;\n  }\n  @right-bottom {\n    text-align: center;\n    vertical-align: bottom;\n  }\n  @bottom-left-corner {\n    text-align: right;\n    vertical-align: middle;\n  }\n  @bottom-left {\n    text-align: left;\n    vertical-align: middle;\n  }\n  @bottom-center {\n    text-align: center;\n    vertical-align: middle;\n  }\n  @bottom-right {\n    text-align: right;\n    vertical-align: middle;\n  }\n  @bottom-right-corner {\n    text-align: left;\n    vertical-align: middle;\n  }\n}\n\n@media print {\n  @page {\n    margin: 10%;\n  }\n}\n',
                  flavor: Ui.USER_AGENT,
                  classes: null,
                  media: null,
                });
                var y3 = t5.head;
                if (!r3 && y3) {
                  for (var w3 = y3.firstChild; w3; w3 = w3.nextSibling)
                    if (1 == w3.nodeType) {
                      var N3 = w3,
                        b3 = N3.namespaceURI,
                        S3 = N3.localName;
                      if (b3 == H2.XHTML)
                        if ('style' == S3) {
                          var C3 = N3.getAttribute('class'),
                            T3 = N3.getAttribute('media'),
                            x3 = N3.getAttribute('title');
                          v3.push({
                            url: i3,
                            text: N3.textContent,
                            flavor: Ui.AUTHOR,
                            classes: x3 ? C3 : null,
                            media: T3,
                          });
                        } else if ('link' == S3) {
                          var I3 = N3.getAttribute('rel'),
                            P3 = N3.getAttribute('class'),
                            R2 = N3.getAttribute('media');
                          if (
                            'stylesheet' == I3 ||
                            ('alternate stylesheet' == I3 && P3)
                          ) {
                            var A3 = N3.getAttribute('href');
                            A3 = W(A3, i3);
                            var L3 = N3.getAttribute('title');
                            v3.push({
                              url: A3,
                              text: null,
                              classes: L3 ? P3 : null,
                              media: R2,
                              flavor: Ui.AUTHOR,
                            });
                          }
                        } else
                          'meta' == S3 &&
                            'viewport' == N3.getAttribute('name') &&
                            v3.push({
                              url: i3,
                              text: pc(N3),
                              flavor: Ui.AUTHOR,
                              classes: null,
                              media: null,
                            });
                      else if (b3 == H2.FB2)
                        'stylesheet' == S3 &&
                          'text/css' == N3.getAttribute('type') &&
                          v3.push({
                            url: i3,
                            text: N3.textContent,
                            flavor: Ui.AUTHOR,
                            classes: null,
                            media: null,
                          });
                      else if (b3 == H2.SSE && 'property' === S3) {
                        var O3 = N3.getElementsByTagName('name')[0];
                        if (O3 && 'stylesheet' === O3.textContent) {
                          var k3 = N3.getElementsByTagName('value')[0];
                          if (k3) {
                            var F2 = W(k3.textContent, i3);
                            v3.push({
                              url: F2,
                              text: null,
                              classes: null,
                              media: null,
                              flavor: Ui.AUTHOR,
                            });
                          }
                        }
                      }
                    }
                }
                if (!r3)
                  for (var D2 = 0; D2 < n4.styleSheets.length; D2++)
                    v3.push(n4.styleSheets[D2]);
                for (var _3 = '', B2 = 0; B2 < v3.length; B2++)
                  (_3 += v3[B2].url),
                    (_3 += '^'),
                    v3[B2].text && (_3 += v3[B2].text),
                    (_3 += '^');
                var M3 = n4.styleByKey[_3];
                if (M3) return (n4.styleByDocURL[i3] = M3), void e4.finish(t5);
                var U2 = n4.styleFetcherByKey[_3];
                U2 ||
                  ((U2 = new Fi(function () {
                    var t6 = bi('fetchStylesheet'),
                      e5 = 0,
                      i4 = new gc(n4.validatorSet);
                    return (
                      t6
                        .loop(function () {
                          if (e5 < v3.length) {
                            var t7 = v3[e5++];
                            return (
                              i4.startStylesheet(t7.flavor),
                              null !== t7.text
                                ? cr(
                                    t7.text,
                                    i4,
                                    t7.url,
                                    t7.classes,
                                    t7.media,
                                  ).thenReturn(true)
                                : fr(t7.url, i4, t7.classes, t7.media)
                            );
                          }
                          return Si(false);
                        })
                        .then(function () {
                          var e6 = i4.cascadeParserHandler.finish();
                          (M3 = new cc(
                            n4,
                            i4.rootScope,
                            i4.pageScope,
                            e6,
                            i4.rootBox,
                            i4.fontFaces,
                            i4.footnoteProps,
                            i4.flowProps,
                            i4.viewportProps,
                            i4.pageProps,
                          )),
                            (n4.styleByKey[_3] = M3),
                            delete n4.styleFetcherByKey[_3],
                            t6.finish(M3);
                        }),
                      t6.result()
                    );
                  }, 'FetchStylesheet ' + i3)),
                  (n4.styleFetcherByKey[_3] = U2),
                  U2.start()),
                  U2.get().then(function (r4) {
                    (n4.styleByDocURL[i3] = r4), e4.finish(t5);
                  });
              } else e4.finish(null);
            }),
            e4.result()
          );
        }),
        e3
      );
    })(Vi);
    function Ec(t3) {
      return String.fromCharCode(
        (t3 >>> 24) & 255,
        (t3 >>> 16) & 255,
        (t3 >>> 8) & 255,
        255 & t3,
      );
    }
    function yc(t3) {
      return (
        ((255 & t3.charCodeAt(0)) << 24) |
        ((255 & t3.charCodeAt(1)) << 16) |
        ((255 & t3.charCodeAt(2)) << 8) |
        (255 & t3.charCodeAt(3))
      );
    }
    function wc(t3) {
      var e3 = new et();
      e3.append(t3);
      var n3 = (55 - t3.length) & 63;
      for (e3.append(''); n3 > 0; ) n3--, e3.append('\0');
      e3.append('\0\0\0\0'), e3.append(Ec(8 * t3.length)), (t3 = e3.toString());
      for (
        var i3,
          r3 = [1732584193, 4023233417, 2562383102, 271733878, 3285377520],
          o3 = [],
          a3 = 0;
        a3 < t3.length;
        a3 += 64
      ) {
        for (i3 = 0; i3 < 16; i3++) o3[i3] = yc(t3.substr(a3 + 4 * i3, 4));
        for (; i3 < 80; i3++) {
          var s3 = o3[i3 - 3] ^ o3[i3 - 8] ^ o3[i3 - 14] ^ o3[i3 - 16];
          o3[i3] = (s3 << 1) | (s3 >>> 31);
        }
        var l3 = r3[0],
          u3 = r3[1],
          h3 = r3[2],
          c3 = r3[3],
          f3 = r3[4],
          d3 = void 0;
        for (i3 = 0; i3 < 80; i3++)
          (d3 =
            i3 < 20
              ? 1518500249 + ((u3 & h3) | (~u3 & c3))
              : i3 < 40
              ? 1859775393 + (u3 ^ h3 ^ c3)
              : i3 < 60
              ? 2400959708 + ((u3 & h3) | (u3 & c3) | (h3 & c3))
              : 3395469782 + (u3 ^ h3 ^ c3)),
            (d3 += ((l3 << 5) | (l3 >>> 27)) + f3 + o3[i3]),
            (f3 = c3),
            (c3 = h3),
            (h3 = (u3 << 30) | (u3 >>> 2)),
            (u3 = l3),
            (l3 = d3);
        (r3[0] = (r3[0] + l3) | 0),
          (r3[1] = (r3[1] + u3) | 0),
          (r3[2] = (r3[2] + h3) | 0),
          (r3[3] = (r3[3] + c3) | 0),
          (r3[4] = (r3[4] + f3) | 0);
      }
      return r3;
    }
    var Nc = (function () {
      function t3(t4, e4, n3, i3, r3, o3, a3, s3, l3, u3) {
        (this.store = t4),
          (this.url = e4),
          (this.lang = n3),
          (this.clientLayout = i3),
          (this.fontMapper = r3),
          (this.rendererFactory = a3),
          (this.fallbackMap = s3),
          (this.documentURLTransformer = l3),
          (this.counterStore = u3),
          (this.page = null),
          (this.instance = null),
          (this.pref = Rt(o3)),
          (this.pref.spreadView = false);
      }
      var e3 = t3.prototype;
      return (
        (e3.setAutoHeight = function (t4, e4) {
          if (0 != e4--) {
            for (var n3 = t4.firstChild; n3; n3 = n3.nextSibling)
              if (1 == n3.nodeType) {
                var i3 = n3;
                'auto' != J(i3, 'height', 'auto') &&
                  ($2(i3, 'height', 'auto'), this.setAutoHeight(i3, e4)),
                  'absolute' == J(i3, 'position', 'static') &&
                    ($2(i3, 'position', 'relative'),
                    this.setAutoHeight(i3, e4));
              }
          }
        }),
        (e3.makeCustomRenderer = function (t4) {
          var e4 = this.rendererFactory.makeCustomRenderer(t4);
          return function (t5, n3, i3) {
            var r3 = i3.behavior;
            if (r3)
              switch (r3.toString()) {
                case 'body-child':
                  t5.parentElement.getAttribute(
                    'data-vivliostyle-primary-entry',
                  ) &&
                    (t5.querySelector(
                      '[role=doc-toc], [role=directory], nav li a, .toc, #toc',
                    ) ||
                      (i3.display = Ye.none));
                  break;
                case 'toc-node-anchor':
                  (i3.color = Ye.inherit), (i3['text-decoration'] = Ye.none);
                  break;
                case 'toc-node':
                  (i3.display = Ye.block),
                    (i3.margin = Ze),
                    (i3.padding = Ze),
                    (i3['padding-inline-start'] = new De(1.25, 'em'));
                  break;
                case 'toc-node-first-child':
                  (i3.display = Ye.inline_block),
                    (i3.margin = new De(0.2, 'em')),
                    (i3['vertical-align'] = Ye.top),
                    (i3.color = Ye.inherit),
                    (i3['text-decoration'] = Ye.none);
              }
            if (
              !r3 ||
              ('toc-node' != r3.toString() && 'toc-container' != r3.toString())
            )
              return e4(t5, n3, i3);
            var o3 = t5.firstChild;
            o3 &&
              1 !== o3.nodeType &&
              '' === o3.textContent.trim() &&
              t5.replaceChild(
                t5.ownerDocument.createComment(o3.textContent),
                o3,
              );
            var a3 = n3.getAttribute('data-adapt-class');
            if ('toc-node' == a3) {
              var s3 = n3.firstChild;
              '' != s3.textContent &&
                ((s3.textContent = ''),
                $2(s3, 'cursor', 'pointer'),
                s3.addEventListener('click', bc, false),
                s3.setAttribute('role', 'button'),
                s3.setAttribute('aria-expanded', 'false'),
                n3.setAttribute('aria-expanded', 'false'),
                '0px' !== n3.style.height && (s3.tabIndex = 0));
            }
            var l3 = n3.ownerDocument.createElement('div');
            if (
              (l3.setAttribute('data-adapt-process-children', 'true'),
              'toc-node' == r3.toString())
            ) {
              var u3 = n3.ownerDocument.createElement('div');
              if (
                ((u3.textContent = ''),
                $2(u3, 'margin', '0.2em 0 0 -1em'),
                $2(u3, 'margin-inline-start', '-1em'),
                $2(u3, 'margin-inline-end', '0'),
                $2(u3, 'display', 'inline-block'),
                $2(u3, 'width', '1em'),
                $2(u3, 'text-align', 'center'),
                $2(u3, 'vertical-align', 'top'),
                $2(u3, 'cursor', 'default'),
                $2(u3, 'font-family', 'Menlo,sans-serif'),
                l3.appendChild(u3),
                $2(l3, 'overflow', 'hidden'),
                l3.setAttribute('data-adapt-class', 'toc-node'),
                l3.setAttribute('role', 'treeitem'),
                'toc-node' == a3 || 'toc-container' == a3)
              ) {
                $2(l3, 'height', '0px');
                var h3 = t5.firstElementChild;
                h3 && 'a' === h3.localName && (h3.tabIndex = -1);
              } else n3.setAttribute('role', 'tree');
            } else
              'toc-node' == a3 &&
                (l3.setAttribute('data-adapt-class', 'toc-container'),
                l3.setAttribute('role', 'group'),
                l3.setAttribute('aria-hidden', 'true'));
            return Si(l3);
          };
        }),
        (e3.showTOC = function (t4, e4, n3, i3, r3) {
          var o3 = this;
          if (this.page) return Si(this.page);
          var a3 = this,
            s3 = bi('showTOC'),
            l3 = new Aa(t4, t4);
          return (
            (this.page = l3),
            this.store.load(this.url + '?viv-toc-box').then(function (i4) {
              var u3 = o3.store.resources[o3.url];
              u3 &&
                u3.body &&
                u3.body.getAttribute('data-vivliostyle-primary-entry') &&
                i4.body.setAttribute('data-vivliostyle-primary-entry', true);
              var h3 = a3.store.getStyleForDoc(i4),
                c3 = h3.sizeViewport(n3, 1e5, r3);
              e4 = new rc(e4.window, c3.fontSize, e4.root, c3.width, c3.height);
              var f3 = a3.makeCustomRenderer(i4),
                d3 = new fc(
                  h3,
                  i4,
                  a3.lang,
                  e4,
                  a3.clientLayout,
                  a3.fontMapper,
                  f3,
                  a3.fallbackMap,
                  0,
                  a3.documentURLTransformer,
                  a3.counterStore,
                );
              (a3.instance = d3),
                (d3.pref = a3.pref),
                d3.init().then(function () {
                  d3.layoutNextPage(l3, null).then(function () {
                    Array.from(
                      l3.container.querySelectorAll(
                        "[data-vivliostyle-toc-box]>*>*>*>*>*[style*='display: none']",
                      ),
                    ).forEach(function (t5) {
                      t5.setAttribute('aria-hidden', 'true'),
                        t5.setAttribute('hidden', 'hidden');
                    }),
                      a3.setAutoHeight(t4, 2),
                      s3.finish(l3);
                  });
                });
            }),
            s3.result()
          );
        }),
        (e3.hideTOC = function () {
          this.page &&
            ((this.page.container.style.visibility = 'hidden'),
            this.page.container.setAttribute('aria-hidden', 'true'));
        }),
        (e3.isTOCVisible = function () {
          return (
            !!this.page && 'visible' === this.page.container.style.visibility
          );
        }),
        (e3.getTOC = function () {
          if (!this.page) return [];
          function t4(t5) {
            if (!t5) return [];
            var n3 = t5.querySelectorAll(':scope > [role=treeitem] > a[href]');
            return Array.from(n3).map(e4);
          }
          function e4(e5) {
            return {
              id: new URL(e5.href).hash.match(/^#(.*)$/)[1],
              title: e5.innerText,
              children: t4(e5.parentElement.querySelector('[role=group]')),
            };
          }
          return t4(this.page.container.querySelector('[role=tree]'));
        }),
        t3
      );
    })();
    function bc(t3) {
      var e3 = t3.target,
        n3 = '' == e3.textContent;
      e3.textContent = n3 ? '' : '';
      var i3 = e3.parentNode;
      e3.setAttribute('aria-expanded', n3 ? 'true' : 'false'),
        i3.setAttribute('aria-expanded', n3 ? 'true' : 'false');
      for (var r3 = i3.firstChild; r3; ) {
        if (1 === r3.nodeType) {
          var o3 = r3,
            a3 = o3.getAttribute('data-adapt-class');
          if ('toc-container' === a3) {
            if (
              (o3.setAttribute('aria-hidden', n3 ? 'false' : 'true'),
              o3.firstChild)
            ) {
              r3 = o3.firstChild;
              continue;
            }
          } else if (
            'toc-node' === a3 &&
            ((o3.style.height = n3 ? 'auto' : '0px'),
            o3.children.length >= 2 && (o3.children[1].tabIndex = n3 ? 0 : -1),
            o3.children.length >= 3 &&
              ((o3.children[0].tabIndex = n3 ? 0 : -1), !n3))
          ) {
            var s3 = o3.children[0];
            if ('' == s3.textContent) {
              (s3.textContent = ''),
                s3.setAttribute('aria-expanded', 'false'),
                o3.setAttribute('aria-expanded', 'false'),
                (r3 = o3.children[2]);
              continue;
            }
          }
        }
        for (; !r3.nextSibling && r3.parentNode !== i3; ) r3 = r3.parentNode;
        r3 = r3.nextSibling;
      }
      t3.stopPropagation();
    }
    var Sc = (function (t3) {
      function e3() {
        var e4;
        return (
          ((e4 = t3.call(this, null) || this).opfByURL = {}),
          (e4.primaryOPFByEPubURL = {}),
          (e4.deobfuscators = {}),
          (e4.documents = {}),
          (e4.fontDeobfuscator = e4.makeDeobfuscatorFactory()),
          (e4.plainXMLStore = new Vi(sc, Ti.DOCUMENT)),
          (e4.jsonStore = new Vi(Hi, Ti.TEXT)),
          e4
        );
      }
      I2(e3, t3);
      var n3 = e3.prototype;
      return (
        (n3.makeDeobfuscatorFactory = function () {
          var t4 = this;
          return function (e4) {
            return t4.deobfuscators[e4];
          };
        }),
        (n3.loadAsPlainXML = function (t4, e4, n4) {
          return this.plainXMLStore.load(t4, e4, n4);
        }),
        (n3.startLoadingAsPlainXML = function (t4) {
          this.plainXMLStore.fetch(t4);
        }),
        (n3.loadAsJSON = function (t4, e4, n4) {
          return this.jsonStore.load(t4, e4, n4);
        }),
        (n3.startLoadingAsJSON = function (t4) {
          this.jsonStore.fetch(t4);
        }),
        (n3.loadPubDoc = function (t4, e4) {
          var n4 = this,
            i3 = bi('loadPubDoc');
          return (
            Bi(t4, null, 'HEAD').then(function (r3) {
              if (r3.status >= 400)
                n4.loadEPUBDoc(t4, e4).then(function (e5) {
                  e5
                    ? i3.finish(e5)
                    : (c2.error(
                        'Failed to fetch a source document from ' +
                          t4 +
                          ' (' +
                          r3.status +
                          (r3.statusText ? ' ' + r3.statusText : '') +
                          ')',
                      ),
                      i3.finish(null));
                });
              else if (
                (r3.status ||
                  r3.responseXML ||
                  r3.responseText ||
                  r3.responseBlob ||
                  r3.contentType ||
                  (/\/[^/.]+(?:[#?]|$)/.test(t4) &&
                    (t4 = t4.replace(/([#?]|$)/, '/$1'))),
                'application/oebps-package+xml' == r3.contentType ||
                  /\.opf(?:[#?]|$)/.test(t4))
              ) {
                var o3 = t4.match(/^((?:.*\/)?)([^/]*)$/);
                n4.loadOPF(o3[1], o3[2], e4).thenFinish(i3);
              } else
                'application/ld+json' == r3.contentType ||
                'application/webpub+json' == r3.contentType ||
                'application/audiobook+json' == r3.contentType ||
                'application/json' == r3.contentType ||
                /\.json(?:ld)?(?:[#?]|$)/.test(t4)
                  ? n4.loadAsJSON(t4, true).then(function (e5) {
                      if (!e5)
                        return (
                          c2.error(
                            'Received an empty response for ' +
                              t4 +
                              '. This may be caused by the server not allowing cross-origin resource sharing (CORS).',
                          ),
                          void i3.finish(null)
                        );
                      var r4 = new kc(n4, t4);
                      r4.initWithWebPubManifest(e5).then(function () {
                        i3.finish(r4);
                      });
                    })
                  : n4.loadWebPub(t4).then(function (r4) {
                      r4
                        ? i3.finish(r4)
                        : n4.loadEPUBDoc(t4, e4).then(function (e5) {
                            e5
                              ? i3.finish(e5)
                              : (c2.error('Failed to load ' + t4 + '.'),
                                i3.finish(null));
                          });
                    });
            }),
            i3.result()
          );
        }),
        (n3.loadEPUBDoc = function (t4, e4) {
          var n4 = this,
            i3 = bi('loadEPUBDoc');
          return (
            t4.endsWith('/') || (t4 += '/'),
            e4 && this.startLoadingAsJSON(t4 + '?r=list'),
            this.startLoadingAsPlainXML(t4 + 'META-INF/encryption.xml'),
            this.loadAsPlainXML(t4 + 'META-INF/container.xml').then(function (
              r3,
            ) {
              if (r3) {
                for (
                  var o3,
                    a3 = D(
                      r3
                        .doc()
                        .child('container')
                        .child('rootfiles')
                        .child('rootfile')
                        .attribute('full-path'),
                    );
                  !(o3 = a3()).done;

                ) {
                  var s3 = o3.value;
                  if (s3) return void n4.loadOPF(t4, s3, e4).thenFinish(i3);
                }
                i3.finish(null);
              }
            }),
            i3.result()
          );
        }),
        (n3.loadOPF = function (t4, e4, n4) {
          var i3 = this,
            r3 = t4 + e4,
            o3 = i3.opfByURL[r3];
          if (o3) return Si(o3);
          var a3 = bi('loadOPF');
          return (
            i3
              .loadAsPlainXML(r3, true, 'Failed to fetch EPUB OPF ' + r3)
              .then(function (e5) {
                e5
                  ? i3
                      .loadAsPlainXML(t4 + 'META-INF/encryption.xml')
                      .then(function (s3) {
                        (n4 ? i3.loadAsJSON(t4 + '?r=list') : Si(null)).then(
                          function (n5) {
                            (o3 = new kc(i3, t4))
                              .initWithXMLDoc(e5, s3, n5, t4 + '?r=manifest')
                              .then(function () {
                                (i3.opfByURL[r3] = o3),
                                  (i3.primaryOPFByEPubURL[t4] = o3),
                                  a3.finish(o3);
                              });
                          },
                        );
                      })
                  : c2.error(
                      'Received an empty response for EPUB OPF ' +
                        r3 +
                        '. This may be caused by the server not allowing cross-origin resource sharing (CORS).',
                    );
              }),
            a3.result()
          );
        }),
        (n3.loadWebPub = function (t4) {
          var e4 = this,
            n4 = bi('loadWebPub');
          return (
            this.load(t4).then(function (i3) {
              if (i3)
                if (
                  i3.document.querySelector(
                    "a[href='META-INF/'],a[href$='/META-INF/']",
                  )
                )
                  n4.finish(null);
                else {
                  var r3 = i3.document,
                    o3 = new kc(e4, t4);
                  r3.body &&
                    r3.body.setAttribute(
                      'data-vivliostyle-primary-entry',
                      true,
                    );
                  var a3 = r3.querySelector(
                    "link[rel='publication'],link[rel='manifest'][type='application/webpub+json']",
                  );
                  if (a3) {
                    var s3 = a3.getAttribute('href');
                    if (/^#/.test(s3)) {
                      var l3 = B(r3.getElementById(s3.substr(1)).textContent);
                      o3.initWithWebPubManifest(l3, r3).then(function () {
                        n4.finish(o3);
                      });
                    } else
                      e4.loadAsJSON(W(a3.getAttribute('href'), t4)).then(
                        function (t5) {
                          o3.initWithWebPubManifest(t5, r3).then(function () {
                            n4.finish(o3);
                          });
                        },
                      );
                  } else
                    o3.initWithWebPubManifest({}, r3).then(function () {
                      o3.xhtmlToc &&
                        o3.xhtmlToc.src === i3.url &&
                        (r3.querySelector(
                          '[role=doc-toc], [role=directory], nav, .toc, #toc',
                        ) ||
                          (o3.xhtmlToc = null)),
                        n4.finish(o3);
                    });
                }
              else
                c2.error(
                  'Received an empty response for ' +
                    t4 +
                    '. This may be caused by the server not allowing cross-origin resource sharing (CORS).',
                );
            }),
            n4.result()
          );
        }),
        (n3.addDocument = function (t4, e4) {
          var n4 = bi('EPUBDocStore.load'),
            i3 = M2(t4);
          return (
            (this.documents[i3] = this.parseOPSResource({
              status: 200,
              statusText: '',
              url: i3,
              contentType: e4.contentType,
              responseText: null,
              responseXML: e4,
              responseBlob: null,
            })).thenFinish(n4),
            n4.result()
          );
        }),
        (n3.load = function (e4) {
          var n4 = M2(e4),
            i3 = this.documents[n4];
          if (i3) return i3.isPending() ? i3 : Si(i3.get());
          var r3 = bi('EPUBDocStore.load');
          return (
            (i3 = t3.prototype.load.call(
              this,
              n4,
              true,
              'Failed to fetch a source document from ' + n4,
            )).then(function (t4) {
              t4
                ? r3.finish(t4)
                : n4.startsWith('data:')
                ? c2.error('Failed to load ' + n4 + '. Invalid data.')
                : n4.startsWith('http:') && U.startsWith('https:')
                ? c2.error(
                    'Failed to load ' +
                      n4 +
                      '. Mixed Content ("http:" content on "https:" context) is not allowed.',
                  )
                : c2.error(
                    'Received an empty response for ' +
                      n4 +
                      '. This may be caused by the server not allowing cross-origin resource sharing (CORS).',
                  );
            }),
            r3.result()
          );
        }),
        e3
      );
    })(vc);
    var Cc = (function () {
      function t3() {
        (this.id = null),
          (this.src = ''),
          (this.mediaType = null),
          (this.title = null),
          (this.itemRefElement = null),
          (this.spineIndex = -1),
          (this.compressedSize = 0),
          (this.compressed = null),
          (this.epage = 0),
          (this.epageCount = 0),
          (this.startPage = null),
          (this.skipPagesBefore = null),
          (this.itemProperties = _2);
      }
      var e3 = t3.prototype;
      return (
        (e3.initWithElement = function (t4, e4) {
          (this.id = t4.getAttribute('id')),
            (this.src = W(t4.getAttribute('href'), e4)),
            (this.mediaType = t4.getAttribute('media-type'));
          var n3 = t4.getAttribute('properties');
          n3 &&
            (this.itemProperties = (function (t5) {
              for (var e5 = {}, n4 = 0; n4 < t5.length; n4++) e5[t5[n4]] = true;
              return e5;
            })(n3.split(/\s+/)));
        }),
        (e3.initWithParam = function (t4) {
          (this.spineIndex = t4.index),
            (this.id = 'item' + (t4.index + 1)),
            (this.src = t4.url),
            (this.startPage = t4.startPage),
            (this.skipPagesBefore = t4.skipPagesBefore);
        }),
        t3
      );
    })();
    function Tc(t3) {
      return t3.id;
    }
    var xc = {
      dcterms: 'http://purl.org/dc/terms/',
      marc: 'http://id.loc.gov/vocabulary/',
      media: 'http://www.idpf.org/epub/vocab/overlays/#',
      rendition: 'http://www.idpf.org/vocab/rendition/#',
      onix: 'http://www.editeur.org/ONIX/book/codelists/current.html#',
      xsd: 'http://www.w3.org/2001/XMLSchema#',
      opf: 'http://www.idpf.org/2007/opf',
    };
    var Ic = 'http://idpf.org/epub/vocab/package/meta/#';
    var Pc = {
      language: xc.dcterms + 'language',
      title: xc.dcterms + 'title',
      creator: xc.dcterms + 'creator',
      layout: xc.rendition + 'layout',
      titleType: Ic + 'title-type',
      displaySeq: Ic + 'display-seq',
      alternateScript: Ic + 'alternate-script',
      role: Ic + 'role',
    };
    function Rc(t3, e3) {
      var n3 = {};
      return function (i3, r3) {
        var o3,
          a3,
          s3,
          l3,
          u3,
          h3 = i3.r || n3,
          c3 = r3.r || n3;
        if (
          t3 == Pc.title &&
          (s3 =
            'main' == (null == (l3 = h3[Pc.titleType]) ? void 0 : l3[0].v)) !=
            ('main' == (null == (u3 = c3[Pc.titleType]) ? void 0 : u3[0].v))
        )
          return s3 ? -1 : 1;
        var f3 = parseInt(
          null == (o3 = h3[Pc.displaySeq]) ? void 0 : o3[0].v,
          10,
        );
        isNaN(f3) && (f3 = Number.MAX_VALUE);
        var d3,
          p3,
          g3 = parseInt(
            null == (a3 = c3[Pc.displaySeq]) ? void 0 : a3[0].v,
            10,
          );
        return (
          isNaN(g3) && (g3 = Number.MAX_VALUE),
          f3 != g3
            ? f3 - g3
            : t3 != Pc.language &&
              e3 &&
              (s3 =
                (null == (d3 = h3[Pc.language] || h3[Pc.alternateScript])
                  ? void 0
                  : d3[0].v) == e3) !=
                ((null == (p3 = c3[Pc.language] || c3[Pc.alternateScript])
                  ? void 0
                  : p3[0].v) ==
                  e3)
            ? s3
              ? -1
              : 1
            : i3.o - r3.o
        );
      };
    }
    function Ac() {
      var t3 = window.MathJax;
      return t3 ? t3.Hub : null;
    }
    var Lc;
    var Oc = {
      'application/xhtml+xml': true,
      'image/jpeg': true,
      'image/png': true,
      'image/svg+xml': true,
      'image/gif': true,
      'audio/mp3': true,
    };
    var kc = (function () {
      function t3(t4, e4) {
        (this.store = t4),
          (this.pubURL = e4),
          (this.opfXML = null),
          (this.encXML = null),
          (this.items = null),
          (this.spine = null),
          (this.itemMap = null),
          (this.itemMapByPath = null),
          (this.uid = null),
          (this.bindings = {}),
          (this.lang = null),
          (this.epageCount = 0),
          (this.prePaginated = false),
          (this.epageIsRenderedPage = true),
          (this.epageCountCallback = null),
          (this.metadata = {}),
          (this.ncxToc = null),
          (this.xhtmlToc = null),
          (this.cover = null),
          (this.fallbackMap = {}),
          (this.pageProgression = null),
          (this.documentURLTransformer = this.createDocumentURLTransformer()),
          Ac() && (Cr[H2.MATHML] = true);
      }
      var e3 = t3.prototype;
      return (
        (e3.createDocumentURLTransformer = function () {
          var t4 = this;
          return new ((function () {
            function e4() {}
            var n3 = e4.prototype;
            return (
              (n3.transformFragment = function (t5, e5) {
                return 'viv-id-' + st(e5 + (t5 ? '#' + t5 : ''), ':');
              }),
              (n3.transformURL = function (e5, n4) {
                var i3 = e5.match(/^([^#]*)#?(.*)$/);
                if (i3) {
                  var r3 = i3[1] || n4,
                    o3 = i3[2];
                  if (
                    r3 &&
                    t4.items.some(function (t5) {
                      return t5.src === r3;
                    })
                  )
                    return '#' + this.transformFragment(o3, r3);
                }
                return e5;
              }),
              (n3.restoreURL = function (t5) {
                '#' === t5.charAt(0) && (t5 = t5.substring(1)),
                  0 === t5.indexOf('viv-id-') &&
                    (t5 = t5.substring('viv-id-'.length));
                var e5 = (function (t6, e6) {
                  e6 = 'string' == typeof e6 ? e6 : '\\u';
                  var n4 = new RegExp(lt(e6) + '[0-9a-fA-F]{4}', 'g');
                  return t6.replace(n4, function (t7) {
                    return (function (t8, e7) {
                      return 0 ===
                        t8.indexOf((e7 = 'string' == typeof e7 ? e7 : '\\u'))
                        ? String.fromCharCode(
                            parseInt(t8.substring(e7.length), 16),
                          )
                        : t8;
                    })(t7, e6);
                  });
                })(t5, ':').match(/^([^#]*)#?(.*)$/);
                return e5 ? [e5[1], e5[2]] : [];
              }),
              e4
            );
          })())();
        }),
        (e3.getMetadata = function () {
          return this.metadata;
        }),
        (e3.getPathFromURL = function (t4) {
          if (t4.startsWith('data:')) return t4 === this.pubURL ? '' : t4;
          if (this.pubURL) {
            var e4 = W('', this.pubURL);
            return t4 === e4 || t4 + '/' === e4
              ? ''
              : ('/' != e4.charAt(e4.length - 1) && (e4 += '/'),
                t4.substr(0, e4.length) == e4
                  ? decodeURI(t4.substr(e4.length))
                  : null);
          }
          return t4;
        }),
        (e3.initWithXMLDoc = function (t4, e4, n3, i3) {
          var r3 = this;
          (this.opfXML = t4), (this.encXML = e4);
          var a3 = t4.doc().child('package'),
            s3 = a3.attribute('unique-identifier')[0];
          if (s3) {
            var l3 = t4.getElement(t4.url + '#' + s3);
            l3 && (this.uid = l3.textContent.replace(/[ \n\r\t]/g, ''));
          }
          var u3 = {};
          for (var h3 in ((this.items = a3
            .child('manifest')
            .child('item')
            .asArray()
            .map(function (e5) {
              var n4 = new Cc(),
                i4 = e5;
              n4.initWithElement(i4, t4.url);
              var o3 = i4.getAttribute('fallback');
              return (
                o3 && !Oc[n4.mediaType] && (u3[n4.src] = o3),
                !r3.xhtmlToc && n4.itemProperties.nav && (r3.xhtmlToc = n4),
                !r3.cover &&
                  n4.itemProperties['cover-image'] &&
                  (r3.cover = n4),
                n4
              );
            })),
          (this.itemMap = ct(this.items, Tc)),
          (this.itemMapByPath = ct(this.items, function (t5) {
            return r3.getPathFromURL(t5.src);
          })),
          u3))
            for (var c3 = h3; ; ) {
              var f3 = this.itemMap[u3[c3]];
              if (!f3) break;
              if (Oc[f3.mediaType]) {
                this.fallbackMap[h3] = f3.src;
                break;
              }
              c3 = f3.src;
            }
          this.spine = a3
            .child('spine')
            .child('itemref')
            .asArray()
            .map(function (t5, e5) {
              var n4 = t5,
                i4 = n4.getAttribute('idref'),
                o3 = r3.itemMap[i4];
              return o3 && ((o3.itemRefElement = n4), (o3.spineIndex = e5)), o3;
            });
          var d3 = a3.child('spine').attribute('toc')[0];
          d3 && (this.ncxToc = this.itemMap[d3]);
          var p3 = a3.child('spine').attribute('page-progression-direction')[0];
          p3 && (this.pageProgression = o2(p3));
          for (
            var g3 = e4
                ? e4
                    .doc()
                    .child('encryption')
                    .child('EncryptedData')
                    .predicate(
                      lc.withChild(
                        'EncryptionMethod',
                        lc.withAttribute(
                          'Algorithm',
                          'http://www.idpf.org/2008/embedding',
                        ),
                      ),
                    )
                    .child('CipherData')
                    .child('CipherReference')
                    .attribute('URI')
                : [],
              m3 = a3.child('bindings').child('mediaType').asArray(),
              v3 = 0;
            v3 < m3.length;
            v3++
          ) {
            var E2 = m3[v3].getAttribute('handler'),
              y3 = m3[v3].getAttribute('media-type');
            y3 &&
              E2 &&
              this.itemMap[E2] &&
              (this.bindings[y3] = this.itemMap[E2].src);
          }
          if (
            ((this.metadata = (function (t5, e5) {
              var n4;
              if (e5) {
                for (var i4 in ((n4 = {}), xc)) n4[i4] = xc[i4];
                for (
                  var r4;
                  null !=
                  (r4 = e5.match(
                    /^\s*([A-Z_a-z\u007F-\uFFFF][-.A-Z_a-z0-9\u007F-\uFFFF]*):\s*(\S+)/,
                  ));

                )
                  (e5 = e5.substr(r4[0].length)), (n4[r4[1]] = r4[2]);
              } else n4 = xc;
              var o3 = function (t6) {
                  if (t6) {
                    var e6 = t6.match(/^\s*(([^:]*):)?(\S+)\s*$/);
                    if (e6) {
                      var i5 = e6[2] ? n4[e6[2]] : Ic;
                      if (i5) return i5 + e6[3];
                    }
                  }
                  return null;
                },
                a4 = 1,
                s4 = t5.childElements().forEachNonNull(function (t6) {
                  if ('meta' == t6.localName) {
                    var e6 = o3(t6.getAttribute('property'));
                    if (e6)
                      return {
                        name: e6,
                        value: t6.textContent,
                        id: t6.getAttribute('id'),
                        order: a4++,
                        refines: t6.getAttribute('refines'),
                        lang: null,
                        scheme: o3(t6.getAttribute('scheme')),
                        role: null,
                      };
                  } else if (t6.namespaceURI == H2.DC) return { name: xc.dcterms + t6.localName, order: a4++, lang: t6.getAttribute('xml:lang'), value: t6.textContent, id: t6.getAttribute('id'), refines: null, scheme: null, role: t6.getAttribute('role') || t6.getAttribute('opf:role') };
                  return null;
                }),
                l4 = ft(s4, function (t6) {
                  return t6.refines;
                }),
                u4 = (function t6(e6) {
                  return (function (e7, n5) {
                    var i5 = {};
                    for (var r5 in e7)
                      i5[r5] = e7[r5].map(function (e8) {
                        var n6 = { v: e8.value, o: e8.order };
                        e8.scheme && (n6.s = e8.scheme);
                        var i6 = l4['#' + e8.id] || [];
                        if (i6.length || e8.lang || e8.role) {
                          e8.lang &&
                            i6.push({
                              name: Pc.language,
                              value: e8.lang,
                              lang: null,
                              id: null,
                              refines: e8.id,
                              scheme: null,
                              order: e8.order,
                              role: null,
                            }),
                            e8.role &&
                              i6.push({
                                name: Pc.role,
                                value: e8.role,
                                lang: null,
                                id: null,
                                refines: e8.id,
                                scheme: null,
                                order: e8.order,
                                role: null,
                              });
                          var r6 = ft(i6, function (t7) {
                            return t7.name;
                          });
                          n6.r = t6(r6);
                        }
                        return n6;
                      });
                    return i5;
                  })(e6);
                })(
                  ft(s4, function (t6) {
                    return t6.refines ? null : t6.name;
                  }),
                ),
                h4 = null;
              return (
                u4[Pc.language] && (h4 = u4[Pc.language][0].v),
                (function t6(e6) {
                  for (var n5 in e6) {
                    var i5 = e6[n5];
                    i5.sort(Rc(n5, h4));
                    for (var r5 = 0; r5 < i5.length; r5++) {
                      var o4 = i5[r5].r;
                      o4 && t6(o4);
                    }
                  }
                })(u4),
                u4
              );
            })(a3.child('metadata'), a3.attribute('prefix')[0])),
            this.metadata[Pc.language] &&
              (this.lang = this.metadata[Pc.language][0].v),
            this.metadata[Pc.layout] &&
              (this.prePaginated =
                'pre-paginated' === this.metadata[Pc.layout][0].v),
            !n3)
          ) {
            if (g3.length > 0 && this.uid)
              for (
                var w3 = (function (t5) {
                    var e5 = (function (t6) {
                      for (
                        var e6, n4 = [], i4 = D(wc(t6));
                        !(e6 = i4()).done;

                      ) {
                        var r4 = e6.value;
                        n4.push(
                          (r4 >>> 24) & 255,
                          (r4 >>> 16) & 255,
                          (r4 >>> 8) & 255,
                          255 & r4,
                        );
                      }
                      return n4;
                    })(t5);
                    return function (t6) {
                      var n4,
                        i4,
                        r4 = bi('deobfuscator');
                      return (
                        t6.slice
                          ? ((n4 = t6.slice(0, 1040)),
                            (i4 = t6.slice(1040, t6.size)))
                          : ((n4 = t6.webkitSlice(0, 1040)),
                            (i4 = t6.webkitSlice(1040, t6.size - 1040))),
                        (function (t7) {
                          var e6 = bi('readBlob'),
                            n5 = new FileReader(),
                            i5 = e6.suspend(n5);
                          return (
                            n5.addEventListener(
                              'load',
                              function () {
                                i5.schedule(n5.result);
                              },
                              false,
                            ),
                            n5.readAsArrayBuffer(t7),
                            e6.result()
                          );
                        })(n4).then(function (t7) {
                          for (
                            var n5 = new DataView(t7), o3 = 0;
                            o3 < n5.byteLength;
                            o3++
                          ) {
                            var a4 = n5.getUint8(o3);
                            n5.setUint8(o3, (a4 ^= e5[o3 % 20]));
                          }
                          r4.finish(Mi([n5, i4]));
                        }),
                        r4.result()
                      );
                    };
                  })(this.uid),
                  N3 = 0;
                N3 < g3.length;
                N3++
              )
                this.store.deobfuscators[this.pubURL + g3[N3]] = w3;
            return this.prePaginated && this.assignAutoPages(), Si(true);
          }
          var b3 = new et(),
            S3 = {};
          if (g3.length > 0 && this.uid)
            for (
              var C3 =
                  '1040:' +
                  (function (t5) {
                    for (
                      var e5 = (function (t6) {
                          for (
                            var e6 = wc(t6), n5 = new et(), i5 = 0;
                            i5 < e6.length;
                            i5++
                          )
                            n5.append(Ec(e6[i5]));
                          return n5.toString();
                        })(t5),
                        n4 = new et(),
                        i4 = 0;
                      i4 < e5.length;
                      i4++
                    )
                      n4.append(
                        (256 | e5.charCodeAt(i4)).toString(16).substr(1),
                      );
                    return n4.toString();
                  })(this.uid),
                T3 = 0;
              T3 < g3.length;
              T3++
            )
              S3[g3[T3]] = C3;
          for (var x3 = 0; x3 < n3.length; x3++) {
            var I3 = n3[x3],
              P3 = I3.n;
            if (P3) {
              var R2 = decodeURI(P3),
                A3 = this.itemMapByPath[R2],
                L3 = null;
              A3 &&
                ((A3.compressed = 0 != I3.m),
                (A3.compressedSize = I3.c),
                A3.mediaType && (L3 = A3.mediaType.replace(/\s+/g, '')));
              var O3 = S3[R2];
              (L3 || O3) &&
                (b3.append(P3),
                b3.append(' '),
                b3.append(L3 || 'application/octet-stream'),
                O3 && (b3.append(' '), b3.append(O3)),
                b3.append('\n'));
            }
          }
          return (
            r3.assignAutoPages(),
            Bi(i3, Ti.DEFAULT, 'POST', b3.toString(), 'text/plain')
          );
        }),
        (e3.assignAutoPages = function () {
          for (var t4, e4 = 0, n3 = D(this.spine); !(t4 = n3()).done; ) {
            var i3 = t4.value,
              r3 = this.prePaginated ? 1 : Math.ceil(i3.compressedSize / 1024);
            (i3.epage = e4), (i3.epageCount = r3), (e4 += r3);
          }
          (this.epageCount = e4),
            this.epageCountCallback && this.epageCountCallback(this.epageCount);
        }),
        (e3.setEPageCountMode = function (t4) {
          this.epageIsRenderedPage = t4 || this.prePaginated;
        }),
        (e3.countEPages = function (t4) {
          var e4 = this;
          if (((this.epageCountCallback = t4), this.epageIsRenderedPage))
            return (
              this.prePaginated &&
                0 == this.epageCount &&
                this.assignAutoPages(),
              Si(true)
            );
          var n3 = 0,
            i3 = 0,
            r3 = bi('countEPages');
          return (
            r3
              .loopWithFrame(function (t5) {
                if (i3 !== e4.spine.length) {
                  var r4 = e4.spine[i3++];
                  (r4.epage = n3),
                    e4.store.load(r4.src).then(function (i4) {
                      var o3 = 1800,
                        a3 = i4.lang || e4.lang;
                      a3 && a3.match(/^(ja|ko|zh)/) && (o3 /= 3),
                        (r4.epageCount = Math.ceil(i4.getTotalOffset() / o3)),
                        (e4.epageCount = n3 += r4.epageCount),
                        e4.epageCountCallback &&
                          e4.epageCountCallback(e4.epageCount),
                        t5.continueLoop();
                    });
                } else t5.breakLoop();
              })
              .thenFinish(r3),
            r3.result()
          );
        }),
        (e3.initWithChapters = function (t4, e4) {
          var n3 = this;
          (this.itemMap = {}),
            (this.itemMapByPath = {}),
            (this.items = []),
            (this.spine = this.items);
          var i3 = (this.opfXML = new oc(
            null,
            '',
            new DOMParser().parseFromString('<spine></spine>', 'text/xml'),
          ));
          return (
            t4.forEach(function (t5) {
              var e5 = new Cc();
              e5.initWithParam(t5);
              var r3 = i3.document.createElement('itemref');
              r3.setAttribute('idref', e5.id),
                i3.root.appendChild(r3),
                (e5.itemRefElement = r3),
                (n3.itemMap[e5.id] = e5);
              var o3 = n3.getPathFromURL(t5.url);
              null == o3 && (o3 = t5.url),
                (n3.itemMapByPath[o3] = e5),
                n3.items.push(e5);
            }),
            e4 ? this.store.addDocument(t4[0].url, e4) : Si(null)
          );
        }),
        (e3.initWithWebPubManifest = function (t4, e4) {
          var n3 = this;
          t4.readingProgression &&
            (this.pageProgression = t4.readingProgression),
            void 0 === this.metadata && (this.metadata = {});
          var i3 =
            (e4 && e4.title) || t4.name || (t4.metadata && t4.metadata.title);
          i3 && (this.metadata[Pc.title] = [{ v: i3 }]);
          var r3 = this.getPathFromURL(this.pubURL);
          !t4.readingOrder &&
            e4 &&
            null !== r3 &&
            ((t4.readingOrder = [encodeURI(r3)]),
            Array.from(
              e4.querySelectorAll(
                '[role=doc-toc] a[href],[role=directory] a[href],nav li a[href],.toc a[href],#toc a[href]',
              ),
            ).forEach(function (e5) {
              var i4 = M2(W(e5.getAttribute('href'), n3.pubURL)),
                r4 = n3.getPathFromURL(i4),
                o4 = null !== r4 ? encodeURI(r4) : i4;
              -1 == t4.readingOrder.indexOf(o4) && t4.readingOrder.push(o4);
            }));
          var o3 = [],
            a3 = 0,
            s3 = -1;
          [t4.readingOrder, t4.resources].forEach(function (e5) {
            e5 instanceof Array &&
              e5.forEach(function (e6) {
                var i4 = t4.readingOrder.includes(e6),
                  r4 = 'string' == typeof e6 ? e6 : e6.url || e6.href,
                  l4 =
                    'string' == typeof e6
                      ? ''
                      : e6.encodingFormat || (e6.href && e6.type) || '';
                if (
                  i4 ||
                  'text/html' === l4 ||
                  'application/xhtml+xml' === l4 ||
                  /(^|\/)([^/]+\.(x?html|htm|xht)|[^/.]*)([#?]|$)/.test(r4)
                ) {
                  var u3 = {
                    url: W(X(r4), n3.pubURL),
                    index: a3++,
                    startPage: null,
                    skipPagesBefore: null,
                  };
                  'contents' === e6.rel && -1 === s3 && (s3 = u3.index),
                    o3.push(u3);
                }
              });
          });
          var l3 = bi('initWithWebPubManifest');
          return (
            this.initWithChapters(o3).then(function () {
              -1 !== s3 && (n3.xhtmlToc = n3.items[s3]),
                n3.xhtmlToc || (n3.xhtmlToc = n3.itemMapByPath[r3]),
                l3.finish(true);
            }),
            l3.result()
          );
        }),
        (e3.getCFI = function (t4, e4) {
          var n3 = this.spine[t4],
            i3 = bi('getCFI');
          return (
            this.store.load(n3.src).then(function (t5) {
              var r3 = t5.getNodeByOffset(e4),
                o3 = null;
              if (r3) {
                var a3 = t5.getNodeOffset(r3, 0, false),
                  s3 = e4 - a3,
                  l3 = new Pt();
                l3.prependPathFromNode(r3, s3, false, null),
                  n3.itemRefElement &&
                    l3.prependPathFromNode(n3.itemRefElement, 0, false, null),
                  (o3 = l3.toString());
              }
              i3.finish(o3);
            }),
            i3.result()
          );
        }),
        (e3.resolveFragment = function (t4) {
          var e4 = this;
          return Ci(
            'resolveFragment',
            function (n3) {
              if (t4) {
                var i3,
                  r3 = new Pt();
                if ((r3.fromString(t4), e4.opfXML)) {
                  var o3 = r3.navigate(e4.opfXML.document);
                  if (1 != o3.node.nodeType || o3.after || !o3.ref)
                    return void n3.finish(null);
                  var a3 = o3.node,
                    s3 = a3.getAttribute('idref');
                  if ('itemref' != a3.localName || !s3 || !e4.itemMap[s3])
                    return void n3.finish(null);
                  (i3 = e4.itemMap[s3]), (r3 = o3.ref);
                } else i3 = e4.spine[0];
                e4.store.load(i3.src).then(function (t5) {
                  var e5 = r3.navigate(t5.document),
                    o4 = t5.getNodeOffset(e5.node, e5.offset, e5.after);
                  n3.finish({
                    spineIndex: i3.spineIndex,
                    offsetInItem: o4,
                    pageIndex: -1,
                  });
                });
              } else n3.finish(null);
            },
            function (e5, n3) {
              c2.warn(n3, 'Cannot resolve fragment:', t4), e5.finish(null);
            },
          );
        }),
        (e3.resolveEPage = function (t4) {
          var e4 = this;
          return Ci(
            'resolveEPage',
            function (n3) {
              if (t4 <= 0)
                n3.finish({ spineIndex: 0, offsetInItem: 0, pageIndex: -1 });
              else if (e4.epageIsRenderedPage) {
                var i3 = e4.spine.findIndex(function (e5) {
                  return (
                    (0 == e5.epage && 0 == e5.epageCount) ||
                    (e5.epage <= t4 && e5.epage + e5.epageCount > t4)
                  );
                });
                -1 == i3 && (i3 = e4.spine.length - 1);
                var r3 = e4.spine[i3];
                (r3 && 0 != r3.epageCount) || (r3 = e4.spine[--i3]);
                var o3 = Math.floor(t4 - r3.epage);
                n3.finish({ spineIndex: i3, offsetInItem: -1, pageIndex: o3 });
              } else {
                var a3 = ut(e4.spine.length, function (n4) {
                  var i4 = e4.spine[n4];
                  return i4.epage + i4.epageCount > t4;
                });
                a3 == e4.spine.length && a3--;
                var s3 = e4.spine[a3];
                e4.store.load(s3.src).then(function (e5) {
                  (t4 -= s3.epage) > s3.epageCount && (t4 = s3.epageCount);
                  var i4 = 0;
                  if (t4 > 0) {
                    var r4 = e5.getTotalOffset();
                    (i4 = Math.round((r4 * t4) / s3.epageCount)) == r4 && i4--;
                  }
                  n3.finish({
                    spineIndex: a3,
                    offsetInItem: i4,
                    pageIndex: -1,
                  });
                });
              }
            },
            function (e5, n3) {
              c2.warn(n3, 'Cannot resolve epage:', t4), e5.finish(null);
            },
          );
        }),
        (e3.getEPageFromPosition = function (t4) {
          var e4 = this.spine[t4.spineIndex];
          if (this.epageIsRenderedPage) return Si(e4.epage + t4.pageIndex);
          if (t4.offsetInItem <= 0) return Si(e4.epage);
          var n3 = bi('getEPage');
          return (
            this.store.load(e4.src).then(function (i3) {
              var r3 = i3.getTotalOffset(),
                o3 = Math.min(r3, t4.offsetInItem);
              n3.finish(e4.epage + (o3 * e4.epageCount) / r3);
            }),
            n3.result()
          );
        }),
        t3
      );
    })();
    var Fc = function (t3, e3) {
      return {
        page: t3,
        position: {
          spineIndex: t3.spineIndex,
          pageIndex: e3,
          offsetInItem: t3.offset,
        },
      };
    };
    var Dc = (function () {
      function t3(t4, e4, n3, i3, r3) {
        (this.opf = t4),
          (this.viewport = e4),
          (this.fontMapper = n3),
          (this.pageSheetSizeReporter = r3),
          (this.spineItems = []),
          (this.spineItemLoadingContinuations = []),
          (this.tocAutohide = false),
          (this.pref = Rt(i3)),
          (this.clientLayout = new ic(e4)),
          (this.counterStore = new Dn(t4.documentURLTransformer));
      }
      var e3 = t3.prototype;
      return (
        (e3.getPage = function (t4) {
          var e4 = this.spineItems[t4.spineIndex];
          return e4 ? e4.pages[t4.pageIndex] : null;
        }),
        (e3.getCurrentPageProgression = function (t4) {
          if (this.opf.pageProgression) return this.opf.pageProgression;
          var e4 = this.spineItems[t4 ? t4.spineIndex : 0];
          return e4 ? e4.instance.pageProgression : null;
        }),
        (e3.finishPageContainer = function (t4, e4, n3) {
          (e4.container.style.display = 'none'),
            (e4.container.style.visibility = 'visible'),
            (e4.container.style.position = ''),
            (e4.container.style.top = ''),
            (e4.container.style.left = ''),
            e4.container.setAttribute('data-vivliostyle-page-side', e4.side);
          var i3 = t4.pages[n3];
          if (
            ((e4.isFirstPage = 0 == t4.item.spineIndex && 0 == n3),
            (t4.pages[n3] = e4),
            this.opf.epageIsRenderedPage)
          ) {
            if (0 == n3 && t4.item.spineIndex > 0) {
              var r3 = this.opf.spine[t4.item.spineIndex - 1];
              t4.item.epage = r3.epage + r3.epageCount;
            }
            (t4.item.epageCount = t4.pages.length),
              (this.opf.epageCount = this.opf.spine.reduce(function (t5, e5) {
                return t5 + e5.epageCount;
              }, 0)),
              this.opf.epageCountCallback &&
                this.opf.epageCountCallback(this.opf.epageCount);
          }
          if (i3)
            t4.instance.viewport.contentContainer.replaceChild(
              e4.container,
              i3.container,
            ),
              i3.dispatchEvent({
                type: 'replaced',
                target: null,
                currentTarget: null,
                preventDefault: null,
                newPage: e4,
              });
          else {
            var o3 = null;
            if (n3 > 0) o3 = t4.pages[n3 - 1].container.nextElementSibling;
            else
              for (
                var a3 = t4.item.spineIndex + 1;
                a3 < this.spineItems.length;
                a3++
              ) {
                var s3 = this.spineItems[a3];
                if (s3 && s3.pages[0]) {
                  o3 = s3.pages[0].container;
                  break;
                }
              }
            t4.instance.viewport.contentContainer.insertBefore(
              e4.container,
              o3,
            );
          }
          this.pageSheetSizeReporter(
            {
              width: t4.instance.pageSheetWidth,
              height: t4.instance.pageSheetHeight,
            },
            t4.instance.pageSheetSize,
            t4.item.spineIndex,
            t4.instance.pageNumberOffset + n3,
          );
        }),
        (e3.renderSinglePage = function (t4, e4) {
          var n3 = bi('renderSinglePage'),
            i3 = this.makePage(t4, e4),
            r3 = this;
          return (
            t4.instance.layoutNextPage(i3, e4).then(function (o3) {
              var a3 = (e4 = o3) ? e4.page - 1 : t4.layoutPositions.length - 1;
              r3.finishPageContainer(t4, i3, a3),
                r3.counterStore.finishPage(i3.spineIndex, a3);
              var s3 = null;
              if (e4) {
                var l3 = t4.layoutPositions[e4.page];
                (t4.layoutPositions[e4.page] = e4),
                  l3 &&
                    t4.pages[e4.page] &&
                    (e4.isSamePosition(l3) ||
                      (s3 = r3.renderSinglePage(t4, e4)));
              }
              s3 || (s3 = Si(true)),
                s3.then(function () {
                  var o4 = r3.counterStore.getUnresolvedRefsToPage(i3),
                    s4 = 0;
                  n3.loopWithFrame(function (t5) {
                    if (++s4 > o4.length) t5.breakLoop();
                    else {
                      var e5 = o4[s4 - 1];
                      (e5.refs = e5.refs.filter(function (t6) {
                        return !t6.isResolved();
                      })),
                        0 !== e5.refs.length
                          ? r3
                              .getPageViewItem(e5.spineIndex)
                              .then(function (n4) {
                                n4
                                  ? (r3.counterStore.pushPageCounters(
                                      e5.pageCounters,
                                    ),
                                    r3.counterStore.pushReferencesToSolve(
                                      e5.refs,
                                    ),
                                    r3
                                      .renderSinglePage(
                                        n4,
                                        n4.layoutPositions[e5.pageIndex],
                                      )
                                      .then(function (e6) {
                                        r3.counterStore.popPageCounters(),
                                          r3.counterStore.popReferencesToSolve();
                                        var n5 = e6.pageAndPosition.position;
                                        n5.spineIndex === i3.spineIndex &&
                                          n5.pageIndex === a3 &&
                                          (i3 = e6.pageAndPosition.page),
                                          t5.continueLoop();
                                      }))
                                  : t5.continueLoop();
                              })
                          : t5.continueLoop();
                    }
                  }).then(function () {
                    i3.container.parentElement || (i3 = t4.pages[a3]),
                      (i3.isLastPage =
                        !e4 && t4.item.spineIndex === r3.opf.spine.length - 1),
                      i3.isLastPage &&
                        r3.counterStore.finishLastPage(r3.viewport),
                      n3.finish({
                        pageAndPosition: Fc(i3, a3),
                        nextLayoutPosition: e4,
                      });
                  });
                });
            }),
            n3.result()
          );
        }),
        (e3.normalizeSeekPosition = function (t4, e4) {
          var n3 = t4.pageIndex,
            i3 = -1;
          if (n3 < 0) {
            i3 = t4.offsetInItem;
            var r3 = ut(e4.layoutPositions.length, function (t5) {
              return e4.instance.getPosition(e4.layoutPositions[t5], true) > i3;
            });
            n3 =
              r3 === e4.layoutPositions.length
                ? e4.complete
                  ? e4.layoutPositions.length - 1
                  : Number.POSITIVE_INFINITY
                : r3 - 1;
          } else
            n3 === Number.POSITIVE_INFINITY &&
              -1 !== t4.offsetInItem &&
              (i3 = t4.offsetInItem);
          return { spineIndex: t4.spineIndex, pageIndex: n3, offsetInItem: i3 };
        }),
        (e3.findPage = function (t4, e4) {
          var n3 = this,
            i3 = bi('findPage');
          return (
            n3.getPageViewItem(t4.spineIndex).then(function (r3) {
              if (r3) {
                var o3,
                  a3 = null;
                i3.loopWithFrame(function (s3) {
                  var l3 = n3.normalizeSeekPosition(t4, r3);
                  (a3 = r3.pages[(o3 = l3.pageIndex)])
                    ? s3.breakLoop()
                    : r3.complete
                    ? ((a3 = r3.pages[(o3 = r3.layoutPositions.length - 1)]),
                      s3.breakLoop())
                    : e4
                    ? n3.renderPage(l3).then(function (t5) {
                        t5 && ((a3 = t5.page), (o3 = t5.position.pageIndex)),
                          s3.breakLoop();
                      })
                    : i3.sleep(100).then(function () {
                        s3.continueLoop();
                      });
                }).then(function () {
                  i3.finish(Fc(a3, o3));
                });
              } else i3.finish(null);
            }),
            i3.result()
          );
        }),
        (e3.renderPage = function (t4) {
          var e4 = this,
            n3 = bi('renderPage');
          return (
            e4.getPageViewItem(t4.spineIndex).then(function (i3) {
              if (i3) {
                var r3 = e4.normalizeSeekPosition(t4, i3),
                  o3 = r3.pageIndex,
                  a3 = r3.offsetInItem,
                  s3 = i3.pages[o3];
                s3
                  ? n3.finish(Fc(s3, o3))
                  : n3
                      .loopWithFrame(function (t5) {
                        if (o3 < i3.layoutPositions.length) t5.breakLoop();
                        else {
                          if (i3.complete)
                            return (
                              (o3 = i3.layoutPositions.length - 1),
                              void t5.breakLoop()
                            );
                          var n4 =
                            i3.layoutPositions[i3.layoutPositions.length - 1];
                          e4.renderSinglePage(i3, n4).then(function (e5) {
                            var r4 = e5.pageAndPosition.page;
                            if ((n4 = e5.nextLayoutPosition)) {
                              if (a3 >= 0 && i3.instance.getPosition(n4) > a3)
                                return (
                                  (s3 = r4),
                                  (o3 = i3.layoutPositions.length - 2),
                                  void t5.breakLoop()
                                );
                              t5.continueLoop();
                            } else (s3 = r4), (o3 = e5.pageAndPosition.position.pageIndex), (i3.complete = true), t5.breakLoop();
                          });
                        }
                      })
                      .then(function () {
                        var t5 = i3.layoutPositions[o3];
                        (s3 = s3 || i3.pages[o3])
                          ? n3.finish(Fc(s3, o3))
                          : e4.renderSinglePage(i3, t5).then(function (t6) {
                              t6.nextLayoutPosition || (i3.complete = true),
                                n3.finish(t6.pageAndPosition);
                            });
                      });
              } else n3.finish(null);
            }),
            n3.result()
          );
        }),
        (e3.renderAllPages = function () {
          return this.renderPagesUpto(
            {
              spineIndex: this.opf.spine.length - 1,
              pageIndex: Number.POSITIVE_INFINITY,
              offsetInItem: -1,
            },
            false,
          );
        }),
        (e3.renderPagesUpto = function (t4, e4) {
          var n3 = this,
            i3 = bi('renderPagesUpto');
          t4 || (t4 = { spineIndex: 0, pageIndex: 0, offsetInItem: 0 });
          var r3,
            o3 = t4.spineIndex,
            a3 = t4.pageIndex,
            s3 = 0;
          return (
            e4 && (s3 = o3),
            i3
              .loopWithFrame(function (e5) {
                n3.renderPage({
                  spineIndex: s3,
                  pageIndex: s3 === o3 ? a3 : Number.POSITIVE_INFINITY,
                  offsetInItem: s3 === o3 ? t4.offsetInItem : -1,
                }).then(function (t5) {
                  (r3 = t5), ++s3 > o3 ? e5.breakLoop() : e5.continueLoop();
                });
              })
              .then(function () {
                i3.finish(r3);
              }),
            i3.result()
          );
        }),
        (e3.firstPage = function (t4, e4) {
          return this.findPage(
            { spineIndex: 0, pageIndex: 0, offsetInItem: -1 },
            e4,
          );
        }),
        (e3.lastPage = function (t4, e4) {
          return this.findPage(
            {
              spineIndex: this.opf.spine.length - 1,
              pageIndex: Number.POSITIVE_INFINITY,
              offsetInItem: -1,
            },
            e4,
          );
        }),
        (e3.nextPage = function (t4, e4) {
          var n3 = this,
            i3 = this,
            r3 = t4.spineIndex,
            o3 = t4.pageIndex,
            a3 = bi('nextPage');
          return (
            i3.getPageViewItem(r3).then(function (t5) {
              if (t5) {
                if (t5.complete && o3 == t5.layoutPositions.length - 1) {
                  if (r3 >= i3.opf.spine.length - 1)
                    return void a3.finish(null);
                  r3++, (o3 = 0);
                  var s3 = n3.spineItems[r3],
                    l3 = s3 && s3.pages[0],
                    u3 = t5.pages[t5.pages.length - 1];
                  l3 &&
                    u3 &&
                    l3.side == u3.side &&
                    (s3.pages.forEach(function (t6) {
                      t6.container && t6.container.remove();
                    }),
                    (n3.spineItems[r3] = null),
                    (n3.spineItemLoadingContinuations[r3] = null));
                } else o3++;
                i3.findPage(
                  { spineIndex: r3, pageIndex: o3, offsetInItem: -1 },
                  e4,
                ).thenFinish(a3);
              } else a3.finish(null);
            }),
            a3.result()
          );
        }),
        (e3.previousPage = function (t4, e4) {
          var n3 = t4.spineIndex,
            i3 = t4.pageIndex;
          if (0 == i3) {
            if (0 == n3) return Si(null);
            n3--, (i3 = Number.POSITIVE_INFINITY);
          } else i3--;
          return this.findPage(
            { spineIndex: n3, pageIndex: i3, offsetInItem: -1 },
            e4,
          );
        }),
        (e3.isRectoPage = function (t4, e4) {
          var n3 = t4.side === exports.PageSide.LEFT,
            i3 =
              this.getCurrentPageProgression(e4) ===
              exports.PageProgression.LTR;
          return (!n3 && i3) || (n3 && !i3);
        }),
        (e3.getSpread = function (t4, e4) {
          var n3 = this,
            i3 = bi('getCurrentSpread'),
            r3 = this.getPage(t4);
          if (!r3) return Si({ left: null, right: null });
          var o3 = r3.side === exports.PageSide.LEFT;
          return (
            (this.isRectoPage(r3, t4)
              ? this.previousPage(t4, e4)
              : this.nextPage(t4, e4)
            ).then(function (e5) {
              var r4 = n3.getPage(t4),
                a3 = e5 && e5.page;
              a3 && a3.side === r4.side && (a3 = null),
                i3.finish(
                  o3 ? { left: r4, right: a3 } : { left: a3, right: r4 },
                );
            }),
            i3.result()
          );
        }),
        (e3.nextSpread = function (t4, e4) {
          var n3 = this.getPage(t4);
          if (!n3) return Si(null);
          var i3 = this.isRectoPage(n3, t4),
            r3 = this.nextPage(t4, e4);
          if (i3) return r3;
          var o3 = this;
          return r3.thenAsync(function (t5) {
            if (t5) {
              if (t5.page.side === n3.side) return r3;
              var i4 = o3.nextPage(t5.position, e4);
              return i4.thenAsync(function (t6) {
                return t6 ? i4 : r3;
              });
            }
            return Si(null);
          });
        }),
        (e3.previousSpread = function (t4, e4) {
          var n3 = this.getPage(t4);
          if (!n3) return Si(null);
          var i3 = this.isRectoPage(n3, t4),
            r3 = this.previousPage(t4, e4),
            o3 = n3.container.previousElementSibling;
          if (i3) {
            var a3 = this;
            return r3.thenAsync(function (t5) {
              return t5
                ? t5.page.side === n3.side || t5.page.container !== o3
                  ? r3
                  : a3.previousPage(t5.position, e4)
                : Si(null);
            });
          }
          return r3;
        }),
        (e3.navigateToEPage = function (t4, e4, n3) {
          var i3 = bi('navigateToEPage'),
            r3 = this;
          return (
            this.opf.resolveEPage(t4).then(function (t5) {
              t5 ? r3.findPage(t5, n3).thenFinish(i3) : i3.finish(null);
            }),
            i3.result()
          );
        }),
        (e3.navigateToFragment = function (t4, e4, n3) {
          var i3 = bi('navigateToCFI'),
            r3 = this;
          return (
            r3.opf.resolveFragment(t4).then(function (t5) {
              t5 ? r3.findPage(t5, n3).thenFinish(i3) : i3.finish(null);
            }),
            i3.result()
          );
        }),
        (e3.navigateTo = function (t4, e4, n3) {
          c2.debug('Navigate to', t4);
          var i3 = this.opf.getPathFromURL(M2(t4));
          if (!i3) {
            if (this.opf.opfXML && t4.match(/^#epubcfi\(/))
              i3 = this.opf.getPathFromURL(this.opf.opfXML.url);
            else if ('#' === t4.charAt(0)) {
              var r3 = this.opf.documentURLTransformer.restoreURL(t4);
              this.opf.opfXML
                ? null == (i3 = this.opf.getPathFromURL(r3[0])) && (i3 = r3[0])
                : (i3 = r3[0]),
                (t4 = r3[0] + (r3[1] ? '#' + r3[1] : ''));
            }
            if (null == i3) return Si(null);
          }
          var o3 = this.opf.itemMapByPath[i3];
          if (!o3) {
            if (
              this.opf.opfXML &&
              i3 == this.opf.getPathFromURL(this.opf.opfXML.url)
            ) {
              var a3 = t4.indexOf('#');
              if (a3 >= 0)
                return this.navigateToFragment(t4.substr(a3 + 1), e4, n3);
            }
            return Si(null);
          }
          var s3 = bi('navigateTo'),
            l3 = this;
          return (
            l3.getPageViewItem(o3.spineIndex).then(function (i4) {
              if (i4) {
                var r4 = i4.xmldoc.getElement(t4);
                r4
                  ? l3
                      .findPage(
                        {
                          spineIndex: o3.spineIndex,
                          pageIndex: -1,
                          offsetInItem: i4.xmldoc.getElementOffset(r4),
                        },
                        n3,
                      )
                      .thenFinish(s3)
                  : e4.spineIndex !== o3.spineIndex
                  ? l3
                      .findPage(
                        {
                          spineIndex: o3.spineIndex,
                          pageIndex: 0,
                          offsetInItem: -1,
                        },
                        n3,
                      )
                      .thenFinish(s3)
                  : s3.finish(null);
              } else s3.finish(null);
            }),
            s3.result()
          );
        }),
        (e3.makePage = function (t4, e4) {
          var n3 = t4.instance.viewport,
            i3 = n3.document.createElement('div');
          i3.setAttribute('data-vivliostyle-page-container', 'true'),
            i3.setAttribute('role', 'region'),
            (i3.style.position = 'absolute'),
            (i3.style.top = '0'),
            (i3.style.left = '0'),
            exports.isDebug ||
              ((i3.style.visibility = 'hidden'),
              i3.setAttribute('aria-hidden', 'true')),
            n3.layoutBox.appendChild(i3);
          var r3 = n3.document.createElement('div');
          r3.setAttribute('data-vivliostyle-bleed-box', 'true'),
            i3.appendChild(r3);
          var o3 = new Aa(i3, r3);
          if (
            ((o3.spineIndex = t4.item.spineIndex),
            (o3.position = e4),
            (o3.offset = t4.instance.getPosition(e4)),
            0 === o3.offset)
          ) {
            var a3 = this.opf.documentURLTransformer.transformFragment(
              '',
              t4.item.src,
            );
            r3.setAttribute('id', a3), o3.registerElementWithId(r3, a3);
          }
          if (n3 !== this.viewport) {
            var s3 = Ot(
                this.viewport.width,
                this.viewport.height,
                n3.width,
                n3.height,
              ),
              l3 = dr(null, new Ei(s3, null), '');
            o3.delayedItems.push(new Ia(i3, 'transform', l3));
          }
          return o3;
        }),
        (e3.makeObjectView = function (t4, e4, n3, i3) {
          var r3 = e4.getAttribute('data'),
            o3 = null;
          if (r3) {
            r3 = W(r3, t4.url);
            var a3 = e4.getAttribute('media-type');
            if (!a3) {
              var s3 = this.opf.getPathFromURL(r3);
              if (s3) {
                var l3 = this.opf.itemMapByPath[s3];
                l3 && (a3 = l3.mediaType);
              }
            }
            if (a3) {
              var u3 = this.opf.bindings[a3];
              if (u3) {
                (o3 = this.viewport.document.createElement(
                  'iframe',
                )).style.border = 'none';
                var h3 = ot(r3),
                  c3 = ot(a3),
                  f3 = new et();
                f3.append(u3),
                  f3.append('?src='),
                  f3.append(h3),
                  f3.append('&type='),
                  f3.append(c3);
                for (var d3 = e4.firstChild; d3; d3 = d3.nextSibling)
                  if (1 == d3.nodeType) {
                    var p3 = d3;
                    if (
                      'param' == p3.localName &&
                      p3.namespaceURI == H2.XHTML
                    ) {
                      var g3 = p3.getAttribute('name'),
                        m3 = p3.getAttribute('value');
                      g3 &&
                        m3 &&
                        (f3.append('&'),
                        f3.append(encodeURIComponent(g3)),
                        f3.append('='),
                        f3.append(encodeURIComponent(m3)));
                    }
                  }
                o3.setAttribute('src', f3.toString());
                var v3 = e4.getAttribute('width');
                v3 && o3.setAttribute('width', v3);
                var E2 = e4.getAttribute('height');
                E2 && o3.setAttribute('height', E2);
              }
            }
          }
          return (
            o3 ||
              (o3 = this.viewport.document.createElement('span')).setAttribute(
                'data-adapt-process-children',
                'true',
              ),
            Si(o3)
          );
        }),
        (e3.makeMathJaxView = function (t4, e4, n3, i3) {
          var r3 = Ac();
          if (r3) {
            var o3 = n3.ownerDocument,
              a3 = o3.createElement('span');
            n3.appendChild(a3);
            var s3 = o3.importNode(e4, true);
            this.resolveURLsInMathML(s3, t4), a3.appendChild(s3);
            var l3 = r3.queue;
            l3.Push(['Typeset', r3, a3]);
            var u3 = bi('makeMathJaxView'),
              h3 = u3.suspend();
            return (
              l3.Push(function () {
                h3.schedule(a3);
              }),
              u3.result()
            );
          }
          return Si(null);
        }),
        (e3.resolveURLsInMathML = function (t4, e4) {
          if (null != t4) {
            if (1 === t4.nodeType && 'mglyph' === t4.tagName)
              for (
                var n3 = 0, i3 = Array.from(t4.attributes);
                n3 < i3.length;
                n3++
              ) {
                var r3 = i3[n3];
                if ('src' === r3.name) {
                  var o3 = W(r3.nodeValue, e4.url);
                  r3.namespaceURI
                    ? t4.setAttributeNS(r3.namespaceURI, r3.name, o3)
                    : t4.setAttribute(r3.name, o3);
                }
              }
            t4.firstChild && this.resolveURLsInMathML(t4.firstChild, e4),
              t4.nextSibling && this.resolveURLsInMathML(t4.nextSibling, e4);
          }
        }),
        (e3.makeSSEView = function (t4, e4, n3, i3) {
          var r3,
            o3 = n3 ? n3.ownerDocument : this.viewport.document,
            a3 = e4.localName;
          switch (a3) {
            case 't':
            case 'tab':
            case 'ec':
            case 'nt':
            case 'fraction':
            case 'comment':
            case 'mark':
              r3 = 'span';
              break;
            case 'ruby':
            case 'rp':
            case 'rt':
              r3 = a3;
              break;
            default:
              r3 = 'div';
          }
          var s3 = o3.createElement(r3);
          return s3.setAttribute('data-adapt-process-children', 'true'), Si(s3);
        }),
        (e3.makeCustomRenderer = function (t4) {
          var e4 = this;
          return function (n3, i3, r3) {
            return 'object' == n3.localName && n3.namespaceURI == H2.XHTML
              ? e4.makeObjectView(t4, n3, i3, r3)
              : n3.namespaceURI == H2.MATHML
              ? e4.makeMathJaxView(t4, n3, i3, r3)
              : n3.namespaceURI == H2.SSE
              ? e4.makeSSEView(t4, n3, i3, r3)
              : n3.dataset && 'true' == n3.dataset.mathTypeset
              ? e4.makeMathJaxView(t4, n3, i3, r3)
              : Si(null);
          };
        }),
        (e3.getPageViewItem = function (t4) {
          var e4 = this;
          if (-1 === t4 || t4 >= e4.opf.spine.length) return Si(null);
          var n3 = e4.spineItems[t4];
          if (n3) return Si(n3);
          var i3 = bi('getPageViewItem'),
            r3 = this.spineItemLoadingContinuations[t4];
          if (r3) {
            var o3 = i3.suspend();
            return r3.push(o3), i3.result();
          }
          r3 = this.spineItemLoadingContinuations[t4] = [];
          var a3 = e4.opf.spine[t4],
            s3 = e4.opf.store;
          return (
            s3.load(a3.src).then(function (o4) {
              a3.title = o4.document.title;
              var l3 = s3.getStyleForDoc(o4),
                u3 = e4.makeCustomRenderer(o4),
                h3 = e4.viewport,
                c3 = l3.sizeViewport(h3.width, h3.height, h3.fontSize, e4.pref);
              (c3.width == h3.width &&
                c3.height == h3.height &&
                c3.fontSize == h3.fontSize) ||
                (h3 = new rc(
                  h3.window,
                  c3.fontSize,
                  h3.root,
                  c3.width,
                  c3.height,
                ));
              var f3,
                d3 = e4.spineItems[t4 - 1];
              null !== a3.startPage
                ? (f3 = a3.startPage - 1)
                : (!(t4 > 0) || (d3 && d3.complete)
                    ? (f3 = d3
                        ? d3.instance.pageNumberOffset + d3.pages.length
                        : 0)
                    : ((f3 = a3.epage || t4),
                      e4.opf.prePaginated || f3 % 2 != 0 || f3++),
                  null !== a3.skipPagesBefore && (f3 += a3.skipPagesBefore)),
                e4.counterStore.forceSetPageCounter(f3);
              var p3 = new fc(
                l3,
                o4,
                e4.opf.lang,
                h3,
                e4.clientLayout,
                e4.fontMapper,
                u3,
                e4.opf.fallbackMap,
                f3,
                e4.opf.documentURLTransformer,
                e4.counterStore,
                e4.opf.pageProgression,
              );
              p3.pref = e4.pref;
              var g3 = e4.opf.metadata && e4.opf.metadata[Pc.title];
              (p3.pubTitle = (g3 && g3[0] && g3[0].v) || ''),
                (p3.docTitle = a3.title || ''),
                p3.init().then(function () {
                  (e4.spineItems[t4] = n3 = {
                    item: a3,
                    xmldoc: o4,
                    instance: p3,
                    layoutPositions: [null],
                    pages: [],
                    complete: false,
                  }),
                    i3.finish(n3),
                    r3.forEach(function (t5) {
                      t5.schedule(n3);
                    });
                });
            }),
            i3.result()
          );
        }),
        (e3.removeRenderedPages = function () {
          for (var t4, e4 = D(this.spineItems); !(t4 = e4()).done; ) {
            var n3 = t4.value;
            n3 && n3.pages.splice(0);
          }
          this.viewport.clear();
        }),
        (e3.hasAutoSizedPages = function () {
          for (var t4, e4 = D(this.spineItems); !(t4 = e4()).done; ) {
            var n3 = t4.value;
            if (n3)
              for (var i3, r3 = D(n3.pages); !(i3 = r3()).done; ) {
                var o3 = i3.value;
                if (o3.isAutoPageWidth && o3.isAutoPageHeight) return true;
              }
          }
          return false;
        }),
        (e3.hasPages = function () {
          return this.spineItems.some(function (t4) {
            return t4 && t4.pages.length > 0;
          });
        }),
        (e3.showTOC = function (t4) {
          var e4 = this.opf,
            n3 = e4.xhtmlToc || e4.ncxToc;
          if (((this.tocAutohide = t4), !n3)) return Si(null);
          if (this.tocView && this.tocView.page)
            return (
              (this.tocView.page.container.style.visibility = 'visible'),
              this.tocView.page.container.setAttribute('aria-hidden', 'false'),
              Si(this.tocView.page)
            );
          var i3 = bi('showTOC');
          this.tocView ||
            (this.tocView = new Nc(
              e4.store,
              n3.src,
              e4.lang,
              this.clientLayout,
              this.fontMapper,
              this.pref,
              this,
              e4.fallbackMap,
              e4.documentURLTransformer,
              this.counterStore,
            ));
          var r3 = this.viewport,
            o3 = Math.min(350, Math.round(0.67 * r3.width) - 16),
            a3 = r3.height - 6,
            s3 = r3.document.createElement('div');
          return (
            r3.root.appendChild(s3),
            (s3.style.visibility = 'hidden'),
            (s3.style.width = o3 + 10 + 'px'),
            (s3.style.maxHeight = a3 + 'px'),
            s3.setAttribute('data-vivliostyle-toc-box', 'true'),
            s3.setAttribute('role', 'navigation'),
            this.tocView
              .showTOC(s3, r3, o3, a3, this.viewport.fontSize)
              .then(function (t5) {
                (s3.style.visibility = 'visible'),
                  s3.setAttribute('aria-hidden', 'false'),
                  i3.finish(t5);
              }),
            i3.result()
          );
        }),
        (e3.hideTOC = function () {
          this.tocView && this.tocView.hideTOC();
        }),
        (e3.isTOCVisible = function () {
          return !!this.tocView && this.tocView.isTOCVisible();
        }),
        t3
      );
    })();
    !(function (t3) {
      (t3.SINGLE_PAGE = 'singlePage'),
        (t3.SPREAD = 'spread'),
        (t3.AUTO_SPREAD = 'autoSpread');
    })(Lc || (Lc = {}));
    var _c;
    var Bc = (function () {
      function t3(t4, e4, n3, i3) {
        (this.window = t4),
          (this.viewportElement = e4),
          (this.instanceId = n3),
          (this.callbackFn = i3),
          (this.pageSheetSizeAlreadySet = false),
          (this.renderTask = null);
        var r3 = this;
        e4.setAttribute('data-vivliostyle-viewer-viewport', true),
          exports.isDebug && e4.setAttribute('data-vivliostyle-debug', true),
          e4.setAttribute('data-vivliostyle-viewer-status', 'loading');
        var o3 = t4.document;
        (this.fontMapper = new _u(o3.head, e4)),
          this.init(),
          (this.kick = function () {}),
          (this.sendCommand = function () {}),
          (this.resizeListener = function () {
            (r3.needResize = true), r3.kick();
          }),
          (this.pageReplacedListener = this.pageReplacedListener.bind(this)),
          (this.hyperlinkListener = function (t5) {}),
          (this.pageRuleStyleElement = o3.getElementById(
            'vivliostyle-page-rules',
          )),
          (this.actions = {
            loadPublication: this.loadPublication,
            loadXML: this.loadXML,
            configure: this.configure,
            moveTo: this.moveTo,
            toc: this.showTOC,
          }),
          this.addLogListeners();
      }
      var e3 = t3.prototype;
      return (
        (e3.init = function () {
          (this.readyState = exports.ReadyState.LOADING),
            (this.packageURL = []),
            (this.opf = null),
            (this.haveZipMetadata = false),
            (this.touchActive = false),
            (this.touchX = 0),
            (this.touchY = 0),
            (this.needResize = false),
            (this.needRefresh = false),
            (this.viewportSize = null),
            (this.currentPage = null),
            (this.currentSpread = null),
            (this.pagePosition = null),
            (this.fontSize = 16),
            (this.zoom = 1),
            (this.fitToScreen = false),
            (this.pageViewMode = Lc.SINGLE_PAGE),
            (this.waitForLoading = false),
            (this.renderAllPages = true),
            (this.pref = {
              fontFamily: 'serif',
              lineHeight: 1.25,
              margin: 8,
              hyphenate: false,
              columnWidth: 25,
              horizontal: false,
              nightMode: false,
              spreadView: false,
              pageBorder: 1,
              enabledMediaTypes: { vivliostyle: true, print: true },
              defaultPaperSize: void 0,
            }),
            (this.pageSizes = []);
        }),
        (e3.addLogListeners = function () {
          var t4 = this,
            e4 = a2;
          c2.addListener(e4.DEBUG, function (e5) {
            t4.callback({ t: 'debug', content: e5 });
          }),
            c2.addListener(e4.INFO, function (e5) {
              t4.callback({ t: 'info', content: e5 });
            }),
            c2.addListener(e4.WARN, function (e5) {
              t4.callback({ t: 'warn', content: e5 });
            }),
            c2.addListener(e4.ERROR, function (e5) {
              t4.callback({ t: 'error', content: e5 });
            });
        }),
        (e3.callback = function (t4) {
          (t4.i = this.instanceId), this.callbackFn(t4);
        }),
        (e3.setReadyState = function (t4) {
          this.readyState !== t4 &&
            ((this.readyState = t4),
            this.viewportElement.setAttribute(
              'data-vivliostyle-viewer-status',
              t4,
            ),
            this.callback({ t: 'readystatechange' }));
        }),
        (e3.loadPublication = function (t4) {
          S2.registerStartTiming('beforeRender'),
            this.setReadyState(exports.ReadyState.LOADING);
          var e4 = t4.url,
            n3 = t4.fragment,
            i3 = !!t4.zipmeta,
            r3 = t4.authorStyleSheet,
            o3 = t4.userStyleSheet;
          this.viewport = null;
          var a3 = bi('loadPublication'),
            s3 = this;
          return (
            s3.configure(t4).then(function () {
              var t5 = new Sc();
              t5.init(r3, o3).then(function () {
                var r4 = W(X(e4), s3.window.location.href);
                (s3.packageURL = [r4]),
                  t5.loadPubDoc(r4, i3).then(function (t6) {
                    t6
                      ? ((s3.opf = t6),
                        s3.render(n3).then(function () {
                          a3.finish(true);
                        }))
                      : a3.finish(false);
                  });
              });
            }),
            a3.result()
          );
        }),
        (e3.loadXML = function (t4) {
          S2.registerStartTiming('beforeRender'),
            this.setReadyState(exports.ReadyState.LOADING);
          var e4 = t4.url,
            n3 = t4.document,
            i3 = t4.fragment,
            r3 = t4.authorStyleSheet,
            o3 = t4.userStyleSheet;
          this.viewport = null;
          var a3 = bi('loadXML'),
            s3 = this;
          return (
            s3.configure(t4).then(function () {
              var t5 = new Sc();
              t5.init(r3, o3).then(function () {
                var r4 = e4.map(function (t6, e5) {
                  return {
                    url: W(X(t6.url), s3.window.location.href),
                    index: e5,
                    startPage: t6.startPage,
                    skipPagesBefore: t6.skipPagesBefore,
                  };
                });
                (s3.packageURL = r4.map(function (t6) {
                  return t6.url;
                })),
                  (s3.opf = new kc(t5, '')),
                  s3.opf.initWithChapters(r4, n3).then(function () {
                    s3.render(i3).then(function () {
                      a3.finish(true);
                    });
                  });
              });
            }),
            a3.result()
          );
        }),
        (e3.render = function (t4) {
          this.cancelRenderingTask();
          var e4 = this;
          return (t4
            ? this.opf.resolveFragment(t4).thenAsync(function (t5) {
                return (e4.pagePosition = t5), Si(true);
              })
            : Si(true)
          ).thenAsync(function () {
            return S2.registerEndTiming('beforeRender'), e4.resize();
          });
        }),
        (e3.resolveLength = function (t4) {
          var e4,
            n3 = parseFloat(t4);
          if ('string' == typeof t4 && (e4 = t4.match(/[a-z]+$/))) {
            var i3 = e4[0];
            if ('em' === i3 || 'rem' === i3) return n3 * this.fontSize;
            if ('ex' === i3) return (n3 * Ut.ex * this.fontSize) / Ut.em;
            var r3 = Ut[i3];
            if (r3) return n3 * r3;
          }
          return n3;
        }),
        (e3.configure = function (t4) {
          if (
            ('boolean' == typeof t4.autoresize &&
              (t4.autoresize
                ? ((this.viewportSize = null),
                  this.window.addEventListener(
                    'resize',
                    this.resizeListener,
                    false,
                  ),
                  (this.needResize = true))
                : this.window.removeEventListener(
                    'resize',
                    this.resizeListener,
                    false,
                  )),
            'number' == typeof t4.fontSize)
          ) {
            var e4 = t4.fontSize;
            e4 >= 5 &&
              e4 <= 72 &&
              this.fontSize != e4 &&
              ((this.fontSize = e4), (this.needResize = true));
          }
          if ('object' == typeof t4.viewport && t4.viewport) {
            var n3 = t4.viewport,
              i3 = {
                marginLeft: this.resolveLength(n3['margin-left']) || 0,
                marginRight: this.resolveLength(n3['margin-right']) || 0,
                marginTop: this.resolveLength(n3['margin-top']) || 0,
                marginBottom: this.resolveLength(n3['margin-bottom']) || 0,
                width: this.resolveLength(n3.width) || 0,
                height: this.resolveLength(n3.height) || 0,
              };
            (i3.width >= 200 || i3.height >= 200) &&
              (this.window.removeEventListener(
                'resize',
                this.resizeListener,
                false,
              ),
              (this.viewportSize = i3),
              (this.needResize = true));
          }
          return (
            'boolean' == typeof t4.hyphenate &&
              ((this.pref.hyphenate = t4.hyphenate), (this.needResize = true)),
            'boolean' == typeof t4.horizontal &&
              ((this.pref.horizontal = t4.horizontal),
              (this.needResize = true)),
            'boolean' == typeof t4.nightMode &&
              ((this.pref.nightMode = t4.nightMode), (this.needResize = true)),
            'number' == typeof t4.lineHeight &&
              ((this.pref.lineHeight = t4.lineHeight),
              (this.needResize = true)),
            'number' == typeof t4.columnWidth &&
              ((this.pref.columnWidth = t4.columnWidth),
              (this.needResize = true)),
            'string' == typeof t4.fontFamily &&
              ((this.pref.fontFamily = t4.fontFamily),
              (this.needResize = true)),
            'boolean' == typeof t4.load && (this.waitForLoading = t4.load),
            'boolean' == typeof t4.renderAllPages &&
              (this.renderAllPages = t4.renderAllPages),
            'string' == typeof t4.userAgentRootURL &&
              (V(t4.userAgentRootURL.replace(/resources\/?$/, '')),
              G(t4.userAgentRootURL)),
            'string' == typeof t4.rootURL &&
              (V(t4.rootURL), G(U + 'resources/')),
            'string' == typeof t4.pageViewMode &&
              t4.pageViewMode !== this.pageViewMode &&
              ((this.pageViewMode = t4.pageViewMode), (this.needResize = true)),
            'number' == typeof t4.pageBorder &&
              t4.pageBorder !== this.pref.pageBorder &&
              ((this.viewport = null),
              (this.pref.pageBorder = t4.pageBorder),
              (this.needResize = true)),
            'number' == typeof t4.zoom &&
              t4.zoom !== this.zoom &&
              ((this.zoom = t4.zoom), (this.needRefresh = true)),
            'boolean' == typeof t4.fitToScreen &&
              t4.fitToScreen !== this.fitToScreen &&
              ((this.fitToScreen = t4.fitToScreen), (this.needRefresh = true)),
            'object' == typeof t4.defaultPaperSize &&
              'number' == typeof t4.defaultPaperSize.width &&
              'number' == typeof t4.defaultPaperSize.height &&
              ((this.viewport = null),
              (this.pref.defaultPaperSize = t4.defaultPaperSize),
              (this.needResize = true)),
            this.configurePlugins(t4),
            Si(true)
          );
        }),
        (e3.configurePlugins = function (t4) {
          var e4 = this;
          g2(exports.HOOKS.CONFIGURATION).forEach(function (n3) {
            var i3 = n3(t4);
            (e4.needResize = i3.needResize || e4.needResize),
              (e4.needRefresh = i3.needRefresh || e4.needRefresh);
          });
        }),
        (e3.pageReplacedListener = function (t4) {
          var e4 = this.currentPage,
            n3 = this.currentSpread,
            i3 = t4.target;
          n3
            ? (n3.left !== i3 && n3.right !== i3) ||
              this.showCurrent(t4.newPage)
            : e4 === t4.target && this.showCurrent(t4.newPage);
        }),
        (e3.forCurrentPages = function (t4) {
          var e4 = [];
          this.currentPage && e4.push(this.currentPage),
            this.currentSpread &&
              (e4.push(this.currentSpread.left),
              e4.push(this.currentSpread.right)),
            e4.forEach(function (e5) {
              e5 && t4(e5);
            });
        }),
        (e3.removePageListeners = function () {
          var t4 = this;
          this.forCurrentPages(function (e4) {
            e4.removeEventListener('hyperlink', t4.hyperlinkListener, false),
              e4.removeEventListener(
                'replaced',
                t4.pageReplacedListener,
                false,
              );
          });
        }),
        (e3.hidePages = function () {
          this.removePageListeners(),
            this.forCurrentPages(function (t4) {
              $2(t4.container, 'display', 'none'),
                t4.container.setAttribute('aria-hidden', 'true');
            }),
            (this.currentPage = null),
            (this.currentSpread = null);
        }),
        (e3.showSinglePage = function (t4) {
          t4.addEventListener('hyperlink', this.hyperlinkListener, false),
            t4.addEventListener('replaced', this.pageReplacedListener, false),
            $2(t4.container, 'visibility', 'visible'),
            $2(t4.container, 'display', 'block'),
            t4.container.setAttribute('aria-hidden', 'false');
        }),
        (e3.showPage = function (t4) {
          this.hidePages(),
            (this.currentPage = t4),
            (t4.container.style.marginLeft = ''),
            (t4.container.style.marginRight = ''),
            this.showSinglePage(t4);
        }),
        (e3.showSpread = function (t4) {
          if (
            (this.hidePages(), (this.currentSpread = t4), t4.left && t4.right)
          ) {
            var e4 = parseFloat(t4.left.container.style.width),
              n3 = parseFloat(t4.right.container.style.width);
            e4 &&
              n3 &&
              e4 !== n3 &&
              (e4 < n3
                ? (t4.left.container.style.marginLeft = n3 - e4 + 'px')
                : (t4.right.container.style.marginRight = e4 - n3 + 'px'));
          }
          t4.left &&
            (this.showSinglePage(t4.left),
            t4.right
              ? t4.left.container.removeAttribute(
                  'data-vivliostyle-unpaired-page',
                )
              : t4.left.container.setAttribute(
                  'data-vivliostyle-unpaired-page',
                  true,
                )),
            t4.right &&
              (this.showSinglePage(t4.right),
              t4.left
                ? t4.right.container.removeAttribute(
                    'data-vivliostyle-unpaired-page',
                  )
                : t4.right.container.setAttribute(
                    'data-vivliostyle-unpaired-page',
                    true,
                  ));
        }),
        (e3.reportPosition = function () {
          var t4 = bi('reportPosition'),
            e4 = this;
          return (
            e4.opf
              .getCFI(
                this.pagePosition.spineIndex,
                this.pagePosition.offsetInItem,
              )
              .then(function (n3) {
                var i3 = e4.currentPage;
                (e4.waitForLoading && i3.fetchers.length > 0
                  ? Di(i3.fetchers)
                  : Si(true)
                ).then(function () {
                  e4.sendLocationNotification(i3, n3).thenFinish(t4);
                });
              }),
            t4.result()
          );
        }),
        (e3.createViewport = function () {
          var t4 = this.viewportElement;
          if (this.viewportSize) {
            var e4 = this.viewportSize;
            return (
              (t4.style.marginLeft = e4.marginLeft + 'px'),
              (t4.style.marginRight = e4.marginRight + 'px'),
              (t4.style.marginTop = e4.marginTop + 'px'),
              (t4.style.marginBottom = e4.marginBottom + 'px'),
              new rc(this.window, this.fontSize, t4, e4.width, e4.height)
            );
          }
          return new rc(this.window, this.fontSize, t4);
        }),
        (e3.resolveSpreadView = function (t4) {
          switch (this.pageViewMode) {
            case Lc.SINGLE_PAGE:
              return false;
            case Lc.SPREAD:
              return true;
            case Lc.AUTO_SPREAD:
            default:
              return t4.width / t4.height >= 1.45 && t4.width > 800;
          }
        }),
        (e3.updateSpreadView = function (t4) {
          (this.pref.spreadView = t4),
            this.viewportElement.setAttribute(
              'data-vivliostyle-spread-view',
              t4.toString(),
            );
        }),
        (e3.sizeIsGood = function () {
          var t4 = this.createViewport(),
            e4 = this.resolveSpreadView(t4),
            n3 = this.pref.spreadView !== e4;
          return (
            this.updateSpreadView(e4),
            !(
              this.viewportSize ||
              !this.viewport ||
              this.viewport.fontSize != this.fontSize ||
              ((n3 ||
                t4.width != this.viewport.width ||
                t4.height != this.viewport.height) &&
                (n3 ||
                  t4.width != this.viewport.width ||
                  t4.height == this.viewport.height ||
                  !/Android|iPhone|iPad|iPod/.test(navigator.userAgent)) &&
                (!this.opfView ||
                  !this.opfView.hasPages() ||
                  this.opfView.hasAutoSizedPages() ||
                  ((this.viewport.width = t4.width),
                  (this.viewport.height = t4.height),
                  (this.needRefresh = true),
                  0)))
            )
          );
        }),
        (e3.setPageSize = function (t4, e4, n3, i3) {
          (this.pageSizes[i3] = t4), this.setPageSizePageRules(e4, n3, i3);
        }),
        (e3.setPageSizePageRules = function (t4, e4, n3) {
          if (!this.pageSheetSizeAlreadySet && this.pageRuleStyleElement) {
            var i3 = '';
            Object.keys(t4).forEach(function (e5) {
              i3 += '@page ' + e5 + '{margin:0;size:';
              var n4 = t4[e5];
              i3 += n4.width + 'px ' + n4.height + 'px;}';
            }),
              (this.pageRuleStyleElement.textContent = i3),
              (this.pageSheetSizeAlreadySet = true);
          }
        }),
        (e3.removePageSizePageRules = function () {
          this.pageRuleStyleElement &&
            ((this.pageRuleStyleElement.textContent = ''),
            (this.pageSheetSizeAlreadySet = false));
        }),
        (e3.reset = function () {
          var t4 = false,
            e4 = false;
          this.opfView &&
            ((t4 = this.opfView.isTOCVisible()),
            (e4 = this.opfView.tocAutohide),
            this.opfView.hideTOC(),
            this.opfView.removeRenderedPages()),
            this.removePageSizePageRules(),
            (this.viewport = this.createViewport()),
            this.viewport.resetZoom(),
            (this.opfView = new Dc(
              this.opf,
              this.viewport,
              this.fontMapper,
              this.pref,
              this.setPageSize.bind(this),
            )),
            t4 && this.sendCommand({ a: 'toc', v: 'show', autohide: e4 });
        }),
        (e3.showCurrent = function (t4, e4) {
          (this.needRefresh = false), this.removePageListeners();
          var n3 = this;
          return this.pref.spreadView
            ? this.opfView
                .getSpread(this.pagePosition, e4)
                .thenAsync(function (e5) {
                  return (
                    n3.showSpread(e5),
                    n3.setSpreadZoom(e5),
                    (n3.currentPage = t4),
                    Si(null)
                  );
                })
            : (this.showPage(t4),
              this.setPageZoom(t4),
              (this.currentPage = t4),
              Si(null));
        }),
        (e3.setPageZoom = function (t4) {
          var e4 = this.getAdjustedZoomFactor(t4.dimensions);
          this.viewport.zoom(t4.dimensions.width, t4.dimensions.height, e4);
        }),
        (e3.setSpreadZoom = function (t4) {
          var e4 = this.getSpreadDimensions(t4);
          this.viewport.zoom(
            e4.width,
            e4.height,
            this.getAdjustedZoomFactor(e4),
          );
        }),
        (e3.getAdjustedZoomFactor = function (t4) {
          return this.fitToScreen
            ? this.calculateZoomFactorToFitInsideViewPort(t4)
            : this.zoom;
        }),
        (e3.getSpreadDimensions = function (t4) {
          var e4 = 0,
            n3 = 0;
          return (
            t4.left &&
              ((e4 += t4.left.dimensions.width),
              (n3 = t4.left.dimensions.height)),
            t4.right &&
              ((e4 += t4.right.dimensions.width),
              (n3 = Math.max(n3, t4.right.dimensions.height))),
            t4.left &&
              t4.right &&
              ((e4 += 2 * this.pref.pageBorder),
              (e4 += Math.abs(
                t4.left.dimensions.width - t4.right.dimensions.width,
              ))),
            { width: e4, height: n3 }
          );
        }),
        (e3.queryZoomFactor = function (t4) {
          if (!this.currentPage) throw new Error('no page exists.');
          switch (t4) {
            case _c.FIT_INSIDE_VIEWPORT:
              var e4;
              return (
                (e4 = this.pref.spreadView
                  ? this.getSpreadDimensions(this.currentSpread)
                  : this.currentPage.dimensions),
                this.calculateZoomFactorToFitInsideViewPort(e4)
              );
            default:
              throw new Error('unknown zoom type: ' + t4);
          }
        }),
        (e3.calculateZoomFactorToFitInsideViewPort = function (t4) {
          return Math.min(
            this.viewport.width / t4.width,
            this.viewport.height / t4.height,
          );
        }),
        (e3.cancelRenderingTask = function () {
          this.renderTask && this.renderTask.interrupt(new Mc()),
            (this.renderTask = null);
        }),
        (e3.resize = function () {
          if (
            ((this.needResize = false),
            (this.needRefresh = false),
            this.sizeIsGood())
          )
            return Si(true);
          var t4 = this;
          this.setReadyState(exports.ReadyState.LOADING),
            this.cancelRenderingTask();
          var e4 = Ni()
            .getScheduler()
            .run(function () {
              return Ci(
                'resize',
                function (n3) {
                  t4.opf
                    ? ((t4.renderTask = e4),
                      S2.registerStartTiming('render (resize)'),
                      t4.reset(),
                      t4.pagePosition &&
                        ((0 == t4.pagePosition.pageIndex &&
                          0 == t4.pagePosition.offsetInItem) ||
                          (t4.pagePosition.pageIndex = -1)),
                      t4.opf.setEPageCountMode(t4.renderAllPages),
                      t4.opfView
                        .renderPagesUpto(t4.pagePosition, !t4.renderAllPages)
                        .then(function (i3) {
                          i3
                            ? ((t4.pagePosition = i3.position),
                              t4.showCurrent(i3.page, true).then(function () {
                                t4.setReadyState(
                                  exports.ReadyState.INTERACTIVE,
                                ),
                                  t4.opf
                                    .countEPages(function (e5) {
                                      var n4 = {
                                        t: 'nav',
                                        epageCount: e5,
                                        first: t4.currentPage.isFirstPage,
                                        last: t4.currentPage.isLastPage,
                                        metadata: t4.opf.metadata,
                                        docTitle:
                                          t4.opf.spine[
                                            t4.pagePosition.spineIndex
                                          ].title,
                                      };
                                      (t4.currentPage.isFirstPage ||
                                        (0 == t4.pagePosition.pageIndex &&
                                          t4.opf.spine[
                                            t4.pagePosition.spineIndex
                                          ].epage)) &&
                                        (n4.epage =
                                          t4.opf.spine[
                                            t4.pagePosition.spineIndex
                                          ].epage),
                                        t4.callback(n4);
                                    })
                                    .then(function () {
                                      t4.reportPosition().then(function (i4) {
                                        (t4.renderAllPages
                                          ? t4.opfView.renderAllPages()
                                          : Si(null)
                                        ).then(function () {
                                          t4.renderTask === e4 &&
                                            (t4.renderTask = null),
                                            S2.registerEndTiming(
                                              'render (resize)',
                                            ),
                                            t4.renderAllPages &&
                                              t4.setReadyState(
                                                exports.ReadyState.COMPLETE,
                                              ),
                                            t4.callback({ t: 'loaded' }),
                                            n3.finish(i4);
                                        });
                                      });
                                    });
                              }))
                            : n3.finish(false);
                        }))
                    : n3.finish(false);
                },
                function (t5, e5) {
                  if (!(e5 instanceof Mc)) throw e5;
                  S2.registerEndTiming('render (resize)'), c2.debug(e5.message);
                },
              );
            });
          return Si(true);
        }),
        (e3.sendLocationNotification = function (t4, e4) {
          var n3 = bi('sendLocationNotification'),
            i3 = {
              t: 'nav',
              first: t4.isFirstPage,
              last: t4.isLastPage,
              metadata: this.opf.metadata,
              docTitle: this.opf.spine[t4.spineIndex].title,
            },
            r3 = this;
          return (
            this.opf.getEPageFromPosition(r3.pagePosition).then(function (t5) {
              (i3.epage = t5),
                (i3.epageCount = r3.opf.epageCount),
                e4 && (i3.cfi = e4),
                r3.callback(i3),
                n3.finish(true);
            }),
            n3.result()
          );
        }),
        (e3.getCurrentPageProgression = function () {
          return this.opfView
            ? this.opfView.getCurrentPageProgression(this.pagePosition)
            : null;
        }),
        (e3.moveTo = function (t4) {
          var e4,
            n3 = this;
          if (
            (this.readyState !== exports.ReadyState.COMPLETE &&
              'next' !== t4.where &&
              this.setReadyState(exports.ReadyState.LOADING),
            'string' == typeof t4.where)
          ) {
            var i3;
            switch (t4.where) {
              case 'next':
                i3 = this.pref.spreadView
                  ? this.opfView.nextSpread
                  : this.opfView.nextPage;
                break;
              case 'previous':
                i3 = this.pref.spreadView
                  ? this.opfView.previousSpread
                  : this.opfView.previousPage;
                break;
              case 'last':
                i3 = this.opfView.lastPage;
                break;
              case 'first':
                i3 = this.opfView.firstPage;
                break;
              default:
                return Si(true);
            }
            i3 &&
              (e4 = function () {
                return i3.call(n3.opfView, n3.pagePosition, !n3.renderAllPages);
              });
          } else if ('number' == typeof t4.epage) {
            var r3 = t4.epage;
            e4 = function () {
              return n3.opfView.navigateToEPage(
                r3,
                n3.pagePosition,
                !n3.renderAllPages,
              );
            };
          } else {
            if ('string' != typeof t4.url) return Si(true);
            var o3 = t4.url;
            e4 = function () {
              return n3.opfView.navigateTo(
                o3,
                n3.pagePosition,
                !n3.renderAllPages,
              );
            };
          }
          var a3 = bi('moveTo');
          return (
            e4.call(n3.opfView).then(function (t5) {
              var e5;
              if (t5) {
                n3.pagePosition = t5.position;
                var i4 = bi('moveTo.showCurrent');
                (e5 = i4.result()),
                  n3.showCurrent(t5.page, !n3.renderAllPages).then(function () {
                    n3.reportPosition().thenFinish(i4);
                  });
              } else e5 = Si(true);
              e5.then(function (t6) {
                n3.readyState === exports.ReadyState.LOADING &&
                  n3.setReadyState(exports.ReadyState.INTERACTIVE),
                  a3.finish(t6);
              });
            }),
            a3.result()
          );
        }),
        (e3.showTOC = function (t4) {
          var e4 = !!t4.autohide,
            n3 = t4.v,
            i3 = this.opfView.isTOCVisible(),
            r3 = e4 != this.opfView.tocAutohide && 'hide' != n3;
          if (i3) {
            if ('show' == n3 && !r3) return Si(true);
          } else if ('hide' == n3) return Si(true);
          if (i3 && 'show' != n3) return this.opfView.hideTOC(), Si(true);
          var o3 = this,
            a3 = bi('showTOC');
          return (
            this.opfView.showTOC(e4).then(function (t5) {
              t5 &&
                (r3 && (t5.listeners = {}),
                e4 &&
                  t5.addEventListener(
                    'hyperlink',
                    function () {
                      o3.opfView.hideTOC();
                    },
                    false,
                  ),
                t5.addEventListener('hyperlink', o3.hyperlinkListener, false)),
                a3.finish(true);
            }),
            a3.result()
          );
        }),
        (e3.runCommand = function (t4) {
          var e4 = this,
            n3 = t4.a || '';
          return Ci(
            'runCommand',
            function (i3) {
              var r3 = e4.actions[n3];
              r3
                ? r3.call(e4, t4).then(function () {
                    e4.callback({ t: 'done', a: n3 }), i3.finish(true);
                  })
                : (c2.error('No such action:', n3), i3.finish(true));
            },
            function (t5, e5) {
              c2.error(e5, 'Error during action:', n3), t5.finish(true);
            },
          );
        }),
        (e3.initEmbed = function (t4) {
          var e4,
            n3 = Uc(t4),
            i3 = null,
            r3 = this;
          (e4 = function () {
            var t5 = bi('commandLoop'),
              e5 = Ni().getScheduler();
            return (
              (r3.hyperlinkListener = function (t6) {
                var n4 = t6,
                  i4 =
                    '#' === n4.href.charAt(0) ||
                    r3.packageURL.some(function (t7) {
                      return n4.href.substr(0, t7.length) == t7;
                    });
                if (i4) {
                  t6.preventDefault();
                  var o3 = { t: 'hyperlink', href: n4.href, internal: i4 };
                  e5.run(function () {
                    return r3.callback(o3), Si(true);
                  });
                }
              }),
              t5
                .loopWithFrame(function (t6) {
                  if (r3.needResize)
                    r3.resize().then(function () {
                      t6.continueLoop();
                    });
                  else if (r3.needRefresh)
                    r3.currentPage &&
                      r3.showCurrent(r3.currentPage).then(function () {
                        t6.continueLoop();
                      });
                  else if (n3) {
                    var e6 = n3;
                    (n3 = null),
                      r3.runCommand(e6).then(function () {
                        t6.continueLoop();
                      });
                  } else {
                    var o3 = bi('waitForCommand');
                    (i3 = o3.suspend(self)),
                      o3.result().then(function () {
                        t6.continueLoop();
                      });
                  }
                })
                .thenFinish(t5),
              t5.result()
            );
          }),
            (yi ? yi.getScheduler() : wi || new Ii(new xi())).run(e4, void 0),
            (r3.kick = function () {
              var t5 = i3;
              t5 && ((i3 = null), t5.schedule(true));
            }),
            (r3.sendCommand = function (t5) {
              return !n3 && ((n3 = Uc(t5)), r3.kick(), true);
            }),
            (this.window.adapt_command = r3.sendCommand);
        }),
        t3
      );
    })();
    !(function (t3) {
      t3.FIT_INSIDE_VIEWPORT = 'fit inside viewport';
    })(_c || (_c = {}));
    var Mc = (function (t3) {
      function e3() {
        var n3;
        return (
          ((n3 = t3.call(this) || this).name = 'RenderingCanceledError'),
          (n3.message = 'Page rendering has been canceled'),
          Object.setPrototypeOf(k2(n3), e3.prototype),
          (n3.stack = new Error().stack),
          n3
        );
      }
      return I2(e3, t3), e3;
    })(O2(Error));
    function Uc(t3) {
      return 'string' == typeof t3 ? B(t3) : t3;
    }
    var Vc = exports.PageProgression;
    function Hc(t3) {
      var e3 = {};
      return (
        Object.keys(t3).forEach(function (n3) {
          var i3 = t3[n3];
          switch (n3) {
            case 'autoResize':
              e3.autoresize = i3;
              break;
            case 'pageBorderWidth':
              e3.pageBorder = i3;
              break;
            default:
              e3[n3] = i3;
          }
        }),
        e3
      );
    }
    var zc;
    var Gc = (function () {
      function t3(t4, e4) {
        (this.settings = t4),
          (this.initialized = false),
          r2(t4.debug),
          (this.adaptViewer_ = new Bc(
            t4.window || window,
            t4.viewportElement,
            'main',
            this.dispatcher.bind(this),
          )),
          (this.options = {
            autoResize: true,
            fontSize: 16,
            pageBorderWidth: 1,
            renderAllPages: true,
            pageViewMode: Lc.AUTO_SPREAD,
            zoom: 1,
            fitToScreen: false,
            defaultPaperSize: void 0,
          }),
          e4 && this.setOptions(e4),
          (this.eventTarget = new dt()),
          Object.defineProperty(this, 'readyState', {
            get: function () {
              return this.adaptViewer_.readyState;
            },
          });
      }
      var e3 = t3.prototype;
      return (
        (e3.setOptions = function (t4) {
          var e4 = Object.assign({ a: 'configure' }, Hc(t4));
          this.adaptViewer_.sendCommand(e4), Object.assign(this.options, t4);
        }),
        (e3.dispatcher = function (t4) {
          var e4 = { type: t4.t },
            n3 = t4;
          Object.keys(n3).forEach(function (t5) {
            't' !== t5 && (e4[t5] = n3[t5]);
          }),
            this.eventTarget.dispatchEvent(e4);
        }),
        (e3.addListener = function (t4, e4) {
          this.eventTarget.addEventListener(t4, e4, false);
        }),
        (e3.removeListener = function (t4, e4) {
          this.eventTarget.removeEventListener(t4, e4, false);
        }),
        (e3.loadDocument = function (t4, e4, n3) {
          t4 ||
            this.eventTarget.dispatchEvent({
              type: 'error',
              content: 'No URL specified',
            }),
            this.loadDocumentOrPublication(t4, null, e4, n3);
        }),
        (e3.loadPublication = function (t4, e4, n3) {
          t4 ||
            this.eventTarget.dispatchEvent({
              type: 'error',
              content: 'No URL specified',
            }),
            this.loadDocumentOrPublication(null, t4, e4, n3);
        }),
        (e3.loadDocumentOrPublication = function (t4, e4, n3, i3) {
          var r3 = n3 || {};
          function o3(t5) {
            return t5
              ? t5.map(function (t6) {
                  return { url: t6.url || null, text: t6.text || null };
                })
              : void 0;
          }
          var a3 = o3(r3.authorStyleSheet),
            s3 = o3(r3.userStyleSheet);
          i3 && Object.assign(this.options, i3);
          var l3 = Object.assign(
            {
              a: t4 ? 'loadXML' : 'loadPublication',
              userAgentRootURL: this.settings.userAgentRootURL,
              url: Wc(t4) || e4,
              document: r3.documentObject,
              fragment: r3.fragment,
              authorStyleSheet: a3,
              userStyleSheet: s3,
            },
            Hc(this.options),
          );
          this.initialized
            ? this.adaptViewer_.sendCommand(l3)
            : ((this.initialized = true), this.adaptViewer_.initEmbed(l3));
        }),
        (e3.getCurrentPageProgression = function () {
          return this.adaptViewer_.getCurrentPageProgression();
        }),
        (e3.resolveNavigation = function (t4) {
          switch (t4) {
            case exports.Navigation.LEFT:
              return this.getCurrentPageProgression() === Vc.LTR
                ? exports.Navigation.PREVIOUS
                : exports.Navigation.NEXT;
            case exports.Navigation.RIGHT:
              return this.getCurrentPageProgression() === Vc.LTR
                ? exports.Navigation.NEXT
                : exports.Navigation.PREVIOUS;
            default:
              return t4;
          }
        }),
        (e3.navigateToPage = function (t4, e4) {
          t4 === exports.Navigation.EPAGE
            ? this.adaptViewer_.sendCommand({ a: 'moveTo', epage: e4 })
            : this.adaptViewer_.sendCommand({
                a: 'moveTo',
                where: this.resolveNavigation(t4),
              });
        }),
        (e3.navigateToInternalUrl = function (t4) {
          this.adaptViewer_.sendCommand({ a: 'moveTo', url: t4 });
        }),
        (e3.isTOCVisible = function () {
          return this.adaptViewer_.opfView &&
            this.adaptViewer_.opfView.opf &&
            (this.adaptViewer_.opfView.opf.xhtmlToc ||
              this.adaptViewer_.opfView.opf.ncxToc)
            ? !!this.adaptViewer_.opfView.isTOCVisible()
            : null;
        }),
        (e3.showTOC = function (t4, e4) {
          this.adaptViewer_.sendCommand({
            a: 'toc',
            v: null == t4 ? 'toggle' : t4 ? 'show' : 'hide',
            autohide: e4,
          });
        }),
        (e3.queryZoomFactor = function (t4) {
          return this.adaptViewer_.queryZoomFactor(t4);
        }),
        (e3.getPageSizes = function () {
          return this.adaptViewer_.pageSizes;
        }),
        (e3.getTOC = function () {
          var t4, e4;
          return null == (t4 = this.adaptViewer_.opfView) ||
            null == (e4 = t4.tocView)
            ? void 0
            : e4.getTOC();
        }),
        (e3.getMetadata = function () {
          return this.adaptViewer_.opf.getMetadata();
        }),
        (e3.getCover = function () {
          return this.adaptViewer_.opf.cover;
        }),
        t3
      );
    })();
    function Wc(t3) {
      function e3(t4) {
        return 'number' == typeof t4 ? t4 : null;
      }
      function n3(t4) {
        return 'string' == typeof t4
          ? { url: t4, startPage: null, skipPagesBefore: null }
          : {
              url: t4.url,
              startPage: e3(t4.startPage),
              skipPagesBefore: e3(t4.skipPagesBefore),
            };
      }
      return Array.isArray(t3) ? t3.map(n3) : t3 ? [n3(t3)] : null;
    }
    ((zc = exports.Navigation || (exports.Navigation = {})).PREVIOUS =
      'previous'),
      (zc.NEXT = 'next'),
      (zc.LEFT = 'left'),
      (zc.RIGHT = 'right'),
      (zc.FIRST = 'first'),
      (zc.LAST = 'last'),
      (zc.EPAGE = 'epage');
    var Xc = _c;
    var jc = Lc;
    var Yc = { CoreViewer: Gc, PageViewMode: jc, ZoomType: Xc };
    S2.forceRegisterEndTiming('load_vivliostyle');
    var Kc = (function () {
      function t3(t4, e4) {
        var n3 = e4.title,
          i3 = void 0 === n3 ? '' : n3,
          r3 = e4.printCallback,
          o3 =
            void 0 === r3
              ? function (t5) {
                  return t5.print();
                }
              : r3,
          a3 = e4.hideIframe,
          s3 = void 0 === a3 || a3,
          l3 = e4.removeIframe,
          u3 = void 0 === l3 || l3;
        (this.htmlDoc = t4),
          (this.title = i3),
          (this.printCallback = o3),
          (this.hideIframe = s3),
          (this.removeIframe = u3);
      }
      var e3 = t3.prototype;
      return (
        (e3.init = function () {
          (this.iframe = document.createElement('iframe')),
            this.hideIframe &&
              ((this.iframe.style.width = '0'),
              (this.iframe.style.height = '0'),
              (this.iframe.style.borderWidth = '0')),
            (this.window = window),
            (this.window.printInstance = this),
            (this.iframe.srcdoc =
              `
      <!DOCTYPE html>
      <html data-vivliostyle-paginated="true">
        <head>
          <meta charset='utf-8'/>
          <meta name='viewport' content='width=device-width, initial-scale=1.0'/>
          <title>` +
              this.title +
              `</title>
          <style>
/*
 * Copyright 2015 Trim-marks Inc.
 * Copyright 2019 Vivliostyle Foundation
 *
 * Vivliostyle.js is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Vivliostyle.js is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with Vivliostyle.js.  If not, see <http://www.gnu.org/licenses/>.
 *
 */

[data-vivliostyle-layout-box] {
    position: absolute;
    left: 0;
    top: 0;
    right: 0;
    bottom: 0;
    overflow: hidden;
    z-index: -1;
}

[data-vivliostyle-debug] [data-vivliostyle-layout-box] {
    right: auto;
    bottom: auto;
    overflow: visible;
    z-index: auto;
}

[data-vivliostyle-page-container] {
    position: relative;
    overflow: hidden;
}

[data-vivliostyle-bleed-box] {
    position: absolute;
    overflow: hidden;
    max-width: 100%;
    max-height: 100%;
    box-sizing: border-box;
}

[data-vivliostyle-page-box] ~ [data-vivliostyle-page-box] {
    display: none;
}

[data-vivliostyle-toc-box] {
    position: absolute;
    left: 3px;
    top: 3px;
    overflow: scroll;
    overflow-x: hidden;
    background: rgba(248,248,248,0.9);
    border-radius: 2px;
    box-shadow: 1px 1px 2px rgba(0,0,0,0.4);
}

@media print {
    [data-vivliostyle-toc-box] {
        display: none;
    }

    [data-vivliostyle-outer-zoom-box], [data-vivliostyle-spread-container] {
        width: 100% !important;
        height: 100% !important;
    }

    [data-vivliostyle-spread-container], [data-vivliostyle-page-container] {
        -moz-transform: none !important;
        -ms-transform: none !important;
        -webkit-transform: none !important;
        transform: none !important;
    }

    [data-vivliostyle-page-container] {
        display: block !important;
        max-width: 100%;
        height: 100% !important;
        max-height: 100%;
    }

    /* Workaround for Chrome printing problem */
    /* [data-vivliostyle-page-box] {
        padding-bottom: 0 !important;
        overflow: visible !important;
    } */
    [data-vivliostyle-bleed-box] > div > div::before {
        display: block;
        content: "";
        padding-top: 0.015625px;
        margin-bottom: -0.015625px;
    }

    /* Gecko-only hack, see https://bugzilla.mozilla.org/show_bug.cgi?id=267029#c17 */
    @-moz-document regexp('.*') {
        [data-vivliostyle-page-container]:nth-last-child(n+2) {
            top: -1px;
            margin-top: 1px;
            margin-bottom: -1px;
        }
    }
}
</style>
          <style>
/*
 * Copyright 2017 Trim-marks Inc.
 *
 * Vivliostyle.js is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Vivliostyle.js is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with Vivliostyle.js.  If not, see <http://www.gnu.org/licenses/>.
 *
 */

@media screen {

    [data-vivliostyle-viewer-viewport] {
        background: #AAAAAA;
    }

    [data-vivliostyle-page-container] {
        background: white;
    }

    [data-vivliostyle-viewer-viewport] {
        display: -webkit-flex;
        display: flex;
        overflow: auto;
        position: relative;
    }

    [data-vivliostyle-outer-zoom-box] {
        margin: auto;
        overflow: hidden;
        -webkit-flex: none;
        flex: none;
    }

    [data-vivliostyle-viewer-viewport] [data-vivliostyle-spread-container] {
        display: -webkit-flex;
        display: flex;
        -webkit-flex: none;
        flex: none;
        -webkit-justify-content: center;
        justify-content: center;
        -moz-transform-origin: left top;
        -ms-transform-origin: left top;
        -webkit-transform-origin: left top;
        transform-origin: left top;
    }

    [data-vivliostyle-viewer-viewport][data-vivliostyle-page-progression=ltr] [data-vivliostyle-spread-container] {
        -webkit-flex-direction: row;
        flex-direction: row;
    }

    [data-vivliostyle-viewer-viewport][data-vivliostyle-page-progression=rtl] [data-vivliostyle-spread-container] {
        -webkit-flex-direction: row-reverse;
        flex-direction: row-reverse;
    }

    [data-vivliostyle-viewer-viewport] [data-vivliostyle-page-container] {
        margin: 0 auto;
        -webkit-flex: none;
        flex: none;
        transform-origin: center top;
    }

    [data-vivliostyle-viewer-viewport][data-vivliostyle-spread-view=true] [data-vivliostyle-page-container][data-vivliostyle-page-side=left] {
        margin-right: 1px;
        transform-origin: right top;
    }

    [data-vivliostyle-viewer-viewport][data-vivliostyle-spread-view=true] [data-vivliostyle-page-container][data-vivliostyle-page-side=right] {
        margin-left: 1px;
        transform-origin: left top;
    }

    [data-vivliostyle-viewer-viewport][data-vivliostyle-spread-view=true] [data-vivliostyle-page-container][data-vivliostyle-unpaired-page=true] {
        margin-left: auto;
        margin-right: auto;
        transform-origin: center top;
    }

}
</style>
          <style>
            html[data-vivliostyle-paginated] {
              width: 100%;
              height: 100%;
            }
            html[data-vivliostyle-paginated] body,
            html[data-vivliostyle-paginated] [data-vivliostyle-viewer-viewport] {
              width: 100% !important;
              height: 100% !important;
            }
            html[data-vivliostyle-paginated],
            html[data-vivliostyle-paginated] body {
              margin: 0;
              padding: 0;
            }
          </style>
          <style id='vivliostyle-page-rules'></style>
        </head>
        <body onload='parent.printInstance.runInIframe(window)'>
          <div id="vivliostyle-viewer-viewport"></div>
        </body>
      </html>`),
            document.body.appendChild(this.iframe);
        }),
        (e3.runInIframe = function (t4) {
          var e4 = this;
          return (
            (this.iframeWin = t4),
            this.preparePrint()
              .then(function () {
                return e4.browserPrint();
              })
              .then(function () {
                return e4.cleanUp();
              })
          );
        }),
        (e3.preparePrint = function () {
          this.iframeWin.document.title = this.title;
          var t4 = new Blob([this.htmlDoc], { type: 'text/html' }),
            e4 = URL.createObjectURL(t4),
            n3 = new Gc(
              {
                viewportElement: this.iframeWin.document.body.firstElementChild,
                window: this.iframeWin,
                debug: true,
              },
              { defaultPaperSize: { width: 794, height: 1122 } },
            );
          return new Promise(function (t5) {
            n3.addListener('readystatechange', function () {
              'complete' === n3.readyState && t5();
            }),
              n3.loadDocument({ url: e4 });
          });
        }),
        (e3.browserPrint = function () {
          this.printCallback(this.iframeWin);
        }),
        (e3.cleanUp = function () {
          delete this.window.printInstance,
            this.removeIframe &&
              this.iframe.parentElement.removeChild(this.iframe);
        }),
        t3
      );
    })();
    (exports.CoreViewer = Gc),
      (exports.PageViewMode = jc),
      (exports.Profiler = v2),
      (exports.ZoomType = Xc),
      (exports.constants = s2),
      (exports.getHooksForName = g2),
      (exports.pageProgressionOf = o2),
      (exports.plugin = m2),
      (exports.printHTML = function (t3, e3) {
        new Kc(t3, e3).init();
      }),
      (exports.profile = C2),
      (exports.profiler = S2),
      (exports.registerHook = d2),
      (exports.removeHook = p2),
      (exports.setDebug = r2),
      (exports.viewer = Yc);
  });

  // node_modules/preact/dist/preact.module.js
  var n;
  var l;
  var u;
  var i;
  var t;
  var r;
  var o;
  var f = {};
  var e = [];
  var c = /acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;
  function s(n2, l2) {
    for (var u2 in l2) n2[u2] = l2[u2];
    return n2;
  }
  function a(n2) {
    var l2 = n2.parentNode;
    l2 && l2.removeChild(n2);
  }
  function v(n2, l2, u2) {
    var i2,
      t2 = arguments,
      r2 = {};
    for (i2 in l2) 'key' !== i2 && 'ref' !== i2 && (r2[i2] = l2[i2]);
    if (arguments.length > 3)
      for (u2 = [u2], i2 = 3; i2 < arguments.length; i2++) u2.push(t2[i2]);
    if (
      (null != u2 && (r2.children = u2),
      'function' == typeof n2 && null != n2.defaultProps)
    )
      for (i2 in n2.defaultProps)
        void 0 === r2[i2] && (r2[i2] = n2.defaultProps[i2]);
    return h(n2, r2, l2 && l2.key, l2 && l2.ref, null);
  }
  function h(l2, u2, i2, t2, r2) {
    var o2 = {
      type: l2,
      props: u2,
      key: i2,
      ref: t2,
      __k: null,
      __: null,
      __b: 0,
      __e: null,
      __d: void 0,
      __c: null,
      constructor: void 0,
      __v: r2,
    };
    return null == r2 && (o2.__v = o2), n.vnode && n.vnode(o2), o2;
  }
  function p(n2) {
    return n2.children;
  }
  function d(n2, l2) {
    (this.props = n2), (this.context = l2);
  }
  function _(n2, l2) {
    if (null == l2) return n2.__ ? _(n2.__, n2.__.__k.indexOf(n2) + 1) : null;
    for (var u2; l2 < n2.__k.length; l2++)
      if (null != (u2 = n2.__k[l2]) && null != u2.__e) return u2.__e;
    return 'function' == typeof n2.type ? _(n2) : null;
  }
  function k(n2) {
    var l2, u2;
    if (null != (n2 = n2.__) && null != n2.__c) {
      for (n2.__e = n2.__c.base = null, l2 = 0; l2 < n2.__k.length; l2++)
        if (null != (u2 = n2.__k[l2]) && null != u2.__e) {
          n2.__e = n2.__c.base = u2.__e;
          break;
        }
      return k(n2);
    }
  }
  function w(l2) {
    ((!l2.__d && (l2.__d = true) && u.push(l2) && !m.__r++) ||
      t !== n.debounceRendering) &&
      ((t = n.debounceRendering) || i)(m);
  }
  function m() {
    for (var n2; (m.__r = u.length); )
      (n2 = u.sort(function (n3, l2) {
        return n3.__v.__b - l2.__v.__b;
      })),
        (u = []),
        n2.some(function (n3) {
          var l2, u2, i2, t2, r2, o2, f2;
          n3.__d &&
            ((o2 = (r2 = (l2 = n3).__v).__e),
            (f2 = l2.__P) &&
              ((u2 = []),
              ((i2 = s({}, r2)).__v = i2),
              (t2 = T(
                f2,
                r2,
                i2,
                l2.__n,
                void 0 !== f2.ownerSVGElement,
                null,
                u2,
                null == o2 ? _(r2) : o2,
              )),
              $(u2, r2),
              t2 != o2 && k(r2)));
        });
  }
  function g(n2, l2, u2, i2, t2, r2, o2, c2, s2, v2) {
    var y2,
      d2,
      k2,
      w2,
      m2,
      g2,
      b2,
      A2 = (i2 && i2.__k) || e,
      P2 = A2.length;
    for (
      s2 == f && (s2 = null != o2 ? o2[0] : P2 ? _(i2, 0) : null),
        u2.__k = [],
        y2 = 0;
      y2 < l2.length;
      y2++
    )
      if (
        null !=
        (w2 = u2.__k[y2] =
          null == (w2 = l2[y2]) || 'boolean' == typeof w2
            ? null
            : 'string' == typeof w2 || 'number' == typeof w2
            ? h(null, w2, null, null, w2)
            : Array.isArray(w2)
            ? h(p, { children: w2 }, null, null, null)
            : null != w2.__e || null != w2.__c
            ? h(w2.type, w2.props, w2.key, null, w2.__v)
            : w2)
      ) {
        if (
          ((w2.__ = u2),
          (w2.__b = u2.__b + 1),
          null === (k2 = A2[y2]) ||
            (k2 && w2.key == k2.key && w2.type === k2.type))
        )
          A2[y2] = void 0;
        else
          for (d2 = 0; d2 < P2; d2++) {
            if ((k2 = A2[d2]) && w2.key == k2.key && w2.type === k2.type) {
              A2[d2] = void 0;
              break;
            }
            k2 = null;
          }
        (m2 = T(n2, w2, (k2 = k2 || f), t2, r2, o2, c2, s2, v2)),
          (d2 = w2.ref) &&
            k2.ref != d2 &&
            (b2 || (b2 = []),
            k2.ref && b2.push(k2.ref, null, w2),
            b2.push(d2, w2.__c || m2, w2)),
          null != m2
            ? (null == g2 && (g2 = m2),
              (s2 = x(n2, w2, k2, A2, o2, m2, s2)),
              'option' == u2.type
                ? (n2.value = '')
                : 'function' == typeof u2.type && (u2.__d = s2))
            : s2 && k2.__e == s2 && s2.parentNode != n2 && (s2 = _(k2));
      }
    if (((u2.__e = g2), null != o2 && 'function' != typeof u2.type))
      for (y2 = o2.length; y2--; ) null != o2[y2] && a(o2[y2]);
    for (y2 = P2; y2--; ) null != A2[y2] && I(A2[y2], A2[y2]);
    if (b2) for (y2 = 0; y2 < b2.length; y2++) H(b2[y2], b2[++y2], b2[++y2]);
  }
  function x(n2, l2, u2, i2, t2, r2, o2) {
    var f2, e2, c2;
    if (void 0 !== l2.__d) (f2 = l2.__d), (l2.__d = void 0);
    else if (t2 == u2 || r2 != o2 || null == r2.parentNode)
      n: if (null == o2 || o2.parentNode !== n2)
        n2.appendChild(r2), (f2 = null);
      else {
        for (e2 = o2, c2 = 0; (e2 = e2.nextSibling) && c2 < i2.length; c2 += 2)
          if (e2 == r2) break n;
        n2.insertBefore(r2, o2), (f2 = o2);
      }
    return void 0 !== f2 ? f2 : r2.nextSibling;
  }
  function A(n2, l2, u2, i2, t2) {
    var r2;
    for (r2 in u2)
      'children' === r2 ||
        'key' === r2 ||
        r2 in l2 ||
        C(n2, r2, null, u2[r2], i2);
    for (r2 in l2)
      (t2 && 'function' != typeof l2[r2]) ||
        'children' === r2 ||
        'key' === r2 ||
        'value' === r2 ||
        'checked' === r2 ||
        u2[r2] === l2[r2] ||
        C(n2, r2, l2[r2], u2[r2], i2);
  }
  function P(n2, l2, u2) {
    '-' === l2[0]
      ? n2.setProperty(l2, u2)
      : (n2[l2] =
          'number' == typeof u2 && false === c.test(l2)
            ? u2 + 'px'
            : null == u2
            ? ''
            : u2);
  }
  function C(n2, l2, u2, i2, t2) {
    var r2, o2, f2, e2, c2;
    if (
      (t2
        ? 'className' === l2 && (l2 = 'class')
        : 'class' === l2 && (l2 = 'className'),
      'style' === l2)
    )
      if (((r2 = n2.style), 'string' == typeof u2)) r2.cssText = u2;
      else {
        if (('string' == typeof i2 && ((r2.cssText = ''), (i2 = null)), i2))
          for (e2 in i2) (u2 && e2 in u2) || P(r2, e2, '');
        if (u2) for (c2 in u2) (i2 && u2[c2] === i2[c2]) || P(r2, c2, u2[c2]);
      }
    else
      'o' === l2[0] && 'n' === l2[1]
        ? ((o2 = l2 !== (l2 = l2.replace(/Capture$/, ''))),
          (f2 = l2.toLowerCase()),
          (l2 = (f2 in n2 ? f2 : l2).slice(2)),
          u2
            ? (i2 || n2.addEventListener(l2, N, o2),
              ((n2.l || (n2.l = {}))[l2] = u2))
            : n2.removeEventListener(l2, N, o2))
        : 'list' !== l2 &&
          'tagName' !== l2 &&
          'form' !== l2 &&
          'type' !== l2 &&
          'size' !== l2 &&
          !t2 &&
          l2 in n2
        ? (n2[l2] = null == u2 ? '' : u2)
        : 'function' != typeof u2 &&
          'dangerouslySetInnerHTML' !== l2 &&
          (l2 !== (l2 = l2.replace(/^xlink:?/, ''))
            ? null == u2 || false === u2
              ? n2.removeAttributeNS(
                  'http://www.w3.org/1999/xlink',
                  l2.toLowerCase(),
                )
              : n2.setAttributeNS(
                  'http://www.w3.org/1999/xlink',
                  l2.toLowerCase(),
                  u2,
                )
            : null == u2 || (false === u2 && !/^ar/.test(l2))
            ? n2.removeAttribute(l2)
            : n2.setAttribute(l2, u2));
  }
  function N(l2) {
    this.l[l2.type](n.event ? n.event(l2) : l2);
  }
  function z(n2, l2, u2) {
    var i2, t2;
    for (i2 = 0; i2 < n2.__k.length; i2++)
      (t2 = n2.__k[i2]) &&
        ((t2.__ = n2),
        t2.__e &&
          ('function' == typeof t2.type && t2.__k.length > 1 && z(t2, l2, u2),
          (l2 = x(u2, t2, t2, n2.__k, null, t2.__e, l2)),
          'function' == typeof n2.type && (n2.__d = l2)));
  }
  function T(l2, u2, i2, t2, r2, o2, f2, e2, c2) {
    var a2,
      v2,
      h2,
      y2,
      _2,
      k2,
      w2,
      m2,
      b2,
      x2,
      A2,
      P2 = u2.type;
    if (void 0 !== u2.constructor) return null;
    (a2 = n.__b) && a2(u2);
    try {
      n: if ('function' == typeof P2) {
        if (
          ((m2 = u2.props),
          (b2 = (a2 = P2.contextType) && t2[a2.__c]),
          (x2 = a2 ? (b2 ? b2.props.value : a2.__) : t2),
          i2.__c
            ? (w2 = (v2 = u2.__c = i2.__c).__ = v2.__E)
            : ('prototype' in P2 && P2.prototype.render
                ? (u2.__c = v2 = new P2(m2, x2))
                : ((u2.__c = v2 = new d(m2, x2)),
                  (v2.constructor = P2),
                  (v2.render = L)),
              b2 && b2.sub(v2),
              (v2.props = m2),
              v2.state || (v2.state = {}),
              (v2.context = x2),
              (v2.__n = t2),
              (h2 = v2.__d = true),
              (v2.__h = [])),
          null == v2.__s && (v2.__s = v2.state),
          null != P2.getDerivedStateFromProps &&
            (v2.__s == v2.state && (v2.__s = s({}, v2.__s)),
            s(v2.__s, P2.getDerivedStateFromProps(m2, v2.__s))),
          (y2 = v2.props),
          (_2 = v2.state),
          h2)
        )
          null == P2.getDerivedStateFromProps &&
            null != v2.componentWillMount &&
            v2.componentWillMount(),
            null != v2.componentDidMount && v2.__h.push(v2.componentDidMount);
        else {
          if (
            (null == P2.getDerivedStateFromProps &&
              m2 !== y2 &&
              null != v2.componentWillReceiveProps &&
              v2.componentWillReceiveProps(m2, x2),
            (!v2.__e &&
              null != v2.shouldComponentUpdate &&
              false === v2.shouldComponentUpdate(m2, v2.__s, x2)) ||
              u2.__v === i2.__v)
          ) {
            (v2.props = m2),
              (v2.state = v2.__s),
              u2.__v !== i2.__v && (v2.__d = false),
              (v2.__v = u2),
              (u2.__e = i2.__e),
              (u2.__k = i2.__k),
              v2.__h.length && f2.push(v2),
              z(u2, e2, l2);
            break n;
          }
          null != v2.componentWillUpdate &&
            v2.componentWillUpdate(m2, v2.__s, x2),
            null != v2.componentDidUpdate &&
              v2.__h.push(function () {
                v2.componentDidUpdate(y2, _2, k2);
              });
        }
        (v2.context = x2),
          (v2.props = m2),
          (v2.state = v2.__s),
          (a2 = n.__r) && a2(u2),
          (v2.__d = false),
          (v2.__v = u2),
          (v2.__P = l2),
          (a2 = v2.render(v2.props, v2.state, v2.context)),
          (v2.state = v2.__s),
          null != v2.getChildContext &&
            (t2 = s(s({}, t2), v2.getChildContext())),
          h2 ||
            null == v2.getSnapshotBeforeUpdate ||
            (k2 = v2.getSnapshotBeforeUpdate(y2, _2)),
          (A2 =
            null != a2 && a2.type == p && null == a2.key
              ? a2.props.children
              : a2),
          g(l2, Array.isArray(A2) ? A2 : [A2], u2, i2, t2, r2, o2, f2, e2, c2),
          (v2.base = u2.__e),
          v2.__h.length && f2.push(v2),
          w2 && (v2.__E = v2.__ = null),
          (v2.__e = false);
      } else
        null == o2 && u2.__v === i2.__v
          ? ((u2.__k = i2.__k), (u2.__e = i2.__e))
          : (u2.__e = j(i2.__e, u2, i2, t2, r2, o2, f2, c2));
      (a2 = n.diffed) && a2(u2);
    } catch (l3) {
      (u2.__v = null), n.__e(l3, u2, i2);
    }
    return u2.__e;
  }
  function $(l2, u2) {
    n.__c && n.__c(u2, l2),
      l2.some(function (u3) {
        try {
          (l2 = u3.__h),
            (u3.__h = []),
            l2.some(function (n2) {
              n2.call(u3);
            });
        } catch (l3) {
          n.__e(l3, u3.__v);
        }
      });
  }
  function j(n2, l2, u2, i2, t2, r2, o2, c2) {
    var s2,
      a2,
      v2,
      h2,
      y2,
      p2 = u2.props,
      d2 = l2.props;
    if (((t2 = 'svg' === l2.type || t2), null != r2)) {
      for (s2 = 0; s2 < r2.length; s2++)
        if (
          null != (a2 = r2[s2]) &&
          ((null === l2.type ? 3 === a2.nodeType : a2.localName === l2.type) ||
            n2 == a2)
        ) {
          (n2 = a2), (r2[s2] = null);
          break;
        }
    }
    if (null == n2) {
      if (null === l2.type) return document.createTextNode(d2);
      (n2 = t2
        ? document.createElementNS('http://www.w3.org/2000/svg', l2.type)
        : document.createElement(l2.type, d2.is && { is: d2.is })),
        (r2 = null),
        (c2 = false);
    }
    if (null === l2.type) p2 !== d2 && n2.data != d2 && (n2.data = d2);
    else {
      if (
        (null != r2 && (r2 = e.slice.call(n2.childNodes)),
        (v2 = (p2 = u2.props || f).dangerouslySetInnerHTML),
        (h2 = d2.dangerouslySetInnerHTML),
        !c2)
      ) {
        if (null != r2)
          for (p2 = {}, y2 = 0; y2 < n2.attributes.length; y2++)
            p2[n2.attributes[y2].name] = n2.attributes[y2].value;
        (h2 || v2) &&
          ((h2 && v2 && h2.__html == v2.__html) ||
            (n2.innerHTML = (h2 && h2.__html) || ''));
      }
      A(n2, d2, p2, t2, c2),
        h2
          ? (l2.__k = [])
          : ((s2 = l2.props.children),
            g(
              n2,
              Array.isArray(s2) ? s2 : [s2],
              l2,
              u2,
              i2,
              'foreignObject' !== l2.type && t2,
              r2,
              o2,
              f,
              c2,
            )),
        c2 ||
          ('value' in d2 &&
            void 0 !== (s2 = d2.value) &&
            s2 !== n2.value &&
            C(n2, 'value', s2, p2.value, false),
          'checked' in d2 &&
            void 0 !== (s2 = d2.checked) &&
            s2 !== n2.checked &&
            C(n2, 'checked', s2, p2.checked, false));
    }
    return n2;
  }
  function H(l2, u2, i2) {
    try {
      'function' == typeof l2 ? l2(u2) : (l2.current = u2);
    } catch (l3) {
      n.__e(l3, i2);
    }
  }
  function I(l2, u2, i2) {
    var t2, r2, o2;
    if (
      (n.unmount && n.unmount(l2),
      (t2 = l2.ref) &&
        ((t2.current && t2.current !== l2.__e) || H(t2, null, u2)),
      i2 || 'function' == typeof l2.type || (i2 = null != (r2 = l2.__e)),
      (l2.__e = l2.__d = void 0),
      null != (t2 = l2.__c))
    ) {
      if (t2.componentWillUnmount)
        try {
          t2.componentWillUnmount();
        } catch (l3) {
          n.__e(l3, u2);
        }
      t2.base = t2.__P = null;
    }
    if ((t2 = l2.__k))
      for (o2 = 0; o2 < t2.length; o2++) t2[o2] && I(t2[o2], u2, i2);
    null != r2 && a(r2);
  }
  function L(n2, l2, u2) {
    return this.constructor(n2, u2);
  }
  function M(l2, u2, i2) {
    var t2, o2, c2;
    n.__ && n.__(l2, u2),
      (o2 = (t2 = i2 === r) ? null : (i2 && i2.__k) || u2.__k),
      (l2 = v(p, null, [l2])),
      (c2 = []),
      T(
        u2,
        ((t2 ? u2 : i2 || u2).__k = l2),
        o2 || f,
        f,
        void 0 !== u2.ownerSVGElement,
        i2 && !t2
          ? [i2]
          : o2
          ? null
          : u2.childNodes.length
          ? e.slice.call(u2.childNodes)
          : null,
        c2,
        i2 || f,
        t2,
      ),
      $(c2, l2);
  }
  (n = {
    __e: function (n2, l2) {
      for (var u2, i2; (l2 = l2.__); )
        if ((u2 = l2.__c) && !u2.__)
          try {
            if (
              (u2.constructor &&
                null != u2.constructor.getDerivedStateFromError &&
                ((i2 = true),
                u2.setState(u2.constructor.getDerivedStateFromError(n2))),
              null != u2.componentDidCatch &&
                ((i2 = true), u2.componentDidCatch(n2)),
              i2)
            )
              return w((u2.__E = u2));
          } catch (l3) {
            n2 = l3;
          }
      throw n2;
    },
  }),
    (l = function (n2) {
      return null != n2 && void 0 === n2.constructor;
    }),
    (d.prototype.setState = function (n2, l2) {
      var u2;
      (u2 =
        this.__s !== this.state ? this.__s : (this.__s = s({}, this.state))),
        'function' == typeof n2 && (n2 = n2(u2, this.props)),
        n2 && s(u2, n2),
        null != n2 && this.__v && (l2 && this.__h.push(l2), w(this));
    }),
    (d.prototype.forceUpdate = function (n2) {
      this.__v && ((this.__e = true), n2 && this.__h.push(n2), w(this));
    }),
    (d.prototype.render = p),
    (u = []),
    (i =
      'function' == typeof Promise
        ? Promise.prototype.then.bind(Promise.resolve())
        : setTimeout),
    (m.__r = 0),
    (r = f),
    (o = 0);

  // broker/main.js
  const core = __toModule(require_vivliostyle());
  function parseQuery(text) {
    var qs = text.slice(1).split('&');
    var ret = {};
    for (var i2 = 0; i2 < qs.length; i2++) {
      var q2 = qs[i2].split('=');
      if (q2.length > 0) {
        ret[decodeURIComponent(q2[0])] = q2[1] ? decodeURIComponent(q2[1]) : '';
      }
    }
    return ret;
  }
  class Menu extends d {
    constructor(props) {
      super(props);
      this.state = Object.assign({}, this.props.defaultSettings, {
        valueChanged: false,
        prevSettings: this.props.defaultSettings,
      });
    }
    onPageSizeRadioClick(value) {
      return () => {
        if (this.state.pageSizeOption !== value) {
          this.setState({
            valueChanged: true,
            pageSizeOption: value,
          });
        }
      };
    }
    onPresetSelectChange(e2) {
      if (e2.target.value !== this.state.pageSizePresetSelect) {
        this.setState({
          valueChanged: true,
          pageSizePresetSelect: e2.target.value,
        });
      }
    }
    onUseLandscapeCheckboxClick() {
      this.setState({
        valueChanged: true,
        pageSizeUseLandscape: !this.state.pageSizeUseLandscape,
      });
    }
    onWidthTextChange(e2) {
      this.setState({
        valueChanged: true,
        pageSizeWidth: e2.target.value,
      });
    }
    onHeightTextChange(e2) {
      this.setState({
        valueChanged: true,
        pageSizeHeight: e2.target.value,
      });
    }
    onOverrideCheckboxClick() {
      this.setState({
        valueChanged: true,
        overrideDocumentStylesheets: !this.state.overrideDocumentStylesheets,
      });
    }
    onLoadModeRadioClick(value) {
      return () => {
        console.log(value);
        if (this.state.loadMode !== value) {
          this.setState({
            valueChanged: true,
            loadMode: value,
          });
        }
      };
    }
    onPrintButtonClick() {
      if (this.state.valueChanged) {
      } else {
        window.print();
      }
    }
    onResetButtonClick() {
      this.setState({
        ...this.state.prevSettings,
        valueChanged: false,
      });
    }
    onApplyButtonClick() {
      const prevSettings = Object.keys(this.props.defaultSettings).reduce(
        (obj, k2) => {
          obj[k2] = this.state[k2];
          return obj;
        },
        {},
      );
      this.setState({
        prevSettings,
        valueChanged: false,
      });
      this.props.onApplySettings(prevSettings);
    }
    render() {
      const {
        vivliostyleState,
        brokerVersion,
        vivliostyleVersion,
      } = this.props;
      const {
        valueChanged,
        pageSizeOption,
        pageSizePresetSelect,
        pageSizeUseLandscape,
        pageSizeWidth,
        pageSizeHeight,
        overrideDocumentStylesheets,
        loadMode,
      } = this.state;
      const footerButton = valueChanged
        ? [
            v(
              'button',
              {
                className: 'Menu_footer-button cancel',
                onClick: this.onResetButtonClick.bind(this),
              },
              'Reset',
            ),
            v(
              'button',
              {
                className: 'Menu_footer-button',
                onClick: this.onApplyButtonClick.bind(this),
              },
              'Apply',
            ),
          ]
        : vivliostyleState === 'loading' || vivliostyleState === 'interactive'
        ? v(
            'button',
            { className: 'Menu_footer-button', disabled: true },
            'Rendering',
          )
        : v(
            'button',
            {
              className: 'Menu_footer-button',
              onClick: this.onPrintButtonClick.bind(this),
            },
            'Print',
          );
      return v(
        'div',
        { className: 'Menu' },
        v(
          'div',
          { className: 'Menu_content' },
          v('h3', null, 'Viola print previewer'),
          v(
            'fieldset',
            { className: 'Menu_page-size Menu_item' },
            v('legend', null, v('h4', null, 'Page Size')),
            v(
              'ul',
              null,
              v(
                'li',
                { className: pageSizeOption === 'auto' ? 'selected' : '' },
                v('input', {
                  type: 'radio',
                  id: 'page-size_auto',
                  checked: pageSizeOption === 'auto',
                  onClick: this.onPageSizeRadioClick.bind(this)('auto'),
                }),
                v('label', { for: 'page-size_auto' }, 'Auto'),
              ),
              v(
                'li',
                { className: pageSizeOption === 'preset' ? 'selected' : '' },
                v('input', {
                  type: 'radio',
                  id: 'page-size_preset',
                  checked: pageSizeOption === 'preset',
                  onClick: this.onPageSizeRadioClick.bind(this)('preset'),
                }),
                v('label', { for: 'page-size_preset' }, 'Preset'),
                v(
                  'div',
                  { className: 'Menu_subform' },
                  v(
                    'div',
                    { className: 'Menu_input-form' },
                    v('span', null, 'Size'),
                    v(
                      'select',
                      {
                        value: pageSizePresetSelect,
                        onChange: this.onPresetSelectChange.bind(this),
                      },
                      v('option', { value: 'A5' }, 'A5'),
                      v('option', { value: 'A4' }, 'A4'),
                      v('option', { value: 'A3' }, 'A3'),
                      v('option', { value: 'B5' }, 'B5(ISO)'),
                      v('option', { value: 'B4' }, 'B4(ISO)'),
                      v('option', { value: 'JIS-B5' }, 'B5(JIS)'),
                      v('option', { value: 'JIS-B4' }, 'B4(JIS)'),
                      v('option', { value: 'letter' }, 'Letter'),
                      v('option', { value: 'legal' }, 'Legal'),
                      v('option', { value: 'ledger' }, 'Ledger'),
                    ),
                  ),
                  v(
                    'div',
                    { className: 'Menu_input-form' },
                    v('input', {
                      type: 'checkbox',
                      id: 'page-size_landscape',
                      checked: pageSizeUseLandscape,
                      onClick: this.onUseLandscapeCheckboxClick.bind(this),
                    }),
                    v('label', { for: 'page-size_landscape' }, 'Landscape'),
                  ),
                ),
              ),
              v(
                'li',
                { className: pageSizeOption === 'custom' ? 'selected' : '' },
                v('input', {
                  type: 'radio',
                  id: 'page-size_custom',
                  checked: pageSizeOption === 'custom',
                  onClick: this.onPageSizeRadioClick.bind(this)('custom'),
                }),
                v('label', { for: 'page-size_custom' }, 'Custom'),
                v(
                  'div',
                  { className: 'Menu_subform' },
                  v(
                    'div',
                    { className: 'Menu_input-form' },
                    v('label', { for: 'page-size_width' }, 'Width'),
                    v('input', {
                      type: 'text',
                      id: 'page-size_width',
                      size: 1,
                      value: pageSizeWidth,
                      onChange: this.onWidthTextChange.bind(this),
                    }),
                  ),
                  v(
                    'div',
                    { className: 'Menu_input-form' },
                    v('label', { for: 'page-size_height' }, 'Height'),
                    v('input', {
                      type: 'text',
                      id: 'page-size_height',
                      size: 1,
                      value: pageSizeHeight,
                      onChange: this.onHeightTextChange.bind(this),
                    }),
                  ),
                ),
              ),
            ),
          ),
          v(
            'div',
            { className: 'Menu_item' },
            v('input', {
              type: 'checkbox',
              id: 'override-stylesheets',
              checked: overrideDocumentStylesheets,
              onClick: this.onOverrideCheckboxClick.bind(this),
            }),
            v(
              'label',
              { for: 'override-stylesheets' },
              'Override Document StyleSheets',
            ),
          ),
          v(
            'fieldset',
            { className: 'Menu_load-mode Menu_item' },
            v('legend', null, v('h4', null, 'Document loading mode')),
            v(
              'ul',
              null,
              v(
                'li',
                { className: loadMode !== 'book' ? 'selected' : '' },
                v('input', {
                  type: 'radio',
                  id: 'load-mode_document',
                  checked: loadMode !== 'book',
                  onClick: this.onLoadModeRadioClick.bind(this)('document'),
                }),
                v('label', { for: 'load-mode_document' }, 'Document'),
                v(
                  'div',
                  { className: 'Menu_subform' },
                  v('small', null, 'It loads a single (X)HTML document.'),
                ),
              ),
              v(
                'li',
                { className: loadMode === 'book' ? 'selected' : '' },
                v('input', {
                  type: 'radio',
                  id: 'load-mode_book',
                  checked: loadMode === 'book',
                  onClick: this.onLoadModeRadioClick.bind(this)('book'),
                }),
                v('label', { for: 'load-mode_book' }, 'Book'),
                v(
                  'div',
                  { className: 'Menu_subform' },
                  v(
                    'small',
                    null,
                    'It loads a series of HTML documents. See also ',
                    v(
                      'a',
                      {
                        href:
                          'http://vivliostyle.github.io/vivliostyle.js/docs/en/',
                        target: '_blank',
                      },
                      'the Vivliostyle guide',
                    ),
                    '.',
                  ),
                ),
              ),
            ),
          ),
        ),
        v(
          'div',
          { className: 'Menu_footer' },
          v(
            'div',
            { className: 'Menu_footer-text' },
            v(
              'a',
              {
                href: 'https://github.com/vivliostyle/vivliostyle-cli',
                target: '_blank',
              },
              'vivliostyle-cli',
            ),
            brokerVersion && v('span', {}, ' v' + brokerVersion),
          ),
          v(
            'div',
            { className: 'Menu_footer-text' },
            'Powered by ',
            v(
              'a',
              { href: 'https://vivliostyle.org', target: '_blank' },
              'Vivliostyle',
            ),
            vivliostyleVersion && v('span', {}, ' v' + vivliostyleVersion),
          ),
          v('div', { className: 'Menu_footer-button-area' }, footerButton),
        ),
      );
    }
  }
  class PageNavigator extends d {
    onNavigationLeftClick() {
      window.coreViewer.navigateToPage('left');
    }
    onNavigationRightClick() {
      window.coreViewer.navigateToPage('right');
    }
    render() {
      return v(
        'div',
        { className: 'PageNavigator' },
        v('div', {
          className: 'PageNavigator_navigation-left',
          onClick: this.onNavigationLeftClick.bind(this),
        }),
        v('div', {
          className: 'PageNavigator_navigation-right',
          onClick: this.onNavigationRightClick.bind(this),
        }),
      );
    }
  }
  class App extends d {
    constructor(props) {
      super(props);
      let renderUrl = null;
      const query = parseQuery(window.location.search);
      if (query.render) {
        renderUrl = query.render;
      }
      this.state = {
        vivliostyleState: 'loading',
        renderUrl,
      };
      this.defaultSettings = {
        pageSizeOption: query.format
          ? 'preset'
          : query.width && query.height
          ? 'custom'
          : 'auto',
        pageSizePresetSelect: query.format || 'A5',
        pageSizeUseLandscape: false,
        pageSizeWidth: query.width || '210mm',
        pageSizeHeight: query.height || '297mm',
        overrideDocumentStylesheets:
          !!query.format || !!(query.width && query.height),
        loadMode: query.loadMode || 'book',
      };
      console.log(`defaultSettings`, JSON.stringify(this.defaultSettings));
    }
    getUserStyleSheetString({
      pageSizeOption,
      pageSizePresetSelect,
      pageSizeUseLandscape,
      pageSizeWidth,
      pageSizeHeight,
      overrideDocumentStylesheets,
    }) {
      let declaration = '';
      switch (pageSizeOption) {
        case 'auto':
          declaration += 'auto';
          break;
        case 'preset':
          declaration += pageSizePresetSelect;
          if (pageSizeUseLandscape) {
            declaration += ' landscape';
          }
          break;
        case 'custom':
          declaration += pageSizeWidth + ' ' + pageSizeHeight;
          break;
        default:
          throw new Error('Unknown mode ' + this.mode());
      }
      if (overrideDocumentStylesheets) {
        declaration += ' !important';
      }
      return `@page { size: ${declaration}; }`;
    }
    loadDocument(settings) {
      const { renderUrl, pageSizeOption } = this.state;
      if (!renderUrl) {
        return;
      }
      if (settings.loadMode === 'book') {
        window.coreViewer.loadPublication(
          renderUrl,
          {
            userStyleSheet: [
              {
                text: this.getUserStyleSheetString(settings),
              },
            ],
          },
          {
            fitToScreen: pageSizeOption === 'auto',
            pageViewMode: 'singlePage',
          },
        );
      } else {
        window.coreViewer.loadDocument(
          [renderUrl],
          {
            userStyleSheet: [
              {
                text: this.getUserStyleSheetString(settings),
              },
            ],
          },
          {
            fitToScreen: pageSizeOption === 'auto',
            pageViewMode: 'singlePage',
          },
        );
      }
    }
    fetchPackageInfo() {
      const xhr = new XMLHttpRequest();
      xhr.onload = () => {
        if (xhr.status >= 400 || !xhr.responseText) {
          return;
        }
        try {
          const json = JSON.parse(xhr.responseText);
          this.setState({
            brokerVersion: json.version,
            vivliostyleVersion: json.dependencies['@vivliostyle/core'],
          });
        } catch (err) {
          return;
        }
      };
      xhr.open('GET', '/package.json', true);
      xhr.send();
    }
    componentDidMount() {
      this.fetchPackageInfo();
      window.coreViewer = new core.CoreViewer({
        userAgentRootURL: '/node_modules/@vivliostyle/core/resources/',
        viewportElement: document.getElementById('out'),
        debug: false,
      });
      console.log(window.coreViewer);
      window.coreViewer.addListener('readystatechange', (e2) => {
        const vivliostyleState = window.coreViewer.readyState;
        this.setState({ vivliostyleState });
      });
      this.loadDocument(this.defaultSettings);
    }
    render() {
      const {
        vivliostyleState,
        brokerVersion,
        vivliostyleVersion,
      } = this.state;
      return v(
        'div',
        { className: 'App' },
        v(PageNavigator, null),
        v(Menu, {
          vivliostyleState,
          brokerVersion,
          vivliostyleVersion,
          defaultSettings: this.defaultSettings,
          onApplySettings: this.loadDocument.bind(this),
        }),
      );
    }
  }
  M(v(App), document.getElementById('ui'));
})();
